2025-09-05 08:32:25.073 +07:00 [INF] User profile is available. Using 'C:\Users\Administrator\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-09-05 08:32:25.380 +07:00 [INF] Now listening on: https://localhost:7277
2025-09-05 08:32:25.382 +07:00 [INF] Now listening on: http://localhost:5209
2025-09-05 08:32:25.576 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-05 08:32:25.590 +07:00 [INF] Hosting environment: Development
2025-09-05 08:32:25.591 +07:00 [INF] Content root path: C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.API
2025-09-05 08:32:27.673 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/swagger - null null
2025-09-05 08:32:27.896 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/swagger - 301 0 null 229.8737ms
2025-09-05 08:32:27.905 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/swagger/index.html - null null
2025-09-05 08:32:28.000 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/swagger/index.html - 200 null text/html;charset=utf-8 95.0488ms
2025-09-05 08:32:28.004 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/swagger/swagger-ui-standalone-preset.js - null null
2025-09-05 08:32:28.004 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/swagger/swagger-ui.css - null null
2025-09-05 08:32:28.004 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/swagger/swagger-ui-bundle.js - null null
2025-09-05 08:32:28.037 +07:00 [INF] Sending file. Request path: '/swagger-ui-standalone-preset.js'. Physical path: 'N/A'
2025-09-05 08:32:28.038 +07:00 [INF] Sending file. Request path: '/swagger-ui.css'. Physical path: 'N/A'
2025-09-05 08:32:28.040 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/swagger/swagger-ui-standalone-preset.js - 200 230280 text/javascript 36.1436ms
2025-09-05 08:32:28.041 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/swagger/swagger-ui.css - 200 152034 text/css 37.0703ms
2025-09-05 08:32:28.048 +07:00 [INF] Sending file. Request path: '/swagger-ui-bundle.js'. Physical path: 'N/A'
2025-09-05 08:32:28.050 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/swagger/swagger-ui-bundle.js - 200 1456926 text/javascript 45.9927ms
2025-09-05 08:32:28.051 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/_framework/aspnetcore-browser-refresh.js - null null
2025-09-05 08:32:28.063 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/_framework/aspnetcore-browser-refresh.js - 200 13766 application/javascript; charset=utf-8 12.5402ms
2025-09-05 08:32:28.071 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/_vs/browserLink - null null
2025-09-05 08:32:28.147 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/_vs/browserLink - 200 null text/javascript; charset=UTF-8 76.5877ms
2025-09-05 08:32:28.673 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/swagger/v1/swagger.json - null null
2025-09-05 08:32:28.740 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 67.769ms
2025-09-05 08:33:08.946 +07:00 [INF] Request starting HTTP/1.1 POST https://localhost:7277/api/auth/login - application/json; charset=utf-8 null
2025-09-05 08:33:09.034 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.AuthController.Login (PHONE_STORE.API)'
2025-09-05 08:33:09.074 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(LoginRequest, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.AuthController (PHONE_STORE.API).
2025-09-05 08:33:10.642 +07:00 [WRN] The decimal property 'DecValue' on entity type 'ProductAttributeValue' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 08:33:10.644 +07:00 [WRN] The decimal property 'ListPrice' on entity type 'ProductPrice' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 08:33:10.646 +07:00 [WRN] The decimal property 'SalePrice' on entity type 'ProductPrice' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 08:33:10.647 +07:00 [WRN] The decimal property 'WeightGram' on entity type 'ProductVariant' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 08:33:12.166 +07:00 [INF] Executed DbCommand (225ms) [Parameters=[:uname_0='?' (Size = 450), :username_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='0']
SELECT "u"."ID", "u"."CREATED_AT", "u"."EMAIL", "u"."PASSWORD_HASH", "u"."PHONE", "u"."STATUS"
FROM "USER_ACCOUNTS" "u"
WHERE (("u"."EMAIL" = :uname_0) OR ("u"."PHONE" = :username_1))
FETCH FIRST 1 ROWS ONLY
2025-09-05 08:33:12.896 +07:00 [INF] Executed DbCommand (47ms) [Parameters=[:userId_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "r"."CODE"
FROM "USER_ROLES" "u"
INNER JOIN "ROLES" "r" ON "u"."ROLE_ID" = "r"."ID"
WHERE "u"."USER_ID" = :userId_0
2025-09-05 08:33:12.974 +07:00 [INF] Login success [81]
2025-09-05 08:33:12.988 +07:00 [INF] Executing OkObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.AuthResponseDto'.
2025-09-05 08:33:13.003 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.AuthController.Login (PHONE_STORE.API) in 3919.4966ms
2025-09-05 08:33:13.006 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.AuthController.Login (PHONE_STORE.API)'
2025-09-05 08:33:13.022 +07:00 [INF] Request finished HTTP/1.1 POST https://localhost:7277/api/auth/login - 200 null application/json; charset=utf-8 4078.2979ms
2025-09-05 08:33:38.599 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/admin/warehouses - null null
2025-09-05 08:33:38.683 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.WarehousesController.GetAll (PHONE_STORE.API)'
2025-09-05 08:33:38.692 +07:00 [INF] Route matched with {action = "GetAll", controller = "Warehouses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.Application.Dtos.WarehouseDto]]] GetAll(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.WarehousesController (PHONE_STORE.API).
2025-09-05 08:33:38.838 +07:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='0']
SELECT "w"."ID", "w"."CODE", "w"."NAME", "w"."ADDRESS_LINE", "w"."DISTRICT", "w"."PROVINCE", "w"."IS_ACTIVE"
FROM "HEHE"."WAREHOUSES" "w"
ORDER BY "w"."CREATED_AT" DESC
2025-09-05 08:33:38.846 +07:00 [INF] Executing ObjectResult, writing value of type 'System.Collections.Generic.List`1[[PHONE_STORE.Application.Dtos.WarehouseDto, PHONE_STORE.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-05 08:33:38.851 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.WarehousesController.GetAll (PHONE_STORE.API) in 154.5337ms
2025-09-05 08:33:38.852 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.WarehousesController.GetAll (PHONE_STORE.API)'
2025-09-05 08:33:38.853 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/admin/warehouses - 200 null application/json; charset=utf-8 254.3731ms
2025-09-05 08:33:46.728 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/admin/warehouses/options - null null
2025-09-05 08:33:46.735 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.WarehousesController.Options (PHONE_STORE.API)'
2025-09-05 08:33:46.740 +07:00 [INF] Route matched with {action = "Options", controller = "Warehouses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.Application.Dtos.WarehouseOptionDto]]] Options(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.WarehousesController (PHONE_STORE.API).
2025-09-05 08:33:46.800 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='0']
SELECT "w"."ID", "w"."CODE", "w"."NAME"
FROM "HEHE"."WAREHOUSES" "w"
WHERE "w"."IS_ACTIVE" = 1
ORDER BY "w"."NAME"
2025-09-05 08:33:46.801 +07:00 [INF] Executing ObjectResult, writing value of type 'System.Collections.Generic.List`1[[PHONE_STORE.Application.Dtos.WarehouseOptionDto, PHONE_STORE.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-05 08:33:46.804 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.WarehousesController.Options (PHONE_STORE.API) in 60.4374ms
2025-09-05 08:33:46.805 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.WarehousesController.Options (PHONE_STORE.API)'
2025-09-05 08:33:46.806 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/admin/warehouses/options - 200 null application/json; charset=utf-8 77.5652ms
2025-09-05 08:33:57.485 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/admin/customers?q= - null null
2025-09-05 08:33:57.488 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.CustomersController.Search (PHONE_STORE.API)'
2025-09-05 08:33:57.492 +07:00 [INF] Route matched with {action = "Search", controller = "Customers"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.Application.Dtos.CustomerDto]]] Search(System.String, Int32, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.CustomersController (PHONE_STORE.API).
2025-09-05 08:33:57.523 +07:00 [INF] Executed DbCommand (7ms) [Parameters=[:p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."USER_ACCOUNT_ID", "c"."EMAIL", "c"."PHONE", "c"."FULL_NAME", "c"."CREATED_AT", "c"."UPDATED_AT"
FROM "HEHE"."CUSTOMERS" "c"
ORDER BY "c"."CREATED_AT" DESC
FETCH FIRST :p_0 ROWS ONLY
2025-09-05 08:33:57.525 +07:00 [INF] Executing ObjectResult, writing value of type 'System.Collections.Generic.List`1[[PHONE_STORE.Application.Dtos.CustomerDto, PHONE_STORE.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-05 08:33:57.544 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.CustomersController.Search (PHONE_STORE.API) in 49.8953ms
2025-09-05 08:33:57.546 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.CustomersController.Search (PHONE_STORE.API)'
2025-09-05 08:33:57.548 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/admin/customers?q= - 200 null application/json; charset=utf-8 63.0411ms
2025-09-05 08:34:01.602 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/admin/customers/2 - null null
2025-09-05 08:34:01.605 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.CustomersController.Get (PHONE_STORE.API)'
2025-09-05 08:34:01.610 +07:00 [INF] Route matched with {action = "Get", controller = "Customers"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[PHONE_STORE.Application.Dtos.CustomerDto]] Get(Int64, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.CustomersController (PHONE_STORE.API).
2025-09-05 08:34:01.625 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."USER_ACCOUNT_ID", "c"."EMAIL", "c"."PHONE", "c"."FULL_NAME", "c"."CREATED_AT", "c"."UPDATED_AT"
FROM "HEHE"."CUSTOMERS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 08:34:01.627 +07:00 [INF] Executing OkObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CustomerDto'.
2025-09-05 08:34:01.628 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.CustomersController.Get (PHONE_STORE.API) in 16.7527ms
2025-09-05 08:34:01.629 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.CustomersController.Get (PHONE_STORE.API)'
2025-09-05 08:34:01.630 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/admin/customers/2 - 200 null application/json; charset=utf-8 28.1374ms
2025-09-05 08:34:01.636 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/admin/customers/2/addresses - null null
2025-09-05 08:34:01.638 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.CustomersController.ListAddresses (PHONE_STORE.API)'
2025-09-05 08:34:01.643 +07:00 [INF] Route matched with {action = "ListAddresses", controller = "Customers"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.Application.Dtos.AddressDto]]] ListAddresses(Int64, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.CustomersController (PHONE_STORE.API).
2025-09-05 08:34:01.661 +07:00 [INF] Executed DbCommand (7ms) [Parameters=[:customerId_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "a"."ID", "a"."CUSTOMER_ID", "a"."LABEL", "a"."RECIPIENT", "a"."PHONE", "a"."LINE1", "a"."WARD", "a"."DISTRICT", "a"."PROVINCE", "a"."POSTAL_CODE", "a"."ADDRESS_TYPE", "a"."IS_DEFAULT", "a"."CREATED_AT", "a"."UPDATED_AT"
FROM "HEHE"."ADDRESSES" "a"
WHERE "a"."CUSTOMER_ID" = :customerId_0
ORDER BY "a"."IS_DEFAULT" DESC, "a"."CREATED_AT" DESC
2025-09-05 08:34:01.664 +07:00 [INF] Executing ObjectResult, writing value of type 'System.Collections.Generic.List`1[[PHONE_STORE.Application.Dtos.AddressDto, PHONE_STORE.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-05 08:34:01.669 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.CustomersController.ListAddresses (PHONE_STORE.API) in 24.7578ms
2025-09-05 08:34:01.670 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.CustomersController.ListAddresses (PHONE_STORE.API)'
2025-09-05 08:34:01.671 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/admin/customers/2/addresses - 200 null application/json; charset=utf-8 34.2111ms
2025-09-05 08:34:06.347 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/admin/customers?q= - null null
2025-09-05 08:34:06.350 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.CustomersController.Search (PHONE_STORE.API)'
2025-09-05 08:34:06.350 +07:00 [INF] Route matched with {action = "Search", controller = "Customers"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.Application.Dtos.CustomerDto]]] Search(System.String, Int32, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.CustomersController (PHONE_STORE.API).
2025-09-05 08:34:06.362 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[:p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."USER_ACCOUNT_ID", "c"."EMAIL", "c"."PHONE", "c"."FULL_NAME", "c"."CREATED_AT", "c"."UPDATED_AT"
FROM "HEHE"."CUSTOMERS" "c"
ORDER BY "c"."CREATED_AT" DESC
FETCH FIRST :p_0 ROWS ONLY
2025-09-05 08:34:06.365 +07:00 [INF] Executing ObjectResult, writing value of type 'System.Collections.Generic.List`1[[PHONE_STORE.Application.Dtos.CustomerDto, PHONE_STORE.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-05 08:34:06.366 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.CustomersController.Search (PHONE_STORE.API) in 14.1357ms
2025-09-05 08:34:06.367 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.CustomersController.Search (PHONE_STORE.API)'
2025-09-05 08:34:06.367 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/admin/customers?q= - 200 null application/json; charset=utf-8 20.3782ms
2025-09-05 08:34:07.939 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/admin/customers/1 - null null
2025-09-05 08:34:07.943 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.CustomersController.Get (PHONE_STORE.API)'
2025-09-05 08:34:07.951 +07:00 [INF] Route matched with {action = "Get", controller = "Customers"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[PHONE_STORE.Application.Dtos.CustomerDto]] Get(Int64, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.CustomersController (PHONE_STORE.API).
2025-09-05 08:34:07.965 +07:00 [INF] Executed DbCommand (7ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."USER_ACCOUNT_ID", "c"."EMAIL", "c"."PHONE", "c"."FULL_NAME", "c"."CREATED_AT", "c"."UPDATED_AT"
FROM "HEHE"."CUSTOMERS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 08:34:07.967 +07:00 [INF] Executing OkObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CustomerDto'.
2025-09-05 08:34:07.968 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.CustomersController.Get (PHONE_STORE.API) in 12.8316ms
2025-09-05 08:34:07.969 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.CustomersController.Get (PHONE_STORE.API)'
2025-09-05 08:34:07.970 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/admin/customers/1 - 200 null application/json; charset=utf-8 31.0046ms
2025-09-05 08:34:07.972 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/admin/customers/1/addresses - null null
2025-09-05 08:34:07.974 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.CustomersController.ListAddresses (PHONE_STORE.API)'
2025-09-05 08:34:07.975 +07:00 [INF] Route matched with {action = "ListAddresses", controller = "Customers"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.Application.Dtos.AddressDto]]] ListAddresses(Int64, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.CustomersController (PHONE_STORE.API).
2025-09-05 08:34:07.981 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:customerId_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "a"."ID", "a"."CUSTOMER_ID", "a"."LABEL", "a"."RECIPIENT", "a"."PHONE", "a"."LINE1", "a"."WARD", "a"."DISTRICT", "a"."PROVINCE", "a"."POSTAL_CODE", "a"."ADDRESS_TYPE", "a"."IS_DEFAULT", "a"."CREATED_AT", "a"."UPDATED_AT"
FROM "HEHE"."ADDRESSES" "a"
WHERE "a"."CUSTOMER_ID" = :customerId_0
ORDER BY "a"."IS_DEFAULT" DESC, "a"."CREATED_AT" DESC
2025-09-05 08:34:07.983 +07:00 [INF] Executing ObjectResult, writing value of type 'System.Collections.Generic.List`1[[PHONE_STORE.Application.Dtos.AddressDto, PHONE_STORE.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-05 08:34:07.984 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.CustomersController.ListAddresses (PHONE_STORE.API) in 7.1593ms
2025-09-05 08:34:07.985 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.CustomersController.ListAddresses (PHONE_STORE.API)'
2025-09-05 08:34:07.985 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/admin/customers/1/addresses - 200 null application/json; charset=utf-8 12.9187ms
2025-09-05 08:34:09.264 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/admin/customers?q= - null null
2025-09-05 08:34:09.268 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.CustomersController.Search (PHONE_STORE.API)'
2025-09-05 08:34:09.268 +07:00 [INF] Route matched with {action = "Search", controller = "Customers"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.Application.Dtos.CustomerDto]]] Search(System.String, Int32, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.CustomersController (PHONE_STORE.API).
2025-09-05 08:34:09.275 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[:p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."USER_ACCOUNT_ID", "c"."EMAIL", "c"."PHONE", "c"."FULL_NAME", "c"."CREATED_AT", "c"."UPDATED_AT"
FROM "HEHE"."CUSTOMERS" "c"
ORDER BY "c"."CREATED_AT" DESC
FETCH FIRST :p_0 ROWS ONLY
2025-09-05 08:34:09.276 +07:00 [INF] Executing ObjectResult, writing value of type 'System.Collections.Generic.List`1[[PHONE_STORE.Application.Dtos.CustomerDto, PHONE_STORE.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-05 08:34:09.277 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.CustomersController.Search (PHONE_STORE.API) in 7.8746ms
2025-09-05 08:34:09.278 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.CustomersController.Search (PHONE_STORE.API)'
2025-09-05 08:34:09.279 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/admin/customers?q= - 200 null application/json; charset=utf-8 14.8064ms
2025-09-05 08:34:10.883 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/admin/customers/1 - null null
2025-09-05 08:34:10.885 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.CustomersController.Get (PHONE_STORE.API)'
2025-09-05 08:34:10.886 +07:00 [INF] Route matched with {action = "Get", controller = "Customers"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[PHONE_STORE.Application.Dtos.CustomerDto]] Get(Int64, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.CustomersController (PHONE_STORE.API).
2025-09-05 08:34:10.892 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."USER_ACCOUNT_ID", "c"."EMAIL", "c"."PHONE", "c"."FULL_NAME", "c"."CREATED_AT", "c"."UPDATED_AT"
FROM "HEHE"."CUSTOMERS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 08:34:10.899 +07:00 [INF] Executing OkObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CustomerDto'.
2025-09-05 08:34:10.900 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.CustomersController.Get (PHONE_STORE.API) in 11.2882ms
2025-09-05 08:34:10.901 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.CustomersController.Get (PHONE_STORE.API)'
2025-09-05 08:34:10.901 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/admin/customers/1 - 200 null application/json; charset=utf-8 18.484ms
2025-09-05 08:34:10.904 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/admin/customers/1/addresses - null null
2025-09-05 08:34:10.906 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.CustomersController.ListAddresses (PHONE_STORE.API)'
2025-09-05 08:34:10.907 +07:00 [INF] Route matched with {action = "ListAddresses", controller = "Customers"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.Application.Dtos.AddressDto]]] ListAddresses(Int64, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.CustomersController (PHONE_STORE.API).
2025-09-05 08:34:10.912 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:customerId_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "a"."ID", "a"."CUSTOMER_ID", "a"."LABEL", "a"."RECIPIENT", "a"."PHONE", "a"."LINE1", "a"."WARD", "a"."DISTRICT", "a"."PROVINCE", "a"."POSTAL_CODE", "a"."ADDRESS_TYPE", "a"."IS_DEFAULT", "a"."CREATED_AT", "a"."UPDATED_AT"
FROM "HEHE"."ADDRESSES" "a"
WHERE "a"."CUSTOMER_ID" = :customerId_0
ORDER BY "a"."IS_DEFAULT" DESC, "a"."CREATED_AT" DESC
2025-09-05 08:34:10.915 +07:00 [INF] Executing ObjectResult, writing value of type 'System.Collections.Generic.List`1[[PHONE_STORE.Application.Dtos.AddressDto, PHONE_STORE.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-05 08:34:10.916 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.CustomersController.ListAddresses (PHONE_STORE.API) in 7.6426ms
2025-09-05 08:34:10.918 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.CustomersController.ListAddresses (PHONE_STORE.API)'
2025-09-05 08:34:10.919 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/admin/customers/1/addresses - 200 null application/json; charset=utf-8 15.0155ms
2025-09-05 08:34:12.463 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/admin/customers?q= - null null
2025-09-05 08:34:12.465 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.CustomersController.Search (PHONE_STORE.API)'
2025-09-05 08:34:12.466 +07:00 [INF] Route matched with {action = "Search", controller = "Customers"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.Application.Dtos.CustomerDto]]] Search(System.String, Int32, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.CustomersController (PHONE_STORE.API).
2025-09-05 08:34:12.470 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."USER_ACCOUNT_ID", "c"."EMAIL", "c"."PHONE", "c"."FULL_NAME", "c"."CREATED_AT", "c"."UPDATED_AT"
FROM "HEHE"."CUSTOMERS" "c"
ORDER BY "c"."CREATED_AT" DESC
FETCH FIRST :p_0 ROWS ONLY
2025-09-05 08:34:12.472 +07:00 [INF] Executing ObjectResult, writing value of type 'System.Collections.Generic.List`1[[PHONE_STORE.Application.Dtos.CustomerDto, PHONE_STORE.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-05 08:34:12.473 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.CustomersController.Search (PHONE_STORE.API) in 6.1841ms
2025-09-05 08:34:12.474 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.CustomersController.Search (PHONE_STORE.API)'
2025-09-05 08:34:12.475 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/admin/customers?q= - 200 null application/json; charset=utf-8 11.5126ms
2025-09-05 08:34:14.430 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/admin/customers/1 - null null
2025-09-05 08:34:14.433 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.CustomersController.Get (PHONE_STORE.API)'
2025-09-05 08:34:14.434 +07:00 [INF] Route matched with {action = "Get", controller = "Customers"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[PHONE_STORE.Application.Dtos.CustomerDto]] Get(Int64, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.CustomersController (PHONE_STORE.API).
2025-09-05 08:34:14.445 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."USER_ACCOUNT_ID", "c"."EMAIL", "c"."PHONE", "c"."FULL_NAME", "c"."CREATED_AT", "c"."UPDATED_AT"
FROM "HEHE"."CUSTOMERS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 08:34:14.447 +07:00 [INF] Executing OkObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CustomerDto'.
2025-09-05 08:34:14.447 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.CustomersController.Get (PHONE_STORE.API) in 11.9967ms
2025-09-05 08:34:14.448 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.CustomersController.Get (PHONE_STORE.API)'
2025-09-05 08:34:14.449 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/admin/customers/1 - 200 null application/json; charset=utf-8 19.3653ms
2025-09-05 08:34:14.451 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/admin/customers/1/addresses - null null
2025-09-05 08:34:14.453 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.CustomersController.ListAddresses (PHONE_STORE.API)'
2025-09-05 08:34:14.453 +07:00 [INF] Route matched with {action = "ListAddresses", controller = "Customers"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.Application.Dtos.AddressDto]]] ListAddresses(Int64, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.CustomersController (PHONE_STORE.API).
2025-09-05 08:34:14.463 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:customerId_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "a"."ID", "a"."CUSTOMER_ID", "a"."LABEL", "a"."RECIPIENT", "a"."PHONE", "a"."LINE1", "a"."WARD", "a"."DISTRICT", "a"."PROVINCE", "a"."POSTAL_CODE", "a"."ADDRESS_TYPE", "a"."IS_DEFAULT", "a"."CREATED_AT", "a"."UPDATED_AT"
FROM "HEHE"."ADDRESSES" "a"
WHERE "a"."CUSTOMER_ID" = :customerId_0
ORDER BY "a"."IS_DEFAULT" DESC, "a"."CREATED_AT" DESC
2025-09-05 08:34:14.466 +07:00 [INF] Executing ObjectResult, writing value of type 'System.Collections.Generic.List`1[[PHONE_STORE.Application.Dtos.AddressDto, PHONE_STORE.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-05 08:34:14.467 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.CustomersController.ListAddresses (PHONE_STORE.API) in 11.5533ms
2025-09-05 08:34:14.468 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.CustomersController.ListAddresses (PHONE_STORE.API)'
2025-09-05 08:34:14.469 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/admin/customers/1/addresses - 200 null application/json; charset=utf-8 17.3897ms
2025-09-05 08:34:23.883 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/admin/customers?q= - null null
2025-09-05 08:34:23.885 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.CustomersController.Search (PHONE_STORE.API)'
2025-09-05 08:34:23.886 +07:00 [INF] Route matched with {action = "Search", controller = "Customers"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.Application.Dtos.CustomerDto]]] Search(System.String, Int32, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.CustomersController (PHONE_STORE.API).
2025-09-05 08:34:23.895 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."USER_ACCOUNT_ID", "c"."EMAIL", "c"."PHONE", "c"."FULL_NAME", "c"."CREATED_AT", "c"."UPDATED_AT"
FROM "HEHE"."CUSTOMERS" "c"
ORDER BY "c"."CREATED_AT" DESC
FETCH FIRST :p_0 ROWS ONLY
2025-09-05 08:34:23.897 +07:00 [INF] Executing ObjectResult, writing value of type 'System.Collections.Generic.List`1[[PHONE_STORE.Application.Dtos.CustomerDto, PHONE_STORE.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-05 08:34:23.899 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.CustomersController.Search (PHONE_STORE.API) in 11.1241ms
2025-09-05 08:34:23.900 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.CustomersController.Search (PHONE_STORE.API)'
2025-09-05 08:34:23.901 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/admin/customers?q= - 200 null application/json; charset=utf-8 17.7893ms
2025-09-05 08:37:29.334 +07:00 [INF] User profile is available. Using 'C:\Users\Administrator\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-09-05 08:37:29.541 +07:00 [INF] Now listening on: https://localhost:7277
2025-09-05 08:37:29.543 +07:00 [INF] Now listening on: http://localhost:5209
2025-09-05 08:37:29.615 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-05 08:37:29.617 +07:00 [INF] Hosting environment: Development
2025-09-05 08:37:29.618 +07:00 [INF] Content root path: C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.API
2025-09-05 08:37:30.185 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/swagger - null null
2025-09-05 08:37:30.320 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/swagger - 301 0 null 146.0426ms
2025-09-05 08:37:30.327 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/swagger/index.html - null null
2025-09-05 08:37:30.427 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/swagger/index.html - 200 null text/html;charset=utf-8 100.5178ms
2025-09-05 08:37:30.454 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/swagger/swagger-ui.css - null null
2025-09-05 08:37:30.455 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/swagger/swagger-ui-standalone-preset.js - null null
2025-09-05 08:37:30.455 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/swagger/swagger-ui-bundle.js - null null
2025-09-05 08:37:30.491 +07:00 [INF] Sending file. Request path: '/swagger-ui-standalone-preset.js'. Physical path: 'N/A'
2025-09-05 08:37:30.491 +07:00 [INF] Sending file. Request path: '/swagger-ui.css'. Physical path: 'N/A'
2025-09-05 08:37:30.493 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/swagger/swagger-ui-standalone-preset.js - 200 230280 text/javascript 38.2747ms
2025-09-05 08:37:30.497 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/swagger/swagger-ui.css - 200 152034 text/css 44.1832ms
2025-09-05 08:37:30.512 +07:00 [INF] Sending file. Request path: '/swagger-ui-bundle.js'. Physical path: 'N/A'
2025-09-05 08:37:30.516 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/swagger/swagger-ui-bundle.js - 200 1456926 text/javascript 61.6858ms
2025-09-05 08:37:30.669 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/_vs/browserLink - null null
2025-09-05 08:37:30.686 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/_framework/aspnetcore-browser-refresh.js - null null
2025-09-05 08:37:30.694 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/_framework/aspnetcore-browser-refresh.js - 200 13766 application/javascript; charset=utf-8 7.8515ms
2025-09-05 08:37:30.751 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/_vs/browserLink - 200 null text/javascript; charset=UTF-8 81.5053ms
2025-09-05 08:37:30.966 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/swagger/v1/swagger.json - null null
2025-09-05 08:37:30.973 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/swagger/favicon-32x32.png - null null
2025-09-05 08:37:30.975 +07:00 [INF] Sending file. Request path: '/favicon-32x32.png'. Physical path: 'N/A'
2025-09-05 08:37:30.976 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/swagger/favicon-32x32.png - 200 628 image/png 3.4225ms
2025-09-05 08:37:31.012 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 46.1545ms
2025-09-05 08:37:56.447 +07:00 [INF] Request starting HTTP/1.1 POST https://localhost:7277/api/auth/login - application/json; charset=utf-8 null
2025-09-05 08:37:56.488 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.AuthController.Login (PHONE_STORE.API)'
2025-09-05 08:37:56.511 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(LoginRequest, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.AuthController (PHONE_STORE.API).
2025-09-05 08:37:57.239 +07:00 [WRN] The decimal property 'DecValue' on entity type 'ProductAttributeValue' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 08:37:57.242 +07:00 [WRN] The decimal property 'ListPrice' on entity type 'ProductPrice' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 08:37:57.243 +07:00 [WRN] The decimal property 'SalePrice' on entity type 'ProductPrice' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 08:37:57.244 +07:00 [WRN] The decimal property 'WeightGram' on entity type 'ProductVariant' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 08:37:57.903 +07:00 [INF] Executed DbCommand (91ms) [Parameters=[:uname_0='?' (Size = 450), :username_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='0']
SELECT "u"."ID", "u"."CREATED_AT", "u"."EMAIL", "u"."PASSWORD_HASH", "u"."PHONE", "u"."STATUS"
FROM "USER_ACCOUNTS" "u"
WHERE (("u"."EMAIL" = :uname_0) OR ("u"."PHONE" = :username_1))
FETCH FIRST 1 ROWS ONLY
2025-09-05 08:37:58.268 +07:00 [INF] Executed DbCommand (21ms) [Parameters=[:userId_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "r"."CODE"
FROM "USER_ROLES" "u"
INNER JOIN "ROLES" "r" ON "u"."ROLE_ID" = "r"."ID"
WHERE "u"."USER_ID" = :userId_0
2025-09-05 08:37:58.313 +07:00 [INF] Login success [81]
2025-09-05 08:37:58.321 +07:00 [INF] Executing OkObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.AuthResponseDto'.
2025-09-05 08:37:58.329 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.AuthController.Login (PHONE_STORE.API) in 1812.9935ms
2025-09-05 08:37:58.331 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.AuthController.Login (PHONE_STORE.API)'
2025-09-05 08:37:58.337 +07:00 [INF] Request finished HTTP/1.1 POST https://localhost:7277/api/auth/login - 200 null application/json; charset=utf-8 1891.1727ms
2025-09-05 08:46:21.811 +07:00 [INF] User profile is available. Using 'C:\Users\Administrator\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-09-05 08:46:22.077 +07:00 [INF] Now listening on: https://localhost:7277
2025-09-05 08:46:22.079 +07:00 [INF] Now listening on: http://localhost:5209
2025-09-05 08:46:22.186 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-05 08:46:22.187 +07:00 [INF] Hosting environment: Development
2025-09-05 08:46:22.188 +07:00 [INF] Content root path: C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.API
2025-09-05 08:46:22.699 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/swagger/index.html - null null
2025-09-05 08:46:23.198 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/swagger/index.html - 200 null text/html;charset=utf-8 505.7754ms
2025-09-05 08:46:23.330 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/_framework/aspnetcore-browser-refresh.js - null null
2025-09-05 08:46:23.337 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/_framework/aspnetcore-browser-refresh.js - 200 13766 application/javascript; charset=utf-8 7.2939ms
2025-09-05 08:46:23.437 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/_vs/browserLink - null null
2025-09-05 08:46:23.508 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/_vs/browserLink - 200 null text/javascript; charset=UTF-8 71.1235ms
2025-09-05 08:46:23.630 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/swagger/v1/swagger.json - null null
2025-09-05 08:46:23.690 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 59.7153ms
2025-09-05 08:46:34.640 +07:00 [INF] Request starting HTTP/1.1 POST https://localhost:7277/api/auth/login - application/json; charset=utf-8 null
2025-09-05 08:46:34.691 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.AuthController.Login (PHONE_STORE.API)'
2025-09-05 08:46:34.731 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(LoginRequest, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.AuthController (PHONE_STORE.API).
2025-09-05 08:46:36.011 +07:00 [WRN] The decimal property 'DecValue' on entity type 'ProductAttributeValue' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 08:46:36.013 +07:00 [WRN] The decimal property 'ListPrice' on entity type 'ProductPrice' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 08:46:36.014 +07:00 [WRN] The decimal property 'SalePrice' on entity type 'ProductPrice' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 08:46:36.015 +07:00 [WRN] The decimal property 'WeightGram' on entity type 'ProductVariant' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 08:46:37.362 +07:00 [INF] Executed DbCommand (149ms) [Parameters=[:uname_0='?' (Size = 450), :username_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='0']
SELECT "u"."ID", "u"."CREATED_AT", "u"."EMAIL", "u"."PASSWORD_HASH", "u"."PHONE", "u"."STATUS"
FROM "USER_ACCOUNTS" "u"
WHERE (("u"."EMAIL" = :uname_0) OR ("u"."PHONE" = :username_1))
FETCH FIRST 1 ROWS ONLY
2025-09-05 08:46:38.023 +07:00 [INF] Executed DbCommand (30ms) [Parameters=[:userId_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "r"."CODE"
FROM "USER_ROLES" "u"
INNER JOIN "ROLES" "r" ON "u"."ROLE_ID" = "r"."ID"
WHERE "u"."USER_ID" = :userId_0
2025-09-05 08:46:38.095 +07:00 [INF] Login success [81]
2025-09-05 08:46:38.105 +07:00 [INF] Executing OkObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.AuthResponseDto'.
2025-09-05 08:46:38.122 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.AuthController.Login (PHONE_STORE.API) in 3380.7238ms
2025-09-05 08:46:38.124 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.AuthController.Login (PHONE_STORE.API)'
2025-09-05 08:46:38.133 +07:00 [INF] Request finished HTTP/1.1 POST https://localhost:7277/api/auth/login - 200 null application/json; charset=utf-8 3493.9121ms
2025-09-05 08:46:46.458 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/admin/inventory?variantId=1 - null null
2025-09-05 08:46:46.504 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.InventoryController.Get (PHONE_STORE.API)'
2025-09-05 08:46:46.515 +07:00 [INF] Route matched with {action = "Get", controller = "Inventory"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Object]] Get(System.Nullable`1[System.Int64], System.Nullable`1[System.Int64], System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.InventoryController (PHONE_STORE.API).
2025-09-05 08:46:46.657 +07:00 [INF] Executed DbCommand (8ms) [Parameters=[:variantId_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "i"."VARIANT_ID", "i"."WAREHOUSE_ID", "i"."QTY_ON_HAND", "i"."QTY_RESERVED", "i"."UPDATED_AT"
FROM "HEHE"."INVENTORY" "i"
WHERE "i"."VARIANT_ID" = :variantId_0
ORDER BY "i"."WAREHOUSE_ID"
2025-09-05 08:46:46.661 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[PHONE_STORE.Application.Dtos.InventoryDto, PHONE_STORE.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-05 08:46:46.665 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.InventoryController.Get (PHONE_STORE.API) in 146.9923ms
2025-09-05 08:46:46.666 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.InventoryController.Get (PHONE_STORE.API)'
2025-09-05 08:46:46.667 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/admin/inventory?variantId=1 - 200 null application/json; charset=utf-8 209.3704ms
2025-09-05 08:46:46.673 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/admin/warehouses/options - null null
2025-09-05 08:46:46.681 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.WarehousesController.Options (PHONE_STORE.API)'
2025-09-05 08:46:46.684 +07:00 [INF] Route matched with {action = "Options", controller = "Warehouses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.Application.Dtos.WarehouseOptionDto]]] Options(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.WarehousesController (PHONE_STORE.API).
2025-09-05 08:46:46.728 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='0']
SELECT "w"."ID", "w"."CODE", "w"."NAME"
FROM "HEHE"."WAREHOUSES" "w"
WHERE "w"."IS_ACTIVE" = 1
ORDER BY "w"."NAME"
2025-09-05 08:46:46.731 +07:00 [INF] Executing ObjectResult, writing value of type 'System.Collections.Generic.List`1[[PHONE_STORE.Application.Dtos.WarehouseOptionDto, PHONE_STORE.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-05 08:46:46.734 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.WarehousesController.Options (PHONE_STORE.API) in 49.4876ms
2025-09-05 08:46:46.735 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.WarehousesController.Options (PHONE_STORE.API)'
2025-09-05 08:46:46.736 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/admin/warehouses/options - 200 null application/json; charset=utf-8 63.1979ms
2025-09-05 08:46:51.332 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/admin/warehouses/options - null null
2025-09-05 08:46:51.335 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.WarehousesController.Options (PHONE_STORE.API)'
2025-09-05 08:46:51.336 +07:00 [INF] Route matched with {action = "Options", controller = "Warehouses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.Application.Dtos.WarehouseOptionDto]]] Options(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.WarehousesController (PHONE_STORE.API).
2025-09-05 08:46:51.347 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='0']
SELECT "w"."ID", "w"."CODE", "w"."NAME"
FROM "HEHE"."WAREHOUSES" "w"
WHERE "w"."IS_ACTIVE" = 1
ORDER BY "w"."NAME"
2025-09-05 08:46:51.348 +07:00 [INF] Executing ObjectResult, writing value of type 'System.Collections.Generic.List`1[[PHONE_STORE.Application.Dtos.WarehouseOptionDto, PHONE_STORE.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-05 08:46:51.349 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.WarehousesController.Options (PHONE_STORE.API) in 12.4429ms
2025-09-05 08:46:51.350 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.WarehousesController.Options (PHONE_STORE.API)'
2025-09-05 08:46:51.351 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/admin/warehouses/options - 200 null application/json; charset=utf-8 18.9697ms
2025-09-05 08:46:54.775 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/admin/warehouses/options - null null
2025-09-05 08:46:54.778 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.WarehousesController.Options (PHONE_STORE.API)'
2025-09-05 08:46:54.779 +07:00 [INF] Route matched with {action = "Options", controller = "Warehouses"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.Application.Dtos.WarehouseOptionDto]]] Options(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.WarehousesController (PHONE_STORE.API).
2025-09-05 08:46:54.786 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='0']
SELECT "w"."ID", "w"."CODE", "w"."NAME"
FROM "HEHE"."WAREHOUSES" "w"
WHERE "w"."IS_ACTIVE" = 1
ORDER BY "w"."NAME"
2025-09-05 08:46:54.789 +07:00 [INF] Executing ObjectResult, writing value of type 'System.Collections.Generic.List`1[[PHONE_STORE.Application.Dtos.WarehouseOptionDto, PHONE_STORE.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-05 08:46:54.791 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.WarehousesController.Options (PHONE_STORE.API) in 11.7308ms
2025-09-05 08:46:54.792 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.WarehousesController.Options (PHONE_STORE.API)'
2025-09-05 08:46:54.794 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/admin/warehouses/options - 200 null application/json; charset=utf-8 18.6406ms
2025-09-05 08:46:54.796 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/admin/inventory?warehouseId=2 - null null
2025-09-05 08:46:54.797 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.InventoryController.Get (PHONE_STORE.API)'
2025-09-05 08:46:54.797 +07:00 [INF] Route matched with {action = "Get", controller = "Inventory"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Object]] Get(System.Nullable`1[System.Int64], System.Nullable`1[System.Int64], System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.InventoryController (PHONE_STORE.API).
2025-09-05 08:46:54.809 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[:warehouseId_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "i"."VARIANT_ID", "i"."WAREHOUSE_ID", "i"."QTY_ON_HAND", "i"."QTY_RESERVED", "i"."UPDATED_AT"
FROM "HEHE"."INVENTORY" "i"
WHERE "i"."WAREHOUSE_ID" = :warehouseId_0
ORDER BY "i"."VARIANT_ID"
2025-09-05 08:46:54.811 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[PHONE_STORE.Application.Dtos.InventoryDto, PHONE_STORE.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-05 08:46:54.812 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.InventoryController.Get (PHONE_STORE.API) in 13.4454ms
2025-09-05 08:46:54.813 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.InventoryController.Get (PHONE_STORE.API)'
2025-09-05 08:46:54.813 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/admin/inventory?warehouseId=2 - 200 null application/json; charset=utf-8 17.7008ms
2025-09-05 09:38:14.931 +07:00 [WRN] The decimal property 'UnitPrice' on entity type 'CartItem' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 09:38:14.960 +07:00 [WRN] The decimal property 'GrandTotal' on entity type 'Order' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 09:38:14.960 +07:00 [WRN] The decimal property 'ShippingFee' on entity type 'Order' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 09:38:14.960 +07:00 [WRN] The decimal property 'Subtotal' on entity type 'Order' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 09:38:14.960 +07:00 [WRN] The decimal property 'VatAmount' on entity type 'Order' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 09:38:14.960 +07:00 [WRN] The decimal property 'LineTotal' on entity type 'OrderItem' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 09:38:14.960 +07:00 [WRN] The decimal property 'UnitPrice' on entity type 'OrderItem' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 09:38:14.960 +07:00 [WRN] The decimal property 'DecValue' on entity type 'ProductAttributeValue' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 09:38:14.960 +07:00 [WRN] The decimal property 'ListPrice' on entity type 'ProductPrice' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 09:38:14.960 +07:00 [WRN] The decimal property 'SalePrice' on entity type 'ProductPrice' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 09:38:14.960 +07:00 [WRN] The decimal property 'WeightGram' on entity type 'ProductVariant' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 09:38:21.447 +07:00 [WRN] The decimal property 'UnitPrice' on entity type 'CartItem' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 09:38:21.480 +07:00 [WRN] The decimal property 'GrandTotal' on entity type 'Order' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 09:38:21.481 +07:00 [WRN] The decimal property 'ShippingFee' on entity type 'Order' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 09:38:21.481 +07:00 [WRN] The decimal property 'Subtotal' on entity type 'Order' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 09:38:21.481 +07:00 [WRN] The decimal property 'VatAmount' on entity type 'Order' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 09:38:21.481 +07:00 [WRN] The decimal property 'LineTotal' on entity type 'OrderItem' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 09:38:21.481 +07:00 [WRN] The decimal property 'UnitPrice' on entity type 'OrderItem' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 09:38:21.481 +07:00 [WRN] The decimal property 'DecValue' on entity type 'ProductAttributeValue' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 09:38:21.481 +07:00 [WRN] The decimal property 'ListPrice' on entity type 'ProductPrice' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 09:38:21.481 +07:00 [WRN] The decimal property 'SalePrice' on entity type 'ProductPrice' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 09:38:21.481 +07:00 [WRN] The decimal property 'WeightGram' on entity type 'ProductVariant' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 09:38:21.733 +07:00 [WRN] The decimal property 'UnitPrice' on entity type 'CartItem' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 09:38:21.733 +07:00 [WRN] The decimal property 'GrandTotal' on entity type 'Order' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 09:38:21.733 +07:00 [WRN] The decimal property 'ShippingFee' on entity type 'Order' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 09:38:21.733 +07:00 [WRN] The decimal property 'Subtotal' on entity type 'Order' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 09:38:21.733 +07:00 [WRN] The decimal property 'VatAmount' on entity type 'Order' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 09:38:21.733 +07:00 [WRN] The decimal property 'LineTotal' on entity type 'OrderItem' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 09:38:21.733 +07:00 [WRN] The decimal property 'UnitPrice' on entity type 'OrderItem' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 09:38:21.733 +07:00 [WRN] The decimal property 'DecValue' on entity type 'ProductAttributeValue' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 09:38:21.733 +07:00 [WRN] The decimal property 'ListPrice' on entity type 'ProductPrice' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 09:38:21.733 +07:00 [WRN] The decimal property 'SalePrice' on entity type 'ProductPrice' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 09:38:21.733 +07:00 [WRN] The decimal property 'WeightGram' on entity type 'ProductVariant' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 09:38:21.769 +07:00 [ERR] The model for context 'PhoneDbContext' has pending changes. Add a new migration before updating the database. See https://aka.ms/efcore-docs-pending-changes.
2025-09-05 09:38:22.255 +07:00 [INF] Executed DbCommand (95ms) [Parameters=[], CommandType='"Text"', CommandTimeout='0']
DECLARE
V_COUNT INTEGER;
BEGIN
SELECT COUNT(TABLE_NAME) INTO V_COUNT from USER_TABLES where TABLE_NAME = '__EFMigrationsHistory';
IF V_COUNT = 0 THEN
Begin
BEGIN 
EXECUTE IMMEDIATE 'CREATE TABLE 
"__EFMigrationsHistory" (
    "MigrationId" NVARCHAR2(150) NOT NULL,
    "ProductVersion" NVARCHAR2(32) NOT NULL,
    CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY ("MigrationId")
)';
END;

End;

END IF;
EXCEPTION
WHEN OTHERS THEN
    IF(SQLCODE != -942)THEN
        RAISE;
    END IF;
END;
2025-09-05 09:38:22.375 +07:00 [INF] Executed DbCommand (110ms) [Parameters=[], CommandType='"Text"', CommandTimeout='0']
SELECT t.table_name FROM user_tables t WHERE t.table_name = N'__EFMigrationsHistory'
2025-09-05 09:38:22.387 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='0']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId"
2025-09-05 09:38:22.394 +07:00 [INF] Applying migration '20250825035038_AddUniqueIndexes'.
2025-09-05 09:38:22.513 +07:00 [ERR] 2025-09-05 09:38:22.511549 ThreadID:1   (ERROR)   OracleRelationalCommand.ExecuteNonQuery() :  Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-00955: name is already used by an existing object
ORA-06512: at line 2
https://docs.oracle.com/error-help/db/ora-00955/
   at OracleInternal.ServiceObjects.OracleFailoverMgrImpl.OnError(OracleConnection connection, CallHistoryRecord chr, Object mi, Exception ex, Boolean bTopLevelCall, Boolean& bCanRecordNewCall)
   at Oracle.ManagedDataAccess.Client.OracleCommand.ExecuteNonQuery()
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteNonQuery(RelationalCommandParameterObject parameterObject)
2025-09-05 09:38:22.514 +07:00 [ERR] Failed executing DbCommand (111ms) [Parameters=[], CommandType='"Text"', CommandTimeout='0']
BEGIN 
EXECUTE IMMEDIATE 'CREATE TABLE 
"ROLES" (
    "ID" NUMBER(19) GENERATED BY DEFAULT ON NULL AS IDENTITY NOT NULL,
    "CODE" NVARCHAR2(2000) NOT NULL,
    "NAME" NVARCHAR2(2000) NOT NULL,
    CONSTRAINT "PK_ROLES" PRIMARY KEY ("ID")
)';
END;
2025-09-05 09:38:22.517 +07:00 [ERR] 2025-09-05 09:38:22.517342 ThreadID:1   (ERROR)   OracleExecutionStrategy.Execute() :  Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-00955: name is already used by an existing object
ORA-06512: at line 2
https://docs.oracle.com/error-help/db/ora-00955/
   at OracleInternal.ServiceObjects.OracleFailoverMgrImpl.OnError(OracleConnection connection, CallHistoryRecord chr, Object mi, Exception ex, Boolean bTopLevelCall, Boolean& bCanRecordNewCall)
   at Oracle.ManagedDataAccess.Client.OracleCommand.ExecuteNonQuery()
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteNonQuery(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Migrations.MigrationCommand.ExecuteNonQuery(IRelationalConnection connection, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.MigrationCommandExecutor.Execute(IReadOnlyList`1 migrationCommands, IRelationalConnection connection, MigrationExecutionState executionState, Boolean beginTransaction, Boolean commitTransaction, Nullable`1 isolationLevel)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.MigrationCommandExecutor.<>c.<ExecuteNonQuery>b__3_1(DbContext _, ValueTuple`6 s)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
2025-09-05 09:38:22.518 +07:00 [ERR] 2025-09-05 09:38:22.518713 ThreadID:1   (ERROR)   OracleExecutionStrategy.Execute() :  Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-00955: name is already used by an existing object
ORA-06512: at line 2
https://docs.oracle.com/error-help/db/ora-00955/
   at OracleInternal.ServiceObjects.OracleFailoverMgrImpl.OnError(OracleConnection connection, CallHistoryRecord chr, Object mi, Exception ex, Boolean bTopLevelCall, Boolean& bCanRecordNewCall)
   at Oracle.ManagedDataAccess.Client.OracleCommand.ExecuteNonQuery()
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteNonQuery(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Migrations.MigrationCommand.ExecuteNonQuery(IRelationalConnection connection, IReadOnlyDictionary`2 parameterValues)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.MigrationCommandExecutor.Execute(IReadOnlyList`1 migrationCommands, IRelationalConnection connection, MigrationExecutionState executionState, Boolean beginTransaction, Boolean commitTransaction, Nullable`1 isolationLevel)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.MigrationCommandExecutor.<>c.<ExecuteNonQuery>b__3_1(DbContext _, ValueTuple`6 s)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.MigrationCommandExecutor.ExecuteNonQuery(IReadOnlyList`1 migrationCommands, IRelationalConnection connection, MigrationExecutionState executionState, Boolean commitTransaction, Nullable`1 isolationLevel)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.Migrator.MigrateImplementation(DbContext context, String targetMigration, MigrationExecutionState state, Boolean useTransaction)
   at Microsoft.EntityFrameworkCore.Migrations.Internal.Migrator.<>c.<Migrate>b__20_1(DbContext c, ValueTuple`4 s)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
2025-09-05 10:12:59.582 +07:00 [INF] User profile is available. Using 'C:\Users\Administrator\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-09-05 10:12:59.833 +07:00 [INF] Now listening on: https://localhost:7277
2025-09-05 10:12:59.834 +07:00 [INF] Now listening on: http://localhost:5209
2025-09-05 10:12:59.920 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-05 10:12:59.921 +07:00 [INF] Hosting environment: Development
2025-09-05 10:12:59.922 +07:00 [INF] Content root path: C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.API
2025-09-05 10:13:01.000 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/swagger/index.html - null null
2025-09-05 10:13:01.424 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/swagger/index.html - 200 null text/html;charset=utf-8 434.0925ms
2025-09-05 10:13:01.451 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/_vs/browserLink - null null
2025-09-05 10:13:01.451 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/_framework/aspnetcore-browser-refresh.js - null null
2025-09-05 10:13:01.472 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/_framework/aspnetcore-browser-refresh.js - 200 13766 application/javascript; charset=utf-8 21.0273ms
2025-09-05 10:13:01.650 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/_vs/browserLink - 200 null text/javascript; charset=UTF-8 199.2527ms
2025-09-05 10:13:01.802 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 10:13:01.881 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 10:13:01.914 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/swagger/v1/swagger.json - null null
2025-09-05 10:13:01.957 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 10:13:02.105 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 191.1228ms
2025-09-05 10:13:02.831 +07:00 [WRN] The decimal property 'UnitPrice' on entity type 'CartItem' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 10:13:02.833 +07:00 [WRN] The decimal property 'GrandTotal' on entity type 'Order' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 10:13:02.835 +07:00 [WRN] The decimal property 'ShippingFee' on entity type 'Order' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 10:13:02.836 +07:00 [WRN] The decimal property 'Subtotal' on entity type 'Order' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 10:13:02.838 +07:00 [WRN] The decimal property 'VatAmount' on entity type 'Order' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 10:13:02.839 +07:00 [WRN] The decimal property 'LineTotal' on entity type 'OrderItem' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 10:13:02.840 +07:00 [WRN] The decimal property 'UnitPrice' on entity type 'OrderItem' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 10:13:02.841 +07:00 [WRN] The decimal property 'DecValue' on entity type 'ProductAttributeValue' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 10:13:02.842 +07:00 [WRN] The decimal property 'ListPrice' on entity type 'ProductPrice' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 10:13:02.842 +07:00 [WRN] The decimal property 'SalePrice' on entity type 'ProductPrice' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 10:13:02.843 +07:00 [WRN] The decimal property 'WeightGram' on entity type 'ProductVariant' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 10:13:03.499 +07:00 [ERR] 2025-09-05 10:13:03.498709 ThreadID:5   (ERROR)   OracleRelationalCommand.ExecuteReaderAsync() :  Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-06550: line 14, column 63:
PL/SQL: ORA-00904: "SESSION_ID": invalid identifier
ORA-06550: line 14, column 1:
PL/SQL: SQL Statement ignored
https://docs.oracle.com/error-help/db/ora-06550/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
2025-09-05 10:13:03.507 +07:00 [ERR] Failed executing DbCommand (139ms) [Parameters=[:p0='?' (DbType = DateTime), :p1='?' (DbType = Int64), :p2='?' (Size = 64), :p3='?' (DbType = DateTime), :cur0='?' (Direction = Output) (DbType = Object)], CommandType='"Text"', CommandTimeout='0']
DECLARE

TYPE "rCARTS_0" IS RECORD
(
"ID" NUMBER(19)
);
TYPE "tCARTS_0" IS TABLE OF "rCARTS_0";
"lCARTS_0" "tCARTS_0";

BEGIN

"lCARTS_0" := "tCARTS_0"();
"lCARTS_0".extend(1);
INSERT INTO "HEHE"."CARTS" ("CREATED_AT", "CUSTOMER_ID", "SESSION_ID", "UPDATED_AT")
VALUES (:p0, :p1, :p2, :p3)
RETURNING "ID" INTO "lCARTS_0"(1)."ID";
OPEN :cur0 FOR SELECT "lCARTS_0"(1)."ID" FROM DUAL;

END;
2025-09-05 10:13:03.541 +07:00 [ERR] 2025-09-05 10:13:03.541370 ThreadID:5   (ERROR)   OracleExecutionStrategy.ExecuteAsync() :  Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-06550: line 14, column 63:
PL/SQL: ORA-00904: "SESSION_ID": invalid identifier
ORA-06550: line 14, column 1:
PL/SQL: SQL Statement ignored
https://docs.oracle.com/error-help/db/ora-06550/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
2025-09-05 10:13:03.549 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'PHONE_STORE.Infrastructure.Data.PhoneDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-06550: line 14, column 63:
PL/SQL: ORA-00904: "SESSION_ID": invalid identifier
ORA-06550: line 14, column 1:
PL/SQL: SQL Statement ignored
https://docs.oracle.com/error-help/db/ora-06550/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-06550: line 14, column 63:
PL/SQL: ORA-00904: "SESSION_ID": invalid identifier
ORA-06550: line 14, column 1:
PL/SQL: SQL Statement ignored
https://docs.oracle.com/error-help/db/ora-06550/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-09-05 10:13:03.688 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 1718.0397ms
2025-09-05 10:13:03.691 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 10:13:03.698 +07:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-06550: line 14, column 63:
PL/SQL: ORA-00904: "SESSION_ID": invalid identifier
ORA-06550: line 14, column 1:
PL/SQL: SQL Statement ignored
https://docs.oracle.com/error-help/db/ora-06550/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at PHONE_STORE.Infrastructure.Repositories.CartRepository.EnsureCartId(Nullable`1 customerId, String sessionId, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.Infrastructure\Repositories\CartRepository.cs:line 49
   at PHONE_STORE.Infrastructure.Repositories.CartRepository.GetOrCreateAsync(Nullable`1 customerId, String sessionId, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.Infrastructure\Repositories\CartRepository.cs:line 64
   at lambda_method9(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-05 10:13:03.760 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 500 null application/problem+json; charset=utf-8 1960.7697ms
2025-09-05 10:13:20.963 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - null null
2025-09-05 10:13:20.970 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 10:13:20.976 +07:00 [INF] Route matched with {action = "List", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem]]] List(System.String, System.Nullable`1[System.Int64], Int32, Int32, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 10:13:21.333 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API) in 354.6724ms
2025-09-05 10:13:21.336 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 10:13:21.338 +07:00 [ERR] An unhandled exception has occurred while executing the request.
System.ArgumentNullException: Value cannot be null. (Parameter 'parameter')
   at System.ArgumentNullException.Throw(String paramName)
   at System.ArgumentNullException.ThrowIfNull(Object argument, String paramName)
   at System.Linq.Expressions.Expression.Lambda(Expression body, String name, Boolean tailCall, IEnumerable`1 parameters)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.ReducingExpressionVisitor.Visit(Expression expression)
   at System.Dynamic.Utils.ExpressionVisitorUtils.VisitArguments(ExpressionVisitor visitor, IArgumentProvider nodes)
   at System.Linq.Expressions.ExpressionVisitor.VisitMethodCall(MethodCallExpression node)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.ReducingExpressionVisitor.Visit(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.MaterializeCollectionNavigationExpression.VisitChildren(ExpressionVisitor visitor)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.ReducingExpressionVisitor.Visit(Expression expression)
   at System.Dynamic.Utils.ExpressionVisitorUtils.VisitArguments(ExpressionVisitor visitor, IArgumentProvider nodes)
   at System.Linq.Expressions.ExpressionVisitor.VisitMethodCall(MethodCallExpression node)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.ReducingExpressionVisitor.Visit(Expression expression)
   at System.Dynamic.Utils.ExpressionVisitorUtils.VisitArguments(ExpressionVisitor visitor, IArgumentProvider nodes)
   at System.Linq.Expressions.ExpressionVisitor.VisitMethodCall(MethodCallExpression node)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.ReducingExpressionVisitor.Visit(Expression expression)
   at System.Dynamic.Utils.ExpressionVisitorUtils.VisitArguments(ExpressionVisitor visitor, IArgumentProvider nodes)
   at System.Linq.Expressions.ExpressionVisitor.VisitMethodCall(MethodCallExpression node)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.ReducingExpressionVisitor.Visit(Expression expression)
   at System.Dynamic.Utils.ExpressionVisitorUtils.VisitArguments(ExpressionVisitor visitor, IArgumentProvider nodes)
   at System.Linq.Expressions.ExpressionVisitor.VisitMethodCall(MethodCallExpression node)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.ReducingExpressionVisitor.Visit(Expression expression)
   at System.Dynamic.Utils.ExpressionVisitorUtils.VisitArguments(ExpressionVisitor visitor, IArgumentProvider nodes)
   at System.Linq.Expressions.ExpressionVisitor.VisitMethodCall(MethodCallExpression node)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.ReducingExpressionVisitor.Visit(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at System.Dynamic.Utils.ExpressionVisitorUtils.VisitArguments(ExpressionVisitor visitor, IArgumentProvider nodes)
   at System.Linq.Expressions.ExpressionVisitor.VisitNew(NewExpression node)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.PendingSelectorExpandingExpressionVisitor.Visit(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.Expand(Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryTranslationPreprocessor.Process(Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at PHONE_STORE.API.Controllers.ShopProductsController.List(String q, Nullable`1 catId, Int32 page, Int32 pageSize, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.API\Controllers\ShopProductsController.cs:line 35
   at lambda_method82(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-05 10:13:21.357 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - 500 null application/problem+json; charset=utf-8 393.6844ms
2025-09-05 10:13:25.024 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 10:13:25.028 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 10:13:25.029 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 10:13:25.065 +07:00 [ERR] 2025-09-05 10:13:25.065284 ThreadID:5   (ERROR)   OracleRelationalCommand.ExecuteReaderAsync() :  Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-06550: line 14, column 63:
PL/SQL: ORA-00904: "SESSION_ID": invalid identifier
ORA-06550: line 14, column 1:
PL/SQL: SQL Statement ignored
https://docs.oracle.com/error-help/db/ora-06550/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
2025-09-05 10:13:25.066 +07:00 [ERR] Failed executing DbCommand (6ms) [Parameters=[:p0='?' (DbType = DateTime), :p1='?' (DbType = Int64), :p2='?' (Size = 64), :p3='?' (DbType = DateTime), :cur0='?' (Direction = Output) (DbType = Object)], CommandType='"Text"', CommandTimeout='0']
DECLARE

TYPE "rCARTS_0" IS RECORD
(
"ID" NUMBER(19)
);
TYPE "tCARTS_0" IS TABLE OF "rCARTS_0";
"lCARTS_0" "tCARTS_0";

BEGIN

"lCARTS_0" := "tCARTS_0"();
"lCARTS_0".extend(1);
INSERT INTO "HEHE"."CARTS" ("CREATED_AT", "CUSTOMER_ID", "SESSION_ID", "UPDATED_AT")
VALUES (:p0, :p1, :p2, :p3)
RETURNING "ID" INTO "lCARTS_0"(1)."ID";
OPEN :cur0 FOR SELECT "lCARTS_0"(1)."ID" FROM DUAL;

END;
2025-09-05 10:13:25.070 +07:00 [ERR] 2025-09-05 10:13:25.070289 ThreadID:5   (ERROR)   OracleExecutionStrategy.ExecuteAsync() :  Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-06550: line 14, column 63:
PL/SQL: ORA-00904: "SESSION_ID": invalid identifier
ORA-06550: line 14, column 1:
PL/SQL: SQL Statement ignored
https://docs.oracle.com/error-help/db/ora-06550/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
2025-09-05 10:13:25.073 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'PHONE_STORE.Infrastructure.Data.PhoneDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-06550: line 14, column 63:
PL/SQL: ORA-00904: "SESSION_ID": invalid identifier
ORA-06550: line 14, column 1:
PL/SQL: SQL Statement ignored
https://docs.oracle.com/error-help/db/ora-06550/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-06550: line 14, column 63:
PL/SQL: ORA-00904: "SESSION_ID": invalid identifier
ORA-06550: line 14, column 1:
PL/SQL: SQL Statement ignored
https://docs.oracle.com/error-help/db/ora-06550/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-09-05 10:13:25.198 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 167.0515ms
2025-09-05 10:13:25.201 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 10:13:25.202 +07:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-06550: line 14, column 63:
PL/SQL: ORA-00904: "SESSION_ID": invalid identifier
ORA-06550: line 14, column 1:
PL/SQL: SQL Statement ignored
https://docs.oracle.com/error-help/db/ora-06550/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at PHONE_STORE.Infrastructure.Repositories.CartRepository.EnsureCartId(Nullable`1 customerId, String sessionId, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.Infrastructure\Repositories\CartRepository.cs:line 49
   at PHONE_STORE.Infrastructure.Repositories.CartRepository.GetOrCreateAsync(Nullable`1 customerId, String sessionId, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.Infrastructure\Repositories\CartRepository.cs:line 64
   at lambda_method9(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-05 10:13:25.214 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 500 null application/problem+json; charset=utf-8 190.6358ms
2025-09-05 10:13:27.944 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 10:13:27.946 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 10:13:27.947 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 10:13:27.961 +07:00 [ERR] 2025-09-05 10:13:27.961628 ThreadID:5   (ERROR)   OracleRelationalCommand.ExecuteReaderAsync() :  Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-06550: line 14, column 63:
PL/SQL: ORA-00904: "SESSION_ID": invalid identifier
ORA-06550: line 14, column 1:
PL/SQL: SQL Statement ignored
https://docs.oracle.com/error-help/db/ora-06550/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
2025-09-05 10:13:27.964 +07:00 [ERR] Failed executing DbCommand (8ms) [Parameters=[:p0='?' (DbType = DateTime), :p1='?' (DbType = Int64), :p2='?' (Size = 64), :p3='?' (DbType = DateTime), :cur0='?' (Direction = Output) (DbType = Object)], CommandType='"Text"', CommandTimeout='0']
DECLARE

TYPE "rCARTS_0" IS RECORD
(
"ID" NUMBER(19)
);
TYPE "tCARTS_0" IS TABLE OF "rCARTS_0";
"lCARTS_0" "tCARTS_0";

BEGIN

"lCARTS_0" := "tCARTS_0"();
"lCARTS_0".extend(1);
INSERT INTO "HEHE"."CARTS" ("CREATED_AT", "CUSTOMER_ID", "SESSION_ID", "UPDATED_AT")
VALUES (:p0, :p1, :p2, :p3)
RETURNING "ID" INTO "lCARTS_0"(1)."ID";
OPEN :cur0 FOR SELECT "lCARTS_0"(1)."ID" FROM DUAL;

END;
2025-09-05 10:13:27.969 +07:00 [ERR] 2025-09-05 10:13:27.969652 ThreadID:5   (ERROR)   OracleExecutionStrategy.ExecuteAsync() :  Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-06550: line 14, column 63:
PL/SQL: ORA-00904: "SESSION_ID": invalid identifier
ORA-06550: line 14, column 1:
PL/SQL: SQL Statement ignored
https://docs.oracle.com/error-help/db/ora-06550/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
2025-09-05 10:13:27.974 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'PHONE_STORE.Infrastructure.Data.PhoneDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-06550: line 14, column 63:
PL/SQL: ORA-00904: "SESSION_ID": invalid identifier
ORA-06550: line 14, column 1:
PL/SQL: SQL Statement ignored
https://docs.oracle.com/error-help/db/ora-06550/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-06550: line 14, column 63:
PL/SQL: ORA-00904: "SESSION_ID": invalid identifier
ORA-06550: line 14, column 1:
PL/SQL: SQL Statement ignored
https://docs.oracle.com/error-help/db/ora-06550/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-09-05 10:13:28.090 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 141.1642ms
2025-09-05 10:13:28.093 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 10:13:28.095 +07:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-06550: line 14, column 63:
PL/SQL: ORA-00904: "SESSION_ID": invalid identifier
ORA-06550: line 14, column 1:
PL/SQL: SQL Statement ignored
https://docs.oracle.com/error-help/db/ora-06550/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at PHONE_STORE.Infrastructure.Repositories.CartRepository.EnsureCartId(Nullable`1 customerId, String sessionId, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.Infrastructure\Repositories\CartRepository.cs:line 49
   at PHONE_STORE.Infrastructure.Repositories.CartRepository.GetOrCreateAsync(Nullable`1 customerId, String sessionId, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.Infrastructure\Repositories\CartRepository.cs:line 64
   at lambda_method9(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-05 10:13:28.113 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 500 null application/problem+json; charset=utf-8 169.2823ms
2025-09-05 10:13:36.053 +07:00 [INF] Request starting HTTP/1.1 POST https://localhost:7277/api/auth/login - application/json; charset=utf-8 null
2025-09-05 10:13:36.062 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.AuthController.Login (PHONE_STORE.API)'
2025-09-05 10:13:36.068 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(LoginRequest, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.AuthController (PHONE_STORE.API).
2025-09-05 10:13:36.641 +07:00 [INF] Executed DbCommand (71ms) [Parameters=[:uname_0='?' (Size = 450), :username_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='0']
SELECT "u"."ID", "u"."CREATED_AT", "u"."EMAIL", "u"."PASSWORD_HASH", "u"."PHONE", "u"."STATUS"
FROM "USER_ACCOUNTS" "u"
WHERE (("u"."EMAIL" = :uname_0) OR ("u"."PHONE" = :username_1))
FETCH FIRST 1 ROWS ONLY
2025-09-05 10:13:37.398 +07:00 [INF] Executed DbCommand (37ms) [Parameters=[:userId_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "r"."CODE"
FROM "USER_ROLES" "u"
INNER JOIN "ROLES" "r" ON "u"."ROLE_ID" = "r"."ID"
WHERE "u"."USER_ID" = :userId_0
2025-09-05 10:13:37.495 +07:00 [INF] Login success [81]
2025-09-05 10:13:37.515 +07:00 [INF] Executing OkObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.AuthResponseDto'.
2025-09-05 10:13:37.522 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.AuthController.Login (PHONE_STORE.API) in 1452.0936ms
2025-09-05 10:13:37.524 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.AuthController.Login (PHONE_STORE.API)'
2025-09-05 10:13:37.526 +07:00 [INF] Request finished HTTP/1.1 POST https://localhost:7277/api/auth/login - 200 null application/json; charset=utf-8 1472.5366ms
2025-09-05 10:13:37.618 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 10:13:37.672 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 10:13:37.673 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 10:13:37.686 +07:00 [ERR] 2025-09-05 10:13:37.686610 ThreadID:11  (ERROR)   OracleRelationalCommand.ExecuteReaderAsync() :  Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-06550: line 14, column 63:
PL/SQL: ORA-00904: "SESSION_ID": invalid identifier
ORA-06550: line 14, column 1:
PL/SQL: SQL Statement ignored
https://docs.oracle.com/error-help/db/ora-06550/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
2025-09-05 10:13:37.688 +07:00 [ERR] Failed executing DbCommand (8ms) [Parameters=[:p0='?' (DbType = DateTime), :p1='?' (DbType = Int64), :p2='?' (Size = 64), :p3='?' (DbType = DateTime), :cur0='?' (Direction = Output) (DbType = Object)], CommandType='"Text"', CommandTimeout='0']
DECLARE

TYPE "rCARTS_0" IS RECORD
(
"ID" NUMBER(19)
);
TYPE "tCARTS_0" IS TABLE OF "rCARTS_0";
"lCARTS_0" "tCARTS_0";

BEGIN

"lCARTS_0" := "tCARTS_0"();
"lCARTS_0".extend(1);
INSERT INTO "HEHE"."CARTS" ("CREATED_AT", "CUSTOMER_ID", "SESSION_ID", "UPDATED_AT")
VALUES (:p0, :p1, :p2, :p3)
RETURNING "ID" INTO "lCARTS_0"(1)."ID";
OPEN :cur0 FOR SELECT "lCARTS_0"(1)."ID" FROM DUAL;

END;
2025-09-05 10:13:37.692 +07:00 [ERR] 2025-09-05 10:13:37.692691 ThreadID:11  (ERROR)   OracleExecutionStrategy.ExecuteAsync() :  Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-06550: line 14, column 63:
PL/SQL: ORA-00904: "SESSION_ID": invalid identifier
ORA-06550: line 14, column 1:
PL/SQL: SQL Statement ignored
https://docs.oracle.com/error-help/db/ora-06550/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
2025-09-05 10:13:37.695 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'PHONE_STORE.Infrastructure.Data.PhoneDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-06550: line 14, column 63:
PL/SQL: ORA-00904: "SESSION_ID": invalid identifier
ORA-06550: line 14, column 1:
PL/SQL: SQL Statement ignored
https://docs.oracle.com/error-help/db/ora-06550/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-06550: line 14, column 63:
PL/SQL: ORA-00904: "SESSION_ID": invalid identifier
ORA-06550: line 14, column 1:
PL/SQL: SQL Statement ignored
https://docs.oracle.com/error-help/db/ora-06550/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-09-05 10:13:37.825 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 151.5203ms
2025-09-05 10:13:37.828 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 10:13:37.829 +07:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-06550: line 14, column 63:
PL/SQL: ORA-00904: "SESSION_ID": invalid identifier
ORA-06550: line 14, column 1:
PL/SQL: SQL Statement ignored
https://docs.oracle.com/error-help/db/ora-06550/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at PHONE_STORE.Infrastructure.Repositories.CartRepository.EnsureCartId(Nullable`1 customerId, String sessionId, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.Infrastructure\Repositories\CartRepository.cs:line 49
   at PHONE_STORE.Infrastructure.Repositories.CartRepository.GetOrCreateAsync(Nullable`1 customerId, String sessionId, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.Infrastructure\Repositories\CartRepository.cs:line 64
   at lambda_method9(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-05 10:13:37.846 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 500 null application/problem+json; charset=utf-8 228.2267ms
2025-09-05 10:13:39.870 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - null null
2025-09-05 10:13:39.874 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 10:13:39.876 +07:00 [INF] Route matched with {action = "List", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem]]] List(System.String, System.Nullable`1[System.Int64], Int32, Int32, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 10:13:39.904 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API) in 26.9323ms
2025-09-05 10:13:39.906 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 10:13:39.908 +07:00 [ERR] An unhandled exception has occurred while executing the request.
System.ArgumentNullException: Value cannot be null. (Parameter 'parameter')
   at System.ArgumentNullException.Throw(String paramName)
   at System.ArgumentNullException.ThrowIfNull(Object argument, String paramName)
   at System.Linq.Expressions.Expression.Lambda(Expression body, String name, Boolean tailCall, IEnumerable`1 parameters)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.ReducingExpressionVisitor.Visit(Expression expression)
   at System.Dynamic.Utils.ExpressionVisitorUtils.VisitArguments(ExpressionVisitor visitor, IArgumentProvider nodes)
   at System.Linq.Expressions.ExpressionVisitor.VisitMethodCall(MethodCallExpression node)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.ReducingExpressionVisitor.Visit(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.MaterializeCollectionNavigationExpression.VisitChildren(ExpressionVisitor visitor)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.ReducingExpressionVisitor.Visit(Expression expression)
   at System.Dynamic.Utils.ExpressionVisitorUtils.VisitArguments(ExpressionVisitor visitor, IArgumentProvider nodes)
   at System.Linq.Expressions.ExpressionVisitor.VisitMethodCall(MethodCallExpression node)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.ReducingExpressionVisitor.Visit(Expression expression)
   at System.Dynamic.Utils.ExpressionVisitorUtils.VisitArguments(ExpressionVisitor visitor, IArgumentProvider nodes)
   at System.Linq.Expressions.ExpressionVisitor.VisitMethodCall(MethodCallExpression node)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.ReducingExpressionVisitor.Visit(Expression expression)
   at System.Dynamic.Utils.ExpressionVisitorUtils.VisitArguments(ExpressionVisitor visitor, IArgumentProvider nodes)
   at System.Linq.Expressions.ExpressionVisitor.VisitMethodCall(MethodCallExpression node)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.ReducingExpressionVisitor.Visit(Expression expression)
   at System.Dynamic.Utils.ExpressionVisitorUtils.VisitArguments(ExpressionVisitor visitor, IArgumentProvider nodes)
   at System.Linq.Expressions.ExpressionVisitor.VisitMethodCall(MethodCallExpression node)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.ReducingExpressionVisitor.Visit(Expression expression)
   at System.Dynamic.Utils.ExpressionVisitorUtils.VisitArguments(ExpressionVisitor visitor, IArgumentProvider nodes)
   at System.Linq.Expressions.ExpressionVisitor.VisitMethodCall(MethodCallExpression node)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.ReducingExpressionVisitor.Visit(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at System.Dynamic.Utils.ExpressionVisitorUtils.VisitArguments(ExpressionVisitor visitor, IArgumentProvider nodes)
   at System.Linq.Expressions.ExpressionVisitor.VisitNew(NewExpression node)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.PendingSelectorExpandingExpressionVisitor.Visit(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.Expand(Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryTranslationPreprocessor.Process(Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at PHONE_STORE.API.Controllers.ShopProductsController.List(String q, Nullable`1 catId, Int32 page, Int32 pageSize, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.API\Controllers\ShopProductsController.cs:line 35
   at lambda_method82(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-05 10:13:39.927 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - 500 null application/problem+json; charset=utf-8 56.8087ms
2025-09-05 10:13:51.249 +07:00 [INF] Request starting HTTP/1.1 POST https://localhost:7277/api/auth/logout - application/json; charset=utf-8 null
2025-09-05 10:13:51.254 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.AuthController.Logout (PHONE_STORE.API)'
2025-09-05 10:13:51.258 +07:00 [INF] Route matched with {action = "Logout", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Logout(RefreshRequest, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.AuthController (PHONE_STORE.API).
2025-09-05 10:13:51.270 +07:00 [INF] Logout: revoked RT
2025-09-05 10:13:51.271 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType1`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-05 10:13:51.275 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.AuthController.Logout (PHONE_STORE.API) in 15.9248ms
2025-09-05 10:13:51.276 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.AuthController.Logout (PHONE_STORE.API)'
2025-09-05 10:13:51.277 +07:00 [INF] Request finished HTTP/1.1 POST https://localhost:7277/api/auth/logout - 200 null application/json; charset=utf-8 28.246ms
2025-09-05 10:13:51.306 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 10:13:51.309 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 10:13:51.310 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 10:13:51.323 +07:00 [ERR] 2025-09-05 10:13:51.323402 ThreadID:11  (ERROR)   OracleRelationalCommand.ExecuteReaderAsync() :  Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-06550: line 14, column 63:
PL/SQL: ORA-00904: "SESSION_ID": invalid identifier
ORA-06550: line 14, column 1:
PL/SQL: SQL Statement ignored
https://docs.oracle.com/error-help/db/ora-06550/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
2025-09-05 10:13:51.324 +07:00 [ERR] Failed executing DbCommand (6ms) [Parameters=[:p0='?' (DbType = DateTime), :p1='?' (DbType = Int64), :p2='?' (Size = 64), :p3='?' (DbType = DateTime), :cur0='?' (Direction = Output) (DbType = Object)], CommandType='"Text"', CommandTimeout='0']
DECLARE

TYPE "rCARTS_0" IS RECORD
(
"ID" NUMBER(19)
);
TYPE "tCARTS_0" IS TABLE OF "rCARTS_0";
"lCARTS_0" "tCARTS_0";

BEGIN

"lCARTS_0" := "tCARTS_0"();
"lCARTS_0".extend(1);
INSERT INTO "HEHE"."CARTS" ("CREATED_AT", "CUSTOMER_ID", "SESSION_ID", "UPDATED_AT")
VALUES (:p0, :p1, :p2, :p3)
RETURNING "ID" INTO "lCARTS_0"(1)."ID";
OPEN :cur0 FOR SELECT "lCARTS_0"(1)."ID" FROM DUAL;

END;
2025-09-05 10:13:51.329 +07:00 [ERR] 2025-09-05 10:13:51.329412 ThreadID:11  (ERROR)   OracleExecutionStrategy.ExecuteAsync() :  Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-06550: line 14, column 63:
PL/SQL: ORA-00904: "SESSION_ID": invalid identifier
ORA-06550: line 14, column 1:
PL/SQL: SQL Statement ignored
https://docs.oracle.com/error-help/db/ora-06550/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
2025-09-05 10:13:51.333 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'PHONE_STORE.Infrastructure.Data.PhoneDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-06550: line 14, column 63:
PL/SQL: ORA-00904: "SESSION_ID": invalid identifier
ORA-06550: line 14, column 1:
PL/SQL: SQL Statement ignored
https://docs.oracle.com/error-help/db/ora-06550/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-06550: line 14, column 63:
PL/SQL: ORA-00904: "SESSION_ID": invalid identifier
ORA-06550: line 14, column 1:
PL/SQL: SQL Statement ignored
https://docs.oracle.com/error-help/db/ora-06550/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-09-05 10:13:51.436 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 124.0623ms
2025-09-05 10:13:51.437 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 10:13:51.437 +07:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-06550: line 14, column 63:
PL/SQL: ORA-00904: "SESSION_ID": invalid identifier
ORA-06550: line 14, column 1:
PL/SQL: SQL Statement ignored
https://docs.oracle.com/error-help/db/ora-06550/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at PHONE_STORE.Infrastructure.Repositories.CartRepository.EnsureCartId(Nullable`1 customerId, String sessionId, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.Infrastructure\Repositories\CartRepository.cs:line 49
   at PHONE_STORE.Infrastructure.Repositories.CartRepository.GetOrCreateAsync(Nullable`1 customerId, String sessionId, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.Infrastructure\Repositories\CartRepository.cs:line 64
   at lambda_method9(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-05 10:13:51.451 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 500 null application/problem+json; charset=utf-8 145.6474ms
2025-09-05 10:13:52.346 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - null null
2025-09-05 10:13:52.348 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 10:13:52.348 +07:00 [INF] Route matched with {action = "List", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem]]] List(System.String, System.Nullable`1[System.Int64], Int32, Int32, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 10:13:52.390 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API) in 39.4281ms
2025-09-05 10:13:52.394 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 10:13:52.396 +07:00 [ERR] An unhandled exception has occurred while executing the request.
System.ArgumentNullException: Value cannot be null. (Parameter 'parameter')
   at System.ArgumentNullException.Throw(String paramName)
   at System.Linq.Expressions.Expression.Lambda(Expression body, String name, Boolean tailCall, IEnumerable`1 parameters)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.ReducingExpressionVisitor.Visit(Expression expression)
   at System.Dynamic.Utils.ExpressionVisitorUtils.VisitArguments(ExpressionVisitor visitor, IArgumentProvider nodes)
   at System.Linq.Expressions.ExpressionVisitor.VisitMethodCall(MethodCallExpression node)
   at Microsoft.EntityFrameworkCore.Query.MaterializeCollectionNavigationExpression.VisitChildren(ExpressionVisitor visitor)
   at System.Dynamic.Utils.ExpressionVisitorUtils.VisitArguments(ExpressionVisitor visitor, IArgumentProvider nodes)
   at System.Linq.Expressions.ExpressionVisitor.VisitMethodCall(MethodCallExpression node)
   at System.Dynamic.Utils.ExpressionVisitorUtils.VisitArguments(ExpressionVisitor visitor, IArgumentProvider nodes)
   at System.Linq.Expressions.ExpressionVisitor.VisitMethodCall(MethodCallExpression node)
   at System.Dynamic.Utils.ExpressionVisitorUtils.VisitArguments(ExpressionVisitor visitor, IArgumentProvider nodes)
   at System.Linq.Expressions.ExpressionVisitor.VisitMethodCall(MethodCallExpression node)
   at System.Dynamic.Utils.ExpressionVisitorUtils.VisitArguments(ExpressionVisitor visitor, IArgumentProvider nodes)
   at System.Linq.Expressions.ExpressionVisitor.VisitMethodCall(MethodCallExpression node)
   at System.Dynamic.Utils.ExpressionVisitorUtils.VisitArguments(ExpressionVisitor visitor, IArgumentProvider nodes)
   at System.Linq.Expressions.ExpressionVisitor.VisitMethodCall(MethodCallExpression node)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at System.Dynamic.Utils.ExpressionVisitorUtils.VisitArguments(ExpressionVisitor visitor, IArgumentProvider nodes)
   at System.Linq.Expressions.ExpressionVisitor.VisitNew(NewExpression node)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.PendingSelectorExpandingExpressionVisitor.Visit(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.Expand(Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryTranslationPreprocessor.Process(Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at PHONE_STORE.API.Controllers.ShopProductsController.List(String q, Nullable`1 catId, Int32 page, Int32 pageSize, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.API\Controllers\ShopProductsController.cs:line 35
   at lambda_method82(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-05 10:13:52.417 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - 500 null application/problem+json; charset=utf-8 71.3777ms
2025-09-05 10:14:10.413 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 10:14:10.417 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 10:14:10.417 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 10:14:10.432 +07:00 [ERR] 2025-09-05 10:14:10.432655 ThreadID:5   (ERROR)   OracleRelationalCommand.ExecuteReaderAsync() :  Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-06550: line 14, column 63:
PL/SQL: ORA-00904: "SESSION_ID": invalid identifier
ORA-06550: line 14, column 1:
PL/SQL: SQL Statement ignored
https://docs.oracle.com/error-help/db/ora-06550/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
2025-09-05 10:14:10.433 +07:00 [ERR] Failed executing DbCommand (5ms) [Parameters=[:p0='?' (DbType = DateTime), :p1='?' (DbType = Int64), :p2='?' (Size = 64), :p3='?' (DbType = DateTime), :cur0='?' (Direction = Output) (DbType = Object)], CommandType='"Text"', CommandTimeout='0']
DECLARE

TYPE "rCARTS_0" IS RECORD
(
"ID" NUMBER(19)
);
TYPE "tCARTS_0" IS TABLE OF "rCARTS_0";
"lCARTS_0" "tCARTS_0";

BEGIN

"lCARTS_0" := "tCARTS_0"();
"lCARTS_0".extend(1);
INSERT INTO "HEHE"."CARTS" ("CREATED_AT", "CUSTOMER_ID", "SESSION_ID", "UPDATED_AT")
VALUES (:p0, :p1, :p2, :p3)
RETURNING "ID" INTO "lCARTS_0"(1)."ID";
OPEN :cur0 FOR SELECT "lCARTS_0"(1)."ID" FROM DUAL;

END;
2025-09-05 10:14:10.437 +07:00 [ERR] 2025-09-05 10:14:10.437309 ThreadID:5   (ERROR)   OracleExecutionStrategy.ExecuteAsync() :  Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-06550: line 14, column 63:
PL/SQL: ORA-00904: "SESSION_ID": invalid identifier
ORA-06550: line 14, column 1:
PL/SQL: SQL Statement ignored
https://docs.oracle.com/error-help/db/ora-06550/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
2025-09-05 10:14:10.440 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'PHONE_STORE.Infrastructure.Data.PhoneDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-06550: line 14, column 63:
PL/SQL: ORA-00904: "SESSION_ID": invalid identifier
ORA-06550: line 14, column 1:
PL/SQL: SQL Statement ignored
https://docs.oracle.com/error-help/db/ora-06550/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-06550: line 14, column 63:
PL/SQL: ORA-00904: "SESSION_ID": invalid identifier
ORA-06550: line 14, column 1:
PL/SQL: SQL Statement ignored
https://docs.oracle.com/error-help/db/ora-06550/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-09-05 10:14:10.579 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 159.666ms
2025-09-05 10:14:10.581 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 10:14:10.583 +07:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-06550: line 14, column 63:
PL/SQL: ORA-00904: "SESSION_ID": invalid identifier
ORA-06550: line 14, column 1:
PL/SQL: SQL Statement ignored
https://docs.oracle.com/error-help/db/ora-06550/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at PHONE_STORE.Infrastructure.Repositories.CartRepository.EnsureCartId(Nullable`1 customerId, String sessionId, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.Infrastructure\Repositories\CartRepository.cs:line 49
   at PHONE_STORE.Infrastructure.Repositories.CartRepository.GetOrCreateAsync(Nullable`1 customerId, String sessionId, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.Infrastructure\Repositories\CartRepository.cs:line 64
   at lambda_method9(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-05 10:14:10.600 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 500 null application/problem+json; charset=utf-8 186.9813ms
2025-09-05 10:48:03.318 +07:00 [INF] User profile is available. Using 'C:\Users\Administrator\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-09-05 10:48:03.597 +07:00 [INF] Now listening on: https://localhost:7277
2025-09-05 10:48:03.598 +07:00 [INF] Now listening on: http://localhost:5209
2025-09-05 10:48:03.681 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-05 10:48:03.684 +07:00 [INF] Hosting environment: Development
2025-09-05 10:48:03.684 +07:00 [INF] Content root path: C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.API
2025-09-05 10:48:04.484 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/swagger/index.html - null null
2025-09-05 10:48:04.903 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/swagger/index.html - 200 null text/html;charset=utf-8 430.5788ms
2025-09-05 10:48:04.964 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/_framework/aspnetcore-browser-refresh.js - null null
2025-09-05 10:48:04.974 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/_framework/aspnetcore-browser-refresh.js - 200 13766 application/javascript; charset=utf-8 10.1953ms
2025-09-05 10:48:04.985 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/_vs/browserLink - null null
2025-09-05 10:48:05.051 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/_vs/browserLink - 200 null text/javascript; charset=UTF-8 65.396ms
2025-09-05 10:48:05.272 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/swagger/v1/swagger.json - null null
2025-09-05 10:48:05.311 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 10:48:05.426 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 10:48:05.455 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 182.737ms
2025-09-05 10:48:05.467 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 10:48:06.170 +07:00 [WRN] The decimal property 'UnitPrice' on entity type 'CartItem' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 10:48:06.172 +07:00 [WRN] The decimal property 'DiscountTotal' on entity type 'Order' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 10:48:06.173 +07:00 [WRN] The decimal property 'GrandTotal' on entity type 'Order' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 10:48:06.174 +07:00 [WRN] The decimal property 'ShippingFee' on entity type 'Order' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 10:48:06.175 +07:00 [WRN] The decimal property 'Subtotal' on entity type 'Order' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 10:48:06.175 +07:00 [WRN] The decimal property 'TaxTotal' on entity type 'Order' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 10:48:06.176 +07:00 [WRN] The decimal property 'DiscountAmount' on entity type 'OrderItem' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 10:48:06.177 +07:00 [WRN] The decimal property 'TaxAmount' on entity type 'OrderItem' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 10:48:06.178 +07:00 [WRN] The decimal property 'UnitPrice' on entity type 'OrderItem' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 10:48:06.179 +07:00 [WRN] The decimal property 'DecValue' on entity type 'ProductAttributeValue' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 10:48:06.180 +07:00 [WRN] The decimal property 'ListPrice' on entity type 'ProductPrice' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 10:48:06.181 +07:00 [WRN] The decimal property 'SalePrice' on entity type 'ProductPrice' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 10:48:06.182 +07:00 [WRN] The decimal property 'WeightGram' on entity type 'ProductVariant' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 10:48:06.873 +07:00 [ERR] 2025-09-05 10:48:06.872985 ThreadID:9   (ERROR)   OracleRelationalCommand.ExecuteReaderAsync() :  Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
2025-09-05 10:48:06.881 +07:00 [ERR] Failed executing DbCommand (162ms) [Parameters=[:p0='?' (DbType = DateTime), :p1='?' (Size = 2000), :p2='?' (DbType = Int64), :p3='?' (Size = 64), :p4='?' (Size = 2000), :p5='?' (DbType = DateTime), :cur0='?' (Direction = Output) (DbType = Object)], CommandType='"Text"', CommandTimeout='0']
DECLARE

TYPE "rCARTS_0" IS RECORD
(
"ID" NUMBER(19)
);
TYPE "tCARTS_0" IS TABLE OF "rCARTS_0";
"lCARTS_0" "tCARTS_0";

BEGIN

"lCARTS_0" := "tCARTS_0"();
"lCARTS_0".extend(1);
INSERT INTO "HEHE"."CARTS" ("CREATED_AT", "CURRENCY", "CUSTOMER_ID", "SESSION_TOKEN", "STATUS", "UPDATED_AT")
VALUES (:p0, :p1, :p2, :p3, :p4, :p5)
RETURNING "ID" INTO "lCARTS_0"(1)."ID";
OPEN :cur0 FOR SELECT "lCARTS_0"(1)."ID" FROM DUAL;

END;
2025-09-05 10:48:06.915 +07:00 [ERR] 2025-09-05 10:48:06.915813 ThreadID:9   (ERROR)   OracleExecutionStrategy.ExecuteAsync() :  Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
2025-09-05 10:48:06.925 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'PHONE_STORE.Infrastructure.Data.PhoneDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-09-05 10:48:07.054 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 1583.2775ms
2025-09-05 10:48:07.057 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 10:48:07.061 +07:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at PHONE_STORE.Infrastructure.Repositories.CartRepository.EnsureCartId(Nullable`1 customerId, String sessionId, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.Infrastructure\Repositories\CartRepository.cs:line 50
   at PHONE_STORE.Infrastructure.Repositories.CartRepository.GetOrCreateAsync(Nullable`1 customerId, String sessionId, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.Infrastructure\Repositories\CartRepository.cs:line 77
   at lambda_method9(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-05 10:48:07.096 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 500 null application/problem+json; charset=utf-8 1786.9158ms
2025-09-05 10:48:09.366 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - null null
2025-09-05 10:48:09.370 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 10:48:09.381 +07:00 [INF] Route matched with {action = "List", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem]]] List(System.String, System.Nullable`1[System.Int64], Int32, Int32, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 10:48:09.690 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API) in 306.3344ms
2025-09-05 10:48:09.691 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 10:48:09.692 +07:00 [ERR] An unhandled exception has occurred while executing the request.
System.ArgumentNullException: Value cannot be null. (Parameter 'parameter')
   at System.ArgumentNullException.Throw(String paramName)
   at System.ArgumentNullException.ThrowIfNull(Object argument, String paramName)
   at System.Linq.Expressions.Expression.Lambda(Expression body, String name, Boolean tailCall, IEnumerable`1 parameters)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.ReducingExpressionVisitor.Visit(Expression expression)
   at System.Dynamic.Utils.ExpressionVisitorUtils.VisitArguments(ExpressionVisitor visitor, IArgumentProvider nodes)
   at System.Linq.Expressions.ExpressionVisitor.VisitMethodCall(MethodCallExpression node)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.ReducingExpressionVisitor.Visit(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.MaterializeCollectionNavigationExpression.VisitChildren(ExpressionVisitor visitor)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.ReducingExpressionVisitor.Visit(Expression expression)
   at System.Dynamic.Utils.ExpressionVisitorUtils.VisitArguments(ExpressionVisitor visitor, IArgumentProvider nodes)
   at System.Linq.Expressions.ExpressionVisitor.VisitMethodCall(MethodCallExpression node)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.ReducingExpressionVisitor.Visit(Expression expression)
   at System.Dynamic.Utils.ExpressionVisitorUtils.VisitArguments(ExpressionVisitor visitor, IArgumentProvider nodes)
   at System.Linq.Expressions.ExpressionVisitor.VisitMethodCall(MethodCallExpression node)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.ReducingExpressionVisitor.Visit(Expression expression)
   at System.Dynamic.Utils.ExpressionVisitorUtils.VisitArguments(ExpressionVisitor visitor, IArgumentProvider nodes)
   at System.Linq.Expressions.ExpressionVisitor.VisitMethodCall(MethodCallExpression node)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.ReducingExpressionVisitor.Visit(Expression expression)
   at System.Dynamic.Utils.ExpressionVisitorUtils.VisitArguments(ExpressionVisitor visitor, IArgumentProvider nodes)
   at System.Linq.Expressions.ExpressionVisitor.VisitMethodCall(MethodCallExpression node)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.ReducingExpressionVisitor.Visit(Expression expression)
   at System.Dynamic.Utils.ExpressionVisitorUtils.VisitArguments(ExpressionVisitor visitor, IArgumentProvider nodes)
   at System.Linq.Expressions.ExpressionVisitor.VisitMethodCall(MethodCallExpression node)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.ReducingExpressionVisitor.Visit(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at System.Dynamic.Utils.ExpressionVisitorUtils.VisitArguments(ExpressionVisitor visitor, IArgumentProvider nodes)
   at System.Linq.Expressions.ExpressionVisitor.VisitNew(NewExpression node)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.PendingSelectorExpandingExpressionVisitor.Visit(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.Expand(Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryTranslationPreprocessor.Process(Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at PHONE_STORE.API.Controllers.ShopProductsController.List(String q, Nullable`1 catId, Int32 page, Int32 pageSize, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.API\Controllers\ShopProductsController.cs:line 35
   at lambda_method103(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-05 10:48:09.705 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - 500 null application/problem+json; charset=utf-8 339.7609ms
2025-09-05 10:48:12.122 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 10:48:12.129 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 10:48:12.130 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 10:48:12.163 +07:00 [ERR] 2025-09-05 10:48:12.163021 ThreadID:5   (ERROR)   OracleRelationalCommand.ExecuteReaderAsync() :  Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
2025-09-05 10:48:12.165 +07:00 [ERR] Failed executing DbCommand (6ms) [Parameters=[:p0='?' (DbType = DateTime), :p1='?' (Size = 2000), :p2='?' (DbType = Int64), :p3='?' (Size = 64), :p4='?' (Size = 2000), :p5='?' (DbType = DateTime), :cur0='?' (Direction = Output) (DbType = Object)], CommandType='"Text"', CommandTimeout='0']
DECLARE

TYPE "rCARTS_0" IS RECORD
(
"ID" NUMBER(19)
);
TYPE "tCARTS_0" IS TABLE OF "rCARTS_0";
"lCARTS_0" "tCARTS_0";

BEGIN

"lCARTS_0" := "tCARTS_0"();
"lCARTS_0".extend(1);
INSERT INTO "HEHE"."CARTS" ("CREATED_AT", "CURRENCY", "CUSTOMER_ID", "SESSION_TOKEN", "STATUS", "UPDATED_AT")
VALUES (:p0, :p1, :p2, :p3, :p4, :p5)
RETURNING "ID" INTO "lCARTS_0"(1)."ID";
OPEN :cur0 FOR SELECT "lCARTS_0"(1)."ID" FROM DUAL;

END;
2025-09-05 10:48:12.168 +07:00 [ERR] 2025-09-05 10:48:12.168801 ThreadID:5   (ERROR)   OracleExecutionStrategy.ExecuteAsync() :  Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
2025-09-05 10:48:12.171 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'PHONE_STORE.Infrastructure.Data.PhoneDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-09-05 10:48:12.254 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 121.3059ms
2025-09-05 10:48:12.255 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 10:48:12.256 +07:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at PHONE_STORE.Infrastructure.Repositories.CartRepository.EnsureCartId(Nullable`1 customerId, String sessionId, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.Infrastructure\Repositories\CartRepository.cs:line 50
   at PHONE_STORE.Infrastructure.Repositories.CartRepository.GetOrCreateAsync(Nullable`1 customerId, String sessionId, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.Infrastructure\Repositories\CartRepository.cs:line 77
   at lambda_method9(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-05 10:48:12.269 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 500 null application/problem+json; charset=utf-8 147.1801ms
2025-09-05 10:48:17.510 +07:00 [INF] Request starting HTTP/1.1 POST https://localhost:7277/api/auth/login - application/json; charset=utf-8 null
2025-09-05 10:48:17.520 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.AuthController.Login (PHONE_STORE.API)'
2025-09-05 10:48:17.525 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(LoginRequest, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.AuthController (PHONE_STORE.API).
2025-09-05 10:48:18.108 +07:00 [INF] Executed DbCommand (32ms) [Parameters=[:uname_0='?' (Size = 450), :username_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='0']
SELECT "u"."ID", "u"."CREATED_AT", "u"."EMAIL", "u"."PASSWORD_HASH", "u"."PHONE", "u"."STATUS"
FROM "USER_ACCOUNTS" "u"
WHERE (("u"."EMAIL" = :uname_0) OR ("u"."PHONE" = :username_1))
FETCH FIRST 1 ROWS ONLY
2025-09-05 10:48:18.735 +07:00 [INF] Executed DbCommand (23ms) [Parameters=[:userId_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "r"."CODE"
FROM "USER_ROLES" "u"
INNER JOIN "ROLES" "r" ON "u"."ROLE_ID" = "r"."ID"
WHERE "u"."USER_ID" = :userId_0
2025-09-05 10:48:18.838 +07:00 [INF] Login success [81]
2025-09-05 10:48:18.852 +07:00 [INF] Executing OkObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.AuthResponseDto'.
2025-09-05 10:48:18.859 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.AuthController.Login (PHONE_STORE.API) in 1331.0471ms
2025-09-05 10:48:18.861 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.AuthController.Login (PHONE_STORE.API)'
2025-09-05 10:48:18.864 +07:00 [INF] Request finished HTTP/1.1 POST https://localhost:7277/api/auth/login - 200 null application/json; charset=utf-8 1354.4381ms
2025-09-05 10:48:18.962 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 10:48:19.021 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 10:48:19.023 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 10:48:19.040 +07:00 [ERR] 2025-09-05 10:48:19.040437 ThreadID:7   (ERROR)   OracleRelationalCommand.ExecuteReaderAsync() :  Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
2025-09-05 10:48:19.042 +07:00 [ERR] Failed executing DbCommand (8ms) [Parameters=[:p0='?' (DbType = DateTime), :p1='?' (Size = 2000), :p2='?' (DbType = Int64), :p3='?' (Size = 64), :p4='?' (Size = 2000), :p5='?' (DbType = DateTime), :cur0='?' (Direction = Output) (DbType = Object)], CommandType='"Text"', CommandTimeout='0']
DECLARE

TYPE "rCARTS_0" IS RECORD
(
"ID" NUMBER(19)
);
TYPE "tCARTS_0" IS TABLE OF "rCARTS_0";
"lCARTS_0" "tCARTS_0";

BEGIN

"lCARTS_0" := "tCARTS_0"();
"lCARTS_0".extend(1);
INSERT INTO "HEHE"."CARTS" ("CREATED_AT", "CURRENCY", "CUSTOMER_ID", "SESSION_TOKEN", "STATUS", "UPDATED_AT")
VALUES (:p0, :p1, :p2, :p3, :p4, :p5)
RETURNING "ID" INTO "lCARTS_0"(1)."ID";
OPEN :cur0 FOR SELECT "lCARTS_0"(1)."ID" FROM DUAL;

END;
2025-09-05 10:48:19.046 +07:00 [ERR] 2025-09-05 10:48:19.046755 ThreadID:7   (ERROR)   OracleExecutionStrategy.ExecuteAsync() :  Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
2025-09-05 10:48:19.050 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'PHONE_STORE.Infrastructure.Data.PhoneDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-09-05 10:48:19.163 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 138.5953ms
2025-09-05 10:48:19.164 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 10:48:19.165 +07:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at PHONE_STORE.Infrastructure.Repositories.CartRepository.EnsureCartId(Nullable`1 customerId, String sessionId, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.Infrastructure\Repositories\CartRepository.cs:line 50
   at PHONE_STORE.Infrastructure.Repositories.CartRepository.GetOrCreateAsync(Nullable`1 customerId, String sessionId, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.Infrastructure\Repositories\CartRepository.cs:line 77
   at lambda_method9(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-05 10:48:19.187 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 500 null application/problem+json; charset=utf-8 225.2299ms
2025-09-05 10:48:22.211 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/admin/orders?q=&status= - null null
2025-09-05 10:48:22.219 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.OrdersController.Search (PHONE_STORE.API)'
2025-09-05 10:48:22.223 +07:00 [INF] Route matched with {action = "Search", controller = "Orders"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.Collections.Generic.List`1[PHONE_STORE.Application.Dtos.OrderListItemDto]] Search(System.String, System.String, Int32, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.OrdersController (PHONE_STORE.API).
2025-09-05 10:48:22.301 +07:00 [INF] Executed DbCommand (17ms) [Parameters=[:p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='0']
SELECT "o"."ID", "o"."CODE", "o"."STATUS", (
    SELECT "c"."EMAIL"
    FROM "HEHE"."CUSTOMERS" "c"
    WHERE "c"."ID" = "o"."CUSTOMER_ID"
    FETCH FIRST 1 ROWS ONLY), "o"."GRAND_TOTAL", "o"."PLACED_AT"
FROM "HEHE"."ORDERS" "o"
ORDER BY "o"."PLACED_AT" DESC
FETCH FIRST :p_0 ROWS ONLY
2025-09-05 10:48:22.314 +07:00 [INF] Executing ObjectResult, writing value of type 'System.Collections.Generic.List`1[[PHONE_STORE.Application.Dtos.OrderListItemDto, PHONE_STORE.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-05 10:48:22.325 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.OrdersController.Search (PHONE_STORE.API) in 99.7ms
2025-09-05 10:48:22.328 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.OrdersController.Search (PHONE_STORE.API)'
2025-09-05 10:48:22.329 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/admin/orders?q=&status= - 200 null application/json; charset=utf-8 117.4835ms
2025-09-05 10:48:25.862 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/admin/orders/1 - null null
2025-09-05 10:48:25.867 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.OrdersController.Get (PHONE_STORE.API)'
2025-09-05 10:48:25.870 +07:00 [INF] Route matched with {action = "Get", controller = "Orders"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[PHONE_STORE.Application.Dtos.OrderDetailDto]] Get(Int64, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.OrdersController (PHONE_STORE.API).
2025-09-05 10:48:25.889 +07:00 [INF] Executed DbCommand (8ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "o"."ID", "o"."CODE", "o"."CURRENCY", "o"."CUSTOMER_ID", "o"."DISCOUNT_TOTAL", "o"."GRAND_TOTAL", "o"."NOTE", "o"."PLACED_AT", "o"."SHIPPING_ADDRESS_ID", "o"."SHIPPING_FEE", "o"."STATUS", "o"."SUBTOTAL", "o"."TAX_TOTAL", "o"."UPDATED_AT"
FROM "HEHE"."ORDERS" "o"
WHERE "o"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 10:48:25.921 +07:00 [INF] Executed DbCommand (17ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "o"."VARIANT_ID", "o"."PRODUCT_NAME", "o"."SKU", "o"."QUANTITY", "o"."UNIT_PRICE", "o"."UNIT_PRICE" * CAST("o"."QUANTITY" AS DECIMAL(18, 2))
FROM "HEHE"."ORDER_ITEMS" "o"
WHERE "o"."ORDER_ID" = :id_0
2025-09-05 10:48:25.925 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.OrderDetailDto'.
2025-09-05 10:48:25.947 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.OrdersController.Get (PHONE_STORE.API) in 76.1052ms
2025-09-05 10:48:25.949 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.OrdersController.Get (PHONE_STORE.API)'
2025-09-05 10:48:25.950 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/admin/orders/1 - 200 null application/json; charset=utf-8 88.4809ms
2025-09-05 10:48:29.153 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/admin/orders?q=&status= - null null
2025-09-05 10:48:29.158 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.OrdersController.Search (PHONE_STORE.API)'
2025-09-05 10:48:29.159 +07:00 [INF] Route matched with {action = "Search", controller = "Orders"}. Executing controller action with signature System.Threading.Tasks.Task`1[System.Collections.Generic.List`1[PHONE_STORE.Application.Dtos.OrderListItemDto]] Search(System.String, System.String, Int32, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.OrdersController (PHONE_STORE.API).
2025-09-05 10:48:29.171 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[:p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='0']
SELECT "o"."ID", "o"."CODE", "o"."STATUS", (
    SELECT "c"."EMAIL"
    FROM "HEHE"."CUSTOMERS" "c"
    WHERE "c"."ID" = "o"."CUSTOMER_ID"
    FETCH FIRST 1 ROWS ONLY), "o"."GRAND_TOTAL", "o"."PLACED_AT"
FROM "HEHE"."ORDERS" "o"
ORDER BY "o"."PLACED_AT" DESC
FETCH FIRST :p_0 ROWS ONLY
2025-09-05 10:48:29.173 +07:00 [INF] Executing ObjectResult, writing value of type 'System.Collections.Generic.List`1[[PHONE_STORE.Application.Dtos.OrderListItemDto, PHONE_STORE.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-05 10:48:29.174 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.OrdersController.Search (PHONE_STORE.API) in 13.4272ms
2025-09-05 10:48:29.175 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.OrdersController.Search (PHONE_STORE.API)'
2025-09-05 10:48:29.177 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/admin/orders?q=&status= - 200 null application/json; charset=utf-8 24.1673ms
2025-09-05 10:48:34.485 +07:00 [INF] Request starting HTTP/1.1 POST https://localhost:7277/api/auth/logout - application/json; charset=utf-8 null
2025-09-05 10:48:34.490 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.AuthController.Logout (PHONE_STORE.API)'
2025-09-05 10:48:34.494 +07:00 [INF] Route matched with {action = "Logout", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Logout(RefreshRequest, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.AuthController (PHONE_STORE.API).
2025-09-05 10:48:34.506 +07:00 [INF] Logout: revoked RT
2025-09-05 10:48:34.507 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType1`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-05 10:48:34.512 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.AuthController.Logout (PHONE_STORE.API) in 15.1717ms
2025-09-05 10:48:34.512 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.AuthController.Logout (PHONE_STORE.API)'
2025-09-05 10:48:34.514 +07:00 [INF] Request finished HTTP/1.1 POST https://localhost:7277/api/auth/logout - 200 null application/json; charset=utf-8 28.9944ms
2025-09-05 10:48:34.544 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 10:48:34.547 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 10:48:34.548 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 10:48:34.561 +07:00 [ERR] 2025-09-05 10:48:34.561584 ThreadID:13  (ERROR)   OracleRelationalCommand.ExecuteReaderAsync() :  Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
2025-09-05 10:48:34.563 +07:00 [ERR] Failed executing DbCommand (7ms) [Parameters=[:p0='?' (DbType = DateTime), :p1='?' (Size = 2000), :p2='?' (DbType = Int64), :p3='?' (Size = 64), :p4='?' (Size = 2000), :p5='?' (DbType = DateTime), :cur0='?' (Direction = Output) (DbType = Object)], CommandType='"Text"', CommandTimeout='0']
DECLARE

TYPE "rCARTS_0" IS RECORD
(
"ID" NUMBER(19)
);
TYPE "tCARTS_0" IS TABLE OF "rCARTS_0";
"lCARTS_0" "tCARTS_0";

BEGIN

"lCARTS_0" := "tCARTS_0"();
"lCARTS_0".extend(1);
INSERT INTO "HEHE"."CARTS" ("CREATED_AT", "CURRENCY", "CUSTOMER_ID", "SESSION_TOKEN", "STATUS", "UPDATED_AT")
VALUES (:p0, :p1, :p2, :p3, :p4, :p5)
RETURNING "ID" INTO "lCARTS_0"(1)."ID";
OPEN :cur0 FOR SELECT "lCARTS_0"(1)."ID" FROM DUAL;

END;
2025-09-05 10:48:34.568 +07:00 [ERR] 2025-09-05 10:48:34.568903 ThreadID:13  (ERROR)   OracleExecutionStrategy.ExecuteAsync() :  Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
2025-09-05 10:48:34.573 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'PHONE_STORE.Infrastructure.Data.PhoneDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-09-05 10:48:34.654 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 104.3207ms
2025-09-05 10:48:34.655 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 10:48:34.656 +07:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at PHONE_STORE.Infrastructure.Repositories.CartRepository.EnsureCartId(Nullable`1 customerId, String sessionId, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.Infrastructure\Repositories\CartRepository.cs:line 50
   at PHONE_STORE.Infrastructure.Repositories.CartRepository.GetOrCreateAsync(Nullable`1 customerId, String sessionId, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.Infrastructure\Repositories\CartRepository.cs:line 77
   at lambda_method9(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-05 10:48:34.667 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 500 null application/problem+json; charset=utf-8 122.9279ms
2025-09-05 10:48:35.399 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 10:48:35.402 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 10:48:35.403 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 10:48:35.416 +07:00 [ERR] 2025-09-05 10:48:35.416363 ThreadID:5   (ERROR)   OracleRelationalCommand.ExecuteReaderAsync() :  Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
2025-09-05 10:48:35.417 +07:00 [ERR] Failed executing DbCommand (5ms) [Parameters=[:p0='?' (DbType = DateTime), :p1='?' (Size = 2000), :p2='?' (DbType = Int64), :p3='?' (Size = 64), :p4='?' (Size = 2000), :p5='?' (DbType = DateTime), :cur0='?' (Direction = Output) (DbType = Object)], CommandType='"Text"', CommandTimeout='0']
DECLARE

TYPE "rCARTS_0" IS RECORD
(
"ID" NUMBER(19)
);
TYPE "tCARTS_0" IS TABLE OF "rCARTS_0";
"lCARTS_0" "tCARTS_0";

BEGIN

"lCARTS_0" := "tCARTS_0"();
"lCARTS_0".extend(1);
INSERT INTO "HEHE"."CARTS" ("CREATED_AT", "CURRENCY", "CUSTOMER_ID", "SESSION_TOKEN", "STATUS", "UPDATED_AT")
VALUES (:p0, :p1, :p2, :p3, :p4, :p5)
RETURNING "ID" INTO "lCARTS_0"(1)."ID";
OPEN :cur0 FOR SELECT "lCARTS_0"(1)."ID" FROM DUAL;

END;
2025-09-05 10:48:35.421 +07:00 [ERR] 2025-09-05 10:48:35.421138 ThreadID:5   (ERROR)   OracleExecutionStrategy.ExecuteAsync() :  Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
2025-09-05 10:48:35.424 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'PHONE_STORE.Infrastructure.Data.PhoneDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-09-05 10:48:35.538 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 132.1899ms
2025-09-05 10:48:35.540 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 10:48:35.543 +07:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at PHONE_STORE.Infrastructure.Repositories.CartRepository.EnsureCartId(Nullable`1 customerId, String sessionId, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.Infrastructure\Repositories\CartRepository.cs:line 50
   at PHONE_STORE.Infrastructure.Repositories.CartRepository.GetOrCreateAsync(Nullable`1 customerId, String sessionId, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.Infrastructure\Repositories\CartRepository.cs:line 77
   at lambda_method9(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-05 10:48:35.561 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 500 null application/problem+json; charset=utf-8 162.5708ms
2025-09-05 10:48:37.186 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - null null
2025-09-05 10:48:37.189 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 10:48:37.189 +07:00 [INF] Route matched with {action = "List", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem]]] List(System.String, System.Nullable`1[System.Int64], Int32, Int32, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 10:48:37.220 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API) in 29.3761ms
2025-09-05 10:48:37.222 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 10:48:37.223 +07:00 [ERR] An unhandled exception has occurred while executing the request.
System.ArgumentNullException: Value cannot be null. (Parameter 'parameter')
   at System.ArgumentNullException.Throw(String paramName)
   at System.Linq.Expressions.Expression.Lambda(Expression body, String name, Boolean tailCall, IEnumerable`1 parameters)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.ReducingExpressionVisitor.Visit(Expression expression)
   at System.Dynamic.Utils.ExpressionVisitorUtils.VisitArguments(ExpressionVisitor visitor, IArgumentProvider nodes)
   at System.Linq.Expressions.ExpressionVisitor.VisitMethodCall(MethodCallExpression node)
   at Microsoft.EntityFrameworkCore.Query.MaterializeCollectionNavigationExpression.VisitChildren(ExpressionVisitor visitor)
   at System.Dynamic.Utils.ExpressionVisitorUtils.VisitArguments(ExpressionVisitor visitor, IArgumentProvider nodes)
   at System.Linq.Expressions.ExpressionVisitor.VisitMethodCall(MethodCallExpression node)
   at System.Dynamic.Utils.ExpressionVisitorUtils.VisitArguments(ExpressionVisitor visitor, IArgumentProvider nodes)
   at System.Linq.Expressions.ExpressionVisitor.VisitMethodCall(MethodCallExpression node)
   at System.Dynamic.Utils.ExpressionVisitorUtils.VisitArguments(ExpressionVisitor visitor, IArgumentProvider nodes)
   at System.Linq.Expressions.ExpressionVisitor.VisitMethodCall(MethodCallExpression node)
   at System.Dynamic.Utils.ExpressionVisitorUtils.VisitArguments(ExpressionVisitor visitor, IArgumentProvider nodes)
   at System.Linq.Expressions.ExpressionVisitor.VisitMethodCall(MethodCallExpression node)
   at System.Dynamic.Utils.ExpressionVisitorUtils.VisitArguments(ExpressionVisitor visitor, IArgumentProvider nodes)
   at System.Linq.Expressions.ExpressionVisitor.VisitMethodCall(MethodCallExpression node)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at System.Dynamic.Utils.ExpressionVisitorUtils.VisitArguments(ExpressionVisitor visitor, IArgumentProvider nodes)
   at System.Linq.Expressions.ExpressionVisitor.VisitNew(NewExpression node)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.PendingSelectorExpandingExpressionVisitor.Visit(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.Expand(Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryTranslationPreprocessor.Process(Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Storage.Database.CompileQuery[TResult](Expression query, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.CompileQueryCore[TResult](IDatabase database, Expression query, IModel model, Boolean async)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.<>c__DisplayClass11_0`1.<ExecuteCore>b__0()
   at Microsoft.EntityFrameworkCore.Query.Internal.CompiledQueryCache.GetOrAddQuery[TResult](Object cacheKey, Func`1 compiler)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteCore[TResult](Expression query, Boolean async, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.QueryCompiler.ExecuteAsync[TResult](Expression query, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryProvider.ExecuteAsync[TResult](Expression expression, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1.GetAsyncEnumerator(CancellationToken cancellationToken)
   at System.Runtime.CompilerServices.ConfiguredCancelableAsyncEnumerable`1.GetAsyncEnumerator()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at PHONE_STORE.API.Controllers.ShopProductsController.List(String q, Nullable`1 catId, Int32 page, Int32 pageSize, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.API\Controllers\ShopProductsController.cs:line 35
   at lambda_method103(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-05 10:48:37.245 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - 500 null application/problem+json; charset=utf-8 58.857ms
2025-09-05 10:49:10.551 +07:00 [INF] User profile is available. Using 'C:\Users\Administrator\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-09-05 10:49:10.747 +07:00 [INF] Now listening on: https://localhost:7277
2025-09-05 10:49:10.749 +07:00 [INF] Now listening on: http://localhost:5209
2025-09-05 10:49:10.859 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-05 10:49:10.860 +07:00 [INF] Hosting environment: Development
2025-09-05 10:49:10.860 +07:00 [INF] Content root path: C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.API
2025-09-05 10:49:11.014 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/swagger/index.html - null null
2025-09-05 10:49:11.196 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/swagger/index.html - 200 null text/html;charset=utf-8 192.5068ms
2025-09-05 10:49:11.203 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/_vs/browserLink - null null
2025-09-05 10:49:11.203 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/_framework/aspnetcore-browser-refresh.js - null null
2025-09-05 10:49:11.211 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/_framework/aspnetcore-browser-refresh.js - 200 13766 application/javascript; charset=utf-8 8.7228ms
2025-09-05 10:49:11.240 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/_vs/browserLink - 200 null text/javascript; charset=UTF-8 37.4619ms
2025-09-05 10:49:11.281 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/swagger/v1/swagger.json - null null
2025-09-05 10:49:11.327 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 46.5186ms
2025-09-05 10:49:11.932 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 10:49:12.001 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 10:49:12.029 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 10:49:12.684 +07:00 [WRN] The decimal property 'UnitPrice' on entity type 'CartItem' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 10:49:12.688 +07:00 [WRN] The decimal property 'DiscountTotal' on entity type 'Order' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 10:49:12.689 +07:00 [WRN] The decimal property 'GrandTotal' on entity type 'Order' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 10:49:12.690 +07:00 [WRN] The decimal property 'ShippingFee' on entity type 'Order' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 10:49:12.691 +07:00 [WRN] The decimal property 'Subtotal' on entity type 'Order' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 10:49:12.691 +07:00 [WRN] The decimal property 'TaxTotal' on entity type 'Order' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 10:49:12.692 +07:00 [WRN] The decimal property 'DiscountAmount' on entity type 'OrderItem' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 10:49:12.693 +07:00 [WRN] The decimal property 'TaxAmount' on entity type 'OrderItem' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 10:49:12.694 +07:00 [WRN] The decimal property 'UnitPrice' on entity type 'OrderItem' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 10:49:12.694 +07:00 [WRN] The decimal property 'DecValue' on entity type 'ProductAttributeValue' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 10:49:12.695 +07:00 [WRN] The decimal property 'ListPrice' on entity type 'ProductPrice' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 10:49:12.696 +07:00 [WRN] The decimal property 'SalePrice' on entity type 'ProductPrice' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 10:49:12.697 +07:00 [WRN] The decimal property 'WeightGram' on entity type 'ProductVariant' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 10:49:13.310 +07:00 [ERR] 2025-09-05 10:49:13.309677 ThreadID:9   (ERROR)   OracleRelationalCommand.ExecuteReaderAsync() :  Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
2025-09-05 10:49:13.319 +07:00 [ERR] Failed executing DbCommand (109ms) [Parameters=[:p0='?' (DbType = DateTime), :p1='?' (Size = 2000), :p2='?' (DbType = Int64), :p3='?' (Size = 64), :p4='?' (Size = 2000), :p5='?' (DbType = DateTime), :cur0='?' (Direction = Output) (DbType = Object)], CommandType='"Text"', CommandTimeout='0']
DECLARE

TYPE "rCARTS_0" IS RECORD
(
"ID" NUMBER(19)
);
TYPE "tCARTS_0" IS TABLE OF "rCARTS_0";
"lCARTS_0" "tCARTS_0";

BEGIN

"lCARTS_0" := "tCARTS_0"();
"lCARTS_0".extend(1);
INSERT INTO "HEHE"."CARTS" ("CREATED_AT", "CURRENCY", "CUSTOMER_ID", "SESSION_TOKEN", "STATUS", "UPDATED_AT")
VALUES (:p0, :p1, :p2, :p3, :p4, :p5)
RETURNING "ID" INTO "lCARTS_0"(1)."ID";
OPEN :cur0 FOR SELECT "lCARTS_0"(1)."ID" FROM DUAL;

END;
2025-09-05 10:49:13.348 +07:00 [ERR] 2025-09-05 10:49:13.348836 ThreadID:9   (ERROR)   OracleExecutionStrategy.ExecuteAsync() :  Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
2025-09-05 10:49:13.357 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'PHONE_STORE.Infrastructure.Data.PhoneDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-09-05 10:49:13.472 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 1440.5265ms
2025-09-05 10:49:13.476 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 10:49:13.480 +07:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at PHONE_STORE.Infrastructure.Repositories.CartRepository.EnsureCartId(Nullable`1 customerId, String sessionId, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.Infrastructure\Repositories\CartRepository.cs:line 50
   at PHONE_STORE.Infrastructure.Repositories.CartRepository.GetOrCreateAsync(Nullable`1 customerId, String sessionId, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.Infrastructure\Repositories\CartRepository.cs:line 77
   at lambda_method9(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-05 10:49:13.519 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 500 null application/problem+json; charset=utf-8 1588.4236ms
2025-09-05 10:49:13.870 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - null null
2025-09-05 10:49:13.874 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 10:49:13.879 +07:00 [INF] Route matched with {action = "List", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem]]] List(System.String, System.Nullable`1[System.Int64], Int32, Int32, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 10:49:14.055 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API) in 175.2074ms
2025-09-05 10:49:14.057 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 10:49:14.058 +07:00 [ERR] An unhandled exception has occurred while executing the request.
System.ArgumentNullException: Value cannot be null. (Parameter 'parameter')
   at System.ArgumentNullException.Throw(String paramName)
   at System.ArgumentNullException.ThrowIfNull(Object argument, String paramName)
   at System.Linq.Expressions.Expression.Lambda(Expression body, String name, Boolean tailCall, IEnumerable`1 parameters)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.ReducingExpressionVisitor.Visit(Expression expression)
   at System.Dynamic.Utils.ExpressionVisitorUtils.VisitArguments(ExpressionVisitor visitor, IArgumentProvider nodes)
   at System.Linq.Expressions.ExpressionVisitor.VisitMethodCall(MethodCallExpression node)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.ReducingExpressionVisitor.Visit(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.MaterializeCollectionNavigationExpression.VisitChildren(ExpressionVisitor visitor)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.ReducingExpressionVisitor.Visit(Expression expression)
   at System.Dynamic.Utils.ExpressionVisitorUtils.VisitArguments(ExpressionVisitor visitor, IArgumentProvider nodes)
   at System.Linq.Expressions.ExpressionVisitor.VisitMethodCall(MethodCallExpression node)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.ReducingExpressionVisitor.Visit(Expression expression)
   at System.Dynamic.Utils.ExpressionVisitorUtils.VisitArguments(ExpressionVisitor visitor, IArgumentProvider nodes)
   at System.Linq.Expressions.ExpressionVisitor.VisitMethodCall(MethodCallExpression node)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.ReducingExpressionVisitor.Visit(Expression expression)
   at System.Dynamic.Utils.ExpressionVisitorUtils.VisitArguments(ExpressionVisitor visitor, IArgumentProvider nodes)
   at System.Linq.Expressions.ExpressionVisitor.VisitMethodCall(MethodCallExpression node)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.ReducingExpressionVisitor.Visit(Expression expression)
   at System.Dynamic.Utils.ExpressionVisitorUtils.VisitArguments(ExpressionVisitor visitor, IArgumentProvider nodes)
   at System.Linq.Expressions.ExpressionVisitor.VisitMethodCall(MethodCallExpression node)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.ReducingExpressionVisitor.Visit(Expression expression)
   at System.Dynamic.Utils.ExpressionVisitorUtils.VisitArguments(ExpressionVisitor visitor, IArgumentProvider nodes)
   at System.Linq.Expressions.ExpressionVisitor.VisitMethodCall(MethodCallExpression node)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.ReducingExpressionVisitor.Visit(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.VisitMethodCall(MethodCallExpression methodCallExpression)
   at System.Dynamic.Utils.ExpressionVisitorUtils.VisitArguments(ExpressionVisitor visitor, IArgumentProvider nodes)
   at System.Linq.Expressions.ExpressionVisitor.VisitNew(NewExpression node)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.PendingSelectorExpandingExpressionVisitor.Visit(Expression expression)
   at Microsoft.EntityFrameworkCore.Query.Internal.NavigationExpandingExpressionVisitor.Expand(Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryTranslationPreprocessor.Process(Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutorExpression[TResult](Expression query)
   at Microsoft.EntityFrameworkCore.Query.QueryCompilationContext.CreateQueryExecutor[TResult](Expression query)
   at Micr2025-09-05 10:58:51.474 +07:00 [INF] User profile is available. Using 'C:\Users\Administrator\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-09-05 10:58:51.711 +07:00 [INF] Now listening on: https://localhost:7277
2025-09-05 10:58:51.712 +07:00 [INF] Now listening on: http://localhost:5209
2025-09-05 10:58:51.817 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-05 10:58:51.819 +07:00 [INF] Hosting environment: Development
2025-09-05 10:58:51.820 +07:00 [INF] Content root path: C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.API
2025-09-05 10:58:52.703 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/swagger/index.html - null null
2025-09-05 10:58:53.189 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/_vs/browserLink - null null
2025-09-05 10:58:53.189 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/_framework/aspnetcore-browser-refresh.js - null null
2025-09-05 10:58:53.192 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/swagger/index.html - 200 null text/html;charset=utf-8 498.2878ms
2025-09-05 10:58:53.204 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/_framework/aspnetcore-browser-refresh.js - 200 13766 application/javascript; charset=utf-8 15.8737ms
2025-09-05 10:58:53.369 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/_vs/browserLink - 200 null text/javascript; charset=UTF-8 180.5051ms
2025-09-05 10:58:53.407 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - null null
2025-09-05 10:58:53.421 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/swagger/v1/swagger.json - null null
2025-09-05 10:58:53.496 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 10:58:53.521 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 100.4993ms
2025-09-05 10:58:53.545 +07:00 [INF] Route matched with {action = "List", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem]]] List(System.String, System.Nullable`1[System.Int64], Int32, Int32, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 10:58:54.272 +07:00 [WRN] The decimal property 'UnitPrice' on entity type 'CartItem' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 10:58:54.275 +07:00 [WRN] The decimal property 'DiscountTotal' on entity type 'Order' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 10:58:54.275 +07:00 [WRN] The decimal property 'GrandTotal' on entity type 'Order' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 10:58:54.276 +07:00 [WRN] The decimal property 'ShippingFee' on entity type 'Order' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 10:58:54.276 +07:00 [WRN] The decimal property 'Subtotal' on entity type 'Order' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 10:58:54.277 +07:00 [WRN] The decimal property 'TaxTotal' on entity type 'Order' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 10:58:54.278 +07:00 [WRN] The decimal property 'DiscountAmount' on entity type 'OrderItem' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 10:58:54.279 +07:00 [WRN] The decimal property 'TaxAmount' on entity type 'OrderItem' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 10:58:54.280 +07:00 [WRN] The decimal property 'UnitPrice' on entity type 'OrderItem' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 10:58:54.282 +07:00 [WRN] The decimal property 'DecValue' on entity type 'ProductAttributeValue' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 10:58:54.283 +07:00 [WRN] The decimal property 'ListPrice' on entity type 'ProductPrice' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 10:58:54.285 +07:00 [WRN] The decimal property 'SalePrice' on entity type 'ProductPrice' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 10:58:54.285 +07:00 [WRN] The decimal property 'WeightGram' on entity type 'ProductVariant' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 10:58:55.035 +07:00 [INF] Executed DbCommand (129ms) [Parameters=[:p_0='?' (DbType = Int32), :p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."ID" "Id", "p"."NAME" "Name", "p"."SLUG" "Slug"
FROM "HEHE"."PRODUCTS" "p"
WHERE "p"."IS_ACTIVE" = 1
ORDER BY "p"."CREATED_AT" DESC
OFFSET :p_0 ROWS FETCH NEXT :p_1 ROWS ONLY
2025-09-05 10:58:55.174 +07:00 [INF] Executed DbCommand (25ms) [Parameters=[], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", (
    SELECT "p0"."IMAGE_URL"
    FROM "HEHE"."PRODUCT_IMAGES" "p0"
    WHERE (("p0"."PRODUCT_ID" IS NOT NULL AND "p0"."PRODUCT_ID" IN (3, 2, 1)) AND ("p"."PRODUCT_ID" = "p0"."PRODUCT_ID"))
    ORDER BY "p0"."SORT_ORDER"
    FETCH FIRST 1 ROWS ONLY) "Url"
FROM "HEHE"."PRODUCT_IMAGES" "p"
WHERE "p"."PRODUCT_ID" IS NOT NULL AND "p"."PRODUCT_ID" IN (3, 2, 1)
GROUP BY "p"."PRODUCT_ID"
2025-09-05 10:58:55.239 +07:00 [INF] Executed DbCommand (13ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", MIN(COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")) "MinPrice"
FROM "HEHE"."PRODUCT_VARIANTS" "p"
INNER JOIN "HEHE"."PRODUCT_PRICES" "p0" ON "p"."ID" = "p0"."VARIANT_ID"
WHERE (("p"."PRODUCT_ID" IN (3, 2, 1)) AND ((("p0"."STARTS_AT" <= :now_1) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))))
GROUP BY "p"."PRODUCT_ID"
2025-09-05 10:58:55.256 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem, PHONE_STORE.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-05 10:58:55.271 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API) in 1722.1407ms
2025-09-05 10:58:55.274 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 10:58:55.283 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - 200 null application/json; charset=utf-8 1876.9465ms
2025-09-05 10:58:55.432 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 10:58:55.458 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 10:58:55.470 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 10:58:55.741 +07:00 [ERR] 2025-09-05 10:58:55.741432 ThreadID:15  (ERROR)   OracleRelationalCommand.ExecuteReaderAsync() :  Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
2025-09-05 10:58:55.746 +07:00 [ERR] Failed executing DbCommand (66ms) [Parameters=[:p0='?' (DbType = DateTime), :p1='?' (Size = 2000), :p2='?' (DbType = Int64), :p3='?' (Size = 64), :p4='?' (Size = 2000), :p5='?' (DbType = DateTime), :cur0='?' (Direction = Output) (DbType = Object)], CommandType='"Text"', CommandTimeout='0']
DECLARE

TYPE "rCARTS_0" IS RECORD
(
"ID" NUMBER(19)
);
TYPE "tCARTS_0" IS TABLE OF "rCARTS_0";
"lCARTS_0" "tCARTS_0";

BEGIN

"lCARTS_0" := "tCARTS_0"();
"lCARTS_0".extend(1);
INSERT INTO "HEHE"."CARTS" ("CREATED_AT", "CURRENCY", "CUSTOMER_ID", "SESSION_TOKEN", "STATUS", "UPDATED_AT")
VALUES (:p0, :p1, :p2, :p3, :p4, :p5)
RETURNING "ID" INTO "lCARTS_0"(1)."ID";
OPEN :cur0 FOR SELECT "lCARTS_0"(1)."ID" FROM DUAL;

END;
2025-09-05 10:58:55.770 +07:00 [ERR] 2025-09-05 10:58:55.770279 ThreadID:15  (ERROR)   OracleExecutionStrategy.ExecuteAsync() :  Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
2025-09-05 10:58:55.778 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'PHONE_STORE.Infrastructure.Data.PhoneDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-09-05 10:58:55.896 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 423.2749ms
2025-09-05 10:58:55.898 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 10:58:55.901 +07:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at PHONE_STORE.Infrastructure.Repositories.CartRepository.EnsureCartId(Nullable`1 customerId, String sessionId, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.Infrastructure\Repositories\CartRepository.cs:line 50
   at PHONE_STORE.Infrastructure.Repositories.CartRepository.GetOrCreateAsync(Nullable`1 customerId, String sessionId, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.Infrastructure\Repositories\CartRepository.cs:line 77
   at lambda_method31(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-05 10:58:55.931 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 500 null application/problem+json; charset=utf-8 498.9585ms
2025-09-05 10:59:03.286 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - null null
2025-09-05 10:59:03.290 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 10:59:03.292 +07:00 [INF] Route matched with {action = "List", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem]]] List(System.String, System.Nullable`1[System.Int64], Int32, Int32, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 10:59:03.316 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:p_0='?' (DbType = Int32), :p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."ID" "Id", "p"."NAME" "Name", "p"."SLUG" "Slug"
FROM "HEHE"."PRODUCTS" "p"
WHERE "p"."IS_ACTIVE" = 1
ORDER BY "p"."CREATED_AT" DESC
OFFSET :p_0 ROWS FETCH NEXT :p_1 ROWS ONLY
2025-09-05 10:59:03.322 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", (
    SELECT "p0"."IMAGE_URL"
    FROM "HEHE"."PRODUCT_IMAGES" "p0"
    WHERE (("p0"."PRODUCT_ID" IS NOT NULL AND "p0"."PRODUCT_ID" IN (3, 2, 1)) AND ("p"."PRODUCT_ID" = "p0"."PRODUCT_ID"))
    ORDER BY "p0"."SORT_ORDER"
    FETCH FIRST 1 ROWS ONLY) "Url"
FROM "HEHE"."PRODUCT_IMAGES" "p"
WHERE "p"."PRODUCT_ID" IS NOT NULL AND "p"."PRODUCT_ID" IN (3, 2, 1)
GROUP BY "p"."PRODUCT_ID"
2025-09-05 10:59:03.329 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", MIN(COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")) "MinPrice"
FROM "HEHE"."PRODUCT_VARIANTS" "p"
INNER JOIN "HEHE"."PRODUCT_PRICES" "p0" ON "p"."ID" = "p0"."VARIANT_ID"
WHERE (("p"."PRODUCT_ID" IN (3, 2, 1)) AND ((("p0"."STARTS_AT" <= :now_1) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))))
GROUP BY "p"."PRODUCT_ID"
2025-09-05 10:59:03.331 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem, PHONE_STORE.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-05 10:59:03.332 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API) in 38.2012ms
2025-09-05 10:59:03.333 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 10:59:03.334 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - 200 null application/json; charset=utf-8 47.7629ms
2025-09-05 10:59:03.362 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 10:59:03.365 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 10:59:03.366 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 10:59:03.391 +07:00 [ERR] 2025-09-05 10:59:03.391529 ThreadID:15  (ERROR)   OracleRelationalCommand.ExecuteReaderAsync() :  Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
2025-09-05 10:59:03.393 +07:00 [ERR] Failed executing DbCommand (15ms) [Parameters=[:p0='?' (DbType = DateTime), :p1='?' (Size = 2000), :p2='?' (DbType = Int64), :p3='?' (Size = 64), :p4='?' (Size = 2000), :p5='?' (DbType = DateTime), :cur0='?' (Direction = Output) (DbType = Object)], CommandType='"Text"', CommandTimeout='0']
DECLARE

TYPE "rCARTS_0" IS RECORD
(
"ID" NUMBER(19)
);
TYPE "tCARTS_0" IS TABLE OF "rCARTS_0";
"lCARTS_0" "tCARTS_0";

BEGIN

"lCARTS_0" := "tCARTS_0"();
"lCARTS_0".extend(1);
INSERT INTO "HEHE"."CARTS" ("CREATED_AT", "CURRENCY", "CUSTOMER_ID", "SESSION_TOKEN", "STATUS", "UPDATED_AT")
VALUES (:p0, :p1, :p2, :p3, :p4, :p5)
RETURNING "ID" INTO "lCARTS_0"(1)."ID";
OPEN :cur0 FOR SELECT "lCARTS_0"(1)."ID" FROM DUAL;

END;
2025-09-05 10:59:03.397 +07:00 [ERR] 2025-09-05 10:59:03.397154 ThreadID:15  (ERROR)   OracleExecutionStrategy.ExecuteAsync() :  Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
2025-09-05 10:59:03.400 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'PHONE_STORE.Infrastructure.Data.PhoneDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-09-05 10:59:03.537 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 169.3122ms
2025-09-05 10:59:03.539 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 10:59:03.541 +07:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at PHONE_STORE.Infrastructure.Repositories.CartRepository.EnsureCartId(Nullable`1 customerId, String sessionId, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.Infrastructure\Repositories\CartRepository.cs:line 50
   at PHONE_STORE.Infrastructure.Repositories.CartRepository.GetOrCreateAsync(Nullable`1 customerId, String sessionId, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.Infrastructure\Repositories\CartRepository.cs:line 77
   at lambda_method31(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-05 10:59:03.557 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 500 null application/problem+json; charset=utf-8 195.4072ms
2025-09-05 10:59:04.486 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 10:59:04.489 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 10:59:04.489 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 10:59:04.500 +07:00 [ERR] 2025-09-05 10:59:04.500619 ThreadID:7   (ERROR)   OracleRelationalCommand.ExecuteReaderAsync() :  Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
2025-09-05 10:59:04.501 +07:00 [ERR] Failed executing DbCommand (7ms) [Parameters=[:p0='?' (DbType = DateTime), :p1='?' (Size = 2000), :p2='?' (DbType = Int64), :p3='?' (Size = 64), :p4='?' (Size = 2000), :p5='?' (DbType = DateTime), :cur0='?' (Direction = Output) (DbType = Object)], CommandType='"Text"', CommandTimeout='0']
DECLARE

TYPE "rCARTS_0" IS RECORD
(
"ID" NUMBER(19)
);
TYPE "tCARTS_0" IS TABLE OF "rCARTS_0";
"lCARTS_0" "tCARTS_0";

BEGIN

"lCARTS_0" := "tCARTS_0"();
"lCARTS_0".extend(1);
INSERT INTO "HEHE"."CARTS" ("CREATED_AT", "CURRENCY", "CUSTOMER_ID", "SESSION_TOKEN", "STATUS", "UPDATED_AT")
VALUES (:p0, :p1, :p2, :p3, :p4, :p5)
RETURNING "ID" INTO "lCARTS_0"(1)."ID";
OPEN :cur0 FOR SELECT "lCARTS_0"(1)."ID" FROM DUAL;

END;
2025-09-05 10:59:04.505 +07:00 [ERR] 2025-09-05 10:59:04.505620 ThreadID:7   (ERROR)   OracleExecutionStrategy.ExecuteAsync() :  Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
2025-09-05 10:59:04.508 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'PHONE_STORE.Infrastructure.Data.PhoneDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-09-05 10:59:04.619 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 128.4797ms
2025-09-05 10:59:04.620 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 10:59:04.621 +07:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at PHONE_STORE.Infrastructure.Repositories.CartRepository.EnsureCartId(Nullable`1 customerId, String sessionId, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.Infrastructure\Repositories\CartRepository.cs:line 50
   at PHONE_STORE.Infrastructure.Repositories.CartRepository.GetOrCreateAsync(Nullable`1 customerId, String sessionId, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.Infrastructure\Repositories\CartRepository.cs:line 77
   at lambda_method31(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-05 10:59:04.635 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 500 null application/problem+json; charset=utf-8 149.1733ms
2025-09-05 10:59:09.107 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products/galaxy-s24 - null null
2025-09-05 10:59:09.109 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API)'
2025-09-05 10:59:09.114 +07:00 [INF] Route matched with {action = "Details", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductDetail]] Details(System.String, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 10:59:09.226 +07:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-09-05 10:59:09.282 +07:00 [INF] Executed DbCommand (14ms) [Parameters=[:slug_0='?' (Size = 220)], CommandType='"Text"', CommandTimeout='0']
SELECT "p2"."ID", "p2"."BRAND_ID", "p2"."CREATED_AT", "p2"."DEFAULT_CATEGORY_ID", "p2"."DESCRIPTION", "p2"."IS_ACTIVE", "p2"."NAME", "p2"."SLUG", "p2"."SPEC_JSON", "p0"."ID", "p0"."BARCODE", "p0"."COLOR", "p0"."IS_ACTIVE", "p0"."PRODUCT_ID", "p0"."SKU", "p0"."STORAGE_GB", "p0"."WEIGHT_GRAM", "p1"."ID", "p1"."ALT_TEXT", "p1"."IMAGE_URL", "p1"."IS_PRIMARY", "p1"."PRODUCT_ID", "p1"."SORT_ORDER", "p1"."VARIANT_ID"
FROM (
    SELECT "p"."ID", "p"."BRAND_ID", "p"."CREATED_AT", "p"."DEFAULT_CATEGORY_ID", "p"."DESCRIPTION", "p"."IS_ACTIVE", "p"."NAME", "p"."SLUG", "p"."SPEC_JSON"
    FROM "HEHE"."PRODUCTS" "p"
    WHERE (("p"."SLUG" = :slug_0) AND ("p"."IS_ACTIVE" = 1))
    FETCH FIRST 1 ROWS ONLY
) "p2"
LEFT JOIN "HEHE"."PRODUCT_VARIANTS" "p0" ON "p2"."ID" = "p0"."PRODUCT_ID"
LEFT JOIN "HEHE"."PRODUCT_IMAGES" "p1" ON "p2"."ID" = "p1"."PRODUCT_ID"
ORDER BY "p2"."ID", "p0"."ID"
2025-09-05 10:59:09.419 +07:00 [INF] Executed DbCommand (37ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."VARIANT_ID" "VariantId", COALESCE((
    SELECT COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")
    FROM "HEHE"."PRODUCT_PRICES" "p0"
    WHERE (((((("p0"."VARIANT_ID" = 3) AND ("p0"."STARTS_AT" <= :now_1))) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))) AND ("p"."VARIANT_ID" = "p0"."VARIANT_ID"))
    ORDER BY "p0"."STARTS_AT" DESC
    FETCH FIRST 1 ROWS ONLY), 0.0) "Price"
FROM "HEHE"."PRODUCT_PRICES" "p"
WHERE (((("p"."VARIANT_ID" = 3) AND ("p"."STARTS_AT" <= :now_1))) AND ((("p"."ENDS_AT" IS NULL) OR ("p"."ENDS_AT" > :now_2))))
GROUP BY "p"."VARIANT_ID"
2025-09-05 10:59:09.428 +07:00 [INF] Executing OkObjectResult, writing value of type 'PHONE_STORE.API.Controllers.ShopProductsController+ShopProductDetail'.
2025-09-05 10:59:09.443 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API) in 328.0065ms
2025-09-05 10:59:09.446 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API)'
2025-09-05 10:59:09.447 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products/galaxy-s24 - 200 null application/json; charset=utf-8 340.0128ms
2025-09-05 10:59:09.476 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 10:59:09.479 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 10:59:09.479 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 10:59:09.489 +07:00 [ERR] 2025-09-05 10:59:09.489876 ThreadID:7   (ERROR)   OracleRelationalCommand.ExecuteReaderAsync() :  Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
2025-09-05 10:59:09.492 +07:00 [ERR] Failed executing DbCommand (9ms) [Parameters=[:p0='?' (DbType = DateTime), :p1='?' (Size = 2000), :p2='?' (DbType = Int64), :p3='?' (Size = 64), :p4='?' (Size = 2000), :p5='?' (DbType = DateTime), :cur0='?' (Direction = Output) (DbType = Object)], CommandType='"Text"', CommandTimeout='0']
DECLARE

TYPE "rCARTS_0" IS RECORD
(
"ID" NUMBER(19)
);
TYPE "tCARTS_0" IS TABLE OF "rCARTS_0";
"lCARTS_0" "tCARTS_0";

BEGIN

"lCARTS_0" := "tCARTS_0"();
"lCARTS_0".extend(1);
INSERT INTO "HEHE"."CARTS" ("CREATED_AT", "CURRENCY", "CUSTOMER_ID", "SESSION_TOKEN", "STATUS", "UPDATED_AT")
VALUES (:p0, :p1, :p2, :p3, :p4, :p5)
RETURNING "ID" INTO "lCARTS_0"(1)."ID";
OPEN :cur0 FOR SELECT "lCARTS_0"(1)."ID" FROM DUAL;

END;
2025-09-05 10:59:09.495 +07:00 [ERR] 2025-09-05 10:59:09.495844 ThreadID:7   (ERROR)   OracleExecutionStrategy.ExecuteAsync() :  Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
2025-09-05 10:59:09.499 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'PHONE_STORE.Infrastructure.Data.PhoneDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-09-05 10:59:09.605 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 125.1011ms
2025-09-05 10:59:09.606 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 10:59:09.608 +07:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at PHONE_STORE.Infrastructure.Repositories.CartRepository.EnsureCartId(Nullable`1 customerId, String sessionId, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.Infrastructure\Repositories\CartRepository.cs:line 50
   at PHONE_STORE.Infrastructure.Repositories.CartRepository.GetOrCreateAsync(Nullable`1 customerId, String sessionId, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.Infrastructure\Repositories\CartRepository.cs:line 77
   at lambda_method31(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-05 10:59:09.622 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 500 null application/problem+json; charset=utf-8 145.4745ms
2025-09-05 10:59:11.587 +07:00 [INF] Request starting HTTP/1.1 POST https://localhost:7277/api/shop/cart/items - application/json; charset=utf-8 null
2025-09-05 10:59:11.590 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Add (PHONE_STORE.API)'
2025-09-05 10:59:11.594 +07:00 [INF] Route matched with {action = "Add", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Add(PHONE_STORE.Application.Dtos.CartItemUpsertDto, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 10:59:11.645 +07:00 [ERR] 2025-09-05 10:59:11.645686 ThreadID:5   (ERROR)   OracleRelationalCommand.ExecuteReaderAsync() :  Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
2025-09-05 10:59:11.647 +07:00 [ERR] Failed executing DbCommand (16ms) [Parameters=[:p0='?' (DbType = DateTime), :p1='?' (Size = 2000), :p2='?' (DbType = Int64), :p3='?' (Size = 64), :p4='?' (Size = 2000), :p5='?' (DbType = DateTime), :cur0='?' (Direction = Output) (DbType = Object)], CommandType='"Text"', CommandTimeout='0']
DECLARE

TYPE "rCARTS_0" IS RECORD
(
"ID" NUMBER(19)
);
TYPE "tCARTS_0" IS TABLE OF "rCARTS_0";
"lCARTS_0" "tCARTS_0";

BEGIN

"lCARTS_0" := "tCARTS_0"();
"lCARTS_0".extend(1);
INSERT INTO "HEHE"."CARTS" ("CREATED_AT", "CURRENCY", "CUSTOMER_ID", "SESSION_TOKEN", "STATUS", "UPDATED_AT")
VALUES (:p0, :p1, :p2, :p3, :p4, :p5)
RETURNING "ID" INTO "lCARTS_0"(1)."ID";
OPEN :cur0 FOR SELECT "lCARTS_0"(1)."ID" FROM DUAL;

END;
2025-09-05 10:59:11.651 +07:00 [ERR] 2025-09-05 10:59:11.651407 ThreadID:5   (ERROR)   OracleExecutionStrategy.ExecuteAsync() :  Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
2025-09-05 10:59:11.654 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'PHONE_STORE.Infrastructure.Data.PhoneDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-09-05 10:59:11.784 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Add (PHONE_STORE.API) in 188.8468ms
2025-09-05 10:59:11.786 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Add (PHONE_STORE.API)'
2025-09-05 10:59:11.788 +07:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at PHONE_STORE.Infrastructure.Repositories.CartRepository.EnsureCartId(Nullable`1 customerId, String sessionId, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.Infrastructure\Repositories\CartRepository.cs:line 50
   at PHONE_STORE.Infrastructure.Repositories.CartRepository.AddOrUpdateItemAsync(Nullable`1 customerId, String sessionId, CartItemUpsertDto dto, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.Infrastructure\Repositories\CartRepository.cs:line 98
   at lambda_method208(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-05 10:59:11.818 +07:00 [INF] Request finished HTTP/1.1 POST https://localhost:7277/api/shop/cart/items - 500 null application/problem+json; charset=utf-8 230.1492ms
2025-09-05 10:59:11.823 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products/galaxy-s24 - null null
2025-09-05 10:59:11.825 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API)'
2025-09-05 10:59:11.826 +07:00 [INF] Route matched with {action = "Details", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductDetail]] Details(System.String, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 10:59:11.830 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:slug_0='?' (Size = 220)], CommandType='"Text"', CommandTimeout='0']
SELECT "p2"."ID", "p2"."BRAND_ID", "p2"."CREATED_AT", "p2"."DEFAULT_CATEGORY_ID", "p2"."DESCRIPTION", "p2"."IS_ACTIVE", "p2"."NAME", "p2"."SLUG", "p2"."SPEC_JSON", "p0"."ID", "p0"."BARCODE", "p0"."COLOR", "p0"."IS_ACTIVE", "p0"."PRODUCT_ID", "p0"."SKU", "p0"."STORAGE_GB", "p0"."WEIGHT_GRAM", "p1"."ID", "p1"."ALT_TEXT", "p1"."IMAGE_URL", "p1"."IS_PRIMARY", "p1"."PRODUCT_ID", "p1"."SORT_ORDER", "p1"."VARIANT_ID"
FROM (
    SELECT "p"."ID", "p"."BRAND_ID", "p"."CREATED_AT", "p"."DEFAULT_CATEGORY_ID", "p"."DESCRIPTION", "p"."IS_ACTIVE", "p"."NAME", "p"."SLUG", "p"."SPEC_JSON"
    FROM "HEHE"."PRODUCTS" "p"
    WHERE (("p"."SLUG" = :slug_0) AND ("p"."IS_ACTIVE" = 1))
    FETCH FIRST 1 ROWS ONLY
) "p2"
LEFT JOIN "HEHE"."PRODUCT_VARIANTS" "p0" ON "p2"."ID" = "p0"."PRODUCT_ID"
LEFT JOIN "HEHE"."PRODUCT_IMAGES" "p1" ON "p2"."ID" = "p1"."PRODUCT_ID"
ORDER BY "p2"."ID", "p0"."ID"
2025-09-05 10:59:11.845 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."VARIANT_ID" "VariantId", COALESCE((
    SELECT COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")
    FROM "HEHE"."PRODUCT_PRICES" "p0"
    WHERE (((((("p0"."VARIANT_ID" = 3) AND ("p0"."STARTS_AT" <= :now_1))) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))) AND ("p"."VARIANT_ID" = "p0"."VARIANT_ID"))
    ORDER BY "p0"."STARTS_AT" DESC
    FETCH FIRST 1 ROWS ONLY), 0.0) "Price"
FROM "HEHE"."PRODUCT_PRICES" "p"
WHERE (((("p"."VARIANT_ID" = 3) AND ("p"."STARTS_AT" <= :now_1))) AND ((("p"."ENDS_AT" IS NULL) OR ("p"."ENDS_AT" > :now_2))))
GROUP BY "p"."VARIANT_ID"
2025-09-05 10:59:11.847 +07:00 [INF] Executing OkObjectResult, writing value of type 'PHONE_STORE.API.Controllers.ShopProductsController+ShopProductDetail'.
2025-09-05 10:59:11.848 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API) in 21.0867ms
2025-09-05 10:59:11.849 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API)'
2025-09-05 10:59:11.849 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products/galaxy-s24 - 200 null application/json; charset=utf-8 26.1585ms
2025-09-05 10:59:11.868 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 10:59:11.870 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 10:59:11.870 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 10:59:11.883 +07:00 [ERR] 2025-09-05 10:59:11.883256 ThreadID:5   (ERROR)   OracleRelationalCommand.ExecuteReaderAsync() :  Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
2025-09-05 10:59:11.887 +07:00 [ERR] Failed executing DbCommand (11ms) [Parameters=[:p0='?' (DbType = DateTime), :p1='?' (Size = 2000), :p2='?' (DbType = Int64), :p3='?' (Size = 64), :p4='?' (Size = 2000), :p5='?' (DbType = DateTime), :cur0='?' (Direction = Output) (DbType = Object)], CommandType='"Text"', CommandTimeout='0']
DECLARE

TYPE "rCARTS_0" IS RECORD
(
"ID" NUMBER(19)
);
TYPE "tCARTS_0" IS TABLE OF "rCARTS_0";
"lCARTS_0" "tCARTS_0";

BEGIN

"lCARTS_0" := "tCARTS_0"();
"lCARTS_0".extend(1);
INSERT INTO "HEHE"."CARTS" ("CREATED_AT", "CURRENCY", "CUSTOMER_ID", "SESSION_TOKEN", "STATUS", "UPDATED_AT")
VALUES (:p0, :p1, :p2, :p3, :p4, :p5)
RETURNING "ID" INTO "lCARTS_0"(1)."ID";
OPEN :cur0 FOR SELECT "lCARTS_0"(1)."ID" FROM DUAL;

END;
2025-09-05 10:59:11.893 +07:00 [ERR] 2025-09-05 10:59:11.893817 ThreadID:5   (ERROR)   OracleExecutionStrategy.ExecuteAsync() :  Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
2025-09-05 10:59:11.898 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'PHONE_STORE.Infrastructure.Data.PhoneDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-09-05 10:59:11.987 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 114.888ms
2025-09-05 10:59:11.988 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 10:59:11.989 +07:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at PHONE_STORE.Infrastructure.Repositories.CartRepository.EnsureCartId(Nullable`1 customerId, String sessionId, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.Infrastructure\Repositories\CartRepository.cs:line 50
   at PHONE_STORE.Infrastructure.Repositories.CartRepository.GetOrCreateAsync(Nullable`1 customerId, String sessionId, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.Infrastructure\Repositories\CartRepository.cs:line 77
   at lambda_method31(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-05 10:59:12.002 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 500 null application/problem+json; charset=utf-8 134.462ms
2025-09-05 10:59:14.845 +07:00 [INF] Request starting HTTP/1.1 POST https://localhost:7277/api/shop/cart/items - application/json; charset=utf-8 null
2025-09-05 10:59:14.847 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Add (PHONE_STORE.API)'
2025-09-05 10:59:14.848 +07:00 [INF] Route matched with {action = "Add", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Add(PHONE_STORE.Application.Dtos.CartItemUpsertDto, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 10:59:14.857 +07:00 [ERR] 2025-09-05 10:59:14.857780 ThreadID:5   (ERROR)   OracleRelationalCommand.ExecuteReaderAsync() :  Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
2025-09-05 10:59:14.859 +07:00 [ERR] Failed executing DbCommand (7ms) [Parameters=[:p0='?' (DbType = DateTime), :p1='?' (Size = 2000), :p2='?' (DbType = Int64), :p3='?' (Size = 64), :p4='?' (Size = 2000), :p5='?' (DbType = DateTime), :cur0='?' (Direction = Output) (DbType = Object)], CommandType='"Text"', CommandTimeout='0']
DECLARE

TYPE "rCARTS_0" IS RECORD
(
"ID" NUMBER(19)
);
TYPE "tCARTS_0" IS TABLE OF "rCARTS_0";
"lCARTS_0" "tCARTS_0";

BEGIN

"lCARTS_0" := "tCARTS_0"();
"lCARTS_0".extend(1);
INSERT INTO "HEHE"."CARTS" ("CREATED_AT", "CURRENCY", "CUSTOMER_ID", "SESSION_TOKEN", "STATUS", "UPDATED_AT")
VALUES (:p0, :p1, :p2, :p3, :p4, :p5)
RETURNING "ID" INTO "lCARTS_0"(1)."ID";
OPEN :cur0 FOR SELECT "lCARTS_0"(1)."ID" FROM DUAL;

END;
2025-09-05 10:59:14.863 +07:00 [ERR] 2025-09-05 10:59:14.862992 ThreadID:5   (ERROR)   OracleExecutionStrategy.ExecuteAsync() :  Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
2025-09-05 10:59:14.866 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'PHONE_STORE.Infrastructure.Data.PhoneDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-09-05 10:59:14.977 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Add (PHONE_STORE.API) in 128.3259ms
2025-09-05 10:59:14.979 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Add (PHONE_STORE.API)'
2025-09-05 10:59:14.980 +07:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at PHONE_STORE.Infrastructure.Repositories.CartRepository.EnsureCartId(Nullable`1 customerId, String sessionId, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.Infrastructure\Repositories\CartRepository.cs:line 50
   at PHONE_STORE.Infrastructure.Repositories.CartRepository.AddOrUpdateItemAsync(Nullable`1 customerId, String sessionId, CartItemUpsertDto dto, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.Infrastructure\Repositories\CartRepository.cs:line 98
   at lambda_method208(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-05 10:59:15.000 +07:00 [INF] Request finished HTTP/1.1 POST https://localhost:7277/api/shop/cart/items - 500 null application/problem+json; charset=utf-8 155.3041ms
2025-09-05 10:59:15.005 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products/galaxy-s24 - null null
2025-09-05 10:59:15.007 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API)'
2025-09-05 10:59:15.007 +07:00 [INF] Route matched with {action = "Details", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductDetail]] Details(System.String, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 10:59:15.011 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:slug_0='?' (Size = 220)], CommandType='"Text"', CommandTimeout='0']
SELECT "p2"."ID", "p2"."BRAND_ID", "p2"."CREATED_AT", "p2"."DEFAULT_CATEGORY_ID", "p2"."DESCRIPTION", "p2"."IS_ACTIVE", "p2"."NAME", "p2"."SLUG", "p2"."SPEC_JSON", "p0"."ID", "p0"."BARCODE", "p0"."COLOR", "p0"."IS_ACTIVE", "p0"."PRODUCT_ID", "p0"."SKU", "p0"."STORAGE_GB", "p0"."WEIGHT_GRAM", "p1"."ID", "p1"."ALT_TEXT", "p1"."IMAGE_URL", "p1"."IS_PRIMARY", "p1"."PRODUCT_ID", "p1"."SORT_ORDER", "p1"."VARIANT_ID"
FROM (
    SELECT "p"."ID", "p"."BRAND_ID", "p"."CREATED_AT", "p"."DEFAULT_CATEGORY_ID", "p"."DESCRIPTION", "p"."IS_ACTIVE", "p"."NAME", "p"."SLUG", "p"."SPEC_JSON"
    FROM "HEHE"."PRODUCTS" "p"
    WHERE (("p"."SLUG" = :slug_0) AND ("p"."IS_ACTIVE" = 1))
    FETCH FIRST 1 ROWS ONLY
) "p2"
LEFT JOIN "HEHE"."PRODUCT_VARIANTS" "p0" ON "p2"."ID" = "p0"."PRODUCT_ID"
LEFT JOIN "HEHE"."PRODUCT_IMAGES" "p1" ON "p2"."ID" = "p1"."PRODUCT_ID"
ORDER BY "p2"."ID", "p0"."ID"
2025-09-05 10:59:15.015 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."VARIANT_ID" "VariantId", COALESCE((
    SELECT COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")
    FROM "HEHE"."PRODUCT_PRICES" "p0"
    WHERE (((((("p0"."VARIANT_ID" = 3) AND ("p0"."STARTS_AT" <= :now_1))) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))) AND ("p"."VARIANT_ID" = "p0"."VARIANT_ID"))
    ORDER BY "p0"."STARTS_AT" DESC
    FETCH FIRST 1 ROWS ONLY), 0.0) "Price"
FROM "HEHE"."PRODUCT_PRICES" "p"
WHERE (((("p"."VARIANT_ID" = 3) AND ("p"."STARTS_AT" <= :now_1))) AND ((("p"."ENDS_AT" IS NULL) OR ("p"."ENDS_AT" > :now_2))))
GROUP BY "p"."VARIANT_ID"
2025-09-05 10:59:15.017 +07:00 [INF] Executing OkObjectResult, writing value of type 'PHONE_STORE.API.Controllers.ShopProductsController+ShopProductDetail'.
2025-09-05 10:59:15.018 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API) in 9.584ms
2025-09-05 10:59:15.019 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API)'
2025-09-05 10:59:15.020 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products/galaxy-s24 - 200 null application/json; charset=utf-8 14.3954ms
2025-09-05 10:59:15.038 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 10:59:15.040 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 10:59:15.041 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 10:59:15.049 +07:00 [ERR] 2025-09-05 10:59:15.049430 ThreadID:10  (ERROR)   OracleRelationalCommand.ExecuteReaderAsync() :  Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
2025-09-05 10:59:15.051 +07:00 [ERR] Failed executing DbCommand (6ms) [Parameters=[:p0='?' (DbType = DateTime), :p1='?' (Size = 2000), :p2='?' (DbType = Int64), :p3='?' (Size = 64), :p4='?' (Size = 2000), :p5='?' (DbType = DateTime), :cur0='?' (Direction = Output) (DbType = Object)], CommandType='"Text"', CommandTimeout='0']
DECLARE

TYPE "rCARTS_0" IS RECORD
(
"ID" NUMBER(19)
);
TYPE "tCARTS_0" IS TABLE OF "rCARTS_0";
"lCARTS_0" "tCARTS_0";

BEGIN

"lCARTS_0" := "tCARTS_0"();
"lCARTS_0".extend(1);
INSERT INTO "HEHE"."CARTS" ("CREATED_AT", "CURRENCY", "CUSTOMER_ID", "SESSION_TOKEN", "STATUS", "UPDATED_AT")
VALUES (:p0, :p1, :p2, :p3, :p4, :p5)
RETURNING "ID" INTO "lCARTS_0"(1)."ID";
OPEN :cur0 FOR SELECT "lCARTS_0"(1)."ID" FROM DUAL;

END;
2025-09-05 10:59:15.058 +07:00 [ERR] 2025-09-05 10:59:15.058438 ThreadID:10  (ERROR)   OracleExecutionStrategy.ExecuteAsync() :  Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
2025-09-05 10:59:15.062 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'PHONE_STORE.Infrastructure.Data.PhoneDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-09-05 10:59:15.172 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 129.6918ms
2025-09-05 10:59:15.174 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 10:59:15.176 +07:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at PHONE_STORE.Infrastructure.Repositories.CartRepository.EnsureCartId(Nullable`1 customerId, String sessionId, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.Infrastructure\Repositories\CartRepository.cs:line 50
   at PHONE_STORE.Infrastructure.Repositories.CartRepository.GetOrCreateAsync(Nullable`1 customerId, String sessionId, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.Infrastructure\Repositories\CartRepository.cs:line 77
   at lambda_method31(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-05 10:59:15.185 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 500 null application/problem+json; charset=utf-8 147.423ms
2025-09-05 10:59:16.697 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 10:59:16.699 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 10:59:16.700 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 10:59:16.705 +07:00 [ERR] 2025-09-05 10:59:16.705693 ThreadID:5   (ERROR)   OracleRelationalCommand.ExecuteReaderAsync() :  Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
2025-09-05 10:59:16.706 +07:00 [ERR] Failed executing DbCommand (4ms) [Parameters=[:p0='?' (DbType = DateTime), :p1='?' (Size = 2000), :p2='?' (DbType = Int64), :p3='?' (Size = 64), :p4='?' (Size = 2000), :p5='?' (DbType = DateTime), :cur0='?' (Direction = Output) (DbType = Object)], CommandType='"Text"', CommandTimeout='0']
DECLARE

TYPE "rCARTS_0" IS RECORD
(
"ID" NUMBER(19)
);
TYPE "tCARTS_0" IS TABLE OF "rCARTS_0";
"lCARTS_0" "tCARTS_0";

BEGIN

"lCARTS_0" := "tCARTS_0"();
"lCARTS_0".extend(1);
INSERT INTO "HEHE"."CARTS" ("CREATED_AT", "CURRENCY", "CUSTOMER_ID", "SESSION_TOKEN", "STATUS", "UPDATED_AT")
VALUES (:p0, :p1, :p2, :p3, :p4, :p5)
RETURNING "ID" INTO "lCARTS_0"(1)."ID";
OPEN :cur0 FOR SELECT "lCARTS_0"(1)."ID" FROM DUAL;

END;
2025-09-05 10:59:16.710 +07:00 [ERR] 2025-09-05 10:59:16.710804 ThreadID:5   (ERROR)   OracleExecutionStrategy.ExecuteAsync() :  Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
2025-09-05 10:59:16.714 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'PHONE_STORE.Infrastructure.Data.PhoneDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-09-05 10:59:16.834 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 133.7404ms
2025-09-05 10:59:16.838 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 10:59:16.840 +07:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at PHONE_STORE.Infrastructure.Repositories.CartRepository.EnsureCartId(Nullable`1 customerId, String sessionId, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.Infrastructure\Repositories\CartRepository.cs:line 50
   at PHONE_STORE.Infrastructure.Repositories.CartRepository.GetOrCreateAsync(Nullable`1 customerId, String sessionId, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.Infrastructure\Repositories\CartRepository.cs:line 77
   at lambda_method31(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-05 10:59:16.879 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 500 null application/problem+json; charset=utf-8 182.254ms
2025-09-05 10:59:18.217 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products/galaxy-s24 - null null
2025-09-05 10:59:18.219 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API)'
2025-09-05 10:59:18.220 +07:00 [INF] Route matched with {action = "Details", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductDetail]] Details(System.String, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 10:59:18.225 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:slug_0='?' (Size = 220)], CommandType='"Text"', CommandTimeout='0']
SELECT "p2"."ID", "p2"."BRAND_ID", "p2"."CREATED_AT", "p2"."DEFAULT_CATEGORY_ID", "p2"."DESCRIPTION", "p2"."IS_ACTIVE", "p2"."NAME", "p2"."SLUG", "p2"."SPEC_JSON", "p0"."ID", "p0"."BARCODE", "p0"."COLOR", "p0"."IS_ACTIVE", "p0"."PRODUCT_ID", "p0"."SKU", "p0"."STORAGE_GB", "p0"."WEIGHT_GRAM", "p1"."ID", "p1"."ALT_TEXT", "p1"."IMAGE_URL", "p1"."IS_PRIMARY", "p1"."PRODUCT_ID", "p1"."SORT_ORDER", "p1"."VARIANT_ID"
FROM (
    SELECT "p"."ID", "p"."BRAND_ID", "p"."CREATED_AT", "p"."DEFAULT_CATEGORY_ID", "p"."DESCRIPTION", "p"."IS_ACTIVE", "p"."NAME", "p"."SLUG", "p"."SPEC_JSON"
    FROM "HEHE"."PRODUCTS" "p"
    WHERE (("p"."SLUG" = :slug_0) AND ("p"."IS_ACTIVE" = 1))
    FETCH FIRST 1 ROWS ONLY
) "p2"
LEFT JOIN "HEHE"."PRODUCT_VARIANTS" "p0" ON "p2"."ID" = "p0"."PRODUCT_ID"
LEFT JOIN "HEHE"."PRODUCT_IMAGES" "p1" ON "p2"."ID" = "p1"."PRODUCT_ID"
ORDER BY "p2"."ID", "p0"."ID"
2025-09-05 10:59:18.230 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."VARIANT_ID" "VariantId", COALESCE((
    SELECT COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")
    FROM "HEHE"."PRODUCT_PRICES" "p0"
    WHERE (((((("p0"."VARIANT_ID" = 3) AND ("p0"."STARTS_AT" <= :now_1))) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))) AND ("p"."VARIANT_ID" = "p0"."VARIANT_ID"))
    ORDER BY "p0"."STARTS_AT" DESC
    FETCH FIRST 1 ROWS ONLY), 0.0) "Price"
FROM "HEHE"."PRODUCT_PRICES" "p"
WHERE (((("p"."VARIANT_ID" = 3) AND ("p"."STARTS_AT" <= :now_1))) AND ((("p"."ENDS_AT" IS NULL) OR ("p"."ENDS_AT" > :now_2))))
GROUP BY "p"."VARIANT_ID"
2025-09-05 10:59:18.232 +07:00 [INF] Executing OkObjectResult, writing value of type 'PHONE_STORE.API.Controllers.ShopProductsController+ShopProductDetail'.
2025-09-05 10:59:18.233 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API) in 10.8855ms
2025-09-05 10:59:18.233 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API)'
2025-09-05 10:59:18.234 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products/galaxy-s24 - 200 null application/json; charset=utf-8 16.8538ms
2025-09-05 10:59:22.084 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 10:59:22.086 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 10:59:22.087 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 10:59:22.097 +07:00 [ERR] 2025-09-05 10:59:22.097828 ThreadID:14  (ERROR)   OracleRelationalCommand.ExecuteReaderAsync() :  Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
2025-09-05 10:59:22.099 +07:00 [ERR] Failed executing DbCommand (9ms) [Parameters=[:p0='?' (DbType = DateTime), :p1='?' (Size = 2000), :p2='?' (DbType = Int64), :p3='?' (Size = 64), :p4='?' (Size = 2000), :p5='?' (DbType = DateTime), :cur0='?' (Direction = Output) (DbType = Object)], CommandType='"Text"', CommandTimeout='0']
DECLARE

TYPE "rCARTS_0" IS RECORD
(
"ID" NUMBER(19)
);
TYPE "tCARTS_0" IS TABLE OF "rCARTS_0";
"lCARTS_0" "tCARTS_0";

BEGIN

"lCARTS_0" := "tCARTS_0"();
"lCARTS_0".extend(1);
INSERT INTO "HEHE"."CARTS" ("CREATED_AT", "CURRENCY", "CUSTOMER_ID", "SESSION_TOKEN", "STATUS", "UPDATED_AT")
VALUES (:p0, :p1, :p2, :p3, :p4, :p5)
RETURNING "ID" INTO "lCARTS_0"(1)."ID";
OPEN :cur0 FOR SELECT "lCARTS_0"(1)."ID" FROM DUAL;

END;
2025-09-05 10:59:22.102 +07:00 [ERR] 2025-09-05 10:59:22.102769 ThreadID:14  (ERROR)   OracleExecutionStrategy.ExecuteAsync() :  Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
2025-09-05 10:59:22.105 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'PHONE_STORE.Infrastructure.Data.PhoneDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-09-05 10:59:22.201 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 113.3003ms
2025-09-05 10:59:22.203 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 10:59:22.205 +07:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at PHONE_STORE.Infrastructure.Repositories.CartRepository.EnsureCartId(Nullable`1 customerId, String sessionId, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.Infrastructure\Repositories\CartRepository.cs:line 50
   at PHONE_STORE.Infrastructure.Repositories.CartRepository.GetOrCreateAsync(Nullable`1 customerId, String sessionId, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.Infrastructure\Repositories\CartRepository.cs:line 77
   at lambda_method31(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-05 10:59:22.228 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 500 null application/problem+json; charset=utf-8 144.2517ms
2025-09-05 10:59:33.488 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products/galaxy-s24 - null null
2025-09-05 10:59:33.489 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API)'
2025-09-05 10:59:33.490 +07:00 [INF] Route matched with {action = "Details", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductDetail]] Details(System.String, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 10:59:33.500 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:slug_0='?' (Size = 220)], CommandType='"Text"', CommandTimeout='0']
SELECT "p2"."ID", "p2"."BRAND_ID", "p2"."CREATED_AT", "p2"."DEFAULT_CATEGORY_ID", "p2"."DESCRIPTION", "p2"."IS_ACTIVE", "p2"."NAME", "p2"."SLUG", "p2"."SPEC_JSON", "p0"."ID", "p0"."BARCODE", "p0"."COLOR", "p0"."IS_ACTIVE", "p0"."PRODUCT_ID", "p0"."SKU", "p0"."STORAGE_GB", "p0"."WEIGHT_GRAM", "p1"."ID", "p1"."ALT_TEXT", "p1"."IMAGE_URL", "p1"."IS_PRIMARY", "p1"."PRODUCT_ID", "p1"."SORT_ORDER", "p1"."VARIANT_ID"
FROM (
    SELECT "p"."ID", "p"."BRAND_ID", "p"."CREATED_AT", "p"."DEFAULT_CATEGORY_ID", "p"."DESCRIPTION", "p"."IS_ACTIVE", "p"."NAME", "p"."SLUG", "p"."SPEC_JSON"
    FROM "HEHE"."PRODUCTS" "p"
    WHERE (("p"."SLUG" = :slug_0) AND ("p"."IS_ACTIVE" = 1))
    FETCH FIRST 1 ROWS ONLY
) "p2"
LEFT JOIN "HEHE"."PRODUCT_VARIANTS" "p0" ON "p2"."ID" = "p0"."PRODUCT_ID"
LEFT JOIN "HEHE"."PRODUCT_IMAGES" "p1" ON "p2"."ID" = "p1"."PRODUCT_ID"
ORDER BY "p2"."ID", "p0"."ID"
2025-09-05 10:59:33.511 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."VARIANT_ID" "VariantId", COALESCE((
    SELECT COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")
    FROM "HEHE"."PRODUCT_PRICES" "p0"
    WHERE (((((("p0"."VARIANT_ID" = 3) AND ("p0"."STARTS_AT" <= :now_1))) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))) AND ("p"."VARIANT_ID" = "p0"."VARIANT_ID"))
    ORDER BY "p0"."STARTS_AT" DESC
    FETCH FIRST 1 ROWS ONLY), 0.0) "Price"
FROM "HEHE"."PRODUCT_PRICES" "p"
WHERE (((("p"."VARIANT_ID" = 3) AND ("p"."STARTS_AT" <= :now_1))) AND ((("p"."ENDS_AT" IS NULL) OR ("p"."ENDS_AT" > :now_2))))
GROUP BY "p"."VARIANT_ID"
2025-09-05 10:59:33.513 +07:00 [INF] Executing OkObjectResult, writing value of type 'PHONE_STORE.API.Controllers.ShopProductsController+ShopProductDetail'.
2025-09-05 10:59:33.514 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API) in 23.2215ms
2025-09-05 10:59:33.515 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API)'
2025-09-05 10:59:33.516 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products/galaxy-s24 - 200 null application/json; charset=utf-8 28.5488ms
2025-09-05 10:59:34.929 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 10:59:34.931 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 10:59:34.931 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 10:59:34.944 +07:00 [ERR] 2025-09-05 10:59:34.944515 ThreadID:9   (ERROR)   OracleRelationalCommand.ExecuteReaderAsync() :  Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
2025-09-05 10:59:34.947 +07:00 [ERR] Failed executing DbCommand (11ms) [Parameters=[:p0='?' (DbType = DateTime), :p1='?' (Size = 2000), :p2='?' (DbType = Int64), :p3='?' (Size = 64), :p4='?' (Size = 2000), :p5='?' (DbType = DateTime), :cur0='?' (Direction = Output) (DbType = Object)], CommandType='"Text"', CommandTimeout='0']
DECLARE

TYPE "rCARTS_0" IS RECORD
(
"ID" NUMBER(19)
);
TYPE "tCARTS_0" IS TABLE OF "rCARTS_0";
"lCARTS_0" "tCARTS_0";

BEGIN

"lCARTS_0" := "tCARTS_0"();
"lCARTS_0".extend(1);
INSERT INTO "HEHE"."CARTS" ("CREATED_AT", "CURRENCY", "CUSTOMER_ID", "SESSION_TOKEN", "STATUS", "UPDATED_AT")
VALUES (:p0, :p1, :p2, :p3, :p4, :p5)
RETURNING "ID" INTO "lCARTS_0"(1)."ID";
OPEN :cur0 FOR SELECT "lCARTS_0"(1)."ID" FROM DUAL;

END;
2025-09-05 10:59:34.952 +07:00 [ERR] 2025-09-05 10:59:34.952019 ThreadID:9   (ERROR)   OracleExecutionStrategy.ExecuteAsync() :  Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
2025-09-05 10:59:34.957 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'PHONE_STORE.Infrastructure.Data.PhoneDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-09-05 10:59:35.070 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 137.6214ms
2025-09-05 10:59:35.071 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 10:59:35.073 +07:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at PHONE_STORE.Infrastructure.Repositories.CartRepository.EnsureCartId(Nullable`1 customerId, String sessionId, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.Infrastructure\Repositories\CartRepository.cs:line 50
   at PHONE_STORE.Infrastructure.Repositories.CartRepository.GetOrCreateAsync(Nullable`1 customerId, String sessionId, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.Infrastructure\Repositories\CartRepository.cs:line 77
   at lambda_method31(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-05 10:59:35.093 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 500 null application/problem+json; charset=utf-8 164.4624ms
2025-09-05 10:59:39.713 +07:00 [INF] Request starting HTTP/1.1 POST https://localhost:7277/api/auth/login - application/json; charset=utf-8 null
2025-09-05 10:59:39.721 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.AuthController.Login (PHONE_STORE.API)'
2025-09-05 10:59:39.726 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(LoginRequest, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.AuthController (PHONE_STORE.API).
2025-09-05 10:59:39.970 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:uname_0='?' (Size = 450), :username_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='0']
SELECT "u"."ID", "u"."CREATED_AT", "u"."EMAIL", "u"."PASSWORD_HASH", "u"."PHONE", "u"."STATUS"
FROM "USER_ACCOUNTS" "u"
WHERE (("u"."EMAIL" = :uname_0) OR ("u"."PHONE" = :username_1))
FETCH FIRST 1 ROWS ONLY
2025-09-05 10:59:40.427 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[:userId_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "r"."CODE"
FROM "USER_ROLES" "u"
INNER JOIN "ROLES" "r" ON "u"."ROLE_ID" = "r"."ID"
WHERE "u"."USER_ID" = :userId_0
2025-09-05 10:59:40.505 +07:00 [INF] Login success [21]
2025-09-05 10:59:40.513 +07:00 [INF] Executing OkObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.AuthResponseDto'.
2025-09-05 10:59:40.515 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.AuthController.Login (PHONE_STORE.API) in 788.3829ms
2025-09-05 10:59:40.516 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.AuthController.Login (PHONE_STORE.API)'
2025-09-05 10:59:40.518 +07:00 [INF] Request finished HTTP/1.1 POST https://localhost:7277/api/auth/login - 200 null application/json; charset=utf-8 805.0334ms
2025-09-05 10:59:40.551 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - null null
2025-09-05 10:59:40.587 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 10:59:40.588 +07:00 [INF] Route matched with {action = "List", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem]]] List(System.String, System.Nullable`1[System.Int64], Int32, Int32, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 10:59:40.598 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[:p_0='?' (DbType = Int32), :p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."ID" "Id", "p"."NAME" "Name", "p"."SLUG" "Slug"
FROM "HEHE"."PRODUCTS" "p"
WHERE "p"."IS_ACTIVE" = 1
ORDER BY "p"."CREATED_AT" DESC
OFFSET :p_0 ROWS FETCH NEXT :p_1 ROWS ONLY
2025-09-05 10:59:40.605 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", (
    SELECT "p0"."IMAGE_URL"
    FROM "HEHE"."PRODUCT_IMAGES" "p0"
    WHERE (("p0"."PRODUCT_ID" IS NOT NULL AND "p0"."PRODUCT_ID" IN (3, 2, 1)) AND ("p"."PRODUCT_ID" = "p0"."PRODUCT_ID"))
    ORDER BY "p0"."SORT_ORDER"
    FETCH FIRST 1 ROWS ONLY) "Url"
FROM "HEHE"."PRODUCT_IMAGES" "p"
WHERE "p"."PRODUCT_ID" IS NOT NULL AND "p"."PRODUCT_ID" IN (3, 2, 1)
GROUP BY "p"."PRODUCT_ID"
2025-09-05 10:59:40.613 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", MIN(COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")) "MinPrice"
FROM "HEHE"."PRODUCT_VARIANTS" "p"
INNER JOIN "HEHE"."PRODUCT_PRICES" "p0" ON "p"."ID" = "p0"."VARIANT_ID"
WHERE (("p"."PRODUCT_ID" IN (3, 2, 1)) AND ((("p0"."STARTS_AT" <= :now_1) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))))
GROUP BY "p"."PRODUCT_ID"
2025-09-05 10:59:40.615 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem, PHONE_STORE.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-05 10:59:40.616 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API) in 23.7439ms
2025-09-05 10:59:40.617 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 10:59:40.618 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - 200 null application/json; charset=utf-8 66.8818ms
2025-09-05 10:59:40.637 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 10:59:40.641 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 10:59:40.642 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 10:59:40.656 +07:00 [ERR] 2025-09-05 10:59:40.656566 ThreadID:9   (ERROR)   OracleRelationalCommand.ExecuteReaderAsync() :  Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
2025-09-05 10:59:40.660 +07:00 [ERR] Failed executing DbCommand (9ms) [Parameters=[:p0='?' (DbType = DateTime), :p1='?' (Size = 2000), :p2='?' (DbType = Int64), :p3='?' (Size = 64), :p4='?' (Size = 2000), :p5='?' (DbType = DateTime), :cur0='?' (Direction = Output) (DbType = Object)], CommandType='"Text"', CommandTimeout='0']
DECLARE

TYPE "rCARTS_0" IS RECORD
(
"ID" NUMBER(19)
);
TYPE "tCARTS_0" IS TABLE OF "rCARTS_0";
"lCARTS_0" "tCARTS_0";

BEGIN

"lCARTS_0" := "tCARTS_0"();
"lCARTS_0".extend(1);
INSERT INTO "HEHE"."CARTS" ("CREATED_AT", "CURRENCY", "CUSTOMER_ID", "SESSION_TOKEN", "STATUS", "UPDATED_AT")
VALUES (:p0, :p1, :p2, :p3, :p4, :p5)
RETURNING "ID" INTO "lCARTS_0"(1)."ID";
OPEN :cur0 FOR SELECT "lCARTS_0"(1)."ID" FROM DUAL;

END;
2025-09-05 10:59:40.666 +07:00 [ERR] 2025-09-05 10:59:40.666448 ThreadID:9   (ERROR)   OracleExecutionStrategy.ExecuteAsync() :  Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
2025-09-05 10:59:40.671 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'PHONE_STORE.Infrastructure.Data.PhoneDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-09-05 10:59:40.765 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 120.1119ms
2025-09-05 10:59:40.765 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 10:59:40.766 +07:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at PHONE_STORE.Infrastructure.Repositories.CartRepository.EnsureCartId(Nullable`1 customerId, String sessionId, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.Infrastructure\Repositories\CartRepository.cs:line 50
   at PHONE_STORE.Infrastructure.Repositories.CartRepository.GetOrCreateAsync(Nullable`1 customerId, String sessionId, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.Infrastructure\Repositories\CartRepository.cs:line 77
   at lambda_method31(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-05 10:59:40.789 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 500 null application/problem+json; charset=utf-8 152.4275ms
2025-09-05 10:59:42.394 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products/galaxy-s24 - null null
2025-09-05 10:59:42.397 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API)'
2025-09-05 10:59:42.397 +07:00 [INF] Route matched with {action = "Details", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductDetail]] Details(System.String, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 10:59:42.401 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:slug_0='?' (Size = 220)], CommandType='"Text"', CommandTimeout='0']
SELECT "p2"."ID", "p2"."BRAND_ID", "p2"."CREATED_AT", "p2"."DEFAULT_CATEGORY_ID", "p2"."DESCRIPTION", "p2"."IS_ACTIVE", "p2"."NAME", "p2"."SLUG", "p2"."SPEC_JSON", "p0"."ID", "p0"."BARCODE", "p0"."COLOR", "p0"."IS_ACTIVE", "p0"."PRODUCT_ID", "p0"."SKU", "p0"."STORAGE_GB", "p0"."WEIGHT_GRAM", "p1"."ID", "p1"."ALT_TEXT", "p1"."IMAGE_URL", "p1"."IS_PRIMARY", "p1"."PRODUCT_ID", "p1"."SORT_ORDER", "p1"."VARIANT_ID"
FROM (
    SELECT "p"."ID", "p"."BRAND_ID", "p"."CREATED_AT", "p"."DEFAULT_CATEGORY_ID", "p"."DESCRIPTION", "p"."IS_ACTIVE", "p"."NAME", "p"."SLUG", "p"."SPEC_JSON"
    FROM "HEHE"."PRODUCTS" "p"
    WHERE (("p"."SLUG" = :slug_0) AND ("p"."IS_ACTIVE" = 1))
    FETCH FIRST 1 ROWS ONLY
) "p2"
LEFT JOIN "HEHE"."PRODUCT_VARIANTS" "p0" ON "p2"."ID" = "p0"."PRODUCT_ID"
LEFT JOIN "HEHE"."PRODUCT_IMAGES" "p1" ON "p2"."ID" = "p1"."PRODUCT_ID"
ORDER BY "p2"."ID", "p0"."ID"
2025-09-05 10:59:42.406 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."VARIANT_ID" "VariantId", COALESCE((
    SELECT COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")
    FROM "HEHE"."PRODUCT_PRICES" "p0"
    WHERE (((((("p0"."VARIANT_ID" = 3) AND ("p0"."STARTS_AT" <= :now_1))) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))) AND ("p"."VARIANT_ID" = "p0"."VARIANT_ID"))
    ORDER BY "p0"."STARTS_AT" DESC
    FETCH FIRST 1 ROWS ONLY), 0.0) "Price"
FROM "HEHE"."PRODUCT_PRICES" "p"
WHERE (((("p"."VARIANT_ID" = 3) AND ("p"."STARTS_AT" <= :now_1))) AND ((("p"."ENDS_AT" IS NULL) OR ("p"."ENDS_AT" > :now_2))))
GROUP BY "p"."VARIANT_ID"
2025-09-05 10:59:42.408 +07:00 [INF] Executing OkObjectResult, writing value of type 'PHONE_STORE.API.Controllers.ShopProductsController+ShopProductDetail'.
2025-09-05 10:59:42.409 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API) in 11.3224ms
2025-09-05 10:59:42.410 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API)'
2025-09-05 10:59:42.411 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products/galaxy-s24 - 200 null application/json; charset=utf-8 16.55ms
2025-09-05 10:59:42.433 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 10:59:42.436 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 10:59:42.437 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 10:59:42.447 +07:00 [ERR] 2025-09-05 10:59:42.447412 ThreadID:13  (ERROR)   OracleRelationalCommand.ExecuteReaderAsync() :  Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
2025-09-05 10:59:42.448 +07:00 [ERR] Failed executing DbCommand (6ms) [Parameters=[:p0='?' (DbType = DateTime), :p1='?' (Size = 2000), :p2='?' (DbType = Int64), :p3='?' (Size = 64), :p4='?' (Size = 2000), :p5='?' (DbType = DateTime), :cur0='?' (Direction = Output) (DbType = Object)], CommandType='"Text"', CommandTimeout='0']
DECLARE

TYPE "rCARTS_0" IS RECORD
(
"ID" NUMBER(19)
);
TYPE "tCARTS_0" IS TABLE OF "rCARTS_0";
"lCARTS_0" "tCARTS_0";

BEGIN

"lCARTS_0" := "tCARTS_0"();
"lCARTS_0".extend(1);
INSERT INTO "HEHE"."CARTS" ("CREATED_AT", "CURRENCY", "CUSTOMER_ID", "SESSION_TOKEN", "STATUS", "UPDATED_AT")
VALUES (:p0, :p1, :p2, :p3, :p4, :p5)
RETURNING "ID" INTO "lCARTS_0"(1)."ID";
OPEN :cur0 FOR SELECT "lCARTS_0"(1)."ID" FROM DUAL;

END;
2025-09-05 10:59:42.454 +07:00 [ERR] 2025-09-05 10:59:42.454103 ThreadID:13  (ERROR)   OracleExecutionStrategy.ExecuteAsync() :  Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
2025-09-05 10:59:42.457 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'PHONE_STORE.Infrastructure.Data.PhoneDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-09-05 10:59:42.570 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 131.4233ms
2025-09-05 10:59:42.571 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 10:59:42.573 +07:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at PHONE_STORE.Infrastructure.Repositories.CartRepository.EnsureCartId(Nullable`1 customerId, String sessionId, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.Infrastructure\Repositories\CartRepository.cs:line 50
   at PHONE_STORE.Infrastructure.Repositories.CartRepository.GetOrCreateAsync(Nullable`1 customerId, String sessionId, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.Infrastructure\Repositories\CartRepository.cs:line 77
   at lambda_method31(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-05 10:59:42.593 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 500 null application/problem+json; charset=utf-8 160.0052ms
2025-09-05 10:59:43.749 +07:00 [INF] Request starting HTTP/1.1 POST https://localhost:7277/api/shop/cart/items - application/json; charset=utf-8 null
2025-09-05 10:59:43.751 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Add (PHONE_STORE.API)'
2025-09-05 10:59:43.751 +07:00 [INF] Route matched with {action = "Add", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Add(PHONE_STORE.Application.Dtos.CartItemUpsertDto, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 10:59:43.769 +07:00 [ERR] 2025-09-05 10:59:43.769253 ThreadID:5   (ERROR)   OracleRelationalCommand.ExecuteReaderAsync() :  Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
2025-09-05 10:59:43.770 +07:00 [ERR] Failed executing DbCommand (16ms) [Parameters=[:p0='?' (DbType = DateTime), :p1='?' (Size = 2000), :p2='?' (DbType = Int64), :p3='?' (Size = 64), :p4='?' (Size = 2000), :p5='?' (DbType = DateTime), :cur0='?' (Direction = Output) (DbType = Object)], CommandType='"Text"', CommandTimeout='0']
DECLARE

TYPE "rCARTS_0" IS RECORD
(
"ID" NUMBER(19)
);
TYPE "tCARTS_0" IS TABLE OF "rCARTS_0";
"lCARTS_0" "tCARTS_0";

BEGIN

"lCARTS_0" := "tCARTS_0"();
"lCARTS_0".extend(1);
INSERT INTO "HEHE"."CARTS" ("CREATED_AT", "CURRENCY", "CUSTOMER_ID", "SESSION_TOKEN", "STATUS", "UPDATED_AT")
VALUES (:p0, :p1, :p2, :p3, :p4, :p5)
RETURNING "ID" INTO "lCARTS_0"(1)."ID";
OPEN :cur0 FOR SELECT "lCARTS_0"(1)."ID" FROM DUAL;

END;
2025-09-05 10:59:43.774 +07:00 [ERR] 2025-09-05 10:59:43.774725 ThreadID:5   (ERROR)   OracleExecutionStrategy.ExecuteAsync() :  Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
2025-09-05 10:59:43.778 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'PHONE_STORE.Infrastructure.Data.PhoneDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-09-05 10:59:43.879 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Add (PHONE_STORE.API) in 127.0952ms
2025-09-05 10:59:43.880 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Add (PHONE_STORE.API)'
2025-09-05 10:59:43.881 +07:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at PHONE_STORE.Infrastructure.Repositories.CartRepository.EnsureCartId(Nullable`1 customerId, String sessionId, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.Infrastructure\Repositories\CartRepository.cs:line 50
   at PHONE_STORE.Infrastructure.Repositories.CartRepository.AddOrUpdateItemAsync(Nullable`1 customerId, String sessionId, CartItemUpsertDto dto, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.Infrastructure\Repositories\CartRepository.cs:line 98
   at lambda_method208(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-05 10:59:43.908 +07:00 [INF] Request finished HTTP/1.1 POST https://localhost:7277/api/shop/cart/items - 500 null application/problem+json; charset=utf-8 158.8323ms
2025-09-05 10:59:43.915 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products/galaxy-s24 - null null
2025-09-05 10:59:43.917 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API)'
2025-09-05 10:59:43.918 +07:00 [INF] Route matched with {action = "Details", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductDetail]] Details(System.String, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 10:59:43.922 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:slug_0='?' (Size = 220)], CommandType='"Text"', CommandTimeout='0']
SELECT "p2"."ID", "p2"."BRAND_ID", "p2"."CREATED_AT", "p2"."DEFAULT_CATEGORY_ID", "p2"."DESCRIPTION", "p2"."IS_ACTIVE", "p2"."NAME", "p2"."SLUG", "p2"."SPEC_JSON", "p0"."ID", "p0"."BARCODE", "p0"."COLOR", "p0"."IS_ACTIVE", "p0"."PRODUCT_ID", "p0"."SKU", "p0"."STORAGE_GB", "p0"."WEIGHT_GRAM", "p1"."ID", "p1"."ALT_TEXT", "p1"."IMAGE_URL", "p1"."IS_PRIMARY", "p1"."PRODUCT_ID", "p1"."SORT_ORDER", "p1"."VARIANT_ID"
FROM (
    SELECT "p"."ID", "p"."BRAND_ID", "p"."CREATED_AT", "p"."DEFAULT_CATEGORY_ID", "p"."DESCRIPTION", "p"."IS_ACTIVE", "p"."NAME", "p"."SLUG", "p"."SPEC_JSON"
    FROM "HEHE"."PRODUCTS" "p"
    WHERE (("p"."SLUG" = :slug_0) AND ("p"."IS_ACTIVE" = 1))
    FETCH FIRST 1 ROWS ONLY
) "p2"
LEFT JOIN "HEHE"."PRODUCT_VARIANTS" "p0" ON "p2"."ID" = "p0"."PRODUCT_ID"
LEFT JOIN "HEHE"."PRODUCT_IMAGES" "p1" ON "p2"."ID" = "p1"."PRODUCT_ID"
ORDER BY "p2"."ID", "p0"."ID"
2025-09-05 10:59:43.927 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."VARIANT_ID" "VariantId", COALESCE((
    SELECT COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")
    FROM "HEHE"."PRODUCT_PRICES" "p0"
    WHERE (((((("p0"."VARIANT_ID" = 3) AND ("p0"."STARTS_AT" <= :now_1))) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))) AND ("p"."VARIANT_ID" = "p0"."VARIANT_ID"))
    ORDER BY "p0"."STARTS_AT" DESC
    FETCH FIRST 1 ROWS ONLY), 0.0) "Price"
FROM "HEHE"."PRODUCT_PRICES" "p"
WHERE (((("p"."VARIANT_ID" = 3) AND ("p"."STARTS_AT" <= :now_1))) AND ((("p"."ENDS_AT" IS NULL) OR ("p"."ENDS_AT" > :now_2))))
GROUP BY "p"."VARIANT_ID"
2025-09-05 10:59:43.928 +07:00 [INF] Executing OkObjectResult, writing value of type 'PHONE_STORE.API.Controllers.ShopProductsController+ShopProductDetail'.
2025-09-05 10:59:43.929 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API) in 9.9411ms
2025-09-05 10:59:43.930 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API)'
2025-09-05 10:59:43.931 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products/galaxy-s24 - 200 null application/json; charset=utf-8 15.9645ms
2025-09-05 10:59:43.950 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 10:59:43.953 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 10:59:43.954 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 10:59:43.963 +07:00 [ERR] 2025-09-05 10:59:43.963296 ThreadID:13  (ERROR)   OracleRelationalCommand.ExecuteReaderAsync() :  Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
2025-09-05 10:59:43.965 +07:00 [ERR] Failed executing DbCommand (7ms) [Parameters=[:p0='?' (DbType = DateTime), :p1='?' (Size = 2000), :p2='?' (DbType = Int64), :p3='?' (Size = 64), :p4='?' (Size = 2000), :p5='?' (DbType = DateTime), :cur0='?' (Direction = Output) (DbType = Object)], CommandType='"Text"', CommandTimeout='0']
DECLARE

TYPE "rCARTS_0" IS RECORD
(
"ID" NUMBER(19)
);
TYPE "tCARTS_0" IS TABLE OF "rCARTS_0";
"lCARTS_0" "tCARTS_0";

BEGIN

"lCARTS_0" := "tCARTS_0"();
"lCARTS_0".extend(1);
INSERT INTO "HEHE"."CARTS" ("CREATED_AT", "CURRENCY", "CUSTOMER_ID", "SESSION_TOKEN", "STATUS", "UPDATED_AT")
VALUES (:p0, :p1, :p2, :p3, :p4, :p5)
RETURNING "ID" INTO "lCARTS_0"(1)."ID";
OPEN :cur0 FOR SELECT "lCARTS_0"(1)."ID" FROM DUAL;

END;
2025-09-05 10:59:43.973 +07:00 [ERR] 2025-09-05 10:59:43.973088 ThreadID:13  (ERROR)   OracleExecutionStrategy.ExecuteAsync() :  Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
2025-09-05 10:59:43.977 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'PHONE_STORE.Infrastructure.Data.PhoneDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-09-05 10:59:44.148 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 192.0949ms
2025-09-05 10:59:44.150 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 10:59:44.152 +07:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at PHONE_STORE.Infrastructure.Repositories.CartRepository.EnsureCartId(Nullable`1 customerId, String sessionId, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.Infrastructure\Repositories\CartRepository.cs:line 50
   at PHONE_STORE.Infrastructure.Repositories.CartRepository.GetOrCreateAsync(Nullable`1 customerId, String sessionId, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.Infrastructure\Repositories\CartRepository.cs:line 77
   at lambda_method31(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-05 10:59:44.172 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 500 null application/problem+json; charset=utf-8 221.492ms
2025-09-05 11:08:16.504 +07:00 [INF] User profile is available. Using 'C:\Users\Administrator\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-09-05 11:08:16.730 +07:00 [INF] Now listening on: https://localhost:7277
2025-09-05 11:08:16.731 +07:00 [INF] Now listening on: http://localhost:5209
2025-09-05 11:08:16.812 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-05 11:08:16.814 +07:00 [INF] Hosting environment: Development
2025-09-05 11:08:16.815 +07:00 [INF] Content root path: C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.API
2025-09-05 11:08:17.600 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/swagger/index.html - null null
2025-09-05 11:08:18.132 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/swagger/index.html - 200 null text/html;charset=utf-8 544.2586ms
2025-09-05 11:08:18.151 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/_framework/aspnetcore-browser-refresh.js - null null
2025-09-05 11:08:18.151 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/_vs/browserLink - null null
2025-09-05 11:08:18.180 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/_framework/aspnetcore-browser-refresh.js - 200 13766 application/javascript; charset=utf-8 28.8815ms
2025-09-05 11:08:18.235 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/_vs/browserLink - 200 null text/javascript; charset=UTF-8 84.7409ms
2025-09-05 11:08:18.264 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - null null
2025-09-05 11:08:18.297 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/swagger/v1/swagger.json - null null
2025-09-05 11:08:18.359 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 62.6705ms
2025-09-05 11:08:18.400 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 11:08:18.431 +07:00 [INF] Route matched with {action = "List", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem]]] List(System.String, System.Nullable`1[System.Int64], Int32, Int32, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 11:08:19.108 +07:00 [WRN] The decimal property 'UnitPrice' on entity type 'CartItem' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 11:08:19.110 +07:00 [WRN] The decimal property 'DiscountTotal' on entity type 'Order' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 11:08:19.111 +07:00 [WRN] The decimal property 'GrandTotal' on entity type 'Order' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 11:08:19.112 +07:00 [WRN] The decimal property 'ShippingFee' on entity type 'Order' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 11:08:19.114 +07:00 [WRN] The decimal property 'Subtotal' on entity type 'Order' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 11:08:19.115 +07:00 [WRN] The decimal property 'TaxTotal' on entity type 'Order' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 11:08:19.115 +07:00 [WRN] The decimal property 'DiscountAmount' on entity type 'OrderItem' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 11:08:19.116 +07:00 [WRN] The decimal property 'TaxAmount' on entity type 'OrderItem' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 11:08:19.117 +07:00 [WRN] The decimal property 'UnitPrice' on entity type 'OrderItem' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 11:08:19.117 +07:00 [WRN] The decimal property 'DecValue' on entity type 'ProductAttributeValue' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 11:08:19.118 +07:00 [WRN] The decimal property 'ListPrice' on entity type 'ProductPrice' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 11:08:19.119 +07:00 [WRN] The decimal property 'SalePrice' on entity type 'ProductPrice' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 11:08:19.119 +07:00 [WRN] The decimal property 'WeightGram' on entity type 'ProductVariant' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 11:08:19.817 +07:00 [INF] Executed DbCommand (112ms) [Parameters=[:p_0='?' (DbType = Int32), :p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."ID" "Id", "p"."NAME" "Name", "p"."SLUG" "Slug"
FROM "HEHE"."PRODUCTS" "p"
WHERE "p"."IS_ACTIVE" = 1
ORDER BY "p"."CREATED_AT" DESC
OFFSET :p_0 ROWS FETCH NEXT :p_1 ROWS ONLY
2025-09-05 11:08:19.929 +07:00 [INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", (
    SELECT "p0"."IMAGE_URL"
    FROM "HEHE"."PRODUCT_IMAGES" "p0"
    WHERE (("p0"."PRODUCT_ID" IS NOT NULL AND "p0"."PRODUCT_ID" IN (3, 2, 1)) AND ("p"."PRODUCT_ID" = "p0"."PRODUCT_ID"))
    ORDER BY "p0"."SORT_ORDER"
    FETCH FIRST 1 ROWS ONLY) "Url"
FROM "HEHE"."PRODUCT_IMAGES" "p"
WHERE "p"."PRODUCT_ID" IS NOT NULL AND "p"."PRODUCT_ID" IN (3, 2, 1)
GROUP BY "p"."PRODUCT_ID"
2025-09-05 11:08:19.977 +07:00 [INF] Executed DbCommand (9ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", MIN(COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")) "MinPrice"
FROM "HEHE"."PRODUCT_VARIANTS" "p"
INNER JOIN "HEHE"."PRODUCT_PRICES" "p0" ON "p"."ID" = "p0"."VARIANT_ID"
WHERE (("p"."PRODUCT_ID" IN (3, 2, 1)) AND ((("p0"."STARTS_AT" <= :now_1) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))))
GROUP BY "p"."PRODUCT_ID"
2025-09-05 11:08:19.993 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem, PHONE_STORE.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-05 11:08:20.009 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API) in 1574.2503ms
2025-09-05 11:08:20.011 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 11:08:20.017 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - 200 null application/json; charset=utf-8 1753.5279ms
2025-09-05 11:08:20.189 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 11:08:20.196 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 11:08:20.202 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 11:08:20.294 +07:00 [INF] Executed DbCommand (15ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 11:08:20.461 +07:00 [INF] Executed DbCommand (29ms) [Parameters=[:p0='?' (DbType = DateTime), :p1='?' (Size = 2000), :p2='?' (DbType = Int64), :p3='?' (Size = 64), :p4='?' (Size = 2000), :p5='?' (DbType = DateTime), :cur0='?' (Direction = Output) (DbType = Object)], CommandType='"Text"', CommandTimeout='0']
DECLARE

TYPE "rCARTS_0" IS RECORD
(
"ID" NUMBER(19)
);
TYPE "tCARTS_0" IS TABLE OF "rCARTS_0";
"lCARTS_0" "tCARTS_0";

BEGIN

"lCARTS_0" := "tCARTS_0"();
"lCARTS_0".extend(1);
INSERT INTO "HEHE"."CARTS" ("CREATED_AT", "CURRENCY", "CUSTOMER_ID", "SESSION_TOKEN", "STATUS", "UPDATED_AT")
VALUES (:p0, :p1, :p2, :p3, :p4, :p5)
RETURNING "ID" INTO "lCARTS_0"(1)."ID";
OPEN :cur0 FOR SELECT "lCARTS_0"(1)."ID" FROM DUAL;

END;
2025-09-05 11:08:20.527 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 11:08:20.549 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 11:08:20.559 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 11:08:20.566 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 361.9529ms
2025-09-05 11:08:20.566 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 11:08:20.567 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 378.7626ms
2025-09-05 11:08:23.280 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products/galaxy-s24 - null null
2025-09-05 11:08:23.283 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API)'
2025-09-05 11:08:23.288 +07:00 [INF] Route matched with {action = "Details", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductDetail]] Details(System.String, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 11:08:23.385 +07:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-09-05 11:08:23.428 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[:slug_0='?' (Size = 220)], CommandType='"Text"', CommandTimeout='0']
SELECT "p2"."ID", "p2"."BRAND_ID", "p2"."CREATED_AT", "p2"."DEFAULT_CATEGORY_ID", "p2"."DESCRIPTION", "p2"."IS_ACTIVE", "p2"."NAME", "p2"."SLUG", "p2"."SPEC_JSON", "p0"."ID", "p0"."BARCODE", "p0"."COLOR", "p0"."IS_ACTIVE", "p0"."PRODUCT_ID", "p0"."SKU", "p0"."STORAGE_GB", "p0"."WEIGHT_GRAM", "p1"."ID", "p1"."ALT_TEXT", "p1"."IMAGE_URL", "p1"."IS_PRIMARY", "p1"."PRODUCT_ID", "p1"."SORT_ORDER", "p1"."VARIANT_ID"
FROM (
    SELECT "p"."ID", "p"."BRAND_ID", "p"."CREATED_AT", "p"."DEFAULT_CATEGORY_ID", "p"."DESCRIPTION", "p"."IS_ACTIVE", "p"."NAME", "p"."SLUG", "p"."SPEC_JSON"
    FROM "HEHE"."PRODUCTS" "p"
    WHERE (("p"."SLUG" = :slug_0) AND ("p"."IS_ACTIVE" = 1))
    FETCH FIRST 1 ROWS ONLY
) "p2"
LEFT JOIN "HEHE"."PRODUCT_VARIANTS" "p0" ON "p2"."ID" = "p0"."PRODUCT_ID"
LEFT JOIN "HEHE"."PRODUCT_IMAGES" "p1" ON "p2"."ID" = "p1"."PRODUCT_ID"
ORDER BY "p2"."ID", "p0"."ID"
2025-09-05 11:08:23.503 +07:00 [INF] Executed DbCommand (24ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."VARIANT_ID" "VariantId", COALESCE((
    SELECT COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")
    FROM "HEHE"."PRODUCT_PRICES" "p0"
    WHERE (((((("p0"."VARIANT_ID" = 3) AND ("p0"."STARTS_AT" <= :now_1))) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))) AND ("p"."VARIANT_ID" = "p0"."VARIANT_ID"))
    ORDER BY "p0"."STARTS_AT" DESC
    FETCH FIRST 1 ROWS ONLY), 0.0) "Price"
FROM "HEHE"."PRODUCT_PRICES" "p"
WHERE (((("p"."VARIANT_ID" = 3) AND ("p"."STARTS_AT" <= :now_1))) AND ((("p"."ENDS_AT" IS NULL) OR ("p"."ENDS_AT" > :now_2))))
GROUP BY "p"."VARIANT_ID"
2025-09-05 11:08:23.508 +07:00 [INF] Executing OkObjectResult, writing value of type 'PHONE_STORE.API.Controllers.ShopProductsController+ShopProductDetail'.
2025-09-05 11:08:23.520 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API) in 230.6167ms
2025-09-05 11:08:23.521 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API)'
2025-09-05 11:08:23.522 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products/galaxy-s24 - 200 null application/json; charset=utf-8 242.3254ms
2025-09-05 11:08:23.553 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 11:08:23.556 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 11:08:23.557 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 11:08:23.567 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 11:08:23.574 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 11:08:23.580 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 11:08:23.582 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 11:08:23.583 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 24.7498ms
2025-09-05 11:08:23.585 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 11:08:23.586 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 32.4597ms
2025-09-05 11:08:24.485 +07:00 [INF] Request starting HTTP/1.1 POST https://localhost:7277/api/shop/cart/items - application/json; charset=utf-8 null
2025-09-05 11:08:24.489 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Add (PHONE_STORE.API)'
2025-09-05 11:08:24.493 +07:00 [INF] Route matched with {action = "Add", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Add(PHONE_STORE.Application.Dtos.CartItemUpsertDto, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 11:08:24.533 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 11:08:24.546 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:id_0='?' (DbType = Int64), :dto_VariantId_1='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE"
FROM "HEHE"."CART_ITEMS" "c"
WHERE (("c"."CART_ID" = :id_0) AND ("c"."VARIANT_ID" = :dto_VariantId_1))
FETCH FIRST 1 ROWS ONLY
2025-09-05 11:08:24.611 +07:00 [INF] Executed DbCommand (41ms) [Parameters=[:variantId_0='?' (DbType = Int64), :now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT COALESCE("p"."SALE_PRICE", "p"."LIST_PRICE")
FROM "HEHE"."PRODUCT_PRICES" "p"
WHERE (((("p"."VARIANT_ID" = :variantId_0) AND ("p"."STARTS_AT" <= :now_1))) AND ((("p"."ENDS_AT" IS NULL) OR ("p"."ENDS_AT" > :now_2))))
ORDER BY "p"."STARTS_AT" DESC
FETCH FIRST 1 ROWS ONLY
2025-09-05 11:08:24.714 +07:00 [INF] Executed DbCommand (19ms) [Parameters=[:p0='?' (DbType = Int64), :p1='?' (DbType = Int64), :p2='?' (DbType = DateTime), :p3='?' (Size = 2000), :p4='?' (DbType = Int32), :p5='?' (DbType = Decimal)], CommandType='"Text"', CommandTimeout='0']
DECLARE


BEGIN

INSERT INTO "HEHE"."CART_ITEMS" ("CART_ID", "VARIANT_ID", "ADDED_AT", "CURRENCY", "QUANTITY", "UNIT_PRICE")
VALUES (:p0, :p1, :p2, :p3, :p4, :p5);

END;
2025-09-05 11:08:24.723 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 11:08:24.728 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 11:08:24.732 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 11:08:24.735 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 11:08:24.737 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Add (PHONE_STORE.API) in 243.106ms
2025-09-05 11:08:24.738 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Add (PHONE_STORE.API)'
2025-09-05 11:08:24.739 +07:00 [INF] Request finished HTTP/1.1 POST https://localhost:7277/api/shop/cart/items - 200 null application/json; charset=utf-8 254.1887ms
2025-09-05 11:08:24.746 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products/galaxy-s24 - null null
2025-09-05 11:08:24.747 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API)'
2025-09-05 11:08:24.748 +07:00 [INF] Route matched with {action = "Details", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductDetail]] Details(System.String, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 11:08:24.752 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:slug_0='?' (Size = 220)], CommandType='"Text"', CommandTimeout='0']
SELECT "p2"."ID", "p2"."BRAND_ID", "p2"."CREATED_AT", "p2"."DEFAULT_CATEGORY_ID", "p2"."DESCRIPTION", "p2"."IS_ACTIVE", "p2"."NAME", "p2"."SLUG", "p2"."SPEC_JSON", "p0"."ID", "p0"."BARCODE", "p0"."COLOR", "p0"."IS_ACTIVE", "p0"."PRODUCT_ID", "p0"."SKU", "p0"."STORAGE_GB", "p0"."WEIGHT_GRAM", "p1"."ID", "p1"."ALT_TEXT", "p1"."IMAGE_URL", "p1"."IS_PRIMARY", "p1"."PRODUCT_ID", "p1"."SORT_ORDER", "p1"."VARIANT_ID"
FROM (
    SELECT "p"."ID", "p"."BRAND_ID", "p"."CREATED_AT", "p"."DEFAULT_CATEGORY_ID", "p"."DESCRIPTION", "p"."IS_ACTIVE", "p"."NAME", "p"."SLUG", "p"."SPEC_JSON"
    FROM "HEHE"."PRODUCTS" "p"
    WHERE (("p"."SLUG" = :slug_0) AND ("p"."IS_ACTIVE" = 1))
    FETCH FIRST 1 ROWS ONLY
) "p2"
LEFT JOIN "HEHE"."PRODUCT_VARIANTS" "p0" ON "p2"."ID" = "p0"."PRODUCT_ID"
LEFT JOIN "HEHE"."PRODUCT_IMAGES" "p1" ON "p2"."ID" = "p1"."PRODUCT_ID"
ORDER BY "p2"."ID", "p0"."ID"
2025-09-05 11:08:24.757 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."VARIANT_ID" "VariantId", COALESCE((
    SELECT COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")
    FROM "HEHE"."PRODUCT_PRICES" "p0"
    WHERE (((((("p0"."VARIANT_ID" = 3) AND ("p0"."STARTS_AT" <= :now_1))) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))) AND ("p"."VARIANT_ID" = "p0"."VARIANT_ID"))
    ORDER BY "p0"."STARTS_AT" DESC
    FETCH FIRST 1 ROWS ONLY), 0.0) "Price"
FROM "HEHE"."PRODUCT_PRICES" "p"
WHERE (((("p"."VARIANT_ID" = 3) AND ("p"."STARTS_AT" <= :now_1))) AND ((("p"."ENDS_AT" IS NULL) OR ("p"."ENDS_AT" > :now_2))))
GROUP BY "p"."VARIANT_ID"
2025-09-05 11:08:24.759 +07:00 [INF] Executing OkObjectResult, writing value of type 'PHONE_STORE.API.Controllers.ShopProductsController+ShopProductDetail'.
2025-09-05 11:08:24.760 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API) in 10.7121ms
2025-09-05 11:08:24.760 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API)'
2025-09-05 11:08:24.761 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products/galaxy-s24 - 200 null application/json; charset=utf-8 15.4186ms
2025-09-05 11:08:24.779 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 11:08:24.782 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 11:08:24.783 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 11:08:24.787 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 11:08:24.793 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 11:08:24.798 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 11:08:24.801 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 11:08:24.802 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 18.1428ms
2025-09-05 11:08:24.804 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 11:08:24.806 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 26.2507ms
2025-09-05 11:08:29.085 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 11:08:29.088 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 11:08:29.089 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 11:08:29.093 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 11:08:29.096 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 11:08:29.099 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 11:08:29.100 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 11:08:29.101 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 11.3416ms
2025-09-05 11:08:29.102 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 11:08:29.103 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 17.5804ms
2025-09-05 11:08:29.126 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 11:08:29.129 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 11:08:29.129 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 11:08:29.134 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 11:08:29.139 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 11:08:29.146 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 11:08:29.148 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 11:08:29.149 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 18.5193ms
2025-09-05 11:08:29.150 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 11:08:29.151 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 24.7508ms
2025-09-05 11:08:30.980 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - null null
2025-09-05 11:08:30.982 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 11:08:30.983 +07:00 [INF] Route matched with {action = "List", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem]]] List(System.String, System.Nullable`1[System.Int64], Int32, Int32, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 11:08:30.989 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:p_0='?' (DbType = Int32), :p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."ID" "Id", "p"."NAME" "Name", "p"."SLUG" "Slug"
FROM "HEHE"."PRODUCTS" "p"
WHERE "p"."IS_ACTIVE" = 1
ORDER BY "p"."CREATED_AT" DESC
OFFSET :p_0 ROWS FETCH NEXT :p_1 ROWS ONLY
2025-09-05 11:08:30.992 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", (
    SELECT "p0"."IMAGE_URL"
    FROM "HEHE"."PRODUCT_IMAGES" "p0"
    WHERE (("p0"."PRODUCT_ID" IS NOT NULL AND "p0"."PRODUCT_ID" IN (3, 2, 1)) AND ("p"."PRODUCT_ID" = "p0"."PRODUCT_ID"))
    ORDER BY "p0"."SORT_ORDER"
    FETCH FIRST 1 ROWS ONLY) "Url"
FROM "HEHE"."PRODUCT_IMAGES" "p"
WHERE "p"."PRODUCT_ID" IS NOT NULL AND "p"."PRODUCT_ID" IN (3, 2, 1)
GROUP BY "p"."PRODUCT_ID"
2025-09-05 11:08:30.995 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", MIN(COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")) "MinPrice"
FROM "HEHE"."PRODUCT_VARIANTS" "p"
INNER JOIN "HEHE"."PRODUCT_PRICES" "p0" ON "p"."ID" = "p0"."VARIANT_ID"
WHERE (("p"."PRODUCT_ID" IN (3, 2, 1)) AND ((("p0"."STARTS_AT" <= :now_1) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))))
GROUP BY "p"."PRODUCT_ID"
2025-09-05 11:08:30.997 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem, PHONE_STORE.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-05 11:08:30.998 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API) in 13.8495ms
2025-09-05 11:08:30.999 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 11:08:30.999 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - 200 null application/json; charset=utf-8 19.3406ms
2025-09-05 11:08:31.023 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 11:08:31.026 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 11:08:31.027 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 11:08:31.032 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 11:08:31.036 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 11:08:31.040 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 11:08:31.042 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 11:08:31.044 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 15.0496ms
2025-09-05 11:08:31.044 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 11:08:31.045 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 21.8781ms
2025-09-05 11:08:33.356 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 11:08:33.358 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 11:08:33.359 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 11:08:33.363 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 11:08:33.366 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 11:08:33.368 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 11:08:33.370 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 11:08:33.371 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 10.971ms
2025-09-05 11:08:33.372 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 11:08:33.372 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 16.0086ms
2025-09-05 11:08:33.394 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 11:08:33.397 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 11:08:33.398 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 11:08:33.402 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 11:08:33.406 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 11:08:33.408 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 11:08:33.410 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 11:08:33.411 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 11.54ms
2025-09-05 11:08:33.412 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 11:08:33.413 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 19.0402ms
2025-09-05 11:08:34.759 +07:00 [INF] Request starting HTTP/1.1 POST https://localhost:7277/api/shop/checkout/preview - application/json; charset=utf-8 null
2025-09-05 11:08:34.766 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCheckoutController.Preview (PHONE_STORE.API)'
2025-09-05 11:08:34.770 +07:00 [INF] Route matched with {action = "Preview", controller = "ShopCheckout"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CheckoutPreviewResult] Preview(PHONE_STORE.Application.Dtos.CheckoutPreviewRequest, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCheckoutController (PHONE_STORE.API).
2025-09-05 12:05:16.814 +07:00 [INF] User profile is available. Using 'C:\Users\Administrator\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-09-05 12:05:17.046 +07:00 [INF] Now listening on: https://localhost:7277
2025-09-05 12:05:17.047 +07:00 [INF] Now listening on: http://localhost:5209
2025-09-05 12:05:17.136 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-05 12:05:17.137 +07:00 [INF] Hosting environment: Development
2025-09-05 12:05:17.138 +07:00 [INF] Content root path: C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.API
2025-09-05 12:05:17.823 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/swagger/index.html - null null
2025-09-05 12:05:18.279 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/swagger/index.html - 200 null text/html;charset=utf-8 467.2664ms
2025-09-05 12:05:18.322 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/_framework/aspnetcore-browser-refresh.js - null null
2025-09-05 12:05:18.342 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/_framework/aspnetcore-browser-refresh.js - 200 13766 application/javascript; charset=utf-8 19.5972ms
2025-09-05 12:05:18.362 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/_vs/browserLink - null null
2025-09-05 12:05:18.444 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/_vs/browserLink - 200 null text/javascript; charset=UTF-8 82.5304ms
2025-09-05 12:05:18.450 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - null null
2025-09-05 12:05:18.542 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 12:05:18.576 +07:00 [INF] Route matched with {action = "List", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem]]] List(System.String, System.Nullable`1[System.Int64], Int32, Int32, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 12:05:18.602 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/swagger/v1/swagger.json - null null
2025-09-05 12:05:18.745 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 143.0519ms
2025-09-05 12:05:19.375 +07:00 [WRN] The decimal property 'UnitPrice' on entity type 'CartItem' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 12:05:19.377 +07:00 [WRN] The decimal property 'DiscountTotal' on entity type 'Order' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 12:05:19.378 +07:00 [WRN] The decimal property 'GrandTotal' on entity type 'Order' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 12:05:19.381 +07:00 [WRN] The decimal property 'ShippingFee' on entity type 'Order' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 12:05:19.383 +07:00 [WRN] The decimal property 'Subtotal' on entity type 'Order' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 12:05:19.385 +07:00 [WRN] The decimal property 'TaxTotal' on entity type 'Order' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 12:05:19.386 +07:00 [WRN] The decimal property 'DiscountAmount' on entity type 'OrderItem' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 12:05:19.388 +07:00 [WRN] The decimal property 'TaxAmount' on entity type 'OrderItem' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 12:05:19.390 +07:00 [WRN] The decimal property 'UnitPrice' on entity type 'OrderItem' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 12:05:19.391 +07:00 [WRN] The decimal property 'DecValue' on entity type 'ProductAttributeValue' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 12:05:19.392 +07:00 [WRN] The decimal property 'ListPrice' on entity type 'ProductPrice' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 12:05:19.393 +07:00 [WRN] The decimal property 'SalePrice' on entity type 'ProductPrice' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 12:05:19.394 +07:00 [WRN] The decimal property 'WeightGram' on entity type 'ProductVariant' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 12:05:20.064 +07:00 [INF] Executed DbCommand (116ms) [Parameters=[:p_0='?' (DbType = Int32), :p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."ID" "Id", "p"."NAME" "Name", "p"."SLUG" "Slug"
FROM "HEHE"."PRODUCTS" "p"
WHERE "p"."IS_ACTIVE" = 1
ORDER BY "p"."CREATED_AT" DESC
OFFSET :p_0 ROWS FETCH NEXT :p_1 ROWS ONLY
2025-09-05 12:05:20.168 +07:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", (
    SELECT "p0"."IMAGE_URL"
    FROM "HEHE"."PRODUCT_IMAGES" "p0"
    WHERE (("p0"."PRODUCT_ID" IS NOT NULL AND "p0"."PRODUCT_ID" IN (3, 2, 1)) AND ("p"."PRODUCT_ID" = "p0"."PRODUCT_ID"))
    ORDER BY "p0"."SORT_ORDER"
    FETCH FIRST 1 ROWS ONLY) "Url"
FROM "HEHE"."PRODUCT_IMAGES" "p"
WHERE "p"."PRODUCT_ID" IS NOT NULL AND "p"."PRODUCT_ID" IN (3, 2, 1)
GROUP BY "p"."PRODUCT_ID"
2025-09-05 12:05:20.210 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", MIN(COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")) "MinPrice"
FROM "HEHE"."PRODUCT_VARIANTS" "p"
INNER JOIN "HEHE"."PRODUCT_PRICES" "p0" ON "p"."ID" = "p0"."VARIANT_ID"
WHERE (("p"."PRODUCT_ID" IN (3, 2, 1)) AND ((("p0"."STARTS_AT" <= :now_1) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))))
GROUP BY "p"."PRODUCT_ID"
2025-09-05 12:05:20.226 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem, PHONE_STORE.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-05 12:05:20.242 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API) in 1662.2912ms
2025-09-05 12:05:20.245 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 12:05:20.254 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - 200 null application/json; charset=utf-8 1809.0697ms
2025-09-05 12:05:20.441 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 12:05:20.447 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 12:05:20.452 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 12:05:20.532 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 12:05:20.592 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 12:05:20.607 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 12:05:20.618 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 12:05:20.629 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 174.1381ms
2025-09-05 12:05:20.631 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 12:05:20.632 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 191.0326ms
2025-09-05 12:05:24.652 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 12:05:24.656 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 12:05:24.657 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 12:05:24.676 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 12:05:24.682 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 12:05:24.686 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 12:05:24.688 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 12:05:24.689 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 30.96ms
2025-09-05 12:05:24.690 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 12:05:24.691 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 38.7071ms
2025-09-05 12:05:24.725 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 12:05:24.727 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 12:05:24.728 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 12:05:24.737 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 12:05:24.744 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 12:05:24.750 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 12:05:24.756 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 12:05:24.758 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 27.874ms
2025-09-05 12:05:24.759 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 12:05:24.760 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 35.1841ms
2025-09-05 12:05:26.235 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 12:05:26.237 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 12:05:26.238 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 12:05:26.244 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 12:05:26.250 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 12:05:26.257 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 12:05:26.263 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 12:05:26.265 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 25.0596ms
2025-09-05 12:05:26.266 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 12:05:26.267 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 32.5321ms
2025-09-05 12:05:34.076 +07:00 [INF] Request starting HTTP/1.1 POST https://localhost:7277/api/auth/login - application/json; charset=utf-8 null
2025-09-05 12:05:34.086 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.AuthController.Login (PHONE_STORE.API)'
2025-09-05 12:05:34.092 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(LoginRequest, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.AuthController (PHONE_STORE.API).
2025-09-05 12:05:34.343 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[:uname_0='?' (Size = 450), :username_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='0']
SELECT "u"."ID", "u"."CREATED_AT", "u"."EMAIL", "u"."PASSWORD_HASH", "u"."PHONE", "u"."STATUS"
FROM "USER_ACCOUNTS" "u"
WHERE (("u"."EMAIL" = :uname_0) OR ("u"."PHONE" = :username_1))
FETCH FIRST 1 ROWS ONLY
2025-09-05 12:05:34.850 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[:userId_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "r"."CODE"
FROM "USER_ROLES" "u"
INNER JOIN "ROLES" "r" ON "u"."ROLE_ID" = "r"."ID"
WHERE "u"."USER_ID" = :userId_0
2025-09-05 12:05:34.921 +07:00 [INF] Login success [21]
2025-09-05 12:05:34.932 +07:00 [INF] Executing OkObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.AuthResponseDto'.
2025-09-05 12:05:34.937 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.AuthController.Login (PHONE_STORE.API) in 842.8991ms
2025-09-05 12:05:34.939 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.AuthController.Login (PHONE_STORE.API)'
2025-09-05 12:05:34.941 +07:00 [INF] Request finished HTTP/1.1 POST https://localhost:7277/api/auth/login - 200 null application/json; charset=utf-8 864.3033ms
2025-09-05 12:05:34.971 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/me/addresses - null null
2025-09-05 12:05:35.032 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopMeController.MyAddresses (PHONE_STORE.API)'
2025-09-05 12:05:35.037 +07:00 [INF] Route matched with {action = "MyAddresses", controller = "ShopMe"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.Application.Dtos.AddressDto]]] MyAddresses(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopMeController (PHONE_STORE.API).
2025-09-05 12:05:35.046 +07:00 [INF] Executing ObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ProblemDetails'.
2025-09-05 12:05:35.060 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopMeController.MyAddresses (PHONE_STORE.API) in 20.0714ms
2025-09-05 12:05:35.064 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopMeController.MyAddresses (PHONE_STORE.API)'
2025-09-05 12:05:35.065 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/me/addresses - 401 null application/problem+json; charset=utf-8 94.3106ms
2025-09-05 12:05:35.070 +07:00 [INF] Request starting HTTP/1.1 POST https://localhost:7277/api/auth/refresh - application/json; charset=utf-8 null
2025-09-05 12:05:35.073 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.AuthController.Refresh (PHONE_STORE.API)'
2025-09-05 12:05:35.077 +07:00 [INF] Route matched with {action = "Refresh", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Refresh(RefreshRequest, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.AuthController (PHONE_STORE.API).
2025-09-05 12:05:35.134 +07:00 [INF] Executed DbCommand (23ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "u"."ID" "Id", "u"."EMAIL" "Email", "u"."PHONE" "Phone", "u"."STATUS" "Status", "u"."CREATED_AT" "CreatedAt"
FROM "USER_ACCOUNTS" "u"
WHERE "u"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 12:05:35.142 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[:userId_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "r"."CODE"
FROM "USER_ROLES" "u"
INNER JOIN "ROLES" "r" ON "u"."ROLE_ID" = "r"."ID"
WHERE "u"."USER_ID" = :userId_0
2025-09-05 12:05:35.149 +07:00 [INF] Refresh success: rotate RT for user 21
2025-09-05 12:05:35.149 +07:00 [INF] Executing OkObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.AuthResponseDto'.
2025-09-05 12:05:35.150 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.AuthController.Refresh (PHONE_STORE.API) in 71.5103ms
2025-09-05 12:05:35.151 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.AuthController.Refresh (PHONE_STORE.API)'
2025-09-05 12:05:35.152 +07:00 [INF] Request finished HTTP/1.1 POST https://localhost:7277/api/auth/refresh - 200 null application/json; charset=utf-8 81.2079ms
2025-09-05 12:05:35.154 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/me/addresses - null null
2025-09-05 12:05:35.158 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopMeController.MyAddresses (PHONE_STORE.API)'
2025-09-05 12:05:35.158 +07:00 [INF] Route matched with {action = "MyAddresses", controller = "ShopMe"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.Application.Dtos.AddressDto]]] MyAddresses(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopMeController (PHONE_STORE.API).
2025-09-05 12:05:35.160 +07:00 [INF] Executing ObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ProblemDetails'.
2025-09-05 12:05:35.161 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopMeController.MyAddresses (PHONE_STORE.API) in 1.1406ms
2025-09-05 12:05:35.162 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopMeController.MyAddresses (PHONE_STORE.API)'
2025-09-05 12:05:35.162 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/me/addresses - 401 null application/problem+json; charset=utf-8 8.0447ms
2025-09-05 12:05:44.298 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - null null
2025-09-05 12:05:44.300 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 12:05:44.300 +07:00 [INF] Route matched with {action = "List", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem]]] List(System.String, System.Nullable`1[System.Int64], Int32, Int32, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 12:05:44.309 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:p_0='?' (DbType = Int32), :p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."ID" "Id", "p"."NAME" "Name", "p"."SLUG" "Slug"
FROM "HEHE"."PRODUCTS" "p"
WHERE "p"."IS_ACTIVE" = 1
ORDER BY "p"."CREATED_AT" DESC
OFFSET :p_0 ROWS FETCH NEXT :p_1 ROWS ONLY
2025-09-05 12:05:44.313 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", (
    SELECT "p0"."IMAGE_URL"
    FROM "HEHE"."PRODUCT_IMAGES" "p0"
    WHERE (("p0"."PRODUCT_ID" IS NOT NULL AND "p0"."PRODUCT_ID" IN (3, 2, 1)) AND ("p"."PRODUCT_ID" = "p0"."PRODUCT_ID"))
    ORDER BY "p0"."SORT_ORDER"
    FETCH FIRST 1 ROWS ONLY) "Url"
FROM "HEHE"."PRODUCT_IMAGES" "p"
WHERE "p"."PRODUCT_ID" IS NOT NULL AND "p"."PRODUCT_ID" IN (3, 2, 1)
GROUP BY "p"."PRODUCT_ID"
2025-09-05 12:05:44.323 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", MIN(COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")) "MinPrice"
FROM "HEHE"."PRODUCT_VARIANTS" "p"
INNER JOIN "HEHE"."PRODUCT_PRICES" "p0" ON "p"."ID" = "p0"."VARIANT_ID"
WHERE (("p"."PRODUCT_ID" IN (3, 2, 1)) AND ((("p0"."STARTS_AT" <= :now_1) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))))
GROUP BY "p"."PRODUCT_ID"
2025-09-05 12:05:44.326 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem, PHONE_STORE.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-05 12:05:44.328 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API) in 25.7755ms
2025-09-05 12:05:44.329 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 12:05:44.329 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - 200 null application/json; charset=utf-8 31.3425ms
2025-09-05 12:05:44.348 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 12:05:44.351 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 12:05:44.352 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 12:05:44.360 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 12:05:44.368 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 12:05:44.382 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 12:05:44.384 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 12:05:44.385 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 30.2846ms
2025-09-05 12:05:44.386 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 12:05:44.386 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 38.0357ms
2025-09-05 12:05:47.364 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 12:05:47.366 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 12:05:47.368 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 12:05:47.373 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 12:05:47.376 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 12:05:47.380 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 12:05:47.382 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 12:05:47.383 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 12.693ms
2025-09-05 12:05:47.384 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 12:05:47.384 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 20.6641ms
2025-09-05 12:05:47.404 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 12:05:47.407 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 12:05:47.409 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 12:05:47.413 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 12:05:47.419 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 12:05:47.422 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 12:05:47.424 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 12:05:47.425 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 14.4563ms
2025-09-05 12:05:47.426 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 12:05:47.427 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 22.3555ms
2025-09-05 12:05:49.344 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/me/addresses - null null
2025-09-05 12:05:49.350 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopMeController.MyAddresses (PHONE_STORE.API)'
2025-09-05 12:05:49.351 +07:00 [INF] Route matched with {action = "MyAddresses", controller = "ShopMe"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.Application.Dtos.AddressDto]]] MyAddresses(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopMeController (PHONE_STORE.API).
2025-09-05 12:05:49.354 +07:00 [INF] Executing ObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ProblemDetails'.
2025-09-05 12:05:49.355 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopMeController.MyAddresses (PHONE_STORE.API) in 1.5199ms
2025-09-05 12:05:49.356 +07:00 [INF] Request starting HTTP/1.1 POST https://localhost:7277/api/auth/refresh - application/json; charset=utf-8 null
2025-09-05 12:05:49.356 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopMeController.MyAddresses (PHONE_STORE.API)'
2025-09-05 12:05:49.358 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.AuthController.Refresh (PHONE_STORE.API)'
2025-09-05 12:05:49.358 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/me/addresses - 401 null application/problem+json; charset=utf-8 14.3657ms
2025-09-05 12:05:49.359 +07:00 [INF] Route matched with {action = "Refresh", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Refresh(RefreshRequest, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.AuthController (PHONE_STORE.API).
2025-09-05 12:05:49.371 +07:00 [WRN] Refresh denied: invalid/expired/revoked RT
2025-09-05 12:05:49.372 +07:00 [INF] Executing ObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ProblemDetails'.
2025-09-05 12:05:49.373 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.AuthController.Refresh (PHONE_STORE.API) in 7.3815ms
2025-09-05 12:05:49.374 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.AuthController.Refresh (PHONE_STORE.API)'
2025-09-05 12:05:49.374 +07:00 [INF] Request finished HTTP/1.1 POST https://localhost:7277/api/auth/refresh - 401 null application/problem+json; charset=utf-8 18.7582ms
2025-09-05 12:05:58.256 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 12:05:58.260 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 12:05:58.261 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 12:05:58.268 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 12:05:58.273 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 12:05:58.280 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 12:05:58.282 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 12:05:58.283 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 20.5938ms
2025-09-05 12:05:58.283 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 12:05:58.284 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 28.7031ms
2025-09-05 12:05:59.563 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - null null
2025-09-05 12:05:59.565 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 12:05:59.566 +07:00 [INF] Route matched with {action = "List", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem]]] List(System.String, System.Nullable`1[System.Int64], Int32, Int32, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 12:05:59.572 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:p_0='?' (DbType = Int32), :p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."ID" "Id", "p"."NAME" "Name", "p"."SLUG" "Slug"
FROM "HEHE"."PRODUCTS" "p"
WHERE "p"."IS_ACTIVE" = 1
ORDER BY "p"."CREATED_AT" DESC
OFFSET :p_0 ROWS FETCH NEXT :p_1 ROWS ONLY
2025-09-05 12:05:59.581 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", (
    SELECT "p0"."IMAGE_URL"
    FROM "HEHE"."PRODUCT_IMAGES" "p0"
    WHERE (("p0"."PRODUCT_ID" IS NOT NULL AND "p0"."PRODUCT_ID" IN (3, 2, 1)) AND ("p"."PRODUCT_ID" = "p0"."PRODUCT_ID"))
    ORDER BY "p0"."SORT_ORDER"
    FETCH FIRST 1 ROWS ONLY) "Url"
FROM "HEHE"."PRODUCT_IMAGES" "p"
WHERE "p"."PRODUCT_ID" IS NOT NULL AND "p"."PRODUCT_ID" IN (3, 2, 1)
GROUP BY "p"."PRODUCT_ID"
2025-09-05 12:05:59.587 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", MIN(COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")) "MinPrice"
FROM "HEHE"."PRODUCT_VARIANTS" "p"
INNER JOIN "HEHE"."PRODUCT_PRICES" "p0" ON "p"."ID" = "p0"."VARIANT_ID"
WHERE (("p"."PRODUCT_ID" IN (3, 2, 1)) AND ((("p0"."STARTS_AT" <= :now_1) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))))
GROUP BY "p"."PRODUCT_ID"
2025-09-05 12:05:59.589 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem, PHONE_STORE.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-05 12:05:59.590 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API) in 22.2145ms
2025-09-05 12:05:59.591 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 12:05:59.592 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - 200 null application/json; charset=utf-8 29.0017ms
2025-09-05 12:05:59.618 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 12:05:59.620 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 12:05:59.621 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 12:05:59.634 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 12:05:59.647 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 12:05:59.651 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 12:05:59.654 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 12:05:59.658 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 27.9398ms
2025-09-05 12:05:59.659 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 12:05:59.660 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 42.2891ms
2025-09-05 12:06:01.245 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products/redmi-note-13 - null null
2025-09-05 12:06:01.247 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API)'
2025-09-05 12:06:01.250 +07:00 [INF] Route matched with {action = "Details", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductDetail]] Details(System.String, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 12:06:01.310 +07:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-09-05 12:06:01.331 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:slug_0='?' (Size = 220)], CommandType='"Text"', CommandTimeout='0']
SELECT "p2"."ID", "p2"."BRAND_ID", "p2"."CREATED_AT", "p2"."DEFAULT_CATEGORY_ID", "p2"."DESCRIPTION", "p2"."IS_ACTIVE", "p2"."NAME", "p2"."SLUG", "p2"."SPEC_JSON", "p0"."ID", "p0"."BARCODE", "p0"."COLOR", "p0"."IS_ACTIVE", "p0"."PRODUCT_ID", "p0"."SKU", "p0"."STORAGE_GB", "p0"."WEIGHT_GRAM", "p1"."ID", "p1"."ALT_TEXT", "p1"."IMAGE_URL", "p1"."IS_PRIMARY", "p1"."PRODUCT_ID", "p1"."SORT_ORDER", "p1"."VARIANT_ID"
FROM (
    SELECT "p"."ID", "p"."BRAND_ID", "p"."CREATED_AT", "p"."DEFAULT_CATEGORY_ID", "p"."DESCRIPTION", "p"."IS_ACTIVE", "p"."NAME", "p"."SLUG", "p"."SPEC_JSON"
    FROM "HEHE"."PRODUCTS" "p"
    WHERE (("p"."SLUG" = :slug_0) AND ("p"."IS_ACTIVE" = 1))
    FETCH FIRST 1 ROWS ONLY
) "p2"
LEFT JOIN "HEHE"."PRODUCT_VARIANTS" "p0" ON "p2"."ID" = "p0"."PRODUCT_ID"
LEFT JOIN "HEHE"."PRODUCT_IMAGES" "p1" ON "p2"."ID" = "p1"."PRODUCT_ID"
ORDER BY "p2"."ID", "p0"."ID"
2025-09-05 12:06:01.373 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."VARIANT_ID" "VariantId", COALESCE((
    SELECT COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")
    FROM "HEHE"."PRODUCT_PRICES" "p0"
    WHERE 0 = 1
    ORDER BY "p0"."STARTS_AT" DESC
    FETCH FIRST 1 ROWS ONLY), 0.0) "Price"
FROM "HEHE"."PRODUCT_PRICES" "p"
WHERE 0 = 1
GROUP BY "p"."VARIANT_ID"
2025-09-05 12:06:01.378 +07:00 [INF] Executing OkObjectResult, writing value of type 'PHONE_STORE.API.Controllers.ShopProductsController+ShopProductDetail'.
2025-09-05 12:06:01.384 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API) in 131.0894ms
2025-09-05 12:06:01.385 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API)'
2025-09-05 12:06:01.386 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products/redmi-note-13 - 200 null application/json; charset=utf-8 140.8538ms
2025-09-05 12:06:01.411 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 12:06:01.413 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 12:06:01.414 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 12:06:01.419 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 12:06:01.423 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 12:06:01.431 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 12:06:01.434 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 12:06:01.435 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 18.0877ms
2025-09-05 12:06:01.435 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 12:06:01.436 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 25.5036ms
2025-09-05 12:06:02.507 +07:00 [INF] Request starting HTTP/1.1 POST https://localhost:7277/api/shop/cart/items - application/json; charset=utf-8 null
2025-09-05 12:06:02.510 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Add (PHONE_STORE.API)'
2025-09-05 12:06:02.514 +07:00 [INF] Route matched with {action = "Add", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Add(PHONE_STORE.Application.Dtos.CartItemUpsertDto, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 12:06:02.524 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 12:06:02.532 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64), :dto_VariantId_1='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE"
FROM "HEHE"."CART_ITEMS" "c"
WHERE (("c"."CART_ID" = :id_0) AND ("c"."VARIANT_ID" = :dto_VariantId_1))
FETCH FIRST 1 ROWS ONLY
2025-09-05 12:06:02.579 +07:00 [INF] Executed DbCommand (29ms) [Parameters=[:variantId_0='?' (DbType = Int64), :now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT COALESCE("p"."SALE_PRICE", "p"."LIST_PRICE")
FROM "HEHE"."PRODUCT_PRICES" "p"
WHERE (((("p"."VARIANT_ID" = :variantId_0) AND ("p"."STARTS_AT" <= :now_1))) AND ((("p"."ENDS_AT" IS NULL) OR ("p"."ENDS_AT" > :now_2))))
ORDER BY "p"."STARTS_AT" DESC
FETCH FIRST 1 ROWS ONLY
2025-09-05 12:06:02.817 +07:00 [ERR] 2025-09-05 12:06:02.817711 ThreadID:5   (ERROR)   OracleRelationalCommand.ExecuteReaderAsync() :  Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02291: integrity constraint (HEHE.FK_CI_VARIANT) violated - parent key not found
ORA-06512: at line 6
https://docs.oracle.com/error-help/db/ora-02291/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
2025-09-05 12:06:02.821 +07:00 [ERR] Failed executing DbCommand (60ms) [Parameters=[:p0='?' (DbType = Int64), :p1='?' (DbType = Int64), :p2='?' (DbType = DateTime), :p3='?' (Size = 2000), :p4='?' (DbType = Int32), :p5='?' (DbType = Decimal)], CommandType='"Text"', CommandTimeout='0']
DECLARE


BEGIN

INSERT INTO "HEHE"."CART_ITEMS" ("CART_ID", "VARIANT_ID", "ADDED_AT", "CURRENCY", "QUANTITY", "UNIT_PRICE")
VALUES (:p0, :p1, :p2, :p3, :p4, :p5);

END;
2025-09-05 12:06:02.846 +07:00 [ERR] 2025-09-05 12:06:02.846005 ThreadID:5   (ERROR)   OracleExecutionStrategy.ExecuteAsync() :  Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02291: integrity constraint (HEHE.FK_CI_VARIANT) violated - parent key not found
ORA-06512: at line 6
https://docs.oracle.com/error-help/db/ora-02291/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
2025-09-05 12:06:02.856 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'PHONE_STORE.Infrastructure.Data.PhoneDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02291: integrity constraint (HEHE.FK_CI_VARIANT) violated - parent key not found
ORA-06512: at line 6
https://docs.oracle.com/error-help/db/ora-02291/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02291: integrity constraint (HEHE.FK_CI_VARIANT) violated - parent key not found
ORA-06512: at line 6
https://docs.oracle.com/error-help/db/ora-02291/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-09-05 12:06:02.957 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Add (PHONE_STORE.API) in 441.4539ms
2025-09-05 12:06:02.960 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Add (PHONE_STORE.API)'
2025-09-05 12:06:02.962 +07:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02291: integrity constraint (HEHE.FK_CI_VARIANT) violated - parent key not found
ORA-06512: at line 6
https://docs.oracle.com/error-help/db/ora-02291/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at PHONE_STORE.Infrastructure.Repositories.CartRepository.AddOrUpdateItemAsync(Nullable`1 customerId, String sessionId, CartItemUpsertDto dto, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.Infrastructure\Repositories\CartRepository.cs:line 123
   at lambda_method262(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-05 12:06:02.999 +07:00 [INF] Request finished HTTP/1.1 POST https://localhost:7277/api/shop/cart/items - 500 null application/problem+json; charset=utf-8 492.6398ms
2025-09-05 12:06:03.004 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products/redmi-note-13 - null null
2025-09-05 12:06:03.006 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API)'
2025-09-05 12:06:03.006 +07:00 [INF] Route matched with {action = "Details", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductDetail]] Details(System.String, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 12:06:03.011 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:slug_0='?' (Size = 220)], CommandType='"Text"', CommandTimeout='0']
SELECT "p2"."ID", "p2"."BRAND_ID", "p2"."CREATED_AT", "p2"."DEFAULT_CATEGORY_ID", "p2"."DESCRIPTION", "p2"."IS_ACTIVE", "p2"."NAME", "p2"."SLUG", "p2"."SPEC_JSON", "p0"."ID", "p0"."BARCODE", "p0"."COLOR", "p0"."IS_ACTIVE", "p0"."PRODUCT_ID", "p0"."SKU", "p0"."STORAGE_GB", "p0"."WEIGHT_GRAM", "p1"."ID", "p1"."ALT_TEXT", "p1"."IMAGE_URL", "p1"."IS_PRIMARY", "p1"."PRODUCT_ID", "p1"."SORT_ORDER", "p1"."VARIANT_ID"
FROM (
    SELECT "p"."ID", "p"."BRAND_ID", "p"."CREATED_AT", "p"."DEFAULT_CATEGORY_ID", "p"."DESCRIPTION", "p"."IS_ACTIVE", "p"."NAME", "p"."SLUG", "p"."SPEC_JSON"
    FROM "HEHE"."PRODUCTS" "p"
    WHERE (("p"."SLUG" = :slug_0) AND ("p"."IS_ACTIVE" = 1))
    FETCH FIRST 1 ROWS ONLY
) "p2"
LEFT JOIN "HEHE"."PRODUCT_VARIANTS" "p0" ON "p2"."ID" = "p0"."PRODUCT_ID"
LEFT JOIN "HEHE"."PRODUCT_IMAGES" "p1" ON "p2"."ID" = "p1"."PRODUCT_ID"
ORDER BY "p2"."ID", "p0"."ID"
2025-09-05 12:06:03.018 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."VARIANT_ID" "VariantId", COALESCE((
    SELECT COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")
    FROM "HEHE"."PRODUCT_PRICES" "p0"
    WHERE 0 = 1
    ORDER BY "p0"."STARTS_AT" DESC
    FETCH FIRST 1 ROWS ONLY), 0.0) "Price"
FROM "HEHE"."PRODUCT_PRICES" "p"
WHERE 0 = 1
GROUP BY "p"."VARIANT_ID"
2025-09-05 12:06:03.019 +07:00 [INF] Executing OkObjectResult, writing value of type 'PHONE_STORE.API.Controllers.ShopProductsController+ShopProductDetail'.
2025-09-05 12:06:03.020 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API) in 12.1466ms
2025-09-05 12:06:03.021 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API)'
2025-09-05 12:06:03.022 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products/redmi-note-13 - 200 null application/json; charset=utf-8 17.3456ms
2025-09-05 12:06:03.041 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 12:06:03.044 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 12:06:03.045 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 12:06:03.051 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 12:06:03.056 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 12:06:03.061 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 12:06:03.065 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 12:06:03.066 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 19.0703ms
2025-09-05 12:06:03.067 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 12:06:03.068 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 27.0094ms
2025-09-05 12:06:04.495 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 12:06:04.497 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 12:06:04.498 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 12:06:04.501 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 12:06:04.505 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 12:06:04.508 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 12:06:04.510 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 12:06:04.511 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 12.42ms
2025-09-05 12:06:04.512 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 12:06:04.513 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 17.3838ms
2025-09-05 12:06:04.530 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 12:06:04.533 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 12:06:04.535 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 12:06:04.541 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 12:06:04.545 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 12:06:04.547 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 12:06:04.551 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 12:06:04.552 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 14.2551ms
2025-09-05 12:06:04.553 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 12:06:04.554 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 23.5167ms
2025-09-05 12:06:07.654 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - null null
2025-09-05 12:06:07.656 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 12:06:07.657 +07:00 [INF] Route matched with {action = "List", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem]]] List(System.String, System.Nullable`1[System.Int64], Int32, Int32, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 12:06:07.665 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:p_0='?' (DbType = Int32), :p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."ID" "Id", "p"."NAME" "Name", "p"."SLUG" "Slug"
FROM "HEHE"."PRODUCTS" "p"
WHERE "p"."IS_ACTIVE" = 1
ORDER BY "p"."CREATED_AT" DESC
OFFSET :p_0 ROWS FETCH NEXT :p_1 ROWS ONLY
2025-09-05 12:06:07.669 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", (
    SELECT "p0"."IMAGE_URL"
    FROM "HEHE"."PRODUCT_IMAGES" "p0"
    WHERE (("p0"."PRODUCT_ID" IS NOT NULL AND "p0"."PRODUCT_ID" IN (3, 2, 1)) AND ("p"."PRODUCT_ID" = "p0"."PRODUCT_ID"))
    ORDER BY "p0"."SORT_ORDER"
    FETCH FIRST 1 ROWS ONLY) "Url"
FROM "HEHE"."PRODUCT_IMAGES" "p"
WHERE "p"."PRODUCT_ID" IS NOT NULL AND "p"."PRODUCT_ID" IN (3, 2, 1)
GROUP BY "p"."PRODUCT_ID"
2025-09-05 12:06:07.674 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", MIN(COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")) "MinPrice"
FROM "HEHE"."PRODUCT_VARIANTS" "p"
INNER JOIN "HEHE"."PRODUCT_PRICES" "p0" ON "p"."ID" = "p0"."VARIANT_ID"
WHERE (("p"."PRODUCT_ID" IN (3, 2, 1)) AND ((("p0"."STARTS_AT" <= :now_1) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))))
GROUP BY "p"."PRODUCT_ID"
2025-09-05 12:06:07.676 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem, PHONE_STORE.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-05 12:06:07.677 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API) in 15.9355ms
2025-09-05 12:06:07.678 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 12:06:07.679 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - 200 null application/json; charset=utf-8 24.8835ms
2025-09-05 12:06:07.702 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 12:06:07.705 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 12:06:07.706 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 12:06:07.716 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 12:06:07.725 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 12:06:07.734 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 12:06:07.738 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 12:06:07.740 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 29.9271ms
2025-09-05 12:06:07.744 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 12:06:07.745 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 43.9627ms
2025-09-05 12:06:11.048 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products/iphone-15 - null null
2025-09-05 12:06:11.050 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API)'
2025-09-05 12:06:11.051 +07:00 [INF] Route matched with {action = "Details", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductDetail]] Details(System.String, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 12:06:11.056 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:slug_0='?' (Size = 220)], CommandType='"Text"', CommandTimeout='0']
SELECT "p2"."ID", "p2"."BRAND_ID", "p2"."CREATED_AT", "p2"."DEFAULT_CATEGORY_ID", "p2"."DESCRIPTION", "p2"."IS_ACTIVE", "p2"."NAME", "p2"."SLUG", "p2"."SPEC_JSON", "p0"."ID", "p0"."BARCODE", "p0"."COLOR", "p0"."IS_ACTIVE", "p0"."PRODUCT_ID", "p0"."SKU", "p0"."STORAGE_GB", "p0"."WEIGHT_GRAM", "p1"."ID", "p1"."ALT_TEXT", "p1"."IMAGE_URL", "p1"."IS_PRIMARY", "p1"."PRODUCT_ID", "p1"."SORT_ORDER", "p1"."VARIANT_ID"
FROM (
    SELECT "p"."ID", "p"."BRAND_ID", "p"."CREATED_AT", "p"."DEFAULT_CATEGORY_ID", "p"."DESCRIPTION", "p"."IS_ACTIVE", "p"."NAME", "p"."SLUG", "p"."SPEC_JSON"
    FROM "HEHE"."PRODUCTS" "p"
    WHERE (("p"."SLUG" = :slug_0) AND ("p"."IS_ACTIVE" = 1))
    FETCH FIRST 1 ROWS ONLY
) "p2"
LEFT JOIN "HEHE"."PRODUCT_VARIANTS" "p0" ON "p2"."ID" = "p0"."PRODUCT_ID"
LEFT JOIN "HEHE"."PRODUCT_IMAGES" "p1" ON "p2"."ID" = "p1"."PRODUCT_ID"
ORDER BY "p2"."ID", "p0"."ID"
2025-09-05 12:06:11.071 +07:00 [INF] Executed DbCommand (9ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."VARIANT_ID" "VariantId", COALESCE((
    SELECT COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")
    FROM "HEHE"."PRODUCT_PRICES" "p0"
    WHERE (((((("p0"."VARIANT_ID" IN (1, 2)) AND ("p0"."STARTS_AT" <= :now_1))) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))) AND ("p"."VARIANT_ID" = "p0"."VARIANT_ID"))
    ORDER BY "p0"."STARTS_AT" DESC
    FETCH FIRST 1 ROWS ONLY), 0.0) "Price"
FROM "HEHE"."PRODUCT_PRICES" "p"
WHERE (((("p"."VARIANT_ID" IN (1, 2)) AND ("p"."STARTS_AT" <= :now_1))) AND ((("p"."ENDS_AT" IS NULL) OR ("p"."ENDS_AT" > :now_2))))
GROUP BY "p"."VARIANT_ID"
2025-09-05 12:06:11.077 +07:00 [INF] Executing OkObjectResult, writing value of type 'PHONE_STORE.API.Controllers.ShopProductsController+ShopProductDetail'.
2025-09-05 12:06:11.079 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API) in 25.8889ms
2025-09-05 12:06:11.080 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API)'
2025-09-05 12:06:11.080 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products/iphone-15 - 200 null application/json; charset=utf-8 32.5515ms
2025-09-05 12:06:11.104 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 12:06:11.107 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 12:06:11.107 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 12:06:11.112 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 12:06:11.116 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 12:06:11.120 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 12:06:11.122 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 12:06:11.122 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 13.3203ms
2025-09-05 12:06:11.123 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 12:06:11.124 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 19.5881ms
2025-09-05 12:06:12.831 +07:00 [INF] Request starting HTTP/1.1 POST https://localhost:7277/api/shop/cart/items - application/json; charset=utf-8 null
2025-09-05 12:06:12.833 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Add (PHONE_STORE.API)'
2025-09-05 12:06:12.834 +07:00 [INF] Route matched with {action = "Add", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Add(PHONE_STORE.Application.Dtos.CartItemUpsertDto, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 12:06:12.838 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 12:06:12.842 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64), :dto_VariantId_1='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE"
FROM "HEHE"."CART_ITEMS" "c"
WHERE (("c"."CART_ID" = :id_0) AND ("c"."VARIANT_ID" = :dto_VariantId_1))
FETCH FIRST 1 ROWS ONLY
2025-09-05 12:06:12.846 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:variantId_0='?' (DbType = Int64), :now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT COALESCE("p"."SALE_PRICE", "p"."LIST_PRICE")
FROM "HEHE"."PRODUCT_PRICES" "p"
WHERE (((("p"."VARIANT_ID" = :variantId_0) AND ("p"."STARTS_AT" <= :now_1))) AND ((("p"."ENDS_AT" IS NULL) OR ("p"."ENDS_AT" > :now_2))))
ORDER BY "p"."STARTS_AT" DESC
FETCH FIRST 1 ROWS ONLY
2025-09-05 12:06:12.852 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:p0='?' (DbType = Int64), :p1='?' (DbType = Int64), :p2='?' (DbType = DateTime), :p3='?' (Size = 2000), :p4='?' (DbType = Int32), :p5='?' (DbType = Decimal)], CommandType='"Text"', CommandTimeout='0']
DECLARE


BEGIN

INSERT INTO "HEHE"."CART_ITEMS" ("CART_ID", "VARIANT_ID", "ADDED_AT", "CURRENCY", "QUANTITY", "UNIT_PRICE")
VALUES (:p0, :p1, :p2, :p3, :p4, :p5);

END;
2025-09-05 12:06:12.880 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 12:06:12.884 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 12:06:12.887 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 12:06:12.890 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 12:06:12.891 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Add (PHONE_STORE.API) in 56.3557ms
2025-09-05 12:06:12.892 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Add (PHONE_STORE.API)'
2025-09-05 12:06:12.893 +07:00 [INF] Request finished HTTP/1.1 POST https://localhost:7277/api/shop/cart/items - 200 null application/json; charset=utf-8 61.493ms
2025-09-05 12:06:12.897 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products/iphone-15 - null null
2025-09-05 12:06:12.900 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API)'
2025-09-05 12:06:12.901 +07:00 [INF] Route matched with {action = "Details", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductDetail]] Details(System.String, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 12:06:12.905 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:slug_0='?' (Size = 220)], CommandType='"Text"', CommandTimeout='0']
SELECT "p2"."ID", "p2"."BRAND_ID", "p2"."CREATED_AT", "p2"."DEFAULT_CATEGORY_ID", "p2"."DESCRIPTION", "p2"."IS_ACTIVE", "p2"."NAME", "p2"."SLUG", "p2"."SPEC_JSON", "p0"."ID", "p0"."BARCODE", "p0"."COLOR", "p0"."IS_ACTIVE", "p0"."PRODUCT_ID", "p0"."SKU", "p0"."STORAGE_GB", "p0"."WEIGHT_GRAM", "p1"."ID", "p1"."ALT_TEXT", "p1"."IMAGE_URL", "p1"."IS_PRIMARY", "p1"."PRODUCT_ID", "p1"."SORT_ORDER", "p1"."VARIANT_ID"
FROM (
    SELECT "p"."ID", "p"."BRAND_ID", "p"."CREATED_AT", "p"."DEFAULT_CATEGORY_ID", "p"."DESCRIPTION", "p"."IS_ACTIVE", "p"."NAME", "p"."SLUG", "p"."SPEC_JSON"
    FROM "HEHE"."PRODUCTS" "p"
    WHERE (("p"."SLUG" = :slug_0) AND ("p"."IS_ACTIVE" = 1))
    FETCH FIRST 1 ROWS ONLY
) "p2"
LEFT JOIN "HEHE"."PRODUCT_VARIANTS" "p0" ON "p2"."ID" = "p0"."PRODUCT_ID"
LEFT JOIN "HEHE"."PRODUCT_IMAGES" "p1" ON "p2"."ID" = "p1"."PRODUCT_ID"
ORDER BY "p2"."ID", "p0"."ID"
2025-09-05 12:06:12.909 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."VARIANT_ID" "VariantId", COALESCE((
    SELECT COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")
    FROM "HEHE"."PRODUCT_PRICES" "p0"
    WHERE (((((("p0"."VARIANT_ID" IN (1, 2)) AND ("p0"."STARTS_AT" <= :now_1))) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))) AND ("p"."VARIANT_ID" = "p0"."VARIANT_ID"))
    ORDER BY "p0"."STARTS_AT" DESC
    FETCH FIRST 1 ROWS ONLY), 0.0) "Price"
FROM "HEHE"."PRODUCT_PRICES" "p"
WHERE (((("p"."VARIANT_ID" IN (1, 2)) AND ("p"."STARTS_AT" <= :now_1))) AND ((("p"."ENDS_AT" IS NULL) OR ("p"."ENDS_AT" > :now_2))))
GROUP BY "p"."VARIANT_ID"
2025-09-05 12:06:12.912 +07:00 [INF] Executing OkObjectResult, writing value of type 'PHONE_STORE.API.Controllers.ShopProductsController+ShopProductDetail'.
2025-09-05 12:06:12.915 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API) in 12.5858ms
2025-09-05 12:06:12.916 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API)'
2025-09-05 12:06:12.916 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products/iphone-15 - 200 null application/json; charset=utf-8 19.3789ms
2025-09-05 12:06:12.937 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 12:06:12.940 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 12:06:12.941 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 12:06:12.947 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 12:06:12.950 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 12:06:12.953 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 12:06:12.955 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 12:06:12.956 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 12.2746ms
2025-09-05 12:06:12.963 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 12:06:12.965 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 28.6024ms
2025-09-05 12:06:14.585 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 12:06:14.587 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 12:06:14.588 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 12:06:14.592 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 12:06:14.596 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 12:06:14.599 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 12:06:14.601 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 12:06:14.602 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 11.4296ms
2025-09-05 12:06:14.602 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 12:06:14.603 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 17.9087ms
2025-09-05 12:06:14.622 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 12:06:14.625 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 12:06:14.626 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 12:06:14.631 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 12:06:14.636 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 12:06:14.643 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 12:06:14.647 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 12:06:14.648 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 20.2122ms
2025-09-05 12:06:14.649 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 12:06:14.650 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 27.6625ms
2025-09-05 12:06:16.451 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/me/addresses - null null
2025-09-05 12:06:16.453 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopMeController.MyAddresses (PHONE_STORE.API)'
2025-09-05 12:06:16.453 +07:00 [INF] Route matched with {action = "MyAddresses", controller = "ShopMe"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.Application.Dtos.AddressDto]]] MyAddresses(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopMeController (PHONE_STORE.API).
2025-09-05 12:06:16.456 +07:00 [INF] Executing ObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ProblemDetails'.
2025-09-05 12:06:16.457 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopMeController.MyAddresses (PHONE_STORE.API) in 1.1854ms
2025-09-05 12:06:16.458 +07:00 [INF] Request starting HTTP/1.1 POST https://localhost:7277/api/auth/refresh - application/json; charset=utf-8 null
2025-09-05 12:06:16.459 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopMeController.MyAddresses (PHONE_STORE.API)'
2025-09-05 12:06:16.461 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.AuthController.Refresh (PHONE_STORE.API)'
2025-09-05 12:06:16.461 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/me/addresses - 401 null application/problem+json; charset=utf-8 10.448ms
2025-09-05 12:06:16.462 +07:00 [INF] Route matched with {action = "Refresh", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Refresh(RefreshRequest, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.AuthController (PHONE_STORE.API).
2025-09-05 12:06:16.466 +07:00 [WRN] Refresh denied: invalid/expired/revoked RT
2025-09-05 12:06:16.467 +07:00 [INF] Executing ObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ProblemDetails'.
2025-09-05 12:06:16.468 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.AuthController.Refresh (PHONE_STORE.API) in 2.9127ms
2025-09-05 12:06:16.468 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.AuthController.Refresh (PHONE_STORE.API)'
2025-09-05 12:06:16.469 +07:00 [INF] Request finished HTTP/1.1 POST https://localhost:7277/api/auth/refresh - 401 null application/problem+json; charset=utf-8 11.4462ms
2025-09-05 12:19:41.748 +07:00 [INF] User profile is available. Using 'C:\Users\Administrator\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-09-05 12:19:42.016 +07:00 [INF] Now listening on: https://localhost:7277
2025-09-05 12:19:42.018 +07:00 [INF] Now listening on: http://localhost:5209
2025-09-05 12:19:42.128 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-05 12:19:42.130 +07:00 [INF] Hosting environment: Development
2025-09-05 12:19:42.130 +07:00 [INF] Content root path: C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.API
2025-09-05 12:19:42.503 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/swagger/index.html - null null
2025-09-05 12:19:42.836 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/swagger/index.html - 200 null text/html;charset=utf-8 342.8483ms
2025-09-05 12:19:42.958 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/_framework/aspnetcore-browser-refresh.js - null null
2025-09-05 12:19:43.063 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/_vs/browserLink - null null
2025-09-05 12:19:43.137 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/_framework/aspnetcore-browser-refresh.js - 200 13766 application/javascript; charset=utf-8 179.0548ms
2025-09-05 12:19:43.202 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/_vs/browserLink - 200 null text/javascript; charset=UTF-8 139.4838ms
2025-09-05 12:19:43.369 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/swagger/v1/swagger.json - null null
2025-09-05 12:19:43.471 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 101.7393ms
2025-09-05 12:19:43.587 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - null null
2025-09-05 12:19:43.706 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 12:19:43.737 +07:00 [INF] Route matched with {action = "List", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem]]] List(System.String, System.Nullable`1[System.Int64], Int32, Int32, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 12:19:44.426 +07:00 [WRN] The decimal property 'UnitPrice' on entity type 'CartItem' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 12:19:44.427 +07:00 [WRN] The decimal property 'DiscountTotal' on entity type 'Order' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 12:19:44.429 +07:00 [WRN] The decimal property 'GrandTotal' on entity type 'Order' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 12:19:44.429 +07:00 [WRN] The decimal property 'ShippingFee' on entity type 'Order' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 12:19:44.431 +07:00 [WRN] The decimal property 'Subtotal' on entity type 'Order' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 12:19:44.432 +07:00 [WRN] The decimal property 'TaxTotal' on entity type 'Order' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 12:19:44.434 +07:00 [WRN] The decimal property 'DiscountAmount' on entity type 'OrderItem' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 12:19:44.436 +07:00 [WRN] The decimal property 'TaxAmount' on entity type 'OrderItem' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 12:19:44.438 +07:00 [WRN] The decimal property 'UnitPrice' on entity type 'OrderItem' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 12:19:44.439 +07:00 [WRN] The decimal property 'DecValue' on entity type 'ProductAttributeValue' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 12:19:44.440 +07:00 [WRN] The decimal property 'ListPrice' on entity type 'ProductPrice' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 12:19:44.441 +07:00 [WRN] The decimal property 'SalePrice' on entity type 'ProductPrice' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 12:19:44.443 +07:00 [WRN] The decimal property 'WeightGram' on entity type 'ProductVariant' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 12:19:45.171 +07:00 [INF] Executed DbCommand (102ms) [Parameters=[:p_0='?' (DbType = Int32), :p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."ID" "Id", "p"."NAME" "Name", "p"."SLUG" "Slug"
FROM "HEHE"."PRODUCTS" "p"
WHERE "p"."IS_ACTIVE" = 1
ORDER BY "p"."CREATED_AT" DESC
OFFSET :p_0 ROWS FETCH NEXT :p_1 ROWS ONLY
2025-09-05 12:19:45.301 +07:00 [INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", (
    SELECT "p0"."IMAGE_URL"
    FROM "HEHE"."PRODUCT_IMAGES" "p0"
    WHERE (("p0"."PRODUCT_ID" IS NOT NULL AND "p0"."PRODUCT_ID" IN (3, 2, 1)) AND ("p"."PRODUCT_ID" = "p0"."PRODUCT_ID"))
    ORDER BY "p0"."SORT_ORDER"
    FETCH FIRST 1 ROWS ONLY) "Url"
FROM "HEHE"."PRODUCT_IMAGES" "p"
WHERE "p"."PRODUCT_ID" IS NOT NULL AND "p"."PRODUCT_ID" IN (3, 2, 1)
GROUP BY "p"."PRODUCT_ID"
2025-09-05 12:19:45.345 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", MIN(COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")) "MinPrice"
FROM "HEHE"."PRODUCT_VARIANTS" "p"
INNER JOIN "HEHE"."PRODUCT_PRICES" "p0" ON "p"."ID" = "p0"."VARIANT_ID"
WHERE (("p"."PRODUCT_ID" IN (3, 2, 1)) AND ((("p0"."STARTS_AT" <= :now_1) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))))
GROUP BY "p"."PRODUCT_ID"
2025-09-05 12:19:45.360 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem, PHONE_STORE.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-05 12:19:45.374 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API) in 1633.6094ms
2025-09-05 12:19:45.377 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 12:19:45.384 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - 200 null application/json; charset=utf-8 1799.1381ms
2025-09-05 12:19:45.555 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 12:19:45.564 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 12:19:45.572 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 12:19:45.810 +07:00 [ERR] 2025-09-05 12:19:45.810619 ThreadID:10  (ERROR)   OracleRelationalCommand.ExecuteReaderAsync() :  Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
2025-09-05 12:19:45.813 +07:00 [ERR] Failed executing DbCommand (43ms) [Parameters=[:p0='?' (DbType = DateTime), :p1='?' (Size = 2000), :p2='?' (DbType = Int64), :p3='?' (Size = 64), :p4='?' (Size = 2000), :p5='?' (DbType = DateTime), :cur0='?' (Direction = Output) (DbType = Object)], CommandType='"Text"', CommandTimeout='0']
DECLARE

TYPE "rCARTS_0" IS RECORD
(
"ID" NUMBER(19)
);
TYPE "tCARTS_0" IS TABLE OF "rCARTS_0";
"lCARTS_0" "tCARTS_0";

BEGIN

"lCARTS_0" := "tCARTS_0"();
"lCARTS_0".extend(1);
INSERT INTO "HEHE"."CARTS" ("CREATED_AT", "CURRENCY", "CUSTOMER_ID", "SESSION_TOKEN", "STATUS", "UPDATED_AT")
VALUES (:p0, :p1, :p2, :p3, :p4, :p5)
RETURNING "ID" INTO "lCARTS_0"(1)."ID";
OPEN :cur0 FOR SELECT "lCARTS_0"(1)."ID" FROM DUAL;

END;
2025-09-05 12:19:45.833 +07:00 [ERR] 2025-09-05 12:19:45.833464 ThreadID:10  (ERROR)   OracleExecutionStrategy.ExecuteAsync() :  Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
2025-09-05 12:19:45.846 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'PHONE_STORE.Infrastructure.Data.PhoneDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-09-05 12:19:45.987 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 412.4771ms
2025-09-05 12:19:45.989 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 12:19:45.992 +07:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at PHONE_STORE.Infrastructure.Repositories.CartRepository.EnsureCartId(Nullable`1 customerId, String sessionId, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.Infrastructure\Repositories\CartRepository.cs:line 50
   at PHONE_STORE.Infrastructure.Repositories.CartRepository.GetOrCreateAsync(Nullable`1 customerId, String sessionId, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.Infrastructure\Repositories\CartRepository.cs:line 77
   at lambda_method31(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-05 12:19:46.043 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 500 null application/problem+json; charset=utf-8 488.2258ms
2025-09-05 12:19:49.884 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products/galaxy-s24 - null null
2025-09-05 12:19:49.889 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API)'
2025-09-05 12:19:49.893 +07:00 [INF] Route matched with {action = "Details", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductDetail]] Details(System.String, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 12:19:49.999 +07:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-09-05 12:19:50.041 +07:00 [INF] Executed DbCommand (8ms) [Parameters=[:slug_0='?' (Size = 220)], CommandType='"Text"', CommandTimeout='0']
SELECT "p2"."ID", "p2"."BRAND_ID", "p2"."CREATED_AT", "p2"."DEFAULT_CATEGORY_ID", "p2"."DESCRIPTION", "p2"."IS_ACTIVE", "p2"."NAME", "p2"."SLUG", "p2"."SPEC_JSON", "p0"."ID", "p0"."BARCODE", "p0"."COLOR", "p0"."IS_ACTIVE", "p0"."PRODUCT_ID", "p0"."SKU", "p0"."STORAGE_GB", "p0"."WEIGHT_GRAM", "p1"."ID", "p1"."ALT_TEXT", "p1"."IMAGE_URL", "p1"."IS_PRIMARY", "p1"."PRODUCT_ID", "p1"."SORT_ORDER", "p1"."VARIANT_ID"
FROM (
    SELECT "p"."ID", "p"."BRAND_ID", "p"."CREATED_AT", "p"."DEFAULT_CATEGORY_ID", "p"."DESCRIPTION", "p"."IS_ACTIVE", "p"."NAME", "p"."SLUG", "p"."SPEC_JSON"
    FROM "HEHE"."PRODUCTS" "p"
    WHERE (("p"."SLUG" = :slug_0) AND ("p"."IS_ACTIVE" = 1))
    FETCH FIRST 1 ROWS ONLY
) "p2"
LEFT JOIN "HEHE"."PRODUCT_VARIANTS" "p0" ON "p2"."ID" = "p0"."PRODUCT_ID"
LEFT JOIN "HEHE"."PRODUCT_IMAGES" "p1" ON "p2"."ID" = "p1"."PRODUCT_ID"
ORDER BY "p2"."ID", "p0"."ID"
2025-09-05 12:19:50.091 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."VARIANT_ID" "VariantId", COALESCE((
    SELECT COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")
    FROM "HEHE"."PRODUCT_PRICES" "p0"
    WHERE (((((("p0"."VARIANT_ID" = 3) AND ("p0"."STARTS_AT" <= :now_1))) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))) AND ("p"."VARIANT_ID" = "p0"."VARIANT_ID"))
    ORDER BY "p0"."STARTS_AT" DESC
    FETCH FIRST 1 ROWS ONLY), 0.0) "Price"
FROM "HEHE"."PRODUCT_PRICES" "p"
WHERE (((("p"."VARIANT_ID" = 3) AND ("p"."STARTS_AT" <= :now_1))) AND ((("p"."ENDS_AT" IS NULL) OR ("p"."ENDS_AT" > :now_2))))
GROUP BY "p"."VARIANT_ID"
2025-09-05 12:19:50.098 +07:00 [INF] Executing OkObjectResult, writing value of type 'PHONE_STORE.API.Controllers.ShopProductsController+ShopProductDetail'.
2025-09-05 12:19:50.107 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API) in 212.9694ms
2025-09-05 12:19:50.109 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API)'
2025-09-05 12:19:50.111 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products/galaxy-s24 - 200 null application/json; charset=utf-8 227.3456ms
2025-09-05 12:19:50.144 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 12:19:50.146 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 12:19:50.147 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 12:19:50.166 +07:00 [ERR] 2025-09-05 12:19:50.166359 ThreadID:8   (ERROR)   OracleRelationalCommand.ExecuteReaderAsync() :  Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
2025-09-05 12:19:50.172 +07:00 [ERR] Failed executing DbCommand (9ms) [Parameters=[:p0='?' (DbType = DateTime), :p1='?' (Size = 2000), :p2='?' (DbType = Int64), :p3='?' (Size = 64), :p4='?' (Size = 2000), :p5='?' (DbType = DateTime), :cur0='?' (Direction = Output) (DbType = Object)], CommandType='"Text"', CommandTimeout='0']
DECLARE

TYPE "rCARTS_0" IS RECORD
(
"ID" NUMBER(19)
);
TYPE "tCARTS_0" IS TABLE OF "rCARTS_0";
"lCARTS_0" "tCARTS_0";

BEGIN

"lCARTS_0" := "tCARTS_0"();
"lCARTS_0".extend(1);
INSERT INTO "HEHE"."CARTS" ("CREATED_AT", "CURRENCY", "CUSTOMER_ID", "SESSION_TOKEN", "STATUS", "UPDATED_AT")
VALUES (:p0, :p1, :p2, :p3, :p4, :p5)
RETURNING "ID" INTO "lCARTS_0"(1)."ID";
OPEN :cur0 FOR SELECT "lCARTS_0"(1)."ID" FROM DUAL;

END;
2025-09-05 12:19:50.178 +07:00 [ERR] 2025-09-05 12:19:50.178374 ThreadID:8   (ERROR)   OracleExecutionStrategy.ExecuteAsync() :  Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
2025-09-05 12:19:50.209 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'PHONE_STORE.Infrastructure.Data.PhoneDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-09-05 12:19:50.349 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 197.3951ms
2025-09-05 12:19:50.351 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 12:19:50.353 +07:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at PHONE_STORE.Infrastructure.Repositories.CartRepository.EnsureCartId(Nullable`1 customerId, String sessionId, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.Infrastructure\Repositories\CartRepository.cs:line 50
   at PHONE_STORE.Infrastructure.Repositories.CartRepository.GetOrCreateAsync(Nullable`1 customerId, String sessionId, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.Infrastructure\Repositories\CartRepository.cs:line 77
   at lambda_method31(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-05 12:19:50.385 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 500 null application/problem+json; charset=utf-8 240.6425ms
2025-09-05 12:19:51.297 +07:00 [INF] Request starting HTTP/1.1 POST https://localhost:7277/api/shop/cart/items - application/json; charset=utf-8 null
2025-09-05 12:19:51.303 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Add (PHONE_STORE.API)'
2025-09-05 12:19:51.308 +07:00 [INF] Route matched with {action = "Add", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Add(PHONE_STORE.Application.Dtos.CartItemUpsertDto, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 12:19:51.369 +07:00 [ERR] 2025-09-05 12:19:51.369555 ThreadID:10  (ERROR)   OracleRelationalCommand.ExecuteReaderAsync() :  Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
2025-09-05 12:19:51.372 +07:00 [ERR] Failed executing DbCommand (17ms) [Parameters=[:p0='?' (DbType = DateTime), :p1='?' (Size = 2000), :p2='?' (DbType = Int64), :p3='?' (Size = 64), :p4='?' (Size = 2000), :p5='?' (DbType = DateTime), :cur0='?' (Direction = Output) (DbType = Object)], CommandType='"Text"', CommandTimeout='0']
DECLARE

TYPE "rCARTS_0" IS RECORD
(
"ID" NUMBER(19)
);
TYPE "tCARTS_0" IS TABLE OF "rCARTS_0";
"lCARTS_0" "tCARTS_0";

BEGIN

"lCARTS_0" := "tCARTS_0"();
"lCARTS_0".extend(1);
INSERT INTO "HEHE"."CARTS" ("CREATED_AT", "CURRENCY", "CUSTOMER_ID", "SESSION_TOKEN", "STATUS", "UPDATED_AT")
VALUES (:p0, :p1, :p2, :p3, :p4, :p5)
RETURNING "ID" INTO "lCARTS_0"(1)."ID";
OPEN :cur0 FOR SELECT "lCARTS_0"(1)."ID" FROM DUAL;

END;
2025-09-05 12:19:51.376 +07:00 [ERR] 2025-09-05 12:19:51.376550 ThreadID:10  (ERROR)   OracleExecutionStrategy.ExecuteAsync() :  Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
2025-09-05 12:19:51.381 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'PHONE_STORE.Infrastructure.Data.PhoneDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-09-05 12:19:51.520 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Add (PHONE_STORE.API) in 210.8053ms
2025-09-05 12:19:51.524 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Add (PHONE_STORE.API)'
2025-09-05 12:19:51.526 +07:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at PHONE_STORE.Infrastructure.Repositories.CartRepository.EnsureCartId(Nullable`1 customerId, String sessionId, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.Infrastructure\Repositories\CartRepository.cs:line 50
   at PHONE_STORE.Infrastructure.Repositories.CartRepository.AddOrUpdateItemAsync(Nullable`1 customerId, String sessionId, CartItemUpsertDto dto, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.Infrastructure\Repositories\CartRepository.cs:line 98
   at lambda_method208(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-05 12:19:51.555 +07:00 [INF] Request finished HTTP/1.1 POST https://localhost:7277/api/shop/cart/items - 500 null application/problem+json; charset=utf-8 258.1119ms
2025-09-05 12:19:51.561 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products/galaxy-s24 - null null
2025-09-05 12:19:51.564 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API)'
2025-09-05 12:19:51.565 +07:00 [INF] Route matched with {action = "Details", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductDetail]] Details(System.String, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 12:19:51.574 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:slug_0='?' (Size = 220)], CommandType='"Text"', CommandTimeout='0']
SELECT "p2"."ID", "p2"."BRAND_ID", "p2"."CREATED_AT", "p2"."DEFAULT_CATEGORY_ID", "p2"."DESCRIPTION", "p2"."IS_ACTIVE", "p2"."NAME", "p2"."SLUG", "p2"."SPEC_JSON", "p0"."ID", "p0"."BARCODE", "p0"."COLOR", "p0"."IS_ACTIVE", "p0"."PRODUCT_ID", "p0"."SKU", "p0"."STORAGE_GB", "p0"."WEIGHT_GRAM", "p1"."ID", "p1"."ALT_TEXT", "p1"."IMAGE_URL", "p1"."IS_PRIMARY", "p1"."PRODUCT_ID", "p1"."SORT_ORDER", "p1"."VARIANT_ID"
FROM (
    SELECT "p"."ID", "p"."BRAND_ID", "p"."CREATED_AT", "p"."DEFAULT_CATEGORY_ID", "p"."DESCRIPTION", "p"."IS_ACTIVE", "p"."NAME", "p"."SLUG", "p"."SPEC_JSON"
    FROM "HEHE"."PRODUCTS" "p"
    WHERE (("p"."SLUG" = :slug_0) AND ("p"."IS_ACTIVE" = 1))
    FETCH FIRST 1 ROWS ONLY
) "p2"
LEFT JOIN "HEHE"."PRODUCT_VARIANTS" "p0" ON "p2"."ID" = "p0"."PRODUCT_ID"
LEFT JOIN "HEHE"."PRODUCT_IMAGES" "p1" ON "p2"."ID" = "p1"."PRODUCT_ID"
ORDER BY "p2"."ID", "p0"."ID"
2025-09-05 12:19:51.580 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."VARIANT_ID" "VariantId", COALESCE((
    SELECT COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")
    FROM "HEHE"."PRODUCT_PRICES" "p0"
    WHERE (((((("p0"."VARIANT_ID" = 3) AND ("p0"."STARTS_AT" <= :now_1))) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))) AND ("p"."VARIANT_ID" = "p0"."VARIANT_ID"))
    ORDER BY "p0"."STARTS_AT" DESC
    FETCH FIRST 1 ROWS ONLY), 0.0) "Price"
FROM "HEHE"."PRODUCT_PRICES" "p"
WHERE (((("p"."VARIANT_ID" = 3) AND ("p"."STARTS_AT" <= :now_1))) AND ((("p"."ENDS_AT" IS NULL) OR ("p"."ENDS_AT" > :now_2))))
GROUP BY "p"."VARIANT_ID"
2025-09-05 12:19:51.584 +07:00 [INF] Executing OkObjectResult, writing value of type 'PHONE_STORE.API.Controllers.ShopProductsController+ShopProductDetail'.
2025-09-05 12:19:51.585 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API) in 17.8245ms
2025-09-05 12:19:51.586 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API)'
2025-09-05 12:19:51.587 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products/galaxy-s24 - 200 null application/json; charset=utf-8 25.5992ms
2025-09-05 12:19:51.620 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 12:19:51.622 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 12:19:51.623 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 12:19:51.634 +07:00 [ERR] 2025-09-05 12:19:51.633944 ThreadID:8   (ERROR)   OracleRelationalCommand.ExecuteReaderAsync() :  Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
2025-09-05 12:19:51.638 +07:00 [ERR] Failed executing DbCommand (10ms) [Parameters=[:p0='?' (DbType = DateTime), :p1='?' (Size = 2000), :p2='?' (DbType = Int64), :p3='?' (Size = 64), :p4='?' (Size = 2000), :p5='?' (DbType = DateTime), :cur0='?' (Direction = Output) (DbType = Object)], CommandType='"Text"', CommandTimeout='0']
DECLARE

TYPE "rCARTS_0" IS RECORD
(
"ID" NUMBER(19)
);
TYPE "tCARTS_0" IS TABLE OF "rCARTS_0";
"lCARTS_0" "tCARTS_0";

BEGIN

"lCARTS_0" := "tCARTS_0"();
"lCARTS_0".extend(1);
INSERT INTO "HEHE"."CARTS" ("CREATED_AT", "CURRENCY", "CUSTOMER_ID", "SESSION_TOKEN", "STATUS", "UPDATED_AT")
VALUES (:p0, :p1, :p2, :p3, :p4, :p5)
RETURNING "ID" INTO "lCARTS_0"(1)."ID";
OPEN :cur0 FOR SELECT "lCARTS_0"(1)."ID" FROM DUAL;

END;
2025-09-05 12:19:51.646 +07:00 [ERR] 2025-09-05 12:19:51.646575 ThreadID:8   (ERROR)   OracleExecutionStrategy.ExecuteAsync() :  Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
2025-09-05 12:19:51.655 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'PHONE_STORE.Infrastructure.Data.PhoneDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-09-05 12:19:51.850 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 225.0403ms
2025-09-05 12:19:51.851 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 12:19:51.853 +07:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at PHONE_STORE.Infrastructure.Repositories.CartRepository.EnsureCartId(Nullable`1 customerId, String sessionId, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.Infrastructure\Repositories\CartRepository.cs:line 50
   at PHONE_STORE.Infrastructure.Repositories.CartRepository.GetOrCreateAsync(Nullable`1 customerId, String sessionId, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.Infrastructure\Repositories\CartRepository.cs:line 77
   at lambda_method31(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-05 12:19:51.882 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 500 null application/problem+json; charset=utf-8 262.762ms
2025-09-05 12:19:53.977 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 12:19:53.980 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 12:19:53.980 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 12:19:53.988 +07:00 [ERR] 2025-09-05 12:19:53.988066 ThreadID:8   (ERROR)   OracleRelationalCommand.ExecuteReaderAsync() :  Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
2025-09-05 12:19:53.990 +07:00 [ERR] Failed executing DbCommand (5ms) [Parameters=[:p0='?' (DbType = DateTime), :p1='?' (Size = 2000), :p2='?' (DbType = Int64), :p3='?' (Size = 64), :p4='?' (Size = 2000), :p5='?' (DbType = DateTime), :cur0='?' (Direction = Output) (DbType = Object)], CommandType='"Text"', CommandTimeout='0']
DECLARE

TYPE "rCARTS_0" IS RECORD
(
"ID" NUMBER(19)
);
TYPE "tCARTS_0" IS TABLE OF "rCARTS_0";
"lCARTS_0" "tCARTS_0";

BEGIN

"lCARTS_0" := "tCARTS_0"();
"lCARTS_0".extend(1);
INSERT INTO "HEHE"."CARTS" ("CREATED_AT", "CURRENCY", "CUSTOMER_ID", "SESSION_TOKEN", "STATUS", "UPDATED_AT")
VALUES (:p0, :p1, :p2, :p3, :p4, :p5)
RETURNING "ID" INTO "lCARTS_0"(1)."ID";
OPEN :cur0 FOR SELECT "lCARTS_0"(1)."ID" FROM DUAL;

END;
2025-09-05 12:19:53.993 +07:00 [ERR] 2025-09-05 12:19:53.993574 ThreadID:8   (ERROR)   OracleExecutionStrategy.ExecuteAsync() :  Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
2025-09-05 12:19:53.998 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'PHONE_STORE.Infrastructure.Data.PhoneDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-09-05 12:19:54.123 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 141.3712ms
2025-09-05 12:19:54.126 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 12:19:54.128 +07:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at PHONE_STORE.Infrastructure.Repositories.CartRepository.EnsureCartId(Nullable`1 customerId, String sessionId, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.Infrastructure\Repositories\CartRepository.cs:line 50
   at PHONE_STORE.Infrastructure.Repositories.CartRepository.GetOrCreateAsync(Nullable`1 customerId, String sessionId, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.Infrastructure\Repositories\CartRepository.cs:line 77
   at lambda_method31(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-05 12:19:54.146 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 500 null application/problem+json; charset=utf-8 169.6983ms
2025-09-05 13:56:12.371 +07:00 [INF] User profile is available. Using 'C:\Users\Administrator\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-09-05 13:56:12.771 +07:00 [INF] Now listening on: https://localhost:7277
2025-09-05 13:56:12.774 +07:00 [INF] Now listening on: http://localhost:5209
2025-09-05 13:56:12.872 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-05 13:56:12.873 +07:00 [INF] Hosting environment: Development
2025-09-05 13:56:12.874 +07:00 [INF] Content root path: C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.API
2025-09-05 13:56:14.207 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/swagger/index.html - null null
2025-09-05 13:56:14.651 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/swagger/index.html - 200 null text/html;charset=utf-8 455.7622ms
2025-09-05 13:56:14.671 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/_framework/aspnetcore-browser-refresh.js - null null
2025-09-05 13:56:14.671 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/_vs/browserLink - null null
2025-09-05 13:56:14.726 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/_framework/aspnetcore-browser-refresh.js - 200 13766 application/javascript; charset=utf-8 55.0223ms
2025-09-05 13:56:14.824 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/_vs/browserLink - 200 null text/javascript; charset=UTF-8 152.2542ms
2025-09-05 13:56:14.829 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - null null
2025-09-05 13:56:14.875 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/swagger/v1/swagger.json - null null
2025-09-05 13:56:14.909 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 13:56:14.957 +07:00 [INF] Route matched with {action = "List", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem]]] List(System.String, System.Nullable`1[System.Int64], Int32, Int32, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 13:56:14.974 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 99.1813ms
2025-09-05 13:56:15.816 +07:00 [WRN] The decimal property 'UnitPrice' on entity type 'CartItem' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 13:56:15.818 +07:00 [WRN] The decimal property 'DiscountTotal' on entity type 'Order' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 13:56:15.819 +07:00 [WRN] The decimal property 'GrandTotal' on entity type 'Order' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 13:56:15.821 +07:00 [WRN] The decimal property 'ShippingFee' on entity type 'Order' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 13:56:15.822 +07:00 [WRN] The decimal property 'Subtotal' on entity type 'Order' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 13:56:15.823 +07:00 [WRN] The decimal property 'TaxTotal' on entity type 'Order' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 13:56:15.824 +07:00 [WRN] The decimal property 'DiscountAmount' on entity type 'OrderItem' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 13:56:15.825 +07:00 [WRN] The decimal property 'TaxAmount' on entity type 'OrderItem' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 13:56:15.826 +07:00 [WRN] The decimal property 'UnitPrice' on entity type 'OrderItem' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 13:56:15.827 +07:00 [WRN] The decimal property 'DecValue' on entity type 'ProductAttributeValue' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 13:56:15.828 +07:00 [WRN] The decimal property 'ListPrice' on entity type 'ProductPrice' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 13:56:15.829 +07:00 [WRN] The decimal property 'SalePrice' on entity type 'ProductPrice' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 13:56:15.829 +07:00 [WRN] The decimal property 'WeightGram' on entity type 'ProductVariant' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 13:56:16.646 +07:00 [INF] Executed DbCommand (130ms) [Parameters=[:p_0='?' (DbType = Int32), :p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."ID" "Id", "p"."NAME" "Name", "p"."SLUG" "Slug"
FROM "HEHE"."PRODUCTS" "p"
WHERE "p"."IS_ACTIVE" = 1
ORDER BY "p"."CREATED_AT" DESC
OFFSET :p_0 ROWS FETCH NEXT :p_1 ROWS ONLY
2025-09-05 13:56:16.841 +07:00 [INF] Executed DbCommand (11ms) [Parameters=[], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", (
    SELECT "p0"."IMAGE_URL"
    FROM "HEHE"."PRODUCT_IMAGES" "p0"
    WHERE (("p0"."PRODUCT_ID" IS NOT NULL AND "p0"."PRODUCT_ID" IN (3, 2, 1)) AND ("p"."PRODUCT_ID" = "p0"."PRODUCT_ID"))
    ORDER BY "p0"."SORT_ORDER"
    FETCH FIRST 1 ROWS ONLY) "Url"
FROM "HEHE"."PRODUCT_IMAGES" "p"
WHERE "p"."PRODUCT_ID" IS NOT NULL AND "p"."PRODUCT_ID" IN (3, 2, 1)
GROUP BY "p"."PRODUCT_ID"
2025-09-05 13:56:16.906 +07:00 [INF] Executed DbCommand (12ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", MIN(COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")) "MinPrice"
FROM "HEHE"."PRODUCT_VARIANTS" "p"
INNER JOIN "HEHE"."PRODUCT_PRICES" "p0" ON "p"."ID" = "p0"."VARIANT_ID"
WHERE (("p"."PRODUCT_ID" IN (3, 2, 1)) AND ((("p0"."STARTS_AT" <= :now_1) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))))
GROUP BY "p"."PRODUCT_ID"
2025-09-05 13:56:16.923 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem, PHONE_STORE.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-05 13:56:16.944 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API) in 1970.2451ms
2025-09-05 13:56:16.946 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 13:56:16.955 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - 200 null application/json; charset=utf-8 2128.5073ms
2025-09-05 13:56:17.129 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 13:56:17.134 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 13:56:17.138 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 13:56:17.501 +07:00 [ERR] 2025-09-05 13:56:17.500900 ThreadID:5   (ERROR)   OracleRelationalCommand.ExecuteReaderAsync() :  Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
2025-09-05 13:56:17.503 +07:00 [ERR] Failed executing DbCommand (105ms) [Parameters=[:p0='?' (DbType = DateTime), :p1='?' (Size = 2000), :p2='?' (DbType = Int64), :p3='?' (Size = 64), :p4='?' (Size = 2000), :p5='?' (DbType = DateTime), :cur0='?' (Direction = Output) (DbType = Object)], CommandType='"Text"', CommandTimeout='0']
DECLARE

TYPE "rCARTS_0" IS RECORD
(
"ID" NUMBER(19)
);
TYPE "tCARTS_0" IS TABLE OF "rCARTS_0";
"lCARTS_0" "tCARTS_0";

BEGIN

"lCARTS_0" := "tCARTS_0"();
"lCARTS_0".extend(1);
INSERT INTO "HEHE"."CARTS" ("CREATED_AT", "CURRENCY", "CUSTOMER_ID", "SESSION_TOKEN", "STATUS", "UPDATED_AT")
VALUES (:p0, :p1, :p2, :p3, :p4, :p5)
RETURNING "ID" INTO "lCARTS_0"(1)."ID";
OPEN :cur0 FOR SELECT "lCARTS_0"(1)."ID" FROM DUAL;

END;
2025-09-05 13:56:17.523 +07:00 [ERR] 2025-09-05 13:56:17.523182 ThreadID:5   (ERROR)   OracleExecutionStrategy.ExecuteAsync() :  Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
2025-09-05 13:56:17.531 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'PHONE_STORE.Infrastructure.Data.PhoneDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-09-05 13:56:17.652 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 512.581ms
2025-09-05 13:56:17.655 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 13:56:17.658 +07:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at PHONE_STORE.Infrastructure.Repositories.CartRepository.EnsureCartId(Nullable`1 customerId, String sessionId, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.Infrastructure\Repositories\CartRepository.cs:line 50
   at PHONE_STORE.Infrastructure.Repositories.CartRepository.GetOrCreateAsync(Nullable`1 customerId, String sessionId, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.Infrastructure\Repositories\CartRepository.cs:line 77
   at lambda_method31(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-05 13:56:17.686 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 500 null application/problem+json; charset=utf-8 557.2612ms
2025-09-05 13:56:21.401 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 13:56:21.406 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 13:56:21.408 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 13:56:21.450 +07:00 [ERR] 2025-09-05 13:56:21.450479 ThreadID:9   (ERROR)   OracleRelationalCommand.ExecuteReaderAsync() :  Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
2025-09-05 13:56:21.452 +07:00 [ERR] Failed executing DbCommand (7ms) [Parameters=[:p0='?' (DbType = DateTime), :p1='?' (Size = 2000), :p2='?' (DbType = Int64), :p3='?' (Size = 64), :p4='?' (Size = 2000), :p5='?' (DbType = DateTime), :cur0='?' (Direction = Output) (DbType = Object)], CommandType='"Text"', CommandTimeout='0']
DECLARE

TYPE "rCARTS_0" IS RECORD
(
"ID" NUMBER(19)
);
TYPE "tCARTS_0" IS TABLE OF "rCARTS_0";
"lCARTS_0" "tCARTS_0";

BEGIN

"lCARTS_0" := "tCARTS_0"();
"lCARTS_0".extend(1);
INSERT INTO "HEHE"."CARTS" ("CREATED_AT", "CURRENCY", "CUSTOMER_ID", "SESSION_TOKEN", "STATUS", "UPDATED_AT")
VALUES (:p0, :p1, :p2, :p3, :p4, :p5)
RETURNING "ID" INTO "lCARTS_0"(1)."ID";
OPEN :cur0 FOR SELECT "lCARTS_0"(1)."ID" FROM DUAL;

END;
2025-09-05 13:56:21.458 +07:00 [ERR] 2025-09-05 13:56:21.458548 ThreadID:9   (ERROR)   OracleExecutionStrategy.ExecuteAsync() :  Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
2025-09-05 13:56:21.463 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'PHONE_STORE.Infrastructure.Data.PhoneDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-09-05 13:56:21.602 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 190.5975ms
2025-09-05 13:56:21.604 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 13:56:21.606 +07:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at PHONE_STORE.Infrastructure.Repositories.CartRepository.EnsureCartId(Nullable`1 customerId, String sessionId, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.Infrastructure\Repositories\CartRepository.cs:line 50
   at PHONE_STORE.Infrastructure.Repositories.CartRepository.GetOrCreateAsync(Nullable`1 customerId, String sessionId, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.Infrastructure\Repositories\CartRepository.cs:line 77
   at lambda_method31(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-05 13:56:21.631 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 500 null application/problem+json; charset=utf-8 229.7315ms
2025-09-05 13:56:27.005 +07:00 [INF] Request starting HTTP/1.1 POST https://localhost:7277/api/auth/login - application/json; charset=utf-8 null
2025-09-05 13:56:27.018 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.AuthController.Login (PHONE_STORE.API)'
2025-09-05 13:56:27.027 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(LoginRequest, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.AuthController (PHONE_STORE.API).
2025-09-05 13:56:27.374 +07:00 [INF] Executed DbCommand (9ms) [Parameters=[:uname_0='?' (Size = 450), :username_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='0']
SELECT "u"."ID", "u"."CREATED_AT", "u"."EMAIL", "u"."PASSWORD_HASH", "u"."PHONE", "u"."STATUS"
FROM "USER_ACCOUNTS" "u"
WHERE (("u"."EMAIL" = :uname_0) OR ("u"."PHONE" = :username_1))
FETCH FIRST 1 ROWS ONLY
2025-09-05 13:56:27.905 +07:00 [INF] Executed DbCommand (20ms) [Parameters=[:userId_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "r"."CODE"
FROM "USER_ROLES" "u"
INNER JOIN "ROLES" "r" ON "u"."ROLE_ID" = "r"."ID"
WHERE "u"."USER_ID" = :userId_0
2025-09-05 13:56:27.999 +07:00 [INF] Login success [21]
2025-09-05 13:56:28.008 +07:00 [INF] Executing OkObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.AuthResponseDto'.
2025-09-05 13:56:28.012 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.AuthController.Login (PHONE_STORE.API) in 981.3915ms
2025-09-05 13:56:28.014 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.AuthController.Login (PHONE_STORE.API)'
2025-09-05 13:56:28.015 +07:00 [INF] Request finished HTTP/1.1 POST https://localhost:7277/api/auth/login - 200 null application/json; charset=utf-8 1009.5056ms
2025-09-05 13:56:28.051 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - null null
2025-09-05 13:56:28.105 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 13:56:28.107 +07:00 [INF] Route matched with {action = "List", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem]]] List(System.String, System.Nullable`1[System.Int64], Int32, Int32, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 13:56:28.125 +07:00 [INF] Executed DbCommand (7ms) [Parameters=[:p_0='?' (DbType = Int32), :p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."ID" "Id", "p"."NAME" "Name", "p"."SLUG" "Slug"
FROM "HEHE"."PRODUCTS" "p"
WHERE "p"."IS_ACTIVE" = 1
ORDER BY "p"."CREATED_AT" DESC
OFFSET :p_0 ROWS FETCH NEXT :p_1 ROWS ONLY
2025-09-05 13:56:28.131 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", (
    SELECT "p0"."IMAGE_URL"
    FROM "HEHE"."PRODUCT_IMAGES" "p0"
    WHERE (("p0"."PRODUCT_ID" IS NOT NULL AND "p0"."PRODUCT_ID" IN (3, 2, 1)) AND ("p"."PRODUCT_ID" = "p0"."PRODUCT_ID"))
    ORDER BY "p0"."SORT_ORDER"
    FETCH FIRST 1 ROWS ONLY) "Url"
FROM "HEHE"."PRODUCT_IMAGES" "p"
WHERE "p"."PRODUCT_ID" IS NOT NULL AND "p"."PRODUCT_ID" IN (3, 2, 1)
GROUP BY "p"."PRODUCT_ID"
2025-09-05 13:56:28.137 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", MIN(COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")) "MinPrice"
FROM "HEHE"."PRODUCT_VARIANTS" "p"
INNER JOIN "HEHE"."PRODUCT_PRICES" "p0" ON "p"."ID" = "p0"."VARIANT_ID"
WHERE (("p"."PRODUCT_ID" IN (3, 2, 1)) AND ((("p0"."STARTS_AT" <= :now_1) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))))
GROUP BY "p"."PRODUCT_ID"
2025-09-05 13:56:28.139 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem, PHONE_STORE.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-05 13:56:28.140 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API) in 28.7414ms
2025-09-05 13:56:28.141 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 13:56:28.142 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - 200 null application/json; charset=utf-8 90.6817ms
2025-09-05 13:56:28.178 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 13:56:28.182 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 13:56:28.183 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 13:56:28.209 +07:00 [ERR] 2025-09-05 13:56:28.209181 ThreadID:14  (ERROR)   OracleRelationalCommand.ExecuteReaderAsync() :  Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
2025-09-05 13:56:28.212 +07:00 [ERR] Failed executing DbCommand (12ms) [Parameters=[:p0='?' (DbType = DateTime), :p1='?' (Size = 2000), :p2='?' (DbType = Int64), :p3='?' (Size = 64), :p4='?' (Size = 2000), :p5='?' (DbType = DateTime), :cur0='?' (Direction = Output) (DbType = Object)], CommandType='"Text"', CommandTimeout='0']
DECLARE

TYPE "rCARTS_0" IS RECORD
(
"ID" NUMBER(19)
);
TYPE "tCARTS_0" IS TABLE OF "rCARTS_0";
"lCARTS_0" "tCARTS_0";

BEGIN

"lCARTS_0" := "tCARTS_0"();
"lCARTS_0".extend(1);
INSERT INTO "HEHE"."CARTS" ("CREATED_AT", "CURRENCY", "CUSTOMER_ID", "SESSION_TOKEN", "STATUS", "UPDATED_AT")
VALUES (:p0, :p1, :p2, :p3, :p4, :p5)
RETURNING "ID" INTO "lCARTS_0"(1)."ID";
OPEN :cur0 FOR SELECT "lCARTS_0"(1)."ID" FROM DUAL;

END;
2025-09-05 13:56:28.221 +07:00 [ERR] 2025-09-05 13:56:28.221283 ThreadID:14  (ERROR)   OracleExecutionStrategy.ExecuteAsync() :  Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
2025-09-05 13:56:28.227 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'PHONE_STORE.Infrastructure.Data.PhoneDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-09-05 13:56:28.348 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 162.1956ms
2025-09-05 13:56:28.350 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 13:56:28.352 +07:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at PHONE_STORE.Infrastructure.Repositories.CartRepository.EnsureCartId(Nullable`1 customerId, String sessionId, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.Infrastructure\Repositories\CartRepository.cs:line 50
   at PHONE_STORE.Infrastructure.Repositories.CartRepository.GetOrCreateAsync(Nullable`1 customerId, String sessionId, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.Infrastructure\Repositories\CartRepository.cs:line 77
   at lambda_method31(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-05 13:56:28.369 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 500 null application/problem+json; charset=utf-8 190.828ms
2025-09-05 13:56:30.458 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products/galaxy-s24 - null null
2025-09-05 13:56:30.462 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API)'
2025-09-05 13:56:30.466 +07:00 [INF] Route matched with {action = "Details", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductDetail]] Details(System.String, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 13:56:30.513 +07:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-09-05 13:56:30.540 +07:00 [INF] Executed DbCommand (8ms) [Parameters=[:slug_0='?' (Size = 220)], CommandType='"Text"', CommandTimeout='0']
SELECT "p2"."ID", "p2"."BRAND_ID", "p2"."CREATED_AT", "p2"."DEFAULT_CATEGORY_ID", "p2"."DESCRIPTION", "p2"."IS_ACTIVE", "p2"."NAME", "p2"."SLUG", "p2"."SPEC_JSON", "p0"."ID", "p0"."BARCODE", "p0"."COLOR", "p0"."IS_ACTIVE", "p0"."PRODUCT_ID", "p0"."SKU", "p0"."STORAGE_GB", "p0"."WEIGHT_GRAM", "p1"."ID", "p1"."ALT_TEXT", "p1"."IMAGE_URL", "p1"."IS_PRIMARY", "p1"."PRODUCT_ID", "p1"."SORT_ORDER", "p1"."VARIANT_ID"
FROM (
    SELECT "p"."ID", "p"."BRAND_ID", "p"."CREATED_AT", "p"."DEFAULT_CATEGORY_ID", "p"."DESCRIPTION", "p"."IS_ACTIVE", "p"."NAME", "p"."SLUG", "p"."SPEC_JSON"
    FROM "HEHE"."PRODUCTS" "p"
    WHERE (("p"."SLUG" = :slug_0) AND ("p"."IS_ACTIVE" = 1))
    FETCH FIRST 1 ROWS ONLY
) "p2"
LEFT JOIN "HEHE"."PRODUCT_VARIANTS" "p0" ON "p2"."ID" = "p0"."PRODUCT_ID"
LEFT JOIN "HEHE"."PRODUCT_IMAGES" "p1" ON "p2"."ID" = "p1"."PRODUCT_ID"
ORDER BY "p2"."ID", "p0"."ID"
2025-09-05 13:56:30.610 +07:00 [INF] Executed DbCommand (21ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."VARIANT_ID" "VariantId", COALESCE((
    SELECT COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")
    FROM "HEHE"."PRODUCT_PRICES" "p0"
    WHERE (((((("p0"."VARIANT_ID" = 3) AND ("p0"."STARTS_AT" <= :now_1))) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))) AND ("p"."VARIANT_ID" = "p0"."VARIANT_ID"))
    ORDER BY "p0"."STARTS_AT" DESC
    FETCH FIRST 1 ROWS ONLY), 0.0) "Price"
FROM "HEHE"."PRODUCT_PRICES" "p"
WHERE (((("p"."VARIANT_ID" = 3) AND ("p"."STARTS_AT" <= :now_1))) AND ((("p"."ENDS_AT" IS NULL) OR ("p"."ENDS_AT" > :now_2))))
GROUP BY "p"."VARIANT_ID"
2025-09-05 13:56:30.619 +07:00 [INF] Executing OkObjectResult, writing value of type 'PHONE_STORE.API.Controllers.ShopProductsController+ShopProductDetail'.
2025-09-05 13:56:30.627 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API) in 160.2631ms
2025-09-05 13:56:30.630 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API)'
2025-09-05 13:56:30.631 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products/galaxy-s24 - 200 null application/json; charset=utf-8 173.2442ms
2025-09-05 13:56:30.664 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 13:56:30.666 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 13:56:30.667 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 13:56:30.678 +07:00 [ERR] 2025-09-05 13:56:30.677962 ThreadID:5   (ERROR)   OracleRelationalCommand.ExecuteReaderAsync() :  Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
2025-09-05 13:56:30.679 +07:00 [ERR] Failed executing DbCommand (6ms) [Parameters=[:p0='?' (DbType = DateTime), :p1='?' (Size = 2000), :p2='?' (DbType = Int64), :p3='?' (Size = 64), :p4='?' (Size = 2000), :p5='?' (DbType = DateTime), :cur0='?' (Direction = Output) (DbType = Object)], CommandType='"Text"', CommandTimeout='0']
DECLARE

TYPE "rCARTS_0" IS RECORD
(
"ID" NUMBER(19)
);
TYPE "tCARTS_0" IS TABLE OF "rCARTS_0";
"lCARTS_0" "tCARTS_0";

BEGIN

"lCARTS_0" := "tCARTS_0"();
"lCARTS_0".extend(1);
INSERT INTO "HEHE"."CARTS" ("CREATED_AT", "CURRENCY", "CUSTOMER_ID", "SESSION_TOKEN", "STATUS", "UPDATED_AT")
VALUES (:p0, :p1, :p2, :p3, :p4, :p5)
RETURNING "ID" INTO "lCARTS_0"(1)."ID";
OPEN :cur0 FOR SELECT "lCARTS_0"(1)."ID" FROM DUAL;

END;
2025-09-05 13:56:30.683 +07:00 [ERR] 2025-09-05 13:56:30.683041 ThreadID:5   (ERROR)   OracleExecutionStrategy.ExecuteAsync() :  Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
2025-09-05 13:56:30.687 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'PHONE_STORE.Infrastructure.Data.PhoneDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-09-05 13:56:30.792 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 123.9457ms
2025-09-05 13:56:30.794 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 13:56:30.795 +07:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at PHONE_STORE.Infrastructure.Repositories.CartRepository.EnsureCartId(Nullable`1 customerId, String sessionId, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.Infrastructure\Repositories\CartRepository.cs:line 50
   at PHONE_STORE.Infrastructure.Repositories.CartRepository.GetOrCreateAsync(Nullable`1 customerId, String sessionId, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.Infrastructure\Repositories\CartRepository.cs:line 77
   at lambda_method31(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-05 13:56:30.810 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 500 null application/problem+json; charset=utf-8 146.5225ms
2025-09-05 13:56:32.078 +07:00 [INF] Request starting HTTP/1.1 POST https://localhost:7277/api/shop/cart/items - application/json; charset=utf-8 null
2025-09-05 13:56:32.081 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Add (PHONE_STORE.API)'
2025-09-05 13:56:32.084 +07:00 [INF] Route matched with {action = "Add", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Add(PHONE_STORE.Application.Dtos.CartItemUpsertDto, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 13:56:32.102 +07:00 [ERR] 2025-09-05 13:56:32.102035 ThreadID:9   (ERROR)   OracleRelationalCommand.ExecuteReaderAsync() :  Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
2025-09-05 13:56:32.103 +07:00 [ERR] Failed executing DbCommand (4ms) [Parameters=[:p0='?' (DbType = DateTime), :p1='?' (Size = 2000), :p2='?' (DbType = Int64), :p3='?' (Size = 64), :p4='?' (Size = 2000), :p5='?' (DbType = DateTime), :cur0='?' (Direction = Output) (DbType = Object)], CommandType='"Text"', CommandTimeout='0']
DECLARE

TYPE "rCARTS_0" IS RECORD
(
"ID" NUMBER(19)
);
TYPE "tCARTS_0" IS TABLE OF "rCARTS_0";
"lCARTS_0" "tCARTS_0";

BEGIN

"lCARTS_0" := "tCARTS_0"();
"lCARTS_0".extend(1);
INSERT INTO "HEHE"."CARTS" ("CREATED_AT", "CURRENCY", "CUSTOMER_ID", "SESSION_TOKEN", "STATUS", "UPDATED_AT")
VALUES (:p0, :p1, :p2, :p3, :p4, :p5)
RETURNING "ID" INTO "lCARTS_0"(1)."ID";
OPEN :cur0 FOR SELECT "lCARTS_0"(1)."ID" FROM DUAL;

END;
2025-09-05 13:56:32.106 +07:00 [ERR] 2025-09-05 13:56:32.106800 ThreadID:9   (ERROR)   OracleExecutionStrategy.ExecuteAsync() :  Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
2025-09-05 13:56:32.110 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'PHONE_STORE.Infrastructure.Data.PhoneDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-09-05 13:56:32.225 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Add (PHONE_STORE.API) in 138.8764ms
2025-09-05 13:56:32.226 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Add (PHONE_STORE.API)'
2025-09-05 13:56:32.227 +07:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at PHONE_STORE.Infrastructure.Repositories.CartRepository.EnsureCartId(Nullable`1 customerId, String sessionId, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.Infrastructure\Repositories\CartRepository.cs:line 50
   at PHONE_STORE.Infrastructure.Repositories.CartRepository.AddOrUpdateItemAsync(Nullable`1 customerId, String sessionId, CartItemUpsertDto dto, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.Infrastructure\Repositories\CartRepository.cs:line 98
   at lambda_method264(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-05 13:56:32.248 +07:00 [INF] Request finished HTTP/1.1 POST https://localhost:7277/api/shop/cart/items - 500 null application/problem+json; charset=utf-8 170.0116ms
2025-09-05 13:56:32.253 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products/galaxy-s24 - null null
2025-09-05 13:56:32.255 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API)'
2025-09-05 13:56:32.255 +07:00 [INF] Route matched with {action = "Details", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductDetail]] Details(System.String, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 13:56:32.260 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:slug_0='?' (Size = 220)], CommandType='"Text"', CommandTimeout='0']
SELECT "p2"."ID", "p2"."BRAND_ID", "p2"."CREATED_AT", "p2"."DEFAULT_CATEGORY_ID", "p2"."DESCRIPTION", "p2"."IS_ACTIVE", "p2"."NAME", "p2"."SLUG", "p2"."SPEC_JSON", "p0"."ID", "p0"."BARCODE", "p0"."COLOR", "p0"."IS_ACTIVE", "p0"."PRODUCT_ID", "p0"."SKU", "p0"."STORAGE_GB", "p0"."WEIGHT_GRAM", "p1"."ID", "p1"."ALT_TEXT", "p1"."IMAGE_URL", "p1"."IS_PRIMARY", "p1"."PRODUCT_ID", "p1"."SORT_ORDER", "p1"."VARIANT_ID"
FROM (
    SELECT "p"."ID", "p"."BRAND_ID", "p"."CREATED_AT", "p"."DEFAULT_CATEGORY_ID", "p"."DESCRIPTION", "p"."IS_ACTIVE", "p"."NAME", "p"."SLUG", "p"."SPEC_JSON"
    FROM "HEHE"."PRODUCTS" "p"
    WHERE (("p"."SLUG" = :slug_0) AND ("p"."IS_ACTIVE" = 1))
    FETCH FIRST 1 ROWS ONLY
) "p2"
LEFT JOIN "HEHE"."PRODUCT_VARIANTS" "p0" ON "p2"."ID" = "p0"."PRODUCT_ID"
LEFT JOIN "HEHE"."PRODUCT_IMAGES" "p1" ON "p2"."ID" = "p1"."PRODUCT_ID"
ORDER BY "p2"."ID", "p0"."ID"
2025-09-05 13:56:32.275 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."VARIANT_ID" "VariantId", COALESCE((
    SELECT COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")
    FROM "HEHE"."PRODUCT_PRICES" "p0"
    WHERE (((((("p0"."VARIANT_ID" = 3) AND ("p0"."STARTS_AT" <= :now_1))) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))) AND ("p"."VARIANT_ID" = "p0"."VARIANT_ID"))
    ORDER BY "p0"."STARTS_AT" DESC
    FETCH FIRST 1 ROWS ONLY), 0.0) "Price"
FROM "HEHE"."PRODUCT_PRICES" "p"
WHERE (((("p"."VARIANT_ID" = 3) AND ("p"."STARTS_AT" <= :now_1))) AND ((("p"."ENDS_AT" IS NULL) OR ("p"."ENDS_AT" > :now_2))))
GROUP BY "p"."VARIANT_ID"
2025-09-05 13:56:32.277 +07:00 [INF] Executing OkObjectResult, writing value of type 'PHONE_STORE.API.Controllers.ShopProductsController+ShopProductDetail'.
2025-09-05 13:56:32.277 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API) in 20.2056ms
2025-09-05 13:56:32.278 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API)'
2025-09-05 13:56:32.279 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products/galaxy-s24 - 200 null application/json; charset=utf-8 25.7076ms
2025-09-05 13:56:32.297 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 13:56:32.300 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 13:56:32.300 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 13:56:32.309 +07:00 [ERR] 2025-09-05 13:56:32.309334 ThreadID:5   (ERROR)   OracleRelationalCommand.ExecuteReaderAsync() :  Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
2025-09-05 13:56:32.311 +07:00 [ERR] Failed executing DbCommand (6ms) [Parameters=[:p0='?' (DbType = DateTime), :p1='?' (Size = 2000), :p2='?' (DbType = Int64), :p3='?' (Size = 64), :p4='?' (Size = 2000), :p5='?' (DbType = DateTime), :cur0='?' (Direction = Output) (DbType = Object)], CommandType='"Text"', CommandTimeout='0']
DECLARE

TYPE "rCARTS_0" IS RECORD
(
"ID" NUMBER(19)
);
TYPE "tCARTS_0" IS TABLE OF "rCARTS_0";
"lCARTS_0" "tCARTS_0";

BEGIN

"lCARTS_0" := "tCARTS_0"();
"lCARTS_0".extend(1);
INSERT INTO "HEHE"."CARTS" ("CREATED_AT", "CURRENCY", "CUSTOMER_ID", "SESSION_TOKEN", "STATUS", "UPDATED_AT")
VALUES (:p0, :p1, :p2, :p3, :p4, :p5)
RETURNING "ID" INTO "lCARTS_0"(1)."ID";
OPEN :cur0 FOR SELECT "lCARTS_0"(1)."ID" FROM DUAL;

END;
2025-09-05 13:56:32.316 +07:00 [ERR] 2025-09-05 13:56:32.316352 ThreadID:5   (ERROR)   OracleExecutionStrategy.ExecuteAsync() :  Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
2025-09-05 13:56:32.320 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'PHONE_STORE.Infrastructure.Data.PhoneDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-09-05 13:56:32.419 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 116.6156ms
2025-09-05 13:56:32.421 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 13:56:32.422 +07:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at PHONE_STORE.Infrastructure.Repositories.CartRepository.EnsureCartId(Nullable`1 customerId, String sessionId, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.Infrastructure\Repositories\CartRepository.cs:line 50
   at PHONE_STORE.Infrastructure.Repositories.CartRepository.GetOrCreateAsync(Nullable`1 customerId, String sessionId, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.Infrastructure\Repositories\CartRepository.cs:line 77
   at lambda_method31(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-05 13:56:32.442 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 500 null application/problem+json; charset=utf-8 144.9471ms
2025-09-05 13:56:36.085 +07:00 [INF] Request starting HTTP/1.1 POST https://localhost:7277/api/shop/cart/items - application/json; charset=utf-8 null
2025-09-05 13:56:36.089 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Add (PHONE_STORE.API)'
2025-09-05 13:56:36.090 +07:00 [INF] Route matched with {action = "Add", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Add(PHONE_STORE.Application.Dtos.CartItemUpsertDto, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 13:56:36.101 +07:00 [ERR] 2025-09-05 13:56:36.101655 ThreadID:5   (ERROR)   OracleRelationalCommand.ExecuteReaderAsync() :  Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
2025-09-05 13:56:36.102 +07:00 [ERR] Failed executing DbCommand (7ms) [Parameters=[:p0='?' (DbType = DateTime), :p1='?' (Size = 2000), :p2='?' (DbType = Int64), :p3='?' (Size = 64), :p4='?' (Size = 2000), :p5='?' (DbType = DateTime), :cur0='?' (Direction = Output) (DbType = Object)], CommandType='"Text"', CommandTimeout='0']
DECLARE

TYPE "rCARTS_0" IS RECORD
(
"ID" NUMBER(19)
);
TYPE "tCARTS_0" IS TABLE OF "rCARTS_0";
"lCARTS_0" "tCARTS_0";

BEGIN

"lCARTS_0" := "tCARTS_0"();
"lCARTS_0".extend(1);
INSERT INTO "HEHE"."CARTS" ("CREATED_AT", "CURRENCY", "CUSTOMER_ID", "SESSION_TOKEN", "STATUS", "UPDATED_AT")
VALUES (:p0, :p1, :p2, :p3, :p4, :p5)
RETURNING "ID" INTO "lCARTS_0"(1)."ID";
OPEN :cur0 FOR SELECT "lCARTS_0"(1)."ID" FROM DUAL;

END;
2025-09-05 13:56:36.107 +07:00 [ERR] 2025-09-05 13:56:36.107553 ThreadID:5   (ERROR)   OracleExecutionStrategy.ExecuteAsync() :  Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
2025-09-05 13:56:36.110 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'PHONE_STORE.Infrastructure.Data.PhoneDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-09-05 13:56:36.257 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Add (PHONE_STORE.API) in 165.4721ms
2025-09-05 13:56:36.260 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Add (PHONE_STORE.API)'
2025-09-05 13:56:36.261 +07:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at PHONE_STORE.Infrastructure.Repositories.CartRepository.EnsureCartId(Nullable`1 customerId, String sessionId, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.Infrastructure\Repositories\CartRepository.cs:line 50
   at PHONE_STORE.Infrastructure.Repositories.CartRepository.AddOrUpdateItemAsync(Nullable`1 customerId, String sessionId, CartItemUpsertDto dto, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.Infrastructure\Repositories\CartRepository.cs:line 98
   at lambda_method264(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-05 13:56:36.274 +07:00 [INF] Request finished HTTP/1.1 POST https://localhost:7277/api/shop/cart/items - 500 null application/problem+json; charset=utf-8 188.0975ms
2025-09-05 13:56:36.279 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products/galaxy-s24 - null null
2025-09-05 13:56:36.281 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API)'
2025-09-05 13:56:36.281 +07:00 [INF] Route matched with {action = "Details", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductDetail]] Details(System.String, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 13:56:36.285 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:slug_0='?' (Size = 220)], CommandType='"Text"', CommandTimeout='0']
SELECT "p2"."ID", "p2"."BRAND_ID", "p2"."CREATED_AT", "p2"."DEFAULT_CATEGORY_ID", "p2"."DESCRIPTION", "p2"."IS_ACTIVE", "p2"."NAME", "p2"."SLUG", "p2"."SPEC_JSON", "p0"."ID", "p0"."BARCODE", "p0"."COLOR", "p0"."IS_ACTIVE", "p0"."PRODUCT_ID", "p0"."SKU", "p0"."STORAGE_GB", "p0"."WEIGHT_GRAM", "p1"."ID", "p1"."ALT_TEXT", "p1"."IMAGE_URL", "p1"."IS_PRIMARY", "p1"."PRODUCT_ID", "p1"."SORT_ORDER", "p1"."VARIANT_ID"
FROM (
    SELECT "p"."ID", "p"."BRAND_ID", "p"."CREATED_AT", "p"."DEFAULT_CATEGORY_ID", "p"."DESCRIPTION", "p"."IS_ACTIVE", "p"."NAME", "p"."SLUG", "p"."SPEC_JSON"
    FROM "HEHE"."PRODUCTS" "p"
    WHERE (("p"."SLUG" = :slug_0) AND ("p"."IS_ACTIVE" = 1))
    FETCH FIRST 1 ROWS ONLY
) "p2"
LEFT JOIN "HEHE"."PRODUCT_VARIANTS" "p0" ON "p2"."ID" = "p0"."PRODUCT_ID"
LEFT JOIN "HEHE"."PRODUCT_IMAGES" "p1" ON "p2"."ID" = "p1"."PRODUCT_ID"
ORDER BY "p2"."ID", "p0"."ID"
2025-09-05 13:56:36.289 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."VARIANT_ID" "VariantId", COALESCE((
    SELECT COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")
    FROM "HEHE"."PRODUCT_PRICES" "p0"
    WHERE (((((("p0"."VARIANT_ID" = 3) AND ("p0"."STARTS_AT" <= :now_1))) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))) AND ("p"."VARIANT_ID" = "p0"."VARIANT_ID"))
    ORDER BY "p0"."STARTS_AT" DESC
    FETCH FIRST 1 ROWS ONLY), 0.0) "Price"
FROM "HEHE"."PRODUCT_PRICES" "p"
WHERE (((("p"."VARIANT_ID" = 3) AND ("p"."STARTS_AT" <= :now_1))) AND ((("p"."ENDS_AT" IS NULL) OR ("p"."ENDS_AT" > :now_2))))
GROUP BY "p"."VARIANT_ID"
2025-09-05 13:56:36.291 +07:00 [INF] Executing OkObjectResult, writing value of type 'PHONE_STORE.API.Controllers.ShopProductsController+ShopProductDetail'.
2025-09-05 13:56:36.292 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API) in 9.8914ms
2025-09-05 13:56:36.293 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API)'
2025-09-05 13:56:36.293 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products/galaxy-s24 - 200 null application/json; charset=utf-8 14.3897ms
2025-09-05 13:56:36.313 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 13:56:36.315 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 13:56:36.316 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 13:56:36.327 +07:00 [ERR] 2025-09-05 13:56:36.327021 ThreadID:5   (ERROR)   OracleRelationalCommand.ExecuteReaderAsync() :  Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
2025-09-05 13:56:36.329 +07:00 [ERR] Failed executing DbCommand (8ms) [Parameters=[:p0='?' (DbType = DateTime), :p1='?' (Size = 2000), :p2='?' (DbType = Int64), :p3='?' (Size = 64), :p4='?' (Size = 2000), :p5='?' (DbType = DateTime), :cur0='?' (Direction = Output) (DbType = Object)], CommandType='"Text"', CommandTimeout='0']
DECLARE

TYPE "rCARTS_0" IS RECORD
(
"ID" NUMBER(19)
);
TYPE "tCARTS_0" IS TABLE OF "rCARTS_0";
"lCARTS_0" "tCARTS_0";

BEGIN

"lCARTS_0" := "tCARTS_0"();
"lCARTS_0".extend(1);
INSERT INTO "HEHE"."CARTS" ("CREATED_AT", "CURRENCY", "CUSTOMER_ID", "SESSION_TOKEN", "STATUS", "UPDATED_AT")
VALUES (:p0, :p1, :p2, :p3, :p4, :p5)
RETURNING "ID" INTO "lCARTS_0"(1)."ID";
OPEN :cur0 FOR SELECT "lCARTS_0"(1)."ID" FROM DUAL;

END;
2025-09-05 13:56:36.334 +07:00 [ERR] 2025-09-05 13:56:36.334097 ThreadID:5   (ERROR)   OracleExecutionStrategy.ExecuteAsync() :  Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
2025-09-05 13:56:36.338 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'PHONE_STORE.Infrastructure.Data.PhoneDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-09-05 13:56:36.430 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 112.3855ms
2025-09-05 13:56:36.433 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 13:56:36.435 +07:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at PHONE_STORE.Infrastructure.Repositories.CartRepository.EnsureCartId(Nullable`1 customerId, String sessionId, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.Infrastructure\Repositories\CartRepository.cs:line 50
   at PHONE_STORE.Infrastructure.Repositories.CartRepository.GetOrCreateAsync(Nullable`1 customerId, String sessionId, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.Infrastructure\Repositories\CartRepository.cs:line 77
   at lambda_method31(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-05 13:56:36.451 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 500 null application/problem+json; charset=utf-8 138.6892ms
2025-09-05 13:56:38.636 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - null null
2025-09-05 13:56:38.638 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 13:56:38.639 +07:00 [INF] Route matched with {action = "List", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem]]] List(System.String, System.Nullable`1[System.Int64], Int32, Int32, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 13:56:38.645 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:p_0='?' (DbType = Int32), :p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."ID" "Id", "p"."NAME" "Name", "p"."SLUG" "Slug"
FROM "HEHE"."PRODUCTS" "p"
WHERE "p"."IS_ACTIVE" = 1
ORDER BY "p"."CREATED_AT" DESC
OFFSET :p_0 ROWS FETCH NEXT :p_1 ROWS ONLY
2025-09-05 13:56:38.649 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", (
    SELECT "p0"."IMAGE_URL"
    FROM "HEHE"."PRODUCT_IMAGES" "p0"
    WHERE (("p0"."PRODUCT_ID" IS NOT NULL AND "p0"."PRODUCT_ID" IN (3, 2, 1)) AND ("p"."PRODUCT_ID" = "p0"."PRODUCT_ID"))
    ORDER BY "p0"."SORT_ORDER"
    FETCH FIRST 1 ROWS ONLY) "Url"
FROM "HEHE"."PRODUCT_IMAGES" "p"
WHERE "p"."PRODUCT_ID" IS NOT NULL AND "p"."PRODUCT_ID" IN (3, 2, 1)
GROUP BY "p"."PRODUCT_ID"
2025-09-05 13:56:38.654 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", MIN(COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")) "MinPrice"
FROM "HEHE"."PRODUCT_VARIANTS" "p"
INNER JOIN "HEHE"."PRODUCT_PRICES" "p0" ON "p"."ID" = "p0"."VARIANT_ID"
WHERE (("p"."PRODUCT_ID" IN (3, 2, 1)) AND ((("p0"."STARTS_AT" <= :now_1) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))))
GROUP BY "p"."PRODUCT_ID"
2025-09-05 13:56:38.656 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem, PHONE_STORE.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-05 13:56:38.657 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API) in 16.6236ms
2025-09-05 13:56:38.658 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 13:56:38.659 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - 200 null application/json; charset=utf-8 23.687ms
2025-09-05 13:56:38.684 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 13:56:38.691 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 13:56:38.693 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 13:56:38.707 +07:00 [ERR] 2025-09-05 13:56:38.707582 ThreadID:7   (ERROR)   OracleRelationalCommand.ExecuteReaderAsync() :  Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
2025-09-05 13:56:38.710 +07:00 [ERR] Failed executing DbCommand (11ms) [Parameters=[:p0='?' (DbType = DateTime), :p1='?' (Size = 2000), :p2='?' (DbType = Int64), :p3='?' (Size = 64), :p4='?' (Size = 2000), :p5='?' (DbType = DateTime), :cur0='?' (Direction = Output) (DbType = Object)], CommandType='"Text"', CommandTimeout='0']
DECLARE

TYPE "rCARTS_0" IS RECORD
(
"ID" NUMBER(19)
);
TYPE "tCARTS_0" IS TABLE OF "rCARTS_0";
"lCARTS_0" "tCARTS_0";

BEGIN

"lCARTS_0" := "tCARTS_0"();
"lCARTS_0".extend(1);
INSERT INTO "HEHE"."CARTS" ("CREATED_AT", "CURRENCY", "CUSTOMER_ID", "SESSION_TOKEN", "STATUS", "UPDATED_AT")
VALUES (:p0, :p1, :p2, :p3, :p4, :p5)
RETURNING "ID" INTO "lCARTS_0"(1)."ID";
OPEN :cur0 FOR SELECT "lCARTS_0"(1)."ID" FROM DUAL;

END;
2025-09-05 13:56:38.715 +07:00 [ERR] 2025-09-05 13:56:38.715670 ThreadID:7   (ERROR)   OracleExecutionStrategy.ExecuteAsync() :  Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
2025-09-05 13:56:38.719 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'PHONE_STORE.Infrastructure.Data.PhoneDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-09-05 13:56:38.842 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 147.5613ms
2025-09-05 13:56:38.843 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 13:56:38.844 +07:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at PHONE_STORE.Infrastructure.Repositories.CartRepository.EnsureCartId(Nullable`1 customerId, String sessionId, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.Infrastructure\Repositories\CartRepository.cs:line 50
   at PHONE_STORE.Infrastructure.Repositories.CartRepository.GetOrCreateAsync(Nullable`1 customerId, String sessionId, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.Infrastructure\Repositories\CartRepository.cs:line 77
   at lambda_method31(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-05 13:56:38.869 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 500 null application/problem+json; charset=utf-8 184.3165ms
2025-09-05 13:56:40.965 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products/galaxy-s24 - null null
2025-09-05 13:56:40.968 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API)'
2025-09-05 13:56:40.969 +07:00 [INF] Route matched with {action = "Details", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductDetail]] Details(System.String, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 13:56:40.973 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:slug_0='?' (Size = 220)], CommandType='"Text"', CommandTimeout='0']
SELECT "p2"."ID", "p2"."BRAND_ID", "p2"."CREATED_AT", "p2"."DEFAULT_CATEGORY_ID", "p2"."DESCRIPTION", "p2"."IS_ACTIVE", "p2"."NAME", "p2"."SLUG", "p2"."SPEC_JSON", "p0"."ID", "p0"."BARCODE", "p0"."COLOR", "p0"."IS_ACTIVE", "p0"."PRODUCT_ID", "p0"."SKU", "p0"."STORAGE_GB", "p0"."WEIGHT_GRAM", "p1"."ID", "p1"."ALT_TEXT", "p1"."IMAGE_URL", "p1"."IS_PRIMARY", "p1"."PRODUCT_ID", "p1"."SORT_ORDER", "p1"."VARIANT_ID"
FROM (
    SELECT "p"."ID", "p"."BRAND_ID", "p"."CREATED_AT", "p"."DEFAULT_CATEGORY_ID", "p"."DESCRIPTION", "p"."IS_ACTIVE", "p"."NAME", "p"."SLUG", "p"."SPEC_JSON"
    FROM "HEHE"."PRODUCTS" "p"
    WHERE (("p"."SLUG" = :slug_0) AND ("p"."IS_ACTIVE" = 1))
    FETCH FIRST 1 ROWS ONLY
) "p2"
LEFT JOIN "HEHE"."PRODUCT_VARIANTS" "p0" ON "p2"."ID" = "p0"."PRODUCT_ID"
LEFT JOIN "HEHE"."PRODUCT_IMAGES" "p1" ON "p2"."ID" = "p1"."PRODUCT_ID"
ORDER BY "p2"."ID", "p0"."ID"
2025-09-05 13:56:40.979 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."VARIANT_ID" "VariantId", COALESCE((
    SELECT COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")
    FROM "HEHE"."PRODUCT_PRICES" "p0"
    WHERE (((((("p0"."VARIANT_ID" = 3) AND ("p0"."STARTS_AT" <= :now_1))) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))) AND ("p"."VARIANT_ID" = "p0"."VARIANT_ID"))
    ORDER BY "p0"."STARTS_AT" DESC
    FETCH FIRST 1 ROWS ONLY), 0.0) "Price"
FROM "HEHE"."PRODUCT_PRICES" "p"
WHERE (((("p"."VARIANT_ID" = 3) AND ("p"."STARTS_AT" <= :now_1))) AND ((("p"."ENDS_AT" IS NULL) OR ("p"."ENDS_AT" > :now_2))))
GROUP BY "p"."VARIANT_ID"
2025-09-05 13:56:40.981 +07:00 [INF] Executing OkObjectResult, writing value of type 'PHONE_STORE.API.Controllers.ShopProductsController+ShopProductDetail'.
2025-09-05 13:56:40.981 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API) in 11.5416ms
2025-09-05 13:56:40.982 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API)'
2025-09-05 13:56:40.983 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products/galaxy-s24 - 200 null application/json; charset=utf-8 17.4989ms
2025-09-05 13:56:41.004 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 13:56:41.008 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 13:56:41.009 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 13:56:41.018 +07:00 [ERR] 2025-09-05 13:56:41.018499 ThreadID:7   (ERROR)   OracleRelationalCommand.ExecuteReaderAsync() :  Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
2025-09-05 13:56:41.021 +07:00 [ERR] Failed executing DbCommand (7ms) [Parameters=[:p0='?' (DbType = DateTime), :p1='?' (Size = 2000), :p2='?' (DbType = Int64), :p3='?' (Size = 64), :p4='?' (Size = 2000), :p5='?' (DbType = DateTime), :cur0='?' (Direction = Output) (DbType = Object)], CommandType='"Text"', CommandTimeout='0']
DECLARE

TYPE "rCARTS_0" IS RECORD
(
"ID" NUMBER(19)
);
TYPE "tCARTS_0" IS TABLE OF "rCARTS_0";
"lCARTS_0" "tCARTS_0";

BEGIN

"lCARTS_0" := "tCARTS_0"();
"lCARTS_0".extend(1);
INSERT INTO "HEHE"."CARTS" ("CREATED_AT", "CURRENCY", "CUSTOMER_ID", "SESSION_TOKEN", "STATUS", "UPDATED_AT")
VALUES (:p0, :p1, :p2, :p3, :p4, :p5)
RETURNING "ID" INTO "lCARTS_0"(1)."ID";
OPEN :cur0 FOR SELECT "lCARTS_0"(1)."ID" FROM DUAL;

END;
2025-09-05 13:56:41.024 +07:00 [ERR] 2025-09-05 13:56:41.024747 ThreadID:7   (ERROR)   OracleExecutionStrategy.ExecuteAsync() :  Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
2025-09-05 13:56:41.029 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'PHONE_STORE.Infrastructure.Data.PhoneDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-09-05 13:56:41.139 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 127.8693ms
2025-09-05 13:56:41.141 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 13:56:41.142 +07:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at PHONE_STORE.Infrastructure.Repositories.CartRepository.EnsureCartId(Nullable`1 customerId, String sessionId, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.Infrastructure\Repositories\CartRepository.cs:line 50
   at PHONE_STORE.Infrastructure.Repositories.CartRepository.GetOrCreateAsync(Nullable`1 customerId, String sessionId, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.Infrastructure\Repositories\CartRepository.cs:line 77
   at lambda_method31(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-05 13:56:41.158 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 500 null application/problem+json; charset=utf-8 154.2885ms
2025-09-05 13:56:42.546 +07:00 [INF] Request starting HTTP/1.1 POST https://localhost:7277/api/shop/cart/items - application/json; charset=utf-8 null
2025-09-05 13:56:42.550 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Add (PHONE_STORE.API)'
2025-09-05 13:56:42.551 +07:00 [INF] Route matched with {action = "Add", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Add(PHONE_STORE.Application.Dtos.CartItemUpsertDto, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 13:56:42.561 +07:00 [ERR] 2025-09-05 13:56:42.561120 ThreadID:9   (ERROR)   OracleRelationalCommand.ExecuteReaderAsync() :  Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
2025-09-05 13:56:42.563 +07:00 [ERR] Failed executing DbCommand (7ms) [Parameters=[:p0='?' (DbType = DateTime), :p1='?' (Size = 2000), :p2='?' (DbType = Int64), :p3='?' (Size = 64), :p4='?' (Size = 2000), :p5='?' (DbType = DateTime), :cur0='?' (Direction = Output) (DbType = Object)], CommandType='"Text"', CommandTimeout='0']
DECLARE

TYPE "rCARTS_0" IS RECORD
(
"ID" NUMBER(19)
);
TYPE "tCARTS_0" IS TABLE OF "rCARTS_0";
"lCARTS_0" "tCARTS_0";

BEGIN

"lCARTS_0" := "tCARTS_0"();
"lCARTS_0".extend(1);
INSERT INTO "HEHE"."CARTS" ("CREATED_AT", "CURRENCY", "CUSTOMER_ID", "SESSION_TOKEN", "STATUS", "UPDATED_AT")
VALUES (:p0, :p1, :p2, :p3, :p4, :p5)
RETURNING "ID" INTO "lCARTS_0"(1)."ID";
OPEN :cur0 FOR SELECT "lCARTS_0"(1)."ID" FROM DUAL;

END;
2025-09-05 13:56:42.568 +07:00 [ERR] 2025-09-05 13:56:42.568515 ThreadID:9   (ERROR)   OracleExecutionStrategy.ExecuteAsync() :  Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
2025-09-05 13:56:42.574 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'PHONE_STORE.Infrastructure.Data.PhoneDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-09-05 13:56:42.704 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Add (PHONE_STORE.API) in 151.6153ms
2025-09-05 13:56:42.706 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Add (PHONE_STORE.API)'
2025-09-05 13:56:42.707 +07:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at PHONE_STORE.Infrastructure.Repositories.CartRepository.EnsureCartId(Nullable`1 customerId, String sessionId, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.Infrastructure\Repositories\CartRepository.cs:line 50
   at PHONE_STORE.Infrastructure.Repositories.CartRepository.AddOrUpdateItemAsync(Nullable`1 customerId, String sessionId, CartItemUpsertDto dto, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.Infrastructure\Repositories\CartRepository.cs:line 98
   at lambda_method264(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-05 13:56:42.722 +07:00 [INF] Request finished HTTP/1.1 POST https://localhost:7277/api/shop/cart/items - 500 null application/problem+json; charset=utf-8 175.8167ms
2025-09-05 13:56:42.728 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products/galaxy-s24 - null null
2025-09-05 13:56:42.729 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API)'
2025-09-05 13:56:42.730 +07:00 [INF] Route matched with {action = "Details", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductDetail]] Details(System.String, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 13:56:42.734 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:slug_0='?' (Size = 220)], CommandType='"Text"', CommandTimeout='0']
SELECT "p2"."ID", "p2"."BRAND_ID", "p2"."CREATED_AT", "p2"."DEFAULT_CATEGORY_ID", "p2"."DESCRIPTION", "p2"."IS_ACTIVE", "p2"."NAME", "p2"."SLUG", "p2"."SPEC_JSON", "p0"."ID", "p0"."BARCODE", "p0"."COLOR", "p0"."IS_ACTIVE", "p0"."PRODUCT_ID", "p0"."SKU", "p0"."STORAGE_GB", "p0"."WEIGHT_GRAM", "p1"."ID", "p1"."ALT_TEXT", "p1"."IMAGE_URL", "p1"."IS_PRIMARY", "p1"."PRODUCT_ID", "p1"."SORT_ORDER", "p1"."VARIANT_ID"
FROM (
    SELECT "p"."ID", "p"."BRAND_ID", "p"."CREATED_AT", "p"."DEFAULT_CATEGORY_ID", "p"."DESCRIPTION", "p"."IS_ACTIVE", "p"."NAME", "p"."SLUG", "p"."SPEC_JSON"
    FROM "HEHE"."PRODUCTS" "p"
    WHERE (("p"."SLUG" = :slug_0) AND ("p"."IS_ACTIVE" = 1))
    FETCH FIRST 1 ROWS ONLY
) "p2"
LEFT JOIN "HEHE"."PRODUCT_VARIANTS" "p0" ON "p2"."ID" = "p0"."PRODUCT_ID"
LEFT JOIN "HEHE"."PRODUCT_IMAGES" "p1" ON "p2"."ID" = "p1"."PRODUCT_ID"
ORDER BY "p2"."ID", "p0"."ID"
2025-09-05 13:56:42.740 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."VARIANT_ID" "VariantId", COALESCE((
    SELECT COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")
    FROM "HEHE"."PRODUCT_PRICES" "p0"
    WHERE (((((("p0"."VARIANT_ID" = 3) AND ("p0"."STARTS_AT" <= :now_1))) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))) AND ("p"."VARIANT_ID" = "p0"."VARIANT_ID"))
    ORDER BY "p0"."STARTS_AT" DESC
    FETCH FIRST 1 ROWS ONLY), 0.0) "Price"
FROM "HEHE"."PRODUCT_PRICES" "p"
WHERE (((("p"."VARIANT_ID" = 3) AND ("p"."STARTS_AT" <= :now_1))) AND ((("p"."ENDS_AT" IS NULL) OR ("p"."ENDS_AT" > :now_2))))
GROUP BY "p"."VARIANT_ID"
2025-09-05 13:56:42.741 +07:00 [INF] Executing OkObjectResult, writing value of type 'PHONE_STORE.API.Controllers.ShopProductsController+ShopProductDetail'.
2025-09-05 13:56:42.742 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API) in 10.9009ms
2025-09-05 13:56:42.743 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API)'
2025-09-05 13:56:42.743 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products/galaxy-s24 - 200 null application/json; charset=utf-8 15.6719ms
2025-09-05 13:56:42.764 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 13:56:42.767 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 13:56:42.769 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 13:56:42.785 +07:00 [ERR] 2025-09-05 13:56:42.785776 ThreadID:13  (ERROR)   OracleRelationalCommand.ExecuteReaderAsync() :  Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
2025-09-05 13:56:42.787 +07:00 [ERR] Failed executing DbCommand (10ms) [Parameters=[:p0='?' (DbType = DateTime), :p1='?' (Size = 2000), :p2='?' (DbType = Int64), :p3='?' (Size = 64), :p4='?' (Size = 2000), :p5='?' (DbType = DateTime), :cur0='?' (Direction = Output) (DbType = Object)], CommandType='"Text"', CommandTimeout='0']
DECLARE

TYPE "rCARTS_0" IS RECORD
(
"ID" NUMBER(19)
);
TYPE "tCARTS_0" IS TABLE OF "rCARTS_0";
"lCARTS_0" "tCARTS_0";

BEGIN

"lCARTS_0" := "tCARTS_0"();
"lCARTS_0".extend(1);
INSERT INTO "HEHE"."CARTS" ("CREATED_AT", "CURRENCY", "CUSTOMER_ID", "SESSION_TOKEN", "STATUS", "UPDATED_AT")
VALUES (:p0, :p1, :p2, :p3, :p4, :p5)
RETURNING "ID" INTO "lCARTS_0"(1)."ID";
OPEN :cur0 FOR SELECT "lCARTS_0"(1)."ID" FROM DUAL;

END;
2025-09-05 13:56:42.793 +07:00 [ERR] 2025-09-05 13:56:42.793352 ThreadID:13  (ERROR)   OracleExecutionStrategy.ExecuteAsync() :  Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
2025-09-05 13:56:42.799 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'PHONE_STORE.Infrastructure.Data.PhoneDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-09-05 13:56:42.897 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 125.5977ms
2025-09-05 13:56:42.898 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 13:56:42.899 +07:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at PHONE_STORE.Infrastructure.Repositories.CartRepository.EnsureCartId(Nullable`1 customerId, String sessionId, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.Infrastructure\Repositories\CartRepository.cs:line 50
   at PHONE_STORE.Infrastructure.Repositories.CartRepository.GetOrCreateAsync(Nullable`1 customerId, String sessionId, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.Infrastructure\Repositories\CartRepository.cs:line 77
   at lambda_method31(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-05 13:56:42.928 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 500 null application/problem+json; charset=utf-8 164.6228ms
2025-09-05 13:56:44.809 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - null null
2025-09-05 13:56:44.812 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 13:56:44.813 +07:00 [INF] Route matched with {action = "List", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem]]] List(System.String, System.Nullable`1[System.Int64], Int32, Int32, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 13:56:44.817 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:p_0='?' (DbType = Int32), :p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."ID" "Id", "p"."NAME" "Name", "p"."SLUG" "Slug"
FROM "HEHE"."PRODUCTS" "p"
WHERE "p"."IS_ACTIVE" = 1
ORDER BY "p"."CREATED_AT" DESC
OFFSET :p_0 ROWS FETCH NEXT :p_1 ROWS ONLY
2025-09-05 13:56:44.821 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", (
    SELECT "p0"."IMAGE_URL"
    FROM "HEHE"."PRODUCT_IMAGES" "p0"
    WHERE (("p0"."PRODUCT_ID" IS NOT NULL AND "p0"."PRODUCT_ID" IN (3, 2, 1)) AND ("p"."PRODUCT_ID" = "p0"."PRODUCT_ID"))
    ORDER BY "p0"."SORT_ORDER"
    FETCH FIRST 1 ROWS ONLY) "Url"
FROM "HEHE"."PRODUCT_IMAGES" "p"
WHERE "p"."PRODUCT_ID" IS NOT NULL AND "p"."PRODUCT_ID" IN (3, 2, 1)
GROUP BY "p"."PRODUCT_ID"
2025-09-05 13:56:44.825 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", MIN(COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")) "MinPrice"
FROM "HEHE"."PRODUCT_VARIANTS" "p"
INNER JOIN "HEHE"."PRODUCT_PRICES" "p0" ON "p"."ID" = "p0"."VARIANT_ID"
WHERE (("p"."PRODUCT_ID" IN (3, 2, 1)) AND ((("p0"."STARTS_AT" <= :now_1) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))))
GROUP BY "p"."PRODUCT_ID"
2025-09-05 13:56:44.827 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem, PHONE_STORE.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-05 13:56:44.828 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API) in 14.7478ms
2025-09-05 13:56:44.829 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 13:56:44.830 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - 200 null application/json; charset=utf-8 21.8018ms
2025-09-05 13:56:44.851 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 13:56:44.854 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 13:56:44.855 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 13:56:44.873 +07:00 [ERR] 2025-09-05 13:56:44.873732 ThreadID:9   (ERROR)   OracleRelationalCommand.ExecuteReaderAsync() :  Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
2025-09-05 13:56:44.876 +07:00 [ERR] Failed executing DbCommand (13ms) [Parameters=[:p0='?' (DbType = DateTime), :p1='?' (Size = 2000), :p2='?' (DbType = Int64), :p3='?' (Size = 64), :p4='?' (Size = 2000), :p5='?' (DbType = DateTime), :cur0='?' (Direction = Output) (DbType = Object)], CommandType='"Text"', CommandTimeout='0']
DECLARE

TYPE "rCARTS_0" IS RECORD
(
"ID" NUMBER(19)
);
TYPE "tCARTS_0" IS TABLE OF "rCARTS_0";
"lCARTS_0" "tCARTS_0";

BEGIN

"lCARTS_0" := "tCARTS_0"();
"lCARTS_0".extend(1);
INSERT INTO "HEHE"."CARTS" ("CREATED_AT", "CURRENCY", "CUSTOMER_ID", "SESSION_TOKEN", "STATUS", "UPDATED_AT")
VALUES (:p0, :p1, :p2, :p3, :p4, :p5)
RETURNING "ID" INTO "lCARTS_0"(1)."ID";
OPEN :cur0 FOR SELECT "lCARTS_0"(1)."ID" FROM DUAL;

END;
2025-09-05 13:56:44.882 +07:00 [ERR] 2025-09-05 13:56:44.882740 ThreadID:9   (ERROR)   OracleExecutionStrategy.ExecuteAsync() :  Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
2025-09-05 13:56:44.887 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'PHONE_STORE.Infrastructure.Data.PhoneDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-09-05 13:56:45.001 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 143.4226ms
2025-09-05 13:56:45.003 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 13:56:45.004 +07:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at PHONE_STORE.Infrastructure.Repositories.CartRepository.EnsureCartId(Nullable`1 customerId, String sessionId, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.Infrastructure\Repositories\CartRepository.cs:line 50
   at PHONE_STORE.Infrastructure.Repositories.CartRepository.GetOrCreateAsync(Nullable`1 customerId, String sessionId, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.Infrastructure\Repositories\CartRepository.cs:line 77
   at lambda_method31(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-05 13:56:45.019 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 500 null application/problem+json; charset=utf-8 168.0602ms
2025-09-05 13:56:46.483 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products/iphone-15 - null null
2025-09-05 13:56:46.487 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API)'
2025-09-05 13:56:46.488 +07:00 [INF] Route matched with {action = "Details", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductDetail]] Details(System.String, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 13:56:46.494 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:slug_0='?' (Size = 220)], CommandType='"Text"', CommandTimeout='0']
SELECT "p2"."ID", "p2"."BRAND_ID", "p2"."CREATED_AT", "p2"."DEFAULT_CATEGORY_ID", "p2"."DESCRIPTION", "p2"."IS_ACTIVE", "p2"."NAME", "p2"."SLUG", "p2"."SPEC_JSON", "p0"."ID", "p0"."BARCODE", "p0"."COLOR", "p0"."IS_ACTIVE", "p0"."PRODUCT_ID", "p0"."SKU", "p0"."STORAGE_GB", "p0"."WEIGHT_GRAM", "p1"."ID", "p1"."ALT_TEXT", "p1"."IMAGE_URL", "p1"."IS_PRIMARY", "p1"."PRODUCT_ID", "p1"."SORT_ORDER", "p1"."VARIANT_ID"
FROM (
    SELECT "p"."ID", "p"."BRAND_ID", "p"."CREATED_AT", "p"."DEFAULT_CATEGORY_ID", "p"."DESCRIPTION", "p"."IS_ACTIVE", "p"."NAME", "p"."SLUG", "p"."SPEC_JSON"
    FROM "HEHE"."PRODUCTS" "p"
    WHERE (("p"."SLUG" = :slug_0) AND ("p"."IS_ACTIVE" = 1))
    FETCH FIRST 1 ROWS ONLY
) "p2"
LEFT JOIN "HEHE"."PRODUCT_VARIANTS" "p0" ON "p2"."ID" = "p0"."PRODUCT_ID"
LEFT JOIN "HEHE"."PRODUCT_IMAGES" "p1" ON "p2"."ID" = "p1"."PRODUCT_ID"
ORDER BY "p2"."ID", "p0"."ID"
2025-09-05 13:56:46.507 +07:00 [INF] Executed DbCommand (8ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."VARIANT_ID" "VariantId", COALESCE((
    SELECT COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")
    FROM "HEHE"."PRODUCT_PRICES" "p0"
    WHERE (((((("p0"."VARIANT_ID" IN (1, 2)) AND ("p0"."STARTS_AT" <= :now_1))) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))) AND ("p"."VARIANT_ID" = "p0"."VARIANT_ID"))
    ORDER BY "p0"."STARTS_AT" DESC
    FETCH FIRST 1 ROWS ONLY), 0.0) "Price"
FROM "HEHE"."PRODUCT_PRICES" "p"
WHERE (((("p"."VARIANT_ID" IN (1, 2)) AND ("p"."STARTS_AT" <= :now_1))) AND ((("p"."ENDS_AT" IS NULL) OR ("p"."ENDS_AT" > :now_2))))
GROUP BY "p"."VARIANT_ID"
2025-09-05 13:56:46.508 +07:00 [INF] Executing OkObjectResult, writing value of type 'PHONE_STORE.API.Controllers.ShopProductsController+ShopProductDetail'.
2025-09-05 13:56:46.510 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API) in 19.3957ms
2025-09-05 13:56:46.510 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API)'
2025-09-05 13:56:46.511 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products/iphone-15 - 200 null application/json; charset=utf-8 27.7987ms
2025-09-05 13:56:46.530 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 13:56:46.532 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 13:56:46.533 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 13:56:46.544 +07:00 [ERR] 2025-09-05 13:56:46.544352 ThreadID:9   (ERROR)   OracleRelationalCommand.ExecuteReaderAsync() :  Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
2025-09-05 13:56:46.545 +07:00 [ERR] Failed executing DbCommand (5ms) [Parameters=[:p0='?' (DbType = DateTime), :p1='?' (Size = 2000), :p2='?' (DbType = Int64), :p3='?' (Size = 64), :p4='?' (Size = 2000), :p5='?' (DbType = DateTime), :cur0='?' (Direction = Output) (DbType = Object)], CommandType='"Text"', CommandTimeout='0']
DECLARE

TYPE "rCARTS_0" IS RECORD
(
"ID" NUMBER(19)
);
TYPE "tCARTS_0" IS TABLE OF "rCARTS_0";
"lCARTS_0" "tCARTS_0";

BEGIN

"lCARTS_0" := "tCARTS_0"();
"lCARTS_0".extend(1);
INSERT INTO "HEHE"."CARTS" ("CREATED_AT", "CURRENCY", "CUSTOMER_ID", "SESSION_TOKEN", "STATUS", "UPDATED_AT")
VALUES (:p0, :p1, :p2, :p3, :p4, :p5)
RETURNING "ID" INTO "lCARTS_0"(1)."ID";
OPEN :cur0 FOR SELECT "lCARTS_0"(1)."ID" FROM DUAL;

END;
2025-09-05 13:56:46.549 +07:00 [ERR] 2025-09-05 13:56:46.549105 ThreadID:9   (ERROR)   OracleExecutionStrategy.ExecuteAsync() :  Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
2025-09-05 13:56:46.553 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'PHONE_STORE.Infrastructure.Data.PhoneDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-09-05 13:56:46.658 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 122.0192ms
2025-09-05 13:56:46.659 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 13:56:46.660 +07:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at PHONE_STORE.Infrastructure.Repositories.CartRepository.EnsureCartId(Nullable`1 customerId, String sessionId, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.Infrastructure\Repositories\CartRepository.cs:line 50
   at PHONE_STORE.Infrastructure.Repositories.CartRepository.GetOrCreateAsync(Nullable`1 customerId, String sessionId, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.Infrastructure\Repositories\CartRepository.cs:line 77
   at lambda_method31(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-05 13:56:46.674 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 500 null application/problem+json; charset=utf-8 143.8237ms
2025-09-05 13:56:47.683 +07:00 [INF] Request starting HTTP/1.1 POST https://localhost:7277/api/shop/cart/items - application/json; charset=utf-8 null
2025-09-05 13:56:47.686 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Add (PHONE_STORE.API)'
2025-09-05 13:56:47.687 +07:00 [INF] Route matched with {action = "Add", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Add(PHONE_STORE.Application.Dtos.CartItemUpsertDto, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 13:56:47.705 +07:00 [ERR] 2025-09-05 13:56:47.705328 ThreadID:14  (ERROR)   OracleRelationalCommand.ExecuteReaderAsync() :  Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
2025-09-05 13:56:47.707 +07:00 [ERR] Failed executing DbCommand (15ms) [Parameters=[:p0='?' (DbType = DateTime), :p1='?' (Size = 2000), :p2='?' (DbType = Int64), :p3='?' (Size = 64), :p4='?' (Size = 2000), :p5='?' (DbType = DateTime), :cur0='?' (Direction = Output) (DbType = Object)], CommandType='"Text"', CommandTimeout='0']
DECLARE

TYPE "rCARTS_0" IS RECORD
(
"ID" NUMBER(19)
);
TYPE "tCARTS_0" IS TABLE OF "rCARTS_0";
"lCARTS_0" "tCARTS_0";

BEGIN

"lCARTS_0" := "tCARTS_0"();
"lCARTS_0".extend(1);
INSERT INTO "HEHE"."CARTS" ("CREATED_AT", "CURRENCY", "CUSTOMER_ID", "SESSION_TOKEN", "STATUS", "UPDATED_AT")
VALUES (:p0, :p1, :p2, :p3, :p4, :p5)
RETURNING "ID" INTO "lCARTS_0"(1)."ID";
OPEN :cur0 FOR SELECT "lCARTS_0"(1)."ID" FROM DUAL;

END;
2025-09-05 13:56:47.711 +07:00 [ERR] 2025-09-05 13:56:47.711550 ThreadID:14  (ERROR)   OracleExecutionStrategy.ExecuteAsync() :  Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
2025-09-05 13:56:47.717 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'PHONE_STORE.Infrastructure.Data.PhoneDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-09-05 13:56:47.795 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Add (PHONE_STORE.API) in 105.9736ms
2025-09-05 13:56:47.796 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Add (PHONE_STORE.API)'
2025-09-05 13:56:47.797 +07:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at PHONE_STORE.Infrastructure.Repositories.CartRepository.EnsureCartId(Nullable`1 customerId, String sessionId, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.Infrastructure\Repositories\CartRepository.cs:line 50
   at PHONE_STORE.Infrastructure.Repositories.CartRepository.AddOrUpdateItemAsync(Nullable`1 customerId, String sessionId, CartItemUpsertDto dto, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.Infrastructure\Repositories\CartRepository.cs:line 98
   at lambda_method264(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-05 13:56:47.820 +07:00 [INF] Request finished HTTP/1.1 POST https://localhost:7277/api/shop/cart/items - 500 null application/problem+json; charset=utf-8 136.7039ms
2025-09-05 13:56:47.826 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products/iphone-15 - null null
2025-09-05 13:56:47.828 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API)'
2025-09-05 13:56:47.829 +07:00 [INF] Route matched with {action = "Details", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductDetail]] Details(System.String, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 13:56:47.833 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:slug_0='?' (Size = 220)], CommandType='"Text"', CommandTimeout='0']
SELECT "p2"."ID", "p2"."BRAND_ID", "p2"."CREATED_AT", "p2"."DEFAULT_CATEGORY_ID", "p2"."DESCRIPTION", "p2"."IS_ACTIVE", "p2"."NAME", "p2"."SLUG", "p2"."SPEC_JSON", "p0"."ID", "p0"."BARCODE", "p0"."COLOR", "p0"."IS_ACTIVE", "p0"."PRODUCT_ID", "p0"."SKU", "p0"."STORAGE_GB", "p0"."WEIGHT_GRAM", "p1"."ID", "p1"."ALT_TEXT", "p1"."IMAGE_URL", "p1"."IS_PRIMARY", "p1"."PRODUCT_ID", "p1"."SORT_ORDER", "p1"."VARIANT_ID"
FROM (
    SELECT "p"."ID", "p"."BRAND_ID", "p"."CREATED_AT", "p"."DEFAULT_CATEGORY_ID", "p"."DESCRIPTION", "p"."IS_ACTIVE", "p"."NAME", "p"."SLUG", "p"."SPEC_JSON"
    FROM "HEHE"."PRODUCTS" "p"
    WHERE (("p"."SLUG" = :slug_0) AND ("p"."IS_ACTIVE" = 1))
    FETCH FIRST 1 ROWS ONLY
) "p2"
LEFT JOIN "HEHE"."PRODUCT_VARIANTS" "p0" ON "p2"."ID" = "p0"."PRODUCT_ID"
LEFT JOIN "HEHE"."PRODUCT_IMAGES" "p1" ON "p2"."ID" = "p1"."PRODUCT_ID"
ORDER BY "p2"."ID", "p0"."ID"
2025-09-05 13:56:47.838 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."VARIANT_ID" "VariantId", COALESCE((
    SELECT COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")
    FROM "HEHE"."PRODUCT_PRICES" "p0"
    WHERE (((((("p0"."VARIANT_ID" IN (1, 2)) AND ("p0"."STARTS_AT" <= :now_1))) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))) AND ("p"."VARIANT_ID" = "p0"."VARIANT_ID"))
    ORDER BY "p0"."STARTS_AT" DESC
    FETCH FIRST 1 ROWS ONLY), 0.0) "Price"
FROM "HEHE"."PRODUCT_PRICES" "p"
WHERE (((("p"."VARIANT_ID" IN (1, 2)) AND ("p"."STARTS_AT" <= :now_1))) AND ((("p"."ENDS_AT" IS NULL) OR ("p"."ENDS_AT" > :now_2))))
GROUP BY "p"."VARIANT_ID"
2025-09-05 13:56:47.840 +07:00 [INF] Executing OkObjectResult, writing value of type 'PHONE_STORE.API.Controllers.ShopProductsController+ShopProductDetail'.
2025-09-05 13:56:47.841 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API) in 10.8742ms
2025-09-05 13:56:47.842 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API)'
2025-09-05 13:56:47.842 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products/iphone-15 - 200 null application/json; charset=utf-8 16.0132ms
2025-09-05 13:56:47.862 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 13:56:47.865 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 13:56:47.865 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 13:56:47.874 +07:00 [ERR] 2025-09-05 13:56:47.874286 ThreadID:9   (ERROR)   OracleRelationalCommand.ExecuteReaderAsync() :  Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
2025-09-05 13:56:47.876 +07:00 [ERR] Failed executing DbCommand (6ms) [Parameters=[:p0='?' (DbType = DateTime), :p1='?' (Size = 2000), :p2='?' (DbType = Int64), :p3='?' (Size = 64), :p4='?' (Size = 2000), :p5='?' (DbType = DateTime), :cur0='?' (Direction = Output) (DbType = Object)], CommandType='"Text"', CommandTimeout='0']
DECLARE

TYPE "rCARTS_0" IS RECORD
(
"ID" NUMBER(19)
);
TYPE "tCARTS_0" IS TABLE OF "rCARTS_0";
"lCARTS_0" "tCARTS_0";

BEGIN

"lCARTS_0" := "tCARTS_0"();
"lCARTS_0".extend(1);
INSERT INTO "HEHE"."CARTS" ("CREATED_AT", "CURRENCY", "CUSTOMER_ID", "SESSION_TOKEN", "STATUS", "UPDATED_AT")
VALUES (:p0, :p1, :p2, :p3, :p4, :p5)
RETURNING "ID" INTO "lCARTS_0"(1)."ID";
OPEN :cur0 FOR SELECT "lCARTS_0"(1)."ID" FROM DUAL;

END;
2025-09-05 13:56:47.881 +07:00 [ERR] 2025-09-05 13:56:47.881355 ThreadID:9   (ERROR)   OracleExecutionStrategy.ExecuteAsync() :  Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
2025-09-05 13:56:47.885 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'PHONE_STORE.Infrastructure.Data.PhoneDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-09-05 13:56:47.983 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 115.7033ms
2025-09-05 13:56:47.985 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 13:56:47.987 +07:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at PHONE_STORE.Infrastructure.Repositories.CartRepository.EnsureCartId(Nullable`1 customerId, String sessionId, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.Infrastructure\Repositories\CartRepository.cs:line 50
   at PHONE_STORE.Infrastructure.Repositories.CartRepository.GetOrCreateAsync(Nullable`1 customerId, String sessionId, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.Infrastructure\Repositories\CartRepository.cs:line 77
   at lambda_method31(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-05 13:56:48.011 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 500 null application/problem+json; charset=utf-8 148.4997ms
2025-09-05 13:56:51.267 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - null null
2025-09-05 13:56:51.269 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 13:56:51.270 +07:00 [INF] Route matched with {action = "List", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem]]] List(System.String, System.Nullable`1[System.Int64], Int32, Int32, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 13:56:51.275 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:p_0='?' (DbType = Int32), :p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."ID" "Id", "p"."NAME" "Name", "p"."SLUG" "Slug"
FROM "HEHE"."PRODUCTS" "p"
WHERE "p"."IS_ACTIVE" = 1
ORDER BY "p"."CREATED_AT" DESC
OFFSET :p_0 ROWS FETCH NEXT :p_1 ROWS ONLY
2025-09-05 13:56:51.278 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", (
    SELECT "p0"."IMAGE_URL"
    FROM "HEHE"."PRODUCT_IMAGES" "p0"
    WHERE (("p0"."PRODUCT_ID" IS NOT NULL AND "p0"."PRODUCT_ID" IN (3, 2, 1)) AND ("p"."PRODUCT_ID" = "p0"."PRODUCT_ID"))
    ORDER BY "p0"."SORT_ORDER"
    FETCH FIRST 1 ROWS ONLY) "Url"
FROM "HEHE"."PRODUCT_IMAGES" "p"
WHERE "p"."PRODUCT_ID" IS NOT NULL AND "p"."PRODUCT_ID" IN (3, 2, 1)
GROUP BY "p"."PRODUCT_ID"
2025-09-05 13:56:51.281 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", MIN(COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")) "MinPrice"
FROM "HEHE"."PRODUCT_VARIANTS" "p"
INNER JOIN "HEHE"."PRODUCT_PRICES" "p0" ON "p"."ID" = "p0"."VARIANT_ID"
WHERE (("p"."PRODUCT_ID" IN (3, 2, 1)) AND ((("p0"."STARTS_AT" <= :now_1) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))))
GROUP BY "p"."PRODUCT_ID"
2025-09-05 13:56:51.283 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem, PHONE_STORE.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-05 13:56:51.284 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API) in 12.3777ms
2025-09-05 13:56:51.285 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 13:56:51.286 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - 200 null application/json; charset=utf-8 18.7544ms
2025-09-05 13:56:51.307 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 13:56:51.310 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 13:56:51.311 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 13:56:51.319 +07:00 [ERR] 2025-09-05 13:56:51.319073 ThreadID:10  (ERROR)   OracleRelationalCommand.ExecuteReaderAsync() :  Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
2025-09-05 13:56:51.320 +07:00 [ERR] Failed executing DbCommand (5ms) [Parameters=[:p0='?' (DbType = DateTime), :p1='?' (Size = 2000), :p2='?' (DbType = Int64), :p3='?' (Size = 64), :p4='?' (Size = 2000), :p5='?' (DbType = DateTime), :cur0='?' (Direction = Output) (DbType = Object)], CommandType='"Text"', CommandTimeout='0']
DECLARE

TYPE "rCARTS_0" IS RECORD
(
"ID" NUMBER(19)
);
TYPE "tCARTS_0" IS TABLE OF "rCARTS_0";
"lCARTS_0" "tCARTS_0";

BEGIN

"lCARTS_0" := "tCARTS_0"();
"lCARTS_0".extend(1);
INSERT INTO "HEHE"."CARTS" ("CREATED_AT", "CURRENCY", "CUSTOMER_ID", "SESSION_TOKEN", "STATUS", "UPDATED_AT")
VALUES (:p0, :p1, :p2, :p3, :p4, :p5)
RETURNING "ID" INTO "lCARTS_0"(1)."ID";
OPEN :cur0 FOR SELECT "lCARTS_0"(1)."ID" FROM DUAL;

END;
2025-09-05 13:56:51.326 +07:00 [ERR] 2025-09-05 13:56:51.326477 ThreadID:10  (ERROR)   OracleExecutionStrategy.ExecuteAsync() :  Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
2025-09-05 13:56:51.330 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'PHONE_STORE.Infrastructure.Data.PhoneDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-09-05 13:56:51.441 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 128.2011ms
2025-09-05 13:56:51.444 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 13:56:51.446 +07:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at PHONE_STORE.Infrastructure.Repositories.CartRepository.EnsureCartId(Nullable`1 customerId, String sessionId, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.Infrastructure\Repositories\CartRepository.cs:line 50
   at PHONE_STORE.Infrastructure.Repositories.CartRepository.GetOrCreateAsync(Nullable`1 customerId, String sessionId, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.Infrastructure\Repositories\CartRepository.cs:line 77
   at lambda_method31(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-05 13:56:51.466 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 500 null application/problem+json; charset=utf-8 158.7138ms
2025-09-05 13:56:52.094 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 13:56:52.096 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 13:56:52.097 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 13:56:52.105 +07:00 [ERR] 2025-09-05 13:56:52.105195 ThreadID:9   (ERROR)   OracleRelationalCommand.ExecuteReaderAsync() :  Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
2025-09-05 13:56:52.106 +07:00 [ERR] Failed executing DbCommand (5ms) [Parameters=[:p0='?' (DbType = DateTime), :p1='?' (Size = 2000), :p2='?' (DbType = Int64), :p3='?' (Size = 64), :p4='?' (Size = 2000), :p5='?' (DbType = DateTime), :cur0='?' (Direction = Output) (DbType = Object)], CommandType='"Text"', CommandTimeout='0']
DECLARE

TYPE "rCARTS_0" IS RECORD
(
"ID" NUMBER(19)
);
TYPE "tCARTS_0" IS TABLE OF "rCARTS_0";
"lCARTS_0" "tCARTS_0";

BEGIN

"lCARTS_0" := "tCARTS_0"();
"lCARTS_0".extend(1);
INSERT INTO "HEHE"."CARTS" ("CREATED_AT", "CURRENCY", "CUSTOMER_ID", "SESSION_TOKEN", "STATUS", "UPDATED_AT")
VALUES (:p0, :p1, :p2, :p3, :p4, :p5)
RETURNING "ID" INTO "lCARTS_0"(1)."ID";
OPEN :cur0 FOR SELECT "lCARTS_0"(1)."ID" FROM DUAL;

END;
2025-09-05 13:56:52.110 +07:00 [ERR] 2025-09-05 13:56:52.110044 ThreadID:9   (ERROR)   OracleExecutionStrategy.ExecuteAsync() :  Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
2025-09-05 13:56:52.113 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'PHONE_STORE.Infrastructure.Data.PhoneDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-09-05 13:56:52.220 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 121.1906ms
2025-09-05 13:56:52.222 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 13:56:52.224 +07:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at PHONE_STORE.Infrastructure.Repositories.CartRepository.EnsureCartId(Nullable`1 customerId, String sessionId, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.Infrastructure\Repositories\CartRepository.cs:line 50
   at PHONE_STORE.Infrastructure.Repositories.CartRepository.GetOrCreateAsync(Nullable`1 customerId, String sessionId, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.Infrastructure\Repositories\CartRepository.cs:line 77
   at lambda_method31(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-05 13:56:52.241 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 500 null application/problem+json; charset=utf-8 146.9278ms
2025-09-05 14:03:06.588 +07:00 [INF] User profile is available. Using 'C:\Users\Administrator\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-09-05 14:03:06.898 +07:00 [INF] Now listening on: https://localhost:7277
2025-09-05 14:03:06.899 +07:00 [INF] Now listening on: http://localhost:5209
2025-09-05 14:03:07.011 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-05 14:03:07.012 +07:00 [INF] Hosting environment: Development
2025-09-05 14:03:07.013 +07:00 [INF] Content root path: C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.API
2025-09-05 14:03:07.444 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/swagger/index.html - null null
2025-09-05 14:03:07.880 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/swagger/index.html - 200 null text/html;charset=utf-8 443.8234ms
2025-09-05 14:03:08.034 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/_vs/browserLink - null null
2025-09-05 14:03:08.034 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/_framework/aspnetcore-browser-refresh.js - null null
2025-09-05 14:03:08.053 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/_framework/aspnetcore-browser-refresh.js - 200 13766 application/javascript; charset=utf-8 19.3825ms
2025-09-05 14:03:08.095 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/_vs/browserLink - 200 null text/javascript; charset=UTF-8 61.3376ms
2025-09-05 14:03:08.208 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/swagger/v1/swagger.json - null null
2025-09-05 14:03:08.397 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 188.695ms
2025-09-05 14:03:08.699 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - null null
2025-09-05 14:03:08.796 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 14:03:08.818 +07:00 [INF] Route matched with {action = "List", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem]]] List(System.String, System.Nullable`1[System.Int64], Int32, Int32, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 14:03:09.433 +07:00 [WRN] The decimal property 'UnitPrice' on entity type 'CartItem' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 14:03:09.435 +07:00 [WRN] The decimal property 'DiscountTotal' on entity type 'Order' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 14:03:09.436 +07:00 [WRN] The decimal property 'GrandTotal' on entity type 'Order' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 14:03:09.437 +07:00 [WRN] The decimal property 'ShippingFee' on entity type 'Order' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 14:03:09.438 +07:00 [WRN] The decimal property 'Subtotal' on entity type 'Order' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 14:03:09.439 +07:00 [WRN] The decimal property 'TaxTotal' on entity type 'Order' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 14:03:09.439 +07:00 [WRN] The decimal property 'DiscountAmount' on entity type 'OrderItem' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 14:03:09.440 +07:00 [WRN] The decimal property 'TaxAmount' on entity type 'OrderItem' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 14:03:09.440 +07:00 [WRN] The decimal property 'UnitPrice' on entity type 'OrderItem' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 14:03:09.441 +07:00 [WRN] The decimal property 'DecValue' on entity type 'ProductAttributeValue' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 14:03:09.442 +07:00 [WRN] The decimal property 'ListPrice' on entity type 'ProductPrice' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 14:03:09.442 +07:00 [WRN] The decimal property 'SalePrice' on entity type 'ProductPrice' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 14:03:09.443 +07:00 [WRN] The decimal property 'WeightGram' on entity type 'ProductVariant' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 14:03:10.154 +07:00 [INF] Executed DbCommand (110ms) [Parameters=[:p_0='?' (DbType = Int32), :p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."ID" "Id", "p"."NAME" "Name", "p"."SLUG" "Slug"
FROM "HEHE"."PRODUCTS" "p"
WHERE "p"."IS_ACTIVE" = 1
ORDER BY "p"."CREATED_AT" DESC
OFFSET :p_0 ROWS FETCH NEXT :p_1 ROWS ONLY
2025-09-05 14:03:10.275 +07:00 [INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", (
    SELECT "p0"."IMAGE_URL"
    FROM "HEHE"."PRODUCT_IMAGES" "p0"
    WHERE (("p0"."PRODUCT_ID" IS NOT NULL AND "p0"."PRODUCT_ID" IN (3, 2, 1)) AND ("p"."PRODUCT_ID" = "p0"."PRODUCT_ID"))
    ORDER BY "p0"."SORT_ORDER"
    FETCH FIRST 1 ROWS ONLY) "Url"
FROM "HEHE"."PRODUCT_IMAGES" "p"
WHERE "p"."PRODUCT_ID" IS NOT NULL AND "p"."PRODUCT_ID" IN (3, 2, 1)
GROUP BY "p"."PRODUCT_ID"
2025-09-05 14:03:10.320 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", MIN(COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")) "MinPrice"
FROM "HEHE"."PRODUCT_VARIANTS" "p"
INNER JOIN "HEHE"."PRODUCT_PRICES" "p0" ON "p"."ID" = "p0"."VARIANT_ID"
WHERE (("p"."PRODUCT_ID" IN (3, 2, 1)) AND ((("p0"."STARTS_AT" <= :now_1) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))))
GROUP BY "p"."PRODUCT_ID"
2025-09-05 14:03:10.335 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem, PHONE_STORE.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-05 14:03:10.349 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API) in 1527.7588ms
2025-09-05 14:03:10.351 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 14:03:10.358 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - 200 null application/json; charset=utf-8 1659.9242ms
2025-09-05 14:03:10.560 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 14:03:10.565 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:03:10.568 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 14:03:10.655 +07:00 [INF] Executed DbCommand (8ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:03:10.726 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:03:10.767 +07:00 [INF] Executed DbCommand (24ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 14:03:10.782 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 14:03:10.791 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 221.3815ms
2025-09-05 14:03:10.793 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:03:10.794 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 234.3069ms
2025-09-05 14:03:16.443 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 14:03:16.449 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:03:16.450 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 14:03:16.473 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:03:16.482 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:03:16.490 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 14:03:16.492 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 14:03:16.494 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 41.8703ms
2025-09-05 14:03:16.495 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:03:16.496 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 52.9475ms
2025-09-05 14:03:16.535 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 14:03:16.537 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:03:16.538 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 14:03:16.550 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:03:16.559 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:03:16.563 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 14:03:16.565 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 14:03:16.566 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 26.2871ms
2025-09-05 14:03:16.567 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:03:16.568 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 33.1119ms
2025-09-05 14:03:20.310 +07:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7277/api/shop/cart/items/1?qty=2 - null 0
2025-09-05 14:03:20.313 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Update (PHONE_STORE.API)'
2025-09-05 14:03:20.317 +07:00 [INF] Route matched with {action = "Update", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Update(Int64, Int32, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 14:03:20.326 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:03:20.337 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:id_0='?' (DbType = Int64), :itemId_1='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE"
FROM "HEHE"."CART_ITEMS" "c"
WHERE (("c"."CART_ID" = :id_0) AND ("c"."VARIANT_ID" = :itemId_1))
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:03:20.537 +07:00 [INF] Executed DbCommand (32ms) [Parameters=[:p1='?' (DbType = Int64), :p2='?' (DbType = Int64), :p0='?' (DbType = Int32), :cur0='?' (Direction = Output) (DbType = Object)], CommandType='"Text"', CommandTimeout='0']
DECLARE

v_RowCount INTEGER;

BEGIN

UPDATE "HEHE"."CART_ITEMS" SET "QUANTITY" = :p0
WHERE "CART_ID" = :p1 AND "VARIANT_ID" = :p2;
v_RowCount := SQL%ROWCOUNT;
OPEN :cur0 FOR SELECT v_RowCount FROM DUAL;

END;
2025-09-05 14:03:20.588 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:03:20.593 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:03:20.595 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 14:03:20.597 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 14:03:20.598 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Update (PHONE_STORE.API) in 279.4236ms
2025-09-05 14:03:20.598 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Update (PHONE_STORE.API)'
2025-09-05 14:03:20.599 +07:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7277/api/shop/cart/items/1?qty=2 - 200 null application/json; charset=utf-8 289.0713ms
2025-09-05 14:03:20.606 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 14:03:20.608 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:03:20.608 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 14:03:20.611 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:03:20.614 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:03:20.617 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 14:03:20.618 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 14:03:20.619 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 10.2287ms
2025-09-05 14:03:20.620 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:03:20.621 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 15.2035ms
2025-09-05 14:03:20.642 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 14:03:20.645 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:03:20.646 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 14:03:20.650 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:03:20.655 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:03:20.659 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 14:03:20.663 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 14:03:20.664 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 16.2195ms
2025-09-05 14:03:20.665 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:03:20.666 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 24.3078ms
2025-09-05 14:03:23.464 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/me/addresses - null null
2025-09-05 14:03:23.472 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopMeController.MyAddresses (PHONE_STORE.API)'
2025-09-05 14:03:23.476 +07:00 [INF] Route matched with {action = "MyAddresses", controller = "ShopMe"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.Application.Dtos.AddressDto]]] MyAddresses(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopMeController (PHONE_STORE.API).
2025-09-05 14:03:23.481 +07:00 [INF] Executing ObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ProblemDetails'.
2025-09-05 14:03:23.496 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopMeController.MyAddresses (PHONE_STORE.API) in 18.7902ms
2025-09-05 14:03:23.497 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopMeController.MyAddresses (PHONE_STORE.API)'
2025-09-05 14:03:23.499 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/me/addresses - 401 null application/problem+json; charset=utf-8 35.7845ms
2025-09-05 14:06:44.689 +07:00 [INF] User profile is available. Using 'C:\Users\Administrator\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-09-05 14:06:44.943 +07:00 [INF] Now listening on: https://localhost:7277
2025-09-05 14:06:44.944 +07:00 [INF] Now listening on: http://localhost:5209
2025-09-05 14:06:45.041 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-05 14:06:45.043 +07:00 [INF] Hosting environment: Development
2025-09-05 14:06:45.044 +07:00 [INF] Content root path: C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.API
2025-09-05 14:06:45.420 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/swagger/index.html - null null
2025-09-05 14:06:45.624 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/swagger/index.html - 200 null text/html;charset=utf-8 213.9686ms
2025-09-05 14:06:45.631 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/_framework/aspnetcore-browser-refresh.js - null null
2025-09-05 14:06:45.631 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/_vs/browserLink - null null
2025-09-05 14:06:45.643 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/_framework/aspnetcore-browser-refresh.js - 200 13766 application/javascript; charset=utf-8 11.791ms
2025-09-05 14:06:45.696 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/_vs/browserLink - 200 null text/javascript; charset=UTF-8 65.4518ms
2025-09-05 14:06:45.753 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/swagger/v1/swagger.json - null null
2025-09-05 14:06:45.851 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 98.5195ms
2025-09-05 14:06:46.365 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - null null
2025-09-05 14:06:46.453 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 14:06:46.473 +07:00 [INF] Route matched with {action = "List", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem]]] List(System.String, System.Nullable`1[System.Int64], Int32, Int32, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 14:06:47.172 +07:00 [WRN] The decimal property 'UnitPrice' on entity type 'CartItem' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 14:06:47.174 +07:00 [WRN] The decimal property 'DiscountTotal' on entity type 'Order' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 14:06:47.174 +07:00 [WRN] The decimal property 'GrandTotal' on entity type 'Order' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 14:06:47.175 +07:00 [WRN] The decimal property 'ShippingFee' on entity type 'Order' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 14:06:47.176 +07:00 [WRN] The decimal property 'Subtotal' on entity type 'Order' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 14:06:47.177 +07:00 [WRN] The decimal property 'TaxTotal' on entity type 'Order' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 14:06:47.177 +07:00 [WRN] The decimal property 'DiscountAmount' on entity type 'OrderItem' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 14:06:47.179 +07:00 [WRN] The decimal property 'TaxAmount' on entity type 'OrderItem' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 14:06:47.180 +07:00 [WRN] The decimal property 'UnitPrice' on entity type 'OrderItem' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 14:06:47.181 +07:00 [WRN] The decimal property 'DecValue' on entity type 'ProductAttributeValue' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 14:06:47.182 +07:00 [WRN] The decimal property 'ListPrice' on entity type 'ProductPrice' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 14:06:47.183 +07:00 [WRN] The decimal property 'SalePrice' on entity type 'ProductPrice' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 14:06:47.184 +07:00 [WRN] The decimal property 'WeightGram' on entity type 'ProductVariant' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 14:06:47.897 +07:00 [INF] Executed DbCommand (107ms) [Parameters=[:p_0='?' (DbType = Int32), :p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."ID" "Id", "p"."NAME" "Name", "p"."SLUG" "Slug"
FROM "HEHE"."PRODUCTS" "p"
WHERE "p"."IS_ACTIVE" = 1
ORDER BY "p"."CREATED_AT" DESC
OFFSET :p_0 ROWS FETCH NEXT :p_1 ROWS ONLY
2025-09-05 14:06:48.009 +07:00 [INF] Executed DbCommand (10ms) [Parameters=[], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", (
    SELECT "p0"."IMAGE_URL"
    FROM "HEHE"."PRODUCT_IMAGES" "p0"
    WHERE (("p0"."PRODUCT_ID" IS NOT NULL AND "p0"."PRODUCT_ID" IN (3, 2, 1)) AND ("p"."PRODUCT_ID" = "p0"."PRODUCT_ID"))
    ORDER BY "p0"."SORT_ORDER"
    FETCH FIRST 1 ROWS ONLY) "Url"
FROM "HEHE"."PRODUCT_IMAGES" "p"
WHERE "p"."PRODUCT_ID" IS NOT NULL AND "p"."PRODUCT_ID" IN (3, 2, 1)
GROUP BY "p"."PRODUCT_ID"
2025-09-05 14:06:48.055 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", MIN(COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")) "MinPrice"
FROM "HEHE"."PRODUCT_VARIANTS" "p"
INNER JOIN "HEHE"."PRODUCT_PRICES" "p0" ON "p"."ID" = "p0"."VARIANT_ID"
WHERE (("p"."PRODUCT_ID" IN (3, 2, 1)) AND ((("p0"."STARTS_AT" <= :now_1) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))))
GROUP BY "p"."PRODUCT_ID"
2025-09-05 14:06:48.070 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem, PHONE_STORE.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-05 14:06:48.084 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API) in 1606.4712ms
2025-09-05 14:06:48.086 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 14:06:48.092 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - 200 null application/json; charset=utf-8 1729.0455ms
2025-09-05 14:06:48.272 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 14:06:48.282 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:06:48.289 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 14:06:48.373 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:06:48.434 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:06:48.447 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 14:06:48.460 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 14:06:48.473 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 179.0713ms
2025-09-05 14:06:48.474 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:06:48.475 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 202.4888ms
2025-09-05 14:06:50.107 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 14:06:50.111 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:06:50.112 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 14:06:50.129 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:06:50.132 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:06:50.136 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 14:06:50.137 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 14:06:50.138 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 24.9406ms
2025-09-05 14:06:50.139 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:06:50.139 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 32.6611ms
2025-09-05 14:06:50.174 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 14:06:50.176 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:06:50.177 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 14:06:50.185 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:06:50.189 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:06:50.195 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 14:06:50.196 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 14:06:50.197 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 19.0771ms
2025-09-05 14:06:50.198 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:06:50.199 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 25.1239ms
2025-09-05 14:06:52.570 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/me/addresses - null null
2025-09-05 14:06:52.577 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopMeController.MyAddresses (PHONE_STORE.API)'
2025-09-05 14:06:52.583 +07:00 [INF] Route matched with {action = "MyAddresses", controller = "ShopMe"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.Application.Dtos.AddressDto]]] MyAddresses(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopMeController (PHONE_STORE.API).
2025-09-05 14:06:52.588 +07:00 [INF] Executing ObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ProblemDetails'.
2025-09-05 14:06:52.602 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopMeController.MyAddresses (PHONE_STORE.API) in 16.7322ms
2025-09-05 14:06:52.604 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopMeController.MyAddresses (PHONE_STORE.API)'
2025-09-05 14:06:52.605 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/me/addresses - 401 null application/problem+json; charset=utf-8 34.8841ms
2025-09-05 14:06:52.608 +07:00 [INF] Request starting HTTP/1.1 POST https://localhost:7277/api/auth/refresh - null 0
2025-09-05 14:06:52.609 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.AuthController.Refresh (PHONE_STORE.API)'
2025-09-05 14:06:52.613 +07:00 [INF] Route matched with {action = "Refresh", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Refresh(RefreshRequest, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.AuthController (PHONE_STORE.API).
2025-09-05 14:06:52.754 +07:00 [INF] Executing ObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ProblemDetails'.
2025-09-05 14:06:52.757 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.AuthController.Refresh (PHONE_STORE.API) in 142.6635ms
2025-09-05 14:06:52.758 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.AuthController.Refresh (PHONE_STORE.API)'
2025-09-05 14:06:52.759 +07:00 [INF] Request finished HTTP/1.1 POST https://localhost:7277/api/auth/refresh - 415 null application/problem+json; charset=utf-8 150.9282ms
2025-09-05 14:13:10.805 +07:00 [INF] User profile is available. Using 'C:\Users\Administrator\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-09-05 14:13:11.083 +07:00 [INF] Now listening on: https://localhost:7277
2025-09-05 14:13:11.085 +07:00 [INF] Now listening on: http://localhost:5209
2025-09-05 14:13:11.185 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-05 14:13:11.186 +07:00 [INF] Hosting environment: Development
2025-09-05 14:13:11.186 +07:00 [INF] Content root path: C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.API
2025-09-05 14:13:11.923 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/swagger/index.html - null null
2025-09-05 14:13:12.460 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/swagger/index.html - 200 null text/html;charset=utf-8 548.1228ms
2025-09-05 14:13:12.486 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/_framework/aspnetcore-browser-refresh.js - null null
2025-09-05 14:13:12.487 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/_vs/browserLink - null null
2025-09-05 14:13:12.530 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/_framework/aspnetcore-browser-refresh.js - 200 13766 application/javascript; charset=utf-8 44.3641ms
2025-09-05 14:13:12.619 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/_vs/browserLink - 200 null text/javascript; charset=UTF-8 132.427ms
2025-09-05 14:13:12.734 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/swagger/v1/swagger.json - null null
2025-09-05 14:13:12.821 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 86.7594ms
2025-09-05 14:13:12.824 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - null null
2025-09-05 14:13:12.938 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 14:13:12.983 +07:00 [INF] Route matched with {action = "List", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem]]] List(System.String, System.Nullable`1[System.Int64], Int32, Int32, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 14:13:13.677 +07:00 [WRN] The decimal property 'UnitPrice' on entity type 'CartItem' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 14:13:13.679 +07:00 [WRN] The decimal property 'DiscountTotal' on entity type 'Order' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 14:13:13.680 +07:00 [WRN] The decimal property 'GrandTotal' on entity type 'Order' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 14:13:13.682 +07:00 [WRN] The decimal property 'ShippingFee' on entity type 'Order' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 14:13:13.683 +07:00 [WRN] The decimal property 'Subtotal' on entity type 'Order' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 14:13:13.684 +07:00 [WRN] The decimal property 'TaxTotal' on entity type 'Order' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 14:13:13.686 +07:00 [WRN] The decimal property 'DiscountAmount' on entity type 'OrderItem' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 14:13:13.687 +07:00 [WRN] The decimal property 'TaxAmount' on entity type 'OrderItem' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 14:13:13.688 +07:00 [WRN] The decimal property 'UnitPrice' on entity type 'OrderItem' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 14:13:13.689 +07:00 [WRN] The decimal property 'DecValue' on entity type 'ProductAttributeValue' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 14:13:13.693 +07:00 [WRN] The decimal property 'ListPrice' on entity type 'ProductPrice' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 14:13:13.696 +07:00 [WRN] The decimal property 'SalePrice' on entity type 'ProductPrice' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 14:13:13.698 +07:00 [WRN] The decimal property 'WeightGram' on entity type 'ProductVariant' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 14:13:14.427 +07:00 [INF] Executed DbCommand (109ms) [Parameters=[:p_0='?' (DbType = Int32), :p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."ID" "Id", "p"."NAME" "Name", "p"."SLUG" "Slug"
FROM "HEHE"."PRODUCTS" "p"
WHERE "p"."IS_ACTIVE" = 1
ORDER BY "p"."CREATED_AT" DESC
OFFSET :p_0 ROWS FETCH NEXT :p_1 ROWS ONLY
2025-09-05 14:13:14.569 +07:00 [INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", (
    SELECT "p0"."IMAGE_URL"
    FROM "HEHE"."PRODUCT_IMAGES" "p0"
    WHERE (("p0"."PRODUCT_ID" IS NOT NULL AND "p0"."PRODUCT_ID" IN (3, 2, 1)) AND ("p"."PRODUCT_ID" = "p0"."PRODUCT_ID"))
    ORDER BY "p0"."SORT_ORDER"
    FETCH FIRST 1 ROWS ONLY) "Url"
FROM "HEHE"."PRODUCT_IMAGES" "p"
WHERE "p"."PRODUCT_ID" IS NOT NULL AND "p"."PRODUCT_ID" IN (3, 2, 1)
GROUP BY "p"."PRODUCT_ID"
2025-09-05 14:13:14.620 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", MIN(COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")) "MinPrice"
FROM "HEHE"."PRODUCT_VARIANTS" "p"
INNER JOIN "HEHE"."PRODUCT_PRICES" "p0" ON "p"."ID" = "p0"."VARIANT_ID"
WHERE (("p"."PRODUCT_ID" IN (3, 2, 1)) AND ((("p0"."STARTS_AT" <= :now_1) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))))
GROUP BY "p"."PRODUCT_ID"
2025-09-05 14:13:14.636 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem, PHONE_STORE.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-05 14:13:14.650 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API) in 1662.1078ms
2025-09-05 14:13:14.652 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 14:13:14.661 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - 200 null application/json; charset=utf-8 1838.5068ms
2025-09-05 14:13:14.839 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 14:13:14.849 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:13:14.859 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 14:13:14.945 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:13:15.009 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:13:15.024 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 14:13:15.036 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 14:13:15.048 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 187.055ms
2025-09-05 14:13:15.049 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:13:15.050 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 210.346ms
2025-09-05 14:13:16.367 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 14:13:16.371 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:13:16.372 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 14:13:16.391 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:13:16.396 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:13:16.401 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 14:13:16.403 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 14:13:16.404 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 30.3872ms
2025-09-05 14:13:16.405 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:13:16.406 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 38.737ms
2025-09-05 14:13:16.452 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 14:13:16.455 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:13:16.458 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 14:13:16.469 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:13:16.478 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:13:16.483 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 14:13:16.492 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 14:13:16.494 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 31.1513ms
2025-09-05 14:13:16.501 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:13:16.506 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 54.7512ms
2025-09-05 14:13:17.781 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/me/addresses - null null
2025-09-05 14:13:17.790 +07:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2025-09-05 14:13:17.795 +07:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-09-05 14:13:17.797 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/me/addresses - 401 0 null 16.0465ms
2025-09-05 14:13:24.389 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 14:13:24.391 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:13:24.391 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 14:13:24.402 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:13:24.410 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:13:24.415 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 14:13:24.418 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 14:13:24.419 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 22.6662ms
2025-09-05 14:13:24.420 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:13:24.422 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 33.0743ms
2025-09-05 14:13:36.500 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - null null
2025-09-05 14:13:36.502 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 14:13:36.503 +07:00 [INF] Route matched with {action = "List", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem]]] List(System.String, System.Nullable`1[System.Int64], Int32, Int32, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 14:13:36.511 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:p_0='?' (DbType = Int32), :p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."ID" "Id", "p"."NAME" "Name", "p"."SLUG" "Slug"
FROM "HEHE"."PRODUCTS" "p"
WHERE "p"."IS_ACTIVE" = 1
ORDER BY "p"."CREATED_AT" DESC
OFFSET :p_0 ROWS FETCH NEXT :p_1 ROWS ONLY
2025-09-05 14:13:36.517 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", (
    SELECT "p0"."IMAGE_URL"
    FROM "HEHE"."PRODUCT_IMAGES" "p0"
    WHERE (("p0"."PRODUCT_ID" IS NOT NULL AND "p0"."PRODUCT_ID" IN (3, 2, 1)) AND ("p"."PRODUCT_ID" = "p0"."PRODUCT_ID"))
    ORDER BY "p0"."SORT_ORDER"
    FETCH FIRST 1 ROWS ONLY) "Url"
FROM "HEHE"."PRODUCT_IMAGES" "p"
WHERE "p"."PRODUCT_ID" IS NOT NULL AND "p"."PRODUCT_ID" IN (3, 2, 1)
GROUP BY "p"."PRODUCT_ID"
2025-09-05 14:13:36.525 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", MIN(COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")) "MinPrice"
FROM "HEHE"."PRODUCT_VARIANTS" "p"
INNER JOIN "HEHE"."PRODUCT_PRICES" "p0" ON "p"."ID" = "p0"."VARIANT_ID"
WHERE (("p"."PRODUCT_ID" IN (3, 2, 1)) AND ((("p0"."STARTS_AT" <= :now_1) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))))
GROUP BY "p"."PRODUCT_ID"
2025-09-05 14:13:36.527 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem, PHONE_STORE.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-05 14:13:36.528 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API) in 24.1111ms
2025-09-05 14:13:36.529 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 14:13:36.529 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - 200 null application/json; charset=utf-8 29.5972ms
2025-09-05 14:13:36.550 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 14:13:36.552 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:13:36.554 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 14:13:36.562 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:13:36.580 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:13:36.585 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 14:13:36.587 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 14:13:36.588 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 31.8644ms
2025-09-05 14:13:36.589 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:13:36.589 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 39.4036ms
2025-09-05 14:13:37.486 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - null null
2025-09-05 14:13:37.488 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 14:13:37.488 +07:00 [INF] Route matched with {action = "List", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem]]] List(System.String, System.Nullable`1[System.Int64], Int32, Int32, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 14:13:37.494 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:p_0='?' (DbType = Int32), :p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."ID" "Id", "p"."NAME" "Name", "p"."SLUG" "Slug"
FROM "HEHE"."PRODUCTS" "p"
WHERE "p"."IS_ACTIVE" = 1
ORDER BY "p"."CREATED_AT" DESC
OFFSET :p_0 ROWS FETCH NEXT :p_1 ROWS ONLY
2025-09-05 14:13:37.498 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", (
    SELECT "p0"."IMAGE_URL"
    FROM "HEHE"."PRODUCT_IMAGES" "p0"
    WHERE (("p0"."PRODUCT_ID" IS NOT NULL AND "p0"."PRODUCT_ID" IN (3, 2, 1)) AND ("p"."PRODUCT_ID" = "p0"."PRODUCT_ID"))
    ORDER BY "p0"."SORT_ORDER"
    FETCH FIRST 1 ROWS ONLY) "Url"
FROM "HEHE"."PRODUCT_IMAGES" "p"
WHERE "p"."PRODUCT_ID" IS NOT NULL AND "p"."PRODUCT_ID" IN (3, 2, 1)
GROUP BY "p"."PRODUCT_ID"
2025-09-05 14:13:37.504 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", MIN(COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")) "MinPrice"
FROM "HEHE"."PRODUCT_VARIANTS" "p"
INNER JOIN "HEHE"."PRODUCT_PRICES" "p0" ON "p"."ID" = "p0"."VARIANT_ID"
WHERE (("p"."PRODUCT_ID" IN (3, 2, 1)) AND ((("p0"."STARTS_AT" <= :now_1) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))))
GROUP BY "p"."PRODUCT_ID"
2025-09-05 14:13:37.506 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem, PHONE_STORE.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-05 14:13:37.508 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API) in 17.1298ms
2025-09-05 14:13:37.508 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 14:13:37.509 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - 200 null application/json; charset=utf-8 23.634ms
2025-09-05 14:13:37.532 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 14:13:37.534 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:13:37.535 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 14:13:37.541 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:13:37.558 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:13:37.562 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 14:13:37.565 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 14:13:37.566 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 28.0921ms
2025-09-05 14:13:37.566 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:13:37.567 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 35.4665ms
2025-09-05 14:14:15.583 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 14:14:15.585 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:14:15.586 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 14:14:15.595 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:14:15.600 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:14:15.606 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 14:14:15.610 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 14:14:15.611 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 23.7651ms
2025-09-05 14:14:15.612 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:14:15.613 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 30.2696ms
2025-09-05 14:14:15.647 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 14:14:15.650 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:14:15.650 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 14:14:15.658 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:14:15.666 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:14:15.675 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 14:14:15.678 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 14:14:15.679 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 26.1586ms
2025-09-05 14:14:15.680 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:14:15.681 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 33.6892ms
2025-09-05 14:14:17.359 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/me/addresses - null null
2025-09-05 14:14:17.362 +07:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2025-09-05 14:14:17.363 +07:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-09-05 14:14:17.364 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/me/addresses - 401 0 null 5.6448ms
2025-09-05 14:28:10.762 +07:00 [INF] User profile is available. Using 'C:\Users\Administrator\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-09-05 14:28:10.990 +07:00 [INF] Now listening on: https://localhost:7277
2025-09-05 14:28:10.991 +07:00 [INF] Now listening on: http://localhost:5209
2025-09-05 14:28:11.120 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-05 14:28:11.121 +07:00 [INF] Hosting environment: Development
2025-09-05 14:28:11.122 +07:00 [INF] Content root path: C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.API
2025-09-05 14:28:11.507 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/swagger/index.html - null null
2025-09-05 14:28:12.114 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/swagger/index.html - 200 null text/html;charset=utf-8 558.3216ms
2025-09-05 14:28:12.115 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/_vs/browserLink - null null
2025-09-05 14:28:12.115 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/_framework/aspnetcore-browser-refresh.js - null null
2025-09-05 14:28:12.305 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/_framework/aspnetcore-browser-refresh.js - 200 13766 application/javascript; charset=utf-8 190.044ms
2025-09-05 14:28:12.374 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/_vs/browserLink - 200 null text/javascript; charset=UTF-8 259.1433ms
2025-09-05 14:28:12.424 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/swagger/v1/swagger.json - null null
2025-09-05 14:28:12.609 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 184.9018ms
2025-09-05 14:28:12.949 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - null null
2025-09-05 14:28:12.986 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 14:28:13.008 +07:00 [INF] Route matched with {action = "List", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem]]] List(System.String, System.Nullable`1[System.Int64], Int32, Int32, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 14:28:13.632 +07:00 [WRN] The decimal property 'UnitPrice' on entity type 'CartItem' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 14:28:13.635 +07:00 [WRN] The decimal property 'DiscountTotal' on entity type 'Order' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 14:28:13.636 +07:00 [WRN] The decimal property 'GrandTotal' on entity type 'Order' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 14:28:13.638 +07:00 [WRN] The decimal property 'ShippingFee' on entity type 'Order' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 14:28:13.639 +07:00 [WRN] The decimal property 'Subtotal' on entity type 'Order' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 14:28:13.640 +07:00 [WRN] The decimal property 'TaxTotal' on entity type 'Order' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 14:28:13.641 +07:00 [WRN] The decimal property 'DiscountAmount' on entity type 'OrderItem' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 14:28:13.642 +07:00 [WRN] The decimal property 'TaxAmount' on entity type 'OrderItem' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 14:28:13.643 +07:00 [WRN] The decimal property 'UnitPrice' on entity type 'OrderItem' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 14:28:13.648 +07:00 [WRN] The decimal property 'DecValue' on entity type 'ProductAttributeValue' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 14:28:13.649 +07:00 [WRN] The decimal property 'ListPrice' on entity type 'ProductPrice' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 14:28:13.651 +07:00 [WRN] The decimal property 'SalePrice' on entity type 'ProductPrice' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 14:28:13.653 +07:00 [WRN] The decimal property 'WeightGram' on entity type 'ProductVariant' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 14:28:14.321 +07:00 [INF] Executed DbCommand (100ms) [Parameters=[:p_0='?' (DbType = Int32), :p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."ID" "Id", "p"."NAME" "Name", "p"."SLUG" "Slug"
FROM "HEHE"."PRODUCTS" "p"
WHERE "p"."IS_ACTIVE" = 1
ORDER BY "p"."CREATED_AT" DESC
OFFSET :p_0 ROWS FETCH NEXT :p_1 ROWS ONLY
2025-09-05 14:28:14.430 +07:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", (
    SELECT "p0"."IMAGE_URL"
    FROM "HEHE"."PRODUCT_IMAGES" "p0"
    WHERE (("p0"."PRODUCT_ID" IS NOT NULL AND "p0"."PRODUCT_ID" IN (3, 2, 1)) AND ("p"."PRODUCT_ID" = "p0"."PRODUCT_ID"))
    ORDER BY "p0"."SORT_ORDER"
    FETCH FIRST 1 ROWS ONLY) "Url"
FROM "HEHE"."PRODUCT_IMAGES" "p"
WHERE "p"."PRODUCT_ID" IS NOT NULL AND "p"."PRODUCT_ID" IN (3, 2, 1)
GROUP BY "p"."PRODUCT_ID"
2025-09-05 14:28:14.481 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", MIN(COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")) "MinPrice"
FROM "HEHE"."PRODUCT_VARIANTS" "p"
INNER JOIN "HEHE"."PRODUCT_PRICES" "p0" ON "p"."ID" = "p0"."VARIANT_ID"
WHERE (("p"."PRODUCT_ID" IN (3, 2, 1)) AND ((("p0"."STARTS_AT" <= :now_1) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))))
GROUP BY "p"."PRODUCT_ID"
2025-09-05 14:28:14.497 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem, PHONE_STORE.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-05 14:28:14.513 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API) in 1500.2605ms
2025-09-05 14:28:14.516 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 14:28:14.525 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - 200 null application/json; charset=utf-8 1577.2485ms
2025-09-05 14:28:14.706 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 14:28:14.713 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:28:14.719 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 14:28:14.801 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:28:14.885 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:28:14.905 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 14:28:14.920 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 14:28:14.935 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 212.9398ms
2025-09-05 14:28:14.936 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:28:14.939 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 232.7904ms
2025-09-05 14:28:18.805 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 14:28:18.811 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:28:18.813 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 14:28:18.840 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:28:18.846 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:28:18.850 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 14:28:18.855 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 14:28:18.856 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 41.6539ms
2025-09-05 14:28:18.857 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:28:18.858 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 53.2217ms
2025-09-05 14:28:18.899 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 14:28:18.902 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:28:18.903 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 14:28:18.915 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:28:18.922 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:28:18.927 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 14:28:18.934 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 14:28:18.936 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 28.8521ms
2025-09-05 14:28:18.937 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:28:18.939 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 39.9182ms
2025-09-05 14:28:20.251 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/me/addresses - null null
2025-09-05 14:28:20.258 +07:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2025-09-05 14:28:20.264 +07:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-09-05 14:28:20.265 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/me/addresses - 401 0 null 14.2172ms
2025-09-05 14:28:24.519 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 14:28:24.521 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:28:24.522 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 14:28:24.531 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:28:24.538 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:28:24.550 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 14:28:24.553 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 14:28:24.557 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 33.4695ms
2025-09-05 14:28:24.558 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:28:24.562 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 43.2101ms
2025-09-05 14:28:26.062 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - null null
2025-09-05 14:28:26.064 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 14:28:26.065 +07:00 [INF] Route matched with {action = "List", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem]]] List(System.String, System.Nullable`1[System.Int64], Int32, Int32, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 14:28:26.072 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:p_0='?' (DbType = Int32), :p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."ID" "Id", "p"."NAME" "Name", "p"."SLUG" "Slug"
FROM "HEHE"."PRODUCTS" "p"
WHERE "p"."IS_ACTIVE" = 1
ORDER BY "p"."CREATED_AT" DESC
OFFSET :p_0 ROWS FETCH NEXT :p_1 ROWS ONLY
2025-09-05 14:28:26.079 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", (
    SELECT "p0"."IMAGE_URL"
    FROM "HEHE"."PRODUCT_IMAGES" "p0"
    WHERE (("p0"."PRODUCT_ID" IS NOT NULL AND "p0"."PRODUCT_ID" IN (3, 2, 1)) AND ("p"."PRODUCT_ID" = "p0"."PRODUCT_ID"))
    ORDER BY "p0"."SORT_ORDER"
    FETCH FIRST 1 ROWS ONLY) "Url"
FROM "HEHE"."PRODUCT_IMAGES" "p"
WHERE "p"."PRODUCT_ID" IS NOT NULL AND "p"."PRODUCT_ID" IN (3, 2, 1)
GROUP BY "p"."PRODUCT_ID"
2025-09-05 14:28:26.087 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", MIN(COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")) "MinPrice"
FROM "HEHE"."PRODUCT_VARIANTS" "p"
INNER JOIN "HEHE"."PRODUCT_PRICES" "p0" ON "p"."ID" = "p0"."VARIANT_ID"
WHERE (("p"."PRODUCT_ID" IN (3, 2, 1)) AND ((("p0"."STARTS_AT" <= :now_1) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))))
GROUP BY "p"."PRODUCT_ID"
2025-09-05 14:28:26.089 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem, PHONE_STORE.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-05 14:28:26.090 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API) in 23.6427ms
2025-09-05 14:28:26.091 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 14:28:26.092 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - 200 null application/json; charset=utf-8 29.7273ms
2025-09-05 14:28:26.113 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 14:28:26.116 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:28:26.117 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 14:28:26.122 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:28:26.126 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:28:26.136 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 14:28:26.139 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 14:28:26.140 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 20.8751ms
2025-09-05 14:28:26.140 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:28:26.141 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 28.3885ms
2025-09-05 14:28:32.676 +07:00 [INF] Request starting HTTP/1.1 POST https://localhost:7277/api/auth/logout - application/json; charset=utf-8 null
2025-09-05 14:28:32.678 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.AuthController.Logout (PHONE_STORE.API)'
2025-09-05 14:28:32.682 +07:00 [INF] Route matched with {action = "Logout", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Logout(RefreshRequest, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.AuthController (PHONE_STORE.API).
2025-09-05 14:28:32.914 +07:00 [INF] Logout: revoked RT
2025-09-05 14:28:32.916 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType1`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-05 14:28:32.919 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.AuthController.Logout (PHONE_STORE.API) in 235.7978ms
2025-09-05 14:28:32.920 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.AuthController.Logout (PHONE_STORE.API)'
2025-09-05 14:28:32.921 +07:00 [INF] Request finished HTTP/1.1 POST https://localhost:7277/api/auth/logout - 200 null application/json; charset=utf-8 244.888ms
2025-09-05 14:28:32.933 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - null null
2025-09-05 14:28:32.935 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 14:28:32.935 +07:00 [INF] Route matched with {action = "List", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem]]] List(System.String, System.Nullable`1[System.Int64], Int32, Int32, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 14:28:32.943 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:p_0='?' (DbType = Int32), :p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."ID" "Id", "p"."NAME" "Name", "p"."SLUG" "Slug"
FROM "HEHE"."PRODUCTS" "p"
WHERE "p"."IS_ACTIVE" = 1
ORDER BY "p"."CREATED_AT" DESC
OFFSET :p_0 ROWS FETCH NEXT :p_1 ROWS ONLY
2025-09-05 14:28:32.948 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", (
    SELECT "p0"."IMAGE_URL"
    FROM "HEHE"."PRODUCT_IMAGES" "p0"
    WHERE (("p0"."PRODUCT_ID" IS NOT NULL AND "p0"."PRODUCT_ID" IN (3, 2, 1)) AND ("p"."PRODUCT_ID" = "p0"."PRODUCT_ID"))
    ORDER BY "p0"."SORT_ORDER"
    FETCH FIRST 1 ROWS ONLY) "Url"
FROM "HEHE"."PRODUCT_IMAGES" "p"
WHERE "p"."PRODUCT_ID" IS NOT NULL AND "p"."PRODUCT_ID" IN (3, 2, 1)
GROUP BY "p"."PRODUCT_ID"
2025-09-05 14:28:32.955 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", MIN(COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")) "MinPrice"
FROM "HEHE"."PRODUCT_VARIANTS" "p"
INNER JOIN "HEHE"."PRODUCT_PRICES" "p0" ON "p"."ID" = "p0"."VARIANT_ID"
WHERE (("p"."PRODUCT_ID" IN (3, 2, 1)) AND ((("p0"."STARTS_AT" <= :now_1) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))))
GROUP BY "p"."PRODUCT_ID"
2025-09-05 14:28:32.957 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem, PHONE_STORE.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-05 14:28:32.958 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API) in 21.4782ms
2025-09-05 14:28:32.959 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 14:28:32.960 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - 200 null application/json; charset=utf-8 26.5441ms
2025-09-05 14:28:32.983 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 14:28:32.985 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:28:32.985 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 14:28:32.995 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:28:33.012 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:28:33.017 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 14:28:33.019 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 14:28:33.020 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 32.9356ms
2025-09-05 14:28:33.021 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:28:33.022 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 39.2341ms
2025-09-05 14:28:34.509 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 14:28:34.512 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:28:34.512 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 14:28:34.517 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:28:34.521 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:28:34.524 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 14:28:34.528 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 14:28:34.529 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 15.7344ms
2025-09-05 14:28:34.530 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:28:34.531 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 21.6917ms
2025-09-05 14:28:34.549 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 14:28:34.551 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:28:34.552 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 14:28:34.557 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:28:34.564 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:28:34.569 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 14:28:34.572 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 14:28:34.576 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 21.7161ms
2025-09-05 14:28:34.577 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:28:34.578 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 28.9581ms
2025-09-05 14:28:36.131 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 14:28:36.133 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:28:36.133 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 14:28:36.139 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:28:36.147 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:28:36.153 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 14:28:36.159 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 14:28:36.161 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 25.5711ms
2025-09-05 14:28:36.162 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:28:36.164 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 32.9656ms
2025-09-05 14:28:38.547 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 14:28:38.552 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:28:38.552 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 14:28:38.557 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:28:38.565 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:28:38.569 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 14:28:38.572 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 14:28:38.574 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 19.7494ms
2025-09-05 14:28:38.577 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:28:38.579 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 31.971ms
2025-09-05 14:28:46.747 +07:00 [INF] Request starting HTTP/1.1 POST https://localhost:7277/api/auth/login - application/json; charset=utf-8 null
2025-09-05 14:28:46.760 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.AuthController.Login (PHONE_STORE.API)'
2025-09-05 14:28:46.764 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(LoginRequest, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.AuthController (PHONE_STORE.API).
2025-09-05 14:28:46.772 +07:00 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-09-05 14:28:46.793 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.AuthController.Login (PHONE_STORE.API) in 28.1616ms
2025-09-05 14:28:46.796 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.AuthController.Login (PHONE_STORE.API)'
2025-09-05 14:28:46.797 +07:00 [INF] Request finished HTTP/1.1 POST https://localhost:7277/api/auth/login - 400 null application/problem+json; charset=utf-8 50.6196ms
2025-09-05 14:28:46.829 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 14:28:46.833 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:28:46.833 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 14:28:46.843 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:28:46.851 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:28:46.858 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 14:28:46.865 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 14:28:46.866 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 30.3373ms
2025-09-05 14:28:46.867 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:28:46.867 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 38.0915ms
2025-09-05 14:28:54.549 +07:00 [INF] Request starting HTTP/1.1 POST https://localhost:7277/api/auth/login - application/json; charset=utf-8 null
2025-09-05 14:28:54.551 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.AuthController.Login (PHONE_STORE.API)'
2025-09-05 14:28:54.551 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(LoginRequest, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.AuthController (PHONE_STORE.API).
2025-09-05 14:28:54.556 +07:00 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-09-05 14:28:54.557 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.AuthController.Login (PHONE_STORE.API) in 5.0871ms
2025-09-05 14:28:54.558 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.AuthController.Login (PHONE_STORE.API)'
2025-09-05 14:28:54.559 +07:00 [INF] Request finished HTTP/1.1 POST https://localhost:7277/api/auth/login - 400 null application/problem+json; charset=utf-8 10.4144ms
2025-09-05 14:28:54.581 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 14:28:54.584 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:28:54.586 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 14:28:54.598 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:28:54.605 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:28:54.612 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 14:28:54.615 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 14:28:54.616 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 27.6271ms
2025-09-05 14:28:54.617 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:28:54.617 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 36.3117ms
2025-09-05 14:29:02.064 +07:00 [INF] Request starting HTTP/1.1 POST https://localhost:7277/api/auth/login - application/json; charset=utf-8 null
2025-09-05 14:29:02.068 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.AuthController.Login (PHONE_STORE.API)'
2025-09-05 14:29:02.068 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(LoginRequest, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.AuthController (PHONE_STORE.API).
2025-09-05 14:29:02.071 +07:00 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-09-05 14:29:02.073 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.AuthController.Login (PHONE_STORE.API) in 2.5541ms
2025-09-05 14:29:02.075 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.AuthController.Login (PHONE_STORE.API)'
2025-09-05 14:29:02.076 +07:00 [INF] Request finished HTTP/1.1 POST https://localhost:7277/api/auth/login - 400 null application/problem+json; charset=utf-8 12.4882ms
2025-09-05 14:29:02.094 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 14:29:02.097 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:29:02.099 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 14:29:02.111 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:29:02.119 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:29:02.126 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 14:29:02.130 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 14:29:02.131 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 26.1757ms
2025-09-05 14:29:02.132 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:29:02.133 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 38.6807ms
2025-09-05 14:29:12.053 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 14:29:12.056 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:29:12.057 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 14:29:12.065 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:29:12.072 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:29:12.078 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 14:29:12.081 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 14:29:12.082 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 23.5696ms
2025-09-05 14:29:12.083 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:29:12.084 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 31.718ms
2025-09-05 14:29:21.081 +07:00 [INF] Request starting HTTP/1.1 POST https://localhost:7277/api/auth/login - application/json; charset=utf-8 null
2025-09-05 14:29:21.084 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.AuthController.Login (PHONE_STORE.API)'
2025-09-05 14:29:21.085 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(LoginRequest, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.AuthController (PHONE_STORE.API).
2025-09-05 14:29:21.089 +07:00 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-09-05 14:29:21.090 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.AuthController.Login (PHONE_STORE.API) in 3.4129ms
2025-09-05 14:29:21.091 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.AuthController.Login (PHONE_STORE.API)'
2025-09-05 14:29:21.092 +07:00 [INF] Request finished HTTP/1.1 POST https://localhost:7277/api/auth/login - 400 null application/problem+json; charset=utf-8 11.4926ms
2025-09-05 14:29:21.116 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 14:29:21.120 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:29:21.122 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 14:29:21.131 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:29:21.139 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:29:21.147 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 14:29:21.151 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 14:29:21.152 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 27.8129ms
2025-09-05 14:29:21.153 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:29:21.154 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 37.9851ms
2025-09-05 14:29:57.755 +07:00 [INF] User profile is available. Using 'C:\Users\Administrator\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-09-05 14:29:58.052 +07:00 [INF] Now listening on: https://localhost:7277
2025-09-05 14:29:58.054 +07:00 [INF] Now listening on: http://localhost:5209
2025-09-05 14:29:58.166 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-05 14:29:58.168 +07:00 [INF] Hosting environment: Development
2025-09-05 14:29:58.168 +07:00 [INF] Content root path: C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.API
2025-09-05 14:29:58.752 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/swagger/index.html - null null
2025-09-05 14:29:58.952 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/swagger/index.html - 200 null text/html;charset=utf-8 211.0522ms
2025-09-05 14:29:58.978 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/_framework/aspnetcore-browser-refresh.js - null null
2025-09-05 14:29:58.978 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/_vs/browserLink - null null
2025-09-05 14:29:58.988 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/_framework/aspnetcore-browser-refresh.js - 200 13766 application/javascript; charset=utf-8 10.7452ms
2025-09-05 14:29:59.021 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/_vs/browserLink - 200 null text/javascript; charset=UTF-8 43.5514ms
2025-09-05 14:29:59.048 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - null null
2025-09-05 14:29:59.097 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/swagger/v1/swagger.json - null null
2025-09-05 14:29:59.110 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 14:29:59.135 +07:00 [INF] Route matched with {action = "List", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem]]] List(System.String, System.Nullable`1[System.Int64], Int32, Int32, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 14:29:59.139 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 42.2898ms
2025-09-05 14:29:59.751 +07:00 [WRN] The decimal property 'UnitPrice' on entity type 'CartItem' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 14:29:59.753 +07:00 [WRN] The decimal property 'DiscountTotal' on entity type 'Order' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 14:29:59.754 +07:00 [WRN] The decimal property 'GrandTotal' on entity type 'Order' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 14:29:59.755 +07:00 [WRN] The decimal property 'ShippingFee' on entity type 'Order' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 14:29:59.757 +07:00 [WRN] The decimal property 'Subtotal' on entity type 'Order' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 14:29:59.758 +07:00 [WRN] The decimal property 'TaxTotal' on entity type 'Order' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 14:29:59.759 +07:00 [WRN] The decimal property 'DiscountAmount' on entity type 'OrderItem' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 14:29:59.761 +07:00 [WRN] The decimal property 'TaxAmount' on entity type 'OrderItem' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 14:29:59.762 +07:00 [WRN] The decimal property 'UnitPrice' on entity type 'OrderItem' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 14:29:59.763 +07:00 [WRN] The decimal property 'DecValue' on entity type 'ProductAttributeValue' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 14:29:59.764 +07:00 [WRN] The decimal property 'ListPrice' on entity type 'ProductPrice' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 14:29:59.765 +07:00 [WRN] The decimal property 'SalePrice' on entity type 'ProductPrice' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 14:29:59.766 +07:00 [WRN] The decimal property 'WeightGram' on entity type 'ProductVariant' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 14:30:00.491 +07:00 [INF] Executed DbCommand (108ms) [Parameters=[:p_0='?' (DbType = Int32), :p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."ID" "Id", "p"."NAME" "Name", "p"."SLUG" "Slug"
FROM "HEHE"."PRODUCTS" "p"
WHERE "p"."IS_ACTIVE" = 1
ORDER BY "p"."CREATED_AT" DESC
OFFSET :p_0 ROWS FETCH NEXT :p_1 ROWS ONLY
2025-09-05 14:30:00.627 +07:00 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", (
    SELECT "p0"."IMAGE_URL"
    FROM "HEHE"."PRODUCT_IMAGES" "p0"
    WHERE (("p0"."PRODUCT_ID" IS NOT NULL AND "p0"."PRODUCT_ID" IN (3, 2, 1)) AND ("p"."PRODUCT_ID" = "p0"."PRODUCT_ID"))
    ORDER BY "p0"."SORT_ORDER"
    FETCH FIRST 1 ROWS ONLY) "Url"
FROM "HEHE"."PRODUCT_IMAGES" "p"
WHERE "p"."PRODUCT_ID" IS NOT NULL AND "p"."PRODUCT_ID" IN (3, 2, 1)
GROUP BY "p"."PRODUCT_ID"
2025-09-05 14:30:00.670 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", MIN(COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")) "MinPrice"
FROM "HEHE"."PRODUCT_VARIANTS" "p"
INNER JOIN "HEHE"."PRODUCT_PRICES" "p0" ON "p"."ID" = "p0"."VARIANT_ID"
WHERE (("p"."PRODUCT_ID" IN (3, 2, 1)) AND ((("p0"."STARTS_AT" <= :now_1) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))))
GROUP BY "p"."PRODUCT_ID"
2025-09-05 14:30:00.687 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem, PHONE_STORE.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-05 14:30:00.702 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API) in 1562.9232ms
2025-09-05 14:30:00.704 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 14:30:00.711 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - 200 null application/json; charset=utf-8 1664.1785ms
2025-09-05 14:30:00.882 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 14:30:00.910 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:30:00.915 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 14:30:00.995 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:30:01.075 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:30:01.094 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 14:30:01.105 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 14:30:01.114 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 196.324ms
2025-09-05 14:30:01.116 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:30:01.117 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 234.8675ms
2025-09-05 14:30:03.573 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 14:30:03.579 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:30:03.580 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 14:30:03.609 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:30:03.615 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:30:03.621 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 14:30:03.627 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 14:30:03.628 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 45.127ms
2025-09-05 14:30:03.629 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:30:03.630 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 57.1736ms
2025-09-05 14:30:11.558 +07:00 [INF] Request starting HTTP/1.1 POST https://localhost:7277/api/auth/login - application/json; charset=utf-8 null
2025-09-05 14:30:11.571 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.AuthController.Login (PHONE_STORE.API)'
2025-09-05 14:30:11.578 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(LoginRequest, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.AuthController (PHONE_STORE.API).
2025-09-05 14:30:11.898 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:uname_0='?' (Size = 450), :username_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='0']
SELECT "u"."ID", "u"."CREATED_AT", "u"."EMAIL", "u"."PASSWORD_HASH", "u"."PHONE", "u"."STATUS"
FROM "USER_ACCOUNTS" "u"
WHERE (("u"."EMAIL" = :uname_0) OR ("u"."PHONE" = :username_1))
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:30:11.903 +07:00 [WRN] Login failed: user not found [hehe1@gmail.com]
2025-09-05 14:30:11.918 +07:00 [INF] Executing UnauthorizedObjectResult, writing value of type '<>f__AnonymousType1`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-05 14:30:11.929 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.AuthController.Login (PHONE_STORE.API) in 347.4836ms
2025-09-05 14:30:11.931 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.AuthController.Login (PHONE_STORE.API)'
2025-09-05 14:30:11.934 +07:00 [INF] Request finished HTTP/1.1 POST https://localhost:7277/api/auth/login - 401 null application/json; charset=utf-8 375.7205ms
2025-09-05 14:30:11.971 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 14:30:11.975 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:30:11.976 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 14:30:11.992 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:30:12.005 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:30:12.016 +07:00 [INF] Executed DbCommand (7ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 14:30:12.020 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 14:30:12.021 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 39.5436ms
2025-09-05 14:30:12.022 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:30:12.023 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 51.4012ms
2025-09-05 14:30:13.872 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 14:30:13.874 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:30:13.875 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 14:30:13.881 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:30:13.885 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:30:13.890 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 14:30:13.892 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 14:30:13.893 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 17.1851ms
2025-09-05 14:30:13.894 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:30:13.895 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 23.2263ms
2025-09-05 14:30:13.919 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 14:30:13.921 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:30:13.922 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 14:30:13.927 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:30:13.932 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:30:13.940 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 14:30:13.943 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 14:30:13.944 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 20.0415ms
2025-09-05 14:30:13.945 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:30:13.947 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 27.9132ms
2025-09-05 14:30:15.475 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 14:30:15.478 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:30:15.479 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 14:30:15.484 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:30:15.491 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:30:15.507 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 14:30:15.517 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 14:30:15.519 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 37.913ms
2025-09-05 14:30:15.522 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:30:15.524 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 48.7687ms
2025-09-05 14:30:22.106 +07:00 [INF] Request starting HTTP/1.1 POST https://localhost:7277/api/auth/login - application/json; charset=utf-8 null
2025-09-05 14:30:22.109 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.AuthController.Login (PHONE_STORE.API)'
2025-09-05 14:30:22.110 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(LoginRequest, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.AuthController (PHONE_STORE.API).
2025-09-05 14:30:22.122 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:uname_0='?' (Size = 450), :username_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='0']
SELECT "u"."ID", "u"."CREATED_AT", "u"."EMAIL", "u"."PASSWORD_HASH", "u"."PHONE", "u"."STATUS"
FROM "USER_ACCOUNTS" "u"
WHERE (("u"."EMAIL" = :uname_0) OR ("u"."PHONE" = :username_1))
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:30:22.491 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[:userId_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "r"."CODE"
FROM "USER_ROLES" "u"
INNER JOIN "ROLES" "r" ON "u"."ROLE_ID" = "r"."ID"
WHERE "u"."USER_ID" = :userId_0
2025-09-05 14:30:22.541 +07:00 [INF] Login success [81]
2025-09-05 14:30:22.549 +07:00 [INF] Executing OkObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.AuthResponseDto'.
2025-09-05 14:30:22.554 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.AuthController.Login (PHONE_STORE.API) in 443.3385ms
2025-09-05 14:30:22.556 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.AuthController.Login (PHONE_STORE.API)'
2025-09-05 14:30:22.558 +07:00 [INF] Request finished HTTP/1.1 POST https://localhost:7277/api/auth/login - 200 null application/json; charset=utf-8 452.1226ms
2025-09-05 14:30:22.590 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/me/addresses - null null
2025-09-05 14:30:22.633 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopMeController.MyAddresses (PHONE_STORE.API)'
2025-09-05 14:30:22.638 +07:00 [INF] Route matched with {action = "MyAddresses", controller = "ShopMe"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.Application.Dtos.AddressDto]]] MyAddresses(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopMeController (PHONE_STORE.API).
2025-09-05 14:30:22.644 +07:00 [INF] Executing ObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ProblemDetails'.
2025-09-05 14:30:22.657 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopMeController.MyAddresses (PHONE_STORE.API) in 16.5524ms
2025-09-05 14:30:22.658 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopMeController.MyAddresses (PHONE_STORE.API)'
2025-09-05 14:30:22.661 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/me/addresses - 401 null application/problem+json; charset=utf-8 70.6264ms
2025-09-05 14:30:32.691 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/me/addresses - null null
2025-09-05 14:30:32.696 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopMeController.MyAddresses (PHONE_STORE.API)'
2025-09-05 14:30:32.697 +07:00 [INF] Route matched with {action = "MyAddresses", controller = "ShopMe"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.Application.Dtos.AddressDto]]] MyAddresses(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopMeController (PHONE_STORE.API).
2025-09-05 14:30:32.698 +07:00 [INF] Executing ObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ProblemDetails'.
2025-09-05 14:30:32.699 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopMeController.MyAddresses (PHONE_STORE.API) in 1.0568ms
2025-09-05 14:30:32.700 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopMeController.MyAddresses (PHONE_STORE.API)'
2025-09-05 14:30:32.700 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/me/addresses - 401 null application/problem+json; charset=utf-8 9.3652ms
2025-09-05 14:30:37.791 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - null null
2025-09-05 14:30:37.794 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 14:30:37.795 +07:00 [INF] Route matched with {action = "List", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem]]] List(System.String, System.Nullable`1[System.Int64], Int32, Int32, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 14:30:37.804 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:p_0='?' (DbType = Int32), :p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."ID" "Id", "p"."NAME" "Name", "p"."SLUG" "Slug"
FROM "HEHE"."PRODUCTS" "p"
WHERE "p"."IS_ACTIVE" = 1
ORDER BY "p"."CREATED_AT" DESC
OFFSET :p_0 ROWS FETCH NEXT :p_1 ROWS ONLY
2025-09-05 14:30:37.811 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", (
    SELECT "p0"."IMAGE_URL"
    FROM "HEHE"."PRODUCT_IMAGES" "p0"
    WHERE (("p0"."PRODUCT_ID" IS NOT NULL AND "p0"."PRODUCT_ID" IN (3, 2, 1)) AND ("p"."PRODUCT_ID" = "p0"."PRODUCT_ID"))
    ORDER BY "p0"."SORT_ORDER"
    FETCH FIRST 1 ROWS ONLY) "Url"
FROM "HEHE"."PRODUCT_IMAGES" "p"
WHERE "p"."PRODUCT_ID" IS NOT NULL AND "p"."PRODUCT_ID" IN (3, 2, 1)
GROUP BY "p"."PRODUCT_ID"
2025-09-05 14:30:37.816 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", MIN(COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")) "MinPrice"
FROM "HEHE"."PRODUCT_VARIANTS" "p"
INNER JOIN "HEHE"."PRODUCT_PRICES" "p0" ON "p"."ID" = "p0"."VARIANT_ID"
WHERE (("p"."PRODUCT_ID" IN (3, 2, 1)) AND ((("p0"."STARTS_AT" <= :now_1) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))))
GROUP BY "p"."PRODUCT_ID"
2025-09-05 14:30:37.820 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem, PHONE_STORE.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-05 14:30:37.821 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API) in 23.8074ms
2025-09-05 14:30:37.822 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 14:30:37.823 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - 200 null application/json; charset=utf-8 31.6399ms
2025-09-05 14:30:37.846 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 14:30:37.848 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:30:37.849 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 14:30:37.858 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:30:37.879 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:30:37.884 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 14:30:37.888 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 14:30:37.888 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 35.5599ms
2025-09-05 14:30:37.889 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:30:37.890 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 44.0225ms
2025-09-05 14:30:39.640 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 14:30:39.642 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:30:39.643 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 14:30:39.650 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:30:39.656 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:30:39.660 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 14:30:39.662 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 14:30:39.663 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 15.7908ms
2025-09-05 14:30:39.663 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:30:39.664 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 24.0528ms
2025-09-05 14:30:39.683 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 14:30:39.687 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:30:39.688 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 14:30:39.694 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:30:39.702 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:30:39.707 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 14:30:39.712 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 14:30:39.716 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 25.0214ms
2025-09-05 14:30:39.716 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:30:39.718 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 34.6296ms
2025-09-05 14:30:41.217 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - null null
2025-09-05 14:30:41.221 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 14:30:41.222 +07:00 [INF] Route matched with {action = "List", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem]]] List(System.String, System.Nullable`1[System.Int64], Int32, Int32, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 14:30:41.233 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:p_0='?' (DbType = Int32), :p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."ID" "Id", "p"."NAME" "Name", "p"."SLUG" "Slug"
FROM "HEHE"."PRODUCTS" "p"
WHERE "p"."IS_ACTIVE" = 1
ORDER BY "p"."CREATED_AT" DESC
OFFSET :p_0 ROWS FETCH NEXT :p_1 ROWS ONLY
2025-09-05 14:30:41.237 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", (
    SELECT "p0"."IMAGE_URL"
    FROM "HEHE"."PRODUCT_IMAGES" "p0"
    WHERE (("p0"."PRODUCT_ID" IS NOT NULL AND "p0"."PRODUCT_ID" IN (3, 2, 1)) AND ("p"."PRODUCT_ID" = "p0"."PRODUCT_ID"))
    ORDER BY "p0"."SORT_ORDER"
    FETCH FIRST 1 ROWS ONLY) "Url"
FROM "HEHE"."PRODUCT_IMAGES" "p"
WHERE "p"."PRODUCT_ID" IS NOT NULL AND "p"."PRODUCT_ID" IN (3, 2, 1)
GROUP BY "p"."PRODUCT_ID"
2025-09-05 14:30:41.243 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", MIN(COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")) "MinPrice"
FROM "HEHE"."PRODUCT_VARIANTS" "p"
INNER JOIN "HEHE"."PRODUCT_PRICES" "p0" ON "p"."ID" = "p0"."VARIANT_ID"
WHERE (("p"."PRODUCT_ID" IN (3, 2, 1)) AND ((("p0"."STARTS_AT" <= :now_1) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))))
GROUP BY "p"."PRODUCT_ID"
2025-09-05 14:30:41.245 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem, PHONE_STORE.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-05 14:30:41.246 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API) in 17.9901ms
2025-09-05 14:30:41.247 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 14:30:41.248 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - 200 null application/json; charset=utf-8 30.5944ms
2025-09-05 14:30:41.274 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 14:30:41.278 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:30:41.282 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 14:30:41.293 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:30:41.298 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:30:41.303 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 14:30:41.305 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 14:30:41.306 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 15.9913ms
2025-09-05 14:30:41.307 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:30:41.308 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 33.9478ms
2025-09-05 14:30:44.107 +07:00 [INF] Request starting HTTP/1.1 POST https://localhost:7277/api/auth/logout - application/json; charset=utf-8 null
2025-09-05 14:30:44.111 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.AuthController.Logout (PHONE_STORE.API)'
2025-09-05 14:30:44.114 +07:00 [INF] Route matched with {action = "Logout", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Logout(RefreshRequest, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.AuthController (PHONE_STORE.API).
2025-09-05 14:30:44.127 +07:00 [INF] Logout: revoked RT
2025-09-05 14:30:44.128 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType1`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-05 14:30:44.130 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.AuthController.Logout (PHONE_STORE.API) in 14.2485ms
2025-09-05 14:30:44.131 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.AuthController.Logout (PHONE_STORE.API)'
2025-09-05 14:30:44.132 +07:00 [INF] Request finished HTTP/1.1 POST https://localhost:7277/api/auth/logout - 200 null application/json; charset=utf-8 25.5675ms
2025-09-05 14:30:44.143 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - null null
2025-09-05 14:30:44.145 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 14:30:44.146 +07:00 [INF] Route matched with {action = "List", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem]]] List(System.String, System.Nullable`1[System.Int64], Int32, Int32, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 14:30:44.150 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:p_0='?' (DbType = Int32), :p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."ID" "Id", "p"."NAME" "Name", "p"."SLUG" "Slug"
FROM "HEHE"."PRODUCTS" "p"
WHERE "p"."IS_ACTIVE" = 1
ORDER BY "p"."CREATED_AT" DESC
OFFSET :p_0 ROWS FETCH NEXT :p_1 ROWS ONLY
2025-09-05 14:30:44.153 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", (
    SELECT "p0"."IMAGE_URL"
    FROM "HEHE"."PRODUCT_IMAGES" "p0"
    WHERE (("p0"."PRODUCT_ID" IS NOT NULL AND "p0"."PRODUCT_ID" IN (3, 2, 1)) AND ("p"."PRODUCT_ID" = "p0"."PRODUCT_ID"))
    ORDER BY "p0"."SORT_ORDER"
    FETCH FIRST 1 ROWS ONLY) "Url"
FROM "HEHE"."PRODUCT_IMAGES" "p"
WHERE "p"."PRODUCT_ID" IS NOT NULL AND "p"."PRODUCT_ID" IN (3, 2, 1)
GROUP BY "p"."PRODUCT_ID"
2025-09-05 14:30:44.157 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", MIN(COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")) "MinPrice"
FROM "HEHE"."PRODUCT_VARIANTS" "p"
INNER JOIN "HEHE"."PRODUCT_PRICES" "p0" ON "p"."ID" = "p0"."VARIANT_ID"
WHERE (("p"."PRODUCT_ID" IN (3, 2, 1)) AND ((("p0"."STARTS_AT" <= :now_1) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))))
GROUP BY "p"."PRODUCT_ID"
2025-09-05 14:30:44.162 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem, PHONE_STORE.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-05 14:30:44.163 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API) in 15.301ms
2025-09-05 14:30:44.163 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 14:30:44.164 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - 200 null application/json; charset=utf-8 21.4956ms
2025-09-05 14:30:44.182 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 14:30:44.184 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:30:44.185 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 14:30:44.191 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:30:44.194 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:30:44.197 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 14:30:44.210 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 14:30:44.211 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 23.3659ms
2025-09-05 14:30:44.212 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:30:44.213 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 30.6569ms
2025-09-05 14:30:45.806 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - null null
2025-09-05 14:30:45.809 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 14:30:45.810 +07:00 [INF] Route matched with {action = "List", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem]]] List(System.String, System.Nullable`1[System.Int64], Int32, Int32, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 14:30:45.815 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:p_0='?' (DbType = Int32), :p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."ID" "Id", "p"."NAME" "Name", "p"."SLUG" "Slug"
FROM "HEHE"."PRODUCTS" "p"
WHERE "p"."IS_ACTIVE" = 1
ORDER BY "p"."CREATED_AT" DESC
OFFSET :p_0 ROWS FETCH NEXT :p_1 ROWS ONLY
2025-09-05 14:30:45.818 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", (
    SELECT "p0"."IMAGE_URL"
    FROM "HEHE"."PRODUCT_IMAGES" "p0"
    WHERE (("p0"."PRODUCT_ID" IS NOT NULL AND "p0"."PRODUCT_ID" IN (3, 2, 1)) AND ("p"."PRODUCT_ID" = "p0"."PRODUCT_ID"))
    ORDER BY "p0"."SORT_ORDER"
    FETCH FIRST 1 ROWS ONLY) "Url"
FROM "HEHE"."PRODUCT_IMAGES" "p"
WHERE "p"."PRODUCT_ID" IS NOT NULL AND "p"."PRODUCT_ID" IN (3, 2, 1)
GROUP BY "p"."PRODUCT_ID"
2025-09-05 14:30:45.821 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", MIN(COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")) "MinPrice"
FROM "HEHE"."PRODUCT_VARIANTS" "p"
INNER JOIN "HEHE"."PRODUCT_PRICES" "p0" ON "p"."ID" = "p0"."VARIANT_ID"
WHERE (("p"."PRODUCT_ID" IN (3, 2, 1)) AND ((("p0"."STARTS_AT" <= :now_1) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))))
GROUP BY "p"."PRODUCT_ID"
2025-09-05 14:30:45.826 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem, PHONE_STORE.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-05 14:30:45.827 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API) in 14.9509ms
2025-09-05 14:30:45.828 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 14:30:45.828 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - 200 null application/json; charset=utf-8 22.8954ms
2025-09-05 14:30:45.846 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 14:30:45.849 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:30:45.850 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 14:30:45.857 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:30:45.867 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:30:45.874 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 14:30:45.877 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 14:30:45.877 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 23.6485ms
2025-09-05 14:30:45.878 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:30:45.879 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 32.2417ms
2025-09-05 14:30:46.503 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 14:30:46.505 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:30:46.505 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 14:30:46.510 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:30:46.513 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:30:46.516 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 14:30:46.521 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 14:30:46.522 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 14.3484ms
2025-09-05 14:30:46.522 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:30:46.523 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 20.7677ms
2025-09-05 14:30:46.543 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 14:30:46.547 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:30:46.549 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 14:30:46.556 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:30:46.562 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:30:46.569 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 14:30:46.573 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 14:30:46.574 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 22.2714ms
2025-09-05 14:30:46.575 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:30:46.576 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 33.1555ms
2025-09-05 14:36:01.669 +07:00 [INF] User profile is available. Using 'C:\Users\Administrator\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-09-05 14:36:01.891 +07:00 [INF] Now listening on: https://localhost:7277
2025-09-05 14:36:01.892 +07:00 [INF] Now listening on: http://localhost:5209
2025-09-05 14:36:01.980 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-05 14:36:01.982 +07:00 [INF] Hosting environment: Development
2025-09-05 14:36:01.983 +07:00 [INF] Content root path: C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.API
2025-09-05 14:36:02.606 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/swagger/index.html - null null
2025-09-05 14:36:02.970 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/swagger/index.html - 200 null text/html;charset=utf-8 373.8774ms
2025-09-05 14:36:03.052 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/_framework/aspnetcore-browser-refresh.js - null null
2025-09-05 14:36:03.064 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/_framework/aspnetcore-browser-refresh.js - 200 13766 application/javascript; charset=utf-8 11.6999ms
2025-09-05 14:36:03.069 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/_vs/browserLink - null null
2025-09-05 14:36:03.124 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/_vs/browserLink - 200 null text/javascript; charset=UTF-8 54.4994ms
2025-09-05 14:36:03.146 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - null null
2025-09-05 14:36:03.249 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 14:36:03.280 +07:00 [INF] Route matched with {action = "List", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem]]] List(System.String, System.Nullable`1[System.Int64], Int32, Int32, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 14:36:03.327 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/swagger/v1/swagger.json - null null
2025-09-05 14:36:03.407 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 80.3062ms
2025-09-05 14:36:04.069 +07:00 [WRN] The decimal property 'UnitPrice' on entity type 'CartItem' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 14:36:04.071 +07:00 [WRN] The decimal property 'DiscountTotal' on entity type 'Order' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 14:36:04.072 +07:00 [WRN] The decimal property 'GrandTotal' on entity type 'Order' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 14:36:04.074 +07:00 [WRN] The decimal property 'ShippingFee' on entity type 'Order' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 14:36:04.075 +07:00 [WRN] The decimal property 'Subtotal' on entity type 'Order' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 14:36:04.076 +07:00 [WRN] The decimal property 'TaxTotal' on entity type 'Order' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 14:36:04.077 +07:00 [WRN] The decimal property 'DiscountAmount' on entity type 'OrderItem' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 14:36:04.079 +07:00 [WRN] The decimal property 'TaxAmount' on entity type 'OrderItem' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 14:36:04.080 +07:00 [WRN] The decimal property 'UnitPrice' on entity type 'OrderItem' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 14:36:04.083 +07:00 [WRN] The decimal property 'DecValue' on entity type 'ProductAttributeValue' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 14:36:04.085 +07:00 [WRN] The decimal property 'ListPrice' on entity type 'ProductPrice' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 14:36:04.086 +07:00 [WRN] The decimal property 'SalePrice' on entity type 'ProductPrice' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 14:36:04.087 +07:00 [WRN] The decimal property 'WeightGram' on entity type 'ProductVariant' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 14:36:04.800 +07:00 [INF] Executed DbCommand (99ms) [Parameters=[:p_0='?' (DbType = Int32), :p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."ID" "Id", "p"."NAME" "Name", "p"."SLUG" "Slug"
FROM "HEHE"."PRODUCTS" "p"
WHERE "p"."IS_ACTIVE" = 1
ORDER BY "p"."CREATED_AT" DESC
OFFSET :p_0 ROWS FETCH NEXT :p_1 ROWS ONLY
2025-09-05 14:36:04.920 +07:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", (
    SELECT "p0"."IMAGE_URL"
    FROM "HEHE"."PRODUCT_IMAGES" "p0"
    WHERE (("p0"."PRODUCT_ID" IS NOT NULL AND "p0"."PRODUCT_ID" IN (3, 2, 1)) AND ("p"."PRODUCT_ID" = "p0"."PRODUCT_ID"))
    ORDER BY "p0"."SORT_ORDER"
    FETCH FIRST 1 ROWS ONLY) "Url"
FROM "HEHE"."PRODUCT_IMAGES" "p"
WHERE "p"."PRODUCT_ID" IS NOT NULL AND "p"."PRODUCT_ID" IN (3, 2, 1)
GROUP BY "p"."PRODUCT_ID"
2025-09-05 14:36:04.964 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", MIN(COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")) "MinPrice"
FROM "HEHE"."PRODUCT_VARIANTS" "p"
INNER JOIN "HEHE"."PRODUCT_PRICES" "p0" ON "p"."ID" = "p0"."VARIANT_ID"
WHERE (("p"."PRODUCT_ID" IN (3, 2, 1)) AND ((("p0"."STARTS_AT" <= :now_1) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))))
GROUP BY "p"."PRODUCT_ID"
2025-09-05 14:36:04.979 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem, PHONE_STORE.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-05 14:36:04.992 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API) in 1708.5751ms
2025-09-05 14:36:04.993 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 14:36:05.003 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - 200 null application/json; charset=utf-8 1858.1747ms
2025-09-05 14:36:05.210 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 14:36:05.216 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:36:05.220 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 14:36:05.298 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:36:05.369 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:36:05.385 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 14:36:05.395 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 14:36:05.404 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 183.06ms
2025-09-05 14:36:05.406 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:36:05.407 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 196.8117ms
2025-09-05 14:36:08.401 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 14:36:08.407 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:36:08.409 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 14:36:08.444 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:36:08.453 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:36:08.459 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 14:36:08.463 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 14:36:08.464 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 50.8716ms
2025-09-05 14:36:08.468 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:36:08.469 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 68.5765ms
2025-09-05 14:36:13.830 +07:00 [INF] Request starting HTTP/1.1 POST https://localhost:7277/api/auth/login - application/json; charset=utf-8 null
2025-09-05 14:36:13.840 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.AuthController.Login (PHONE_STORE.API)'
2025-09-05 14:36:13.846 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(LoginRequest, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.AuthController (PHONE_STORE.API).
2025-09-05 14:36:14.132 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:uname_0='?' (Size = 450), :username_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='0']
SELECT "u"."ID", "u"."CREATED_AT", "u"."EMAIL", "u"."PASSWORD_HASH", "u"."PHONE", "u"."STATUS"
FROM "USER_ACCOUNTS" "u"
WHERE (("u"."EMAIL" = :uname_0) OR ("u"."PHONE" = :username_1))
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:36:14.839 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[:userId_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "r"."CODE"
FROM "USER_ROLES" "u"
INNER JOIN "ROLES" "r" ON "u"."ROLE_ID" = "r"."ID"
WHERE "u"."USER_ID" = :userId_0
2025-09-05 14:36:14.912 +07:00 [INF] Login success [21]
2025-09-05 14:36:14.923 +07:00 [INF] Executing OkObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.AuthResponseDto'.
2025-09-05 14:36:14.926 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.AuthController.Login (PHONE_STORE.API) in 1075.6322ms
2025-09-05 14:36:14.927 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.AuthController.Login (PHONE_STORE.API)'
2025-09-05 14:36:14.929 +07:00 [INF] Request finished HTTP/1.1 POST https://localhost:7277/api/auth/login - 200 null application/json; charset=utf-8 1098.7938ms
2025-09-05 14:36:14.950 +07:00 [INF] Request starting HTTP/1.1 POST https://localhost:7277/api/shop/cart/merge - null 0
2025-09-05 14:36:14.955 +07:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2025-09-05 14:36:14.959 +07:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-09-05 14:36:14.960 +07:00 [INF] Request finished HTTP/1.1 POST https://localhost:7277/api/shop/cart/merge - 401 0 null 10.5226ms
2025-09-05 14:36:14.973 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - null null
2025-09-05 14:36:15.019 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 14:36:15.020 +07:00 [INF] Route matched with {action = "List", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem]]] List(System.String, System.Nullable`1[System.Int64], Int32, Int32, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 14:36:15.032 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[:p_0='?' (DbType = Int32), :p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."ID" "Id", "p"."NAME" "Name", "p"."SLUG" "Slug"
FROM "HEHE"."PRODUCTS" "p"
WHERE "p"."IS_ACTIVE" = 1
ORDER BY "p"."CREATED_AT" DESC
OFFSET :p_0 ROWS FETCH NEXT :p_1 ROWS ONLY
2025-09-05 14:36:15.040 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", (
    SELECT "p0"."IMAGE_URL"
    FROM "HEHE"."PRODUCT_IMAGES" "p0"
    WHERE (("p0"."PRODUCT_ID" IS NOT NULL AND "p0"."PRODUCT_ID" IN (3, 2, 1)) AND ("p"."PRODUCT_ID" = "p0"."PRODUCT_ID"))
    ORDER BY "p0"."SORT_ORDER"
    FETCH FIRST 1 ROWS ONLY) "Url"
FROM "HEHE"."PRODUCT_IMAGES" "p"
WHERE "p"."PRODUCT_ID" IS NOT NULL AND "p"."PRODUCT_ID" IN (3, 2, 1)
GROUP BY "p"."PRODUCT_ID"
2025-09-05 14:36:15.052 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", MIN(COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")) "MinPrice"
FROM "HEHE"."PRODUCT_VARIANTS" "p"
INNER JOIN "HEHE"."PRODUCT_PRICES" "p0" ON "p"."ID" = "p0"."VARIANT_ID"
WHERE (("p"."PRODUCT_ID" IN (3, 2, 1)) AND ((("p0"."STARTS_AT" <= :now_1) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))))
GROUP BY "p"."PRODUCT_ID"
2025-09-05 14:36:15.054 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem, PHONE_STORE.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-05 14:36:15.056 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API) in 32.0774ms
2025-09-05 14:36:15.056 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 14:36:15.057 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - 200 null application/json; charset=utf-8 83.9181ms
2025-09-05 14:36:15.081 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 14:36:15.085 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:36:15.086 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 14:36:15.093 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:36:15.302 +07:00 [INF] Executed DbCommand (35ms) [Parameters=[:p0='?' (DbType = DateTime), :p1='?' (Size = 2000), :p2='?' (DbType = Int64), :p3='?' (Size = 64), :p4='?' (Size = 2000), :p5='?' (DbType = DateTime), :cur0='?' (Direction = Output) (DbType = Object)], CommandType='"Text"', CommandTimeout='0']
DECLARE

TYPE "rCARTS_0" IS RECORD
(
"ID" NUMBER(19)
);
TYPE "tCARTS_0" IS TABLE OF "rCARTS_0";
"lCARTS_0" "tCARTS_0";

BEGIN

"lCARTS_0" := "tCARTS_0"();
"lCARTS_0".extend(1);
INSERT INTO "HEHE"."CARTS" ("CREATED_AT", "CURRENCY", "CUSTOMER_ID", "SESSION_TOKEN", "STATUS", "UPDATED_AT")
VALUES (:p0, :p1, :p2, :p3, :p4, :p5)
RETURNING "ID" INTO "lCARTS_0"(1)."ID";
OPEN :cur0 FOR SELECT "lCARTS_0"(1)."ID" FROM DUAL;

END;
2025-09-05 14:36:15.368 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:36:15.374 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 14:36:15.377 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 14:36:15.378 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 290.7317ms
2025-09-05 14:36:15.383 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:36:15.384 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 303.1074ms
2025-09-05 14:36:20.137 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products/galaxy-s24 - null null
2025-09-05 14:36:20.140 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API)'
2025-09-05 14:36:20.143 +07:00 [INF] Route matched with {action = "Details", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductDetail]] Details(System.String, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 14:36:20.201 +07:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-09-05 14:36:20.235 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[:slug_0='?' (Size = 220)], CommandType='"Text"', CommandTimeout='0']
SELECT "p2"."ID", "p2"."BRAND_ID", "p2"."CREATED_AT", "p2"."DEFAULT_CATEGORY_ID", "p2"."DESCRIPTION", "p2"."IS_ACTIVE", "p2"."NAME", "p2"."SLUG", "p2"."SPEC_JSON", "p0"."ID", "p0"."BARCODE", "p0"."COLOR", "p0"."IS_ACTIVE", "p0"."PRODUCT_ID", "p0"."SKU", "p0"."STORAGE_GB", "p0"."WEIGHT_GRAM", "p1"."ID", "p1"."ALT_TEXT", "p1"."IMAGE_URL", "p1"."IS_PRIMARY", "p1"."PRODUCT_ID", "p1"."SORT_ORDER", "p1"."VARIANT_ID"
FROM (
    SELECT "p"."ID", "p"."BRAND_ID", "p"."CREATED_AT", "p"."DEFAULT_CATEGORY_ID", "p"."DESCRIPTION", "p"."IS_ACTIVE", "p"."NAME", "p"."SLUG", "p"."SPEC_JSON"
    FROM "HEHE"."PRODUCTS" "p"
    WHERE (("p"."SLUG" = :slug_0) AND ("p"."IS_ACTIVE" = 1))
    FETCH FIRST 1 ROWS ONLY
) "p2"
LEFT JOIN "HEHE"."PRODUCT_VARIANTS" "p0" ON "p2"."ID" = "p0"."PRODUCT_ID"
LEFT JOIN "HEHE"."PRODUCT_IMAGES" "p1" ON "p2"."ID" = "p1"."PRODUCT_ID"
ORDER BY "p2"."ID", "p0"."ID"
2025-09-05 14:36:20.298 +07:00 [INF] Executed DbCommand (9ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."VARIANT_ID" "VariantId", COALESCE((
    SELECT COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")
    FROM "HEHE"."PRODUCT_PRICES" "p0"
    WHERE (((((("p0"."VARIANT_ID" = 3) AND ("p0"."STARTS_AT" <= :now_1))) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))) AND ("p"."VARIANT_ID" = "p0"."VARIANT_ID"))
    ORDER BY "p0"."STARTS_AT" DESC
    FETCH FIRST 1 ROWS ONLY), 0.0) "Price"
FROM "HEHE"."PRODUCT_PRICES" "p"
WHERE (((("p"."VARIANT_ID" = 3) AND ("p"."STARTS_AT" <= :now_1))) AND ((("p"."ENDS_AT" IS NULL) OR ("p"."ENDS_AT" > :now_2))))
GROUP BY "p"."VARIANT_ID"
2025-09-05 14:36:20.304 +07:00 [INF] Executing OkObjectResult, writing value of type 'PHONE_STORE.API.Controllers.ShopProductsController+ShopProductDetail'.
2025-09-05 14:36:20.310 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API) in 165.143ms
2025-09-05 14:36:20.311 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API)'
2025-09-05 14:36:20.312 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products/galaxy-s24 - 200 null application/json; charset=utf-8 174.8382ms
2025-09-05 14:36:20.354 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 14:36:20.356 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:36:20.358 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 14:36:20.366 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:36:20.375 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:36:20.386 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 14:36:20.389 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 14:36:20.389 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 29.5021ms
2025-09-05 14:36:20.390 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:36:20.391 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 36.9022ms
2025-09-05 14:36:21.165 +07:00 [INF] Request starting HTTP/1.1 POST https://localhost:7277/api/shop/cart/items - application/json; charset=utf-8 null
2025-09-05 14:36:21.169 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Add (PHONE_STORE.API)'
2025-09-05 14:36:21.172 +07:00 [INF] Route matched with {action = "Add", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Add(PHONE_STORE.Application.Dtos.CartItemUpsertDto, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 14:36:21.183 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:36:21.195 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:id_0='?' (DbType = Int64), :dto_VariantId_1='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE"
FROM "HEHE"."CART_ITEMS" "c"
WHERE (("c"."CART_ID" = :id_0) AND ("c"."VARIANT_ID" = :dto_VariantId_1))
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:36:21.293 +07:00 [INF] Executed DbCommand (62ms) [Parameters=[:variantId_0='?' (DbType = Int64), :now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT COALESCE("p"."SALE_PRICE", "p"."LIST_PRICE")
FROM "HEHE"."PRODUCT_PRICES" "p"
WHERE (((("p"."VARIANT_ID" = :variantId_0) AND ("p"."STARTS_AT" <= :now_1))) AND ((("p"."ENDS_AT" IS NULL) OR ("p"."ENDS_AT" > :now_2))))
ORDER BY "p"."STARTS_AT" DESC
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:36:21.361 +07:00 [INF] Executed DbCommand (8ms) [Parameters=[:p0='?' (DbType = Int64), :p1='?' (DbType = Int64), :p2='?' (DbType = DateTime), :p3='?' (Size = 2000), :p4='?' (DbType = Int32), :p5='?' (DbType = Decimal)], CommandType='"Text"', CommandTimeout='0']
DECLARE


BEGIN

INSERT INTO "HEHE"."CART_ITEMS" ("CART_ID", "VARIANT_ID", "ADDED_AT", "CURRENCY", "QUANTITY", "UNIT_PRICE")
VALUES (:p0, :p1, :p2, :p3, :p4, :p5);

END;
2025-09-05 14:36:21.369 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:36:21.373 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:36:21.376 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 14:36:21.381 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 14:36:21.382 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Add (PHONE_STORE.API) in 208.338ms
2025-09-05 14:36:21.383 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Add (PHONE_STORE.API)'
2025-09-05 14:36:21.384 +07:00 [INF] Request finished HTTP/1.1 POST https://localhost:7277/api/shop/cart/items - 200 null application/json; charset=utf-8 218.7558ms
2025-09-05 14:36:21.390 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products/galaxy-s24 - null null
2025-09-05 14:36:21.391 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API)'
2025-09-05 14:36:21.394 +07:00 [INF] Route matched with {action = "Details", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductDetail]] Details(System.String, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 14:36:21.399 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:slug_0='?' (Size = 220)], CommandType='"Text"', CommandTimeout='0']
SELECT "p2"."ID", "p2"."BRAND_ID", "p2"."CREATED_AT", "p2"."DEFAULT_CATEGORY_ID", "p2"."DESCRIPTION", "p2"."IS_ACTIVE", "p2"."NAME", "p2"."SLUG", "p2"."SPEC_JSON", "p0"."ID", "p0"."BARCODE", "p0"."COLOR", "p0"."IS_ACTIVE", "p0"."PRODUCT_ID", "p0"."SKU", "p0"."STORAGE_GB", "p0"."WEIGHT_GRAM", "p1"."ID", "p1"."ALT_TEXT", "p1"."IMAGE_URL", "p1"."IS_PRIMARY", "p1"."PRODUCT_ID", "p1"."SORT_ORDER", "p1"."VARIANT_ID"
FROM (
    SELECT "p"."ID", "p"."BRAND_ID", "p"."CREATED_AT", "p"."DEFAULT_CATEGORY_ID", "p"."DESCRIPTION", "p"."IS_ACTIVE", "p"."NAME", "p"."SLUG", "p"."SPEC_JSON"
    FROM "HEHE"."PRODUCTS" "p"
    WHERE (("p"."SLUG" = :slug_0) AND ("p"."IS_ACTIVE" = 1))
    FETCH FIRST 1 ROWS ONLY
) "p2"
LEFT JOIN "HEHE"."PRODUCT_VARIANTS" "p0" ON "p2"."ID" = "p0"."PRODUCT_ID"
LEFT JOIN "HEHE"."PRODUCT_IMAGES" "p1" ON "p2"."ID" = "p1"."PRODUCT_ID"
ORDER BY "p2"."ID", "p0"."ID"
2025-09-05 14:36:21.403 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."VARIANT_ID" "VariantId", COALESCE((
    SELECT COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")
    FROM "HEHE"."PRODUCT_PRICES" "p0"
    WHERE (((((("p0"."VARIANT_ID" = 3) AND ("p0"."STARTS_AT" <= :now_1))) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))) AND ("p"."VARIANT_ID" = "p0"."VARIANT_ID"))
    ORDER BY "p0"."STARTS_AT" DESC
    FETCH FIRST 1 ROWS ONLY), 0.0) "Price"
FROM "HEHE"."PRODUCT_PRICES" "p"
WHERE (((("p"."VARIANT_ID" = 3) AND ("p"."STARTS_AT" <= :now_1))) AND ((("p"."ENDS_AT" IS NULL) OR ("p"."ENDS_AT" > :now_2))))
GROUP BY "p"."VARIANT_ID"
2025-09-05 14:36:21.406 +07:00 [INF] Executing OkObjectResult, writing value of type 'PHONE_STORE.API.Controllers.ShopProductsController+ShopProductDetail'.
2025-09-05 14:36:21.407 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API) in 11.4257ms
2025-09-05 14:36:21.410 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API)'
2025-09-05 14:36:21.411 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products/galaxy-s24 - 200 null application/json; charset=utf-8 20.8849ms
2025-09-05 14:36:21.432 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 14:36:21.434 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:36:21.435 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 14:36:21.441 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:36:21.449 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:36:21.459 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 14:36:21.462 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 14:36:21.463 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 26.199ms
2025-09-05 14:36:21.467 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:36:21.468 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 36.1354ms
2025-09-05 14:36:23.396 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 14:36:23.399 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:36:23.400 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 14:36:23.405 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:36:23.408 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:36:23.412 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 14:36:23.416 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 14:36:23.417 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 14.6471ms
2025-09-05 14:36:23.418 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:36:23.419 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 22.6347ms
2025-09-05 14:36:23.444 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 14:36:23.446 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:36:23.448 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 14:36:23.454 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:36:23.459 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:36:23.464 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 14:36:23.468 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 14:36:23.469 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 18.2943ms
2025-09-05 14:36:23.470 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:36:23.472 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 27.7051ms
2025-09-05 14:36:24.855 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/me/addresses - null null
2025-09-05 14:36:24.859 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopMeController.MyAddresses (PHONE_STORE.API)'
2025-09-05 14:36:24.862 +07:00 [INF] Route matched with {action = "MyAddresses", controller = "ShopMe"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.Application.Dtos.AddressDto]]] MyAddresses(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopMeController (PHONE_STORE.API).
2025-09-05 14:36:24.868 +07:00 [INF] Executing ObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ProblemDetails'.
2025-09-05 14:36:24.883 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopMeController.MyAddresses (PHONE_STORE.API) in 17.9642ms
2025-09-05 14:36:24.885 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopMeController.MyAddresses (PHONE_STORE.API)'
2025-09-05 14:36:24.886 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/me/addresses - 401 null application/problem+json; charset=utf-8 30.2602ms
2025-09-05 14:36:26.645 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 14:36:26.647 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:36:26.647 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 14:36:26.651 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:36:26.654 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:36:26.657 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 14:36:26.659 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 14:36:26.660 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 11.8034ms
2025-09-05 14:36:26.664 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:36:26.665 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 20.3669ms
2025-09-05 14:37:05.853 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 14:37:05.857 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:37:05.858 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 14:37:05.911 +07:00 [ERR] 2025-09-05 14:37:05.911282 ThreadID:7   (ERROR)   OracleRelationalCommand.ExecuteReaderAsync() :  Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
2025-09-05 14:37:05.916 +07:00 [ERR] Failed executing DbCommand (48ms) [Parameters=[:p0='?' (DbType = DateTime), :p1='?' (Size = 2000), :p2='?' (DbType = Int64), :p3='?' (Size = 64), :p4='?' (Size = 2000), :p5='?' (DbType = DateTime), :cur0='?' (Direction = Output) (DbType = Object)], CommandType='"Text"', CommandTimeout='0']
DECLARE

TYPE "rCARTS_0" IS RECORD
(
"ID" NUMBER(19)
);
TYPE "tCARTS_0" IS TABLE OF "rCARTS_0";
"lCARTS_0" "tCARTS_0";

BEGIN

"lCARTS_0" := "tCARTS_0"();
"lCARTS_0".extend(1);
INSERT INTO "HEHE"."CARTS" ("CREATED_AT", "CURRENCY", "CUSTOMER_ID", "SESSION_TOKEN", "STATUS", "UPDATED_AT")
VALUES (:p0, :p1, :p2, :p3, :p4, :p5)
RETURNING "ID" INTO "lCARTS_0"(1)."ID";
OPEN :cur0 FOR SELECT "lCARTS_0"(1)."ID" FROM DUAL;

END;
2025-09-05 14:37:05.937 +07:00 [ERR] 2025-09-05 14:37:05.937002 ThreadID:7   (ERROR)   OracleExecutionStrategy.ExecuteAsync() :  Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
2025-09-05 14:37:05.960 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'PHONE_STORE.Infrastructure.Data.PhoneDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-09-05 14:37:06.167 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 307.1268ms
2025-09-05 14:37:06.170 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:37:06.174 +07:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Oracle.ManagedDataAccess.Client.OracleException (0x80004005): ORA-02290: check constraint (HEHE.CK_CART_OWNER) violated
ORA-06512: at line 14
https://docs.oracle.com/error-help/db/ora-02290/
   at Oracle.ManagedDataAccess.Client.OracleCommand.<>c.<ExecuteDbDataReaderAsync>b__232_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleRelationalCommandBuilderFactory.OracleRelationalCommandBuilder.OracleRelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Update.Internal.OracleModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Oracle.EntityFrameworkCore.Storage.Internal.OracleExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at PHONE_STORE.Infrastructure.Repositories.CartRepository.EnsureCartId(Nullable`1 customerId, String sessionId, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.Infrastructure\Repositories\CartRepository.cs:line 50
   at PHONE_STORE.Infrastructure.Repositories.CartRepository.GetOrCreateAsync(Nullable`1 customerId, String sessionId, CancellationToken ct) in C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.Infrastructure\Repositories\CartRepository.cs:line 77
   at lambda_method31(Closure, Object)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.AwaitableObjectResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Diagnostics.ExceptionHandlerMiddlewareImpl.<Invoke>g__Awaited|10_0(ExceptionHandlerMiddlewareImpl middleware, HttpContext context, Task task)
2025-09-05 14:37:06.225 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 500 null application/problem+json; charset=utf-8 371.5596ms
2025-09-05 14:37:08.849 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 14:37:08.851 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:37:08.852 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 14:37:08.858 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:37:08.869 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:p0='?' (DbType = DateTime), :p1='?' (Size = 2000), :p2='?' (DbType = Int64), :p3='?' (Size = 64), :p4='?' (Size = 2000), :p5='?' (DbType = DateTime), :cur0='?' (Direction = Output) (DbType = Object)], CommandType='"Text"', CommandTimeout='0']
DECLARE

TYPE "rCARTS_0" IS RECORD
(
"ID" NUMBER(19)
);
TYPE "tCARTS_0" IS TABLE OF "rCARTS_0";
"lCARTS_0" "tCARTS_0";

BEGIN

"lCARTS_0" := "tCARTS_0"();
"lCARTS_0".extend(1);
INSERT INTO "HEHE"."CARTS" ("CREATED_AT", "CURRENCY", "CUSTOMER_ID", "SESSION_TOKEN", "STATUS", "UPDATED_AT")
VALUES (:p0, :p1, :p2, :p3, :p4, :p5)
RETURNING "ID" INTO "lCARTS_0"(1)."ID";
OPEN :cur0 FOR SELECT "lCARTS_0"(1)."ID" FROM DUAL;

END;
2025-09-05 14:37:08.877 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:37:08.884 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 14:37:08.887 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 14:37:08.888 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 34.3506ms
2025-09-05 14:37:08.891 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:37:08.892 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 43.2267ms
2025-09-05 14:37:08.941 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 14:37:08.943 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:37:08.944 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 14:37:08.958 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:37:08.975 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:37:08.984 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 14:37:08.988 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 14:37:08.989 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 38.1773ms
2025-09-05 14:37:08.991 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:37:08.993 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 52.6203ms
2025-09-05 14:37:12.248 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 14:37:12.250 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:37:12.251 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 14:37:12.257 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:37:12.263 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:37:12.276 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 14:37:12.280 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 14:37:12.282 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 29.0158ms
2025-09-05 14:37:12.283 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:37:12.285 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 36.3638ms
2025-09-05 14:37:19.454 +07:00 [INF] Request starting HTTP/1.1 POST https://localhost:7277/api/auth/login - application/json; charset=utf-8 null
2025-09-05 14:37:19.458 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.AuthController.Login (PHONE_STORE.API)'
2025-09-05 14:37:19.459 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(LoginRequest, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.AuthController (PHONE_STORE.API).
2025-09-05 14:37:19.468 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:uname_0='?' (Size = 450), :username_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='0']
SELECT "u"."ID", "u"."CREATED_AT", "u"."EMAIL", "u"."PASSWORD_HASH", "u"."PHONE", "u"."STATUS"
FROM "USER_ACCOUNTS" "u"
WHERE (("u"."EMAIL" = :uname_0) OR ("u"."PHONE" = :username_1))
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:37:19.811 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[:userId_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "r"."CODE"
FROM "USER_ROLES" "u"
INNER JOIN "ROLES" "r" ON "u"."ROLE_ID" = "r"."ID"
WHERE "u"."USER_ID" = :userId_0
2025-09-05 14:37:19.817 +07:00 [INF] Login success [21]
2025-09-05 14:37:19.821 +07:00 [INF] Executing OkObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.AuthResponseDto'.
2025-09-05 14:37:19.825 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.AuthController.Login (PHONE_STORE.API) in 363.727ms
2025-09-05 14:37:19.826 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.AuthController.Login (PHONE_STORE.API)'
2025-09-05 14:37:19.828 +07:00 [INF] Request finished HTTP/1.1 POST https://localhost:7277/api/auth/login - 200 null application/json; charset=utf-8 374.07ms
2025-09-05 14:37:19.830 +07:00 [INF] Request starting HTTP/1.1 POST https://localhost:7277/api/shop/cart/merge - null 0
2025-09-05 14:37:19.835 +07:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2025-09-05 14:37:19.837 +07:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-09-05 14:37:19.839 +07:00 [INF] Request finished HTTP/1.1 POST https://localhost:7277/api/shop/cart/merge - 401 0 null 9.1023ms
2025-09-05 14:37:19.853 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - null null
2025-09-05 14:37:19.855 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 14:37:19.856 +07:00 [INF] Route matched with {action = "List", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem]]] List(System.String, System.Nullable`1[System.Int64], Int32, Int32, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 14:37:19.865 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:p_0='?' (DbType = Int32), :p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."ID" "Id", "p"."NAME" "Name", "p"."SLUG" "Slug"
FROM "HEHE"."PRODUCTS" "p"
WHERE "p"."IS_ACTIVE" = 1
ORDER BY "p"."CREATED_AT" DESC
OFFSET :p_0 ROWS FETCH NEXT :p_1 ROWS ONLY
2025-09-05 14:37:19.874 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", (
    SELECT "p0"."IMAGE_URL"
    FROM "HEHE"."PRODUCT_IMAGES" "p0"
    WHERE (("p0"."PRODUCT_ID" IS NOT NULL AND "p0"."PRODUCT_ID" IN (3, 2, 1)) AND ("p"."PRODUCT_ID" = "p0"."PRODUCT_ID"))
    ORDER BY "p0"."SORT_ORDER"
    FETCH FIRST 1 ROWS ONLY) "Url"
FROM "HEHE"."PRODUCT_IMAGES" "p"
WHERE "p"."PRODUCT_ID" IS NOT NULL AND "p"."PRODUCT_ID" IN (3, 2, 1)
GROUP BY "p"."PRODUCT_ID"
2025-09-05 14:37:19.880 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", MIN(COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")) "MinPrice"
FROM "HEHE"."PRODUCT_VARIANTS" "p"
INNER JOIN "HEHE"."PRODUCT_PRICES" "p0" ON "p"."ID" = "p0"."VARIANT_ID"
WHERE (("p"."PRODUCT_ID" IN (3, 2, 1)) AND ((("p0"."STARTS_AT" <= :now_1) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))))
GROUP BY "p"."PRODUCT_ID"
2025-09-05 14:37:19.884 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem, PHONE_STORE.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-05 14:37:19.885 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API) in 23.9657ms
2025-09-05 14:37:19.886 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 14:37:19.887 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - 200 null application/json; charset=utf-8 33.6314ms
2025-09-05 14:37:19.916 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 14:37:19.920 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:37:19.921 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 14:37:19.928 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:37:19.934 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:p0='?' (DbType = DateTime), :p1='?' (Size = 2000), :p2='?' (DbType = Int64), :p3='?' (Size = 64), :p4='?' (Size = 2000), :p5='?' (DbType = DateTime), :cur0='?' (Direction = Output) (DbType = Object)], CommandType='"Text"', CommandTimeout='0']
DECLARE

TYPE "rCARTS_0" IS RECORD
(
"ID" NUMBER(19)
);
TYPE "tCARTS_0" IS TABLE OF "rCARTS_0";
"lCARTS_0" "tCARTS_0";

BEGIN

"lCARTS_0" := "tCARTS_0"();
"lCARTS_0".extend(1);
INSERT INTO "HEHE"."CARTS" ("CREATED_AT", "CURRENCY", "CUSTOMER_ID", "SESSION_TOKEN", "STATUS", "UPDATED_AT")
VALUES (:p0, :p1, :p2, :p3, :p4, :p5)
RETURNING "ID" INTO "lCARTS_0"(1)."ID";
OPEN :cur0 FOR SELECT "lCARTS_0"(1)."ID" FROM DUAL;

END;
2025-09-05 14:37:19.943 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:37:19.948 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 14:37:19.951 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 14:37:19.959 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 34.1312ms
2025-09-05 14:37:19.960 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:37:19.962 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 45.1915ms
2025-09-05 14:37:23.678 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products/galaxy-s24 - null null
2025-09-05 14:37:23.680 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API)'
2025-09-05 14:37:23.680 +07:00 [INF] Route matched with {action = "Details", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductDetail]] Details(System.String, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 14:37:23.685 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:slug_0='?' (Size = 220)], CommandType='"Text"', CommandTimeout='0']
SELECT "p2"."ID", "p2"."BRAND_ID", "p2"."CREATED_AT", "p2"."DEFAULT_CATEGORY_ID", "p2"."DESCRIPTION", "p2"."IS_ACTIVE", "p2"."NAME", "p2"."SLUG", "p2"."SPEC_JSON", "p0"."ID", "p0"."BARCODE", "p0"."COLOR", "p0"."IS_ACTIVE", "p0"."PRODUCT_ID", "p0"."SKU", "p0"."STORAGE_GB", "p0"."WEIGHT_GRAM", "p1"."ID", "p1"."ALT_TEXT", "p1"."IMAGE_URL", "p1"."IS_PRIMARY", "p1"."PRODUCT_ID", "p1"."SORT_ORDER", "p1"."VARIANT_ID"
FROM (
    SELECT "p"."ID", "p"."BRAND_ID", "p"."CREATED_AT", "p"."DEFAULT_CATEGORY_ID", "p"."DESCRIPTION", "p"."IS_ACTIVE", "p"."NAME", "p"."SLUG", "p"."SPEC_JSON"
    FROM "HEHE"."PRODUCTS" "p"
    WHERE (("p"."SLUG" = :slug_0) AND ("p"."IS_ACTIVE" = 1))
    FETCH FIRST 1 ROWS ONLY
) "p2"
LEFT JOIN "HEHE"."PRODUCT_VARIANTS" "p0" ON "p2"."ID" = "p0"."PRODUCT_ID"
LEFT JOIN "HEHE"."PRODUCT_IMAGES" "p1" ON "p2"."ID" = "p1"."PRODUCT_ID"
ORDER BY "p2"."ID", "p0"."ID"
2025-09-05 14:37:23.692 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."VARIANT_ID" "VariantId", COALESCE((
    SELECT COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")
    FROM "HEHE"."PRODUCT_PRICES" "p0"
    WHERE (((((("p0"."VARIANT_ID" = 3) AND ("p0"."STARTS_AT" <= :now_1))) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))) AND ("p"."VARIANT_ID" = "p0"."VARIANT_ID"))
    ORDER BY "p0"."STARTS_AT" DESC
    FETCH FIRST 1 ROWS ONLY), 0.0) "Price"
FROM "HEHE"."PRODUCT_PRICES" "p"
WHERE (((("p"."VARIANT_ID" = 3) AND ("p"."STARTS_AT" <= :now_1))) AND ((("p"."ENDS_AT" IS NULL) OR ("p"."ENDS_AT" > :now_2))))
GROUP BY "p"."VARIANT_ID"
2025-09-05 14:37:23.696 +07:00 [INF] Executing OkObjectResult, writing value of type 'PHONE_STORE.API.Controllers.ShopProductsController+ShopProductDetail'.
2025-09-05 14:37:23.697 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API) in 14.8987ms
2025-09-05 14:37:23.699 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API)'
2025-09-05 14:37:23.700 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products/galaxy-s24 - 200 null application/json; charset=utf-8 22.4201ms
2025-09-05 14:37:23.734 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 14:37:23.736 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:37:23.737 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 14:37:23.744 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:37:23.748 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:37:23.752 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 14:37:23.763 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 14:37:23.764 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 23.152ms
2025-09-05 14:37:23.765 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:37:23.766 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 32.3932ms
2025-09-05 14:37:25.102 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 14:37:25.106 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:37:25.107 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 14:37:25.111 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:37:25.114 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:37:25.117 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 14:37:25.122 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 14:37:25.123 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 14.5161ms
2025-09-05 14:37:25.124 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:37:25.125 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 22.6579ms
2025-09-05 14:37:25.155 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 14:37:25.158 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:37:25.158 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 14:37:25.162 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:37:25.166 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:37:25.175 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 14:37:25.178 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 14:37:25.179 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 19.3607ms
2025-09-05 14:37:25.182 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:37:25.187 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 32.3395ms
2025-09-05 14:37:26.257 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - null null
2025-09-05 14:37:26.259 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 14:37:26.260 +07:00 [INF] Route matched with {action = "List", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem]]] List(System.String, System.Nullable`1[System.Int64], Int32, Int32, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 14:37:26.265 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:p_0='?' (DbType = Int32), :p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."ID" "Id", "p"."NAME" "Name", "p"."SLUG" "Slug"
FROM "HEHE"."PRODUCTS" "p"
WHERE "p"."IS_ACTIVE" = 1
ORDER BY "p"."CREATED_AT" DESC
OFFSET :p_0 ROWS FETCH NEXT :p_1 ROWS ONLY
2025-09-05 14:37:26.268 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", (
    SELECT "p0"."IMAGE_URL"
    FROM "HEHE"."PRODUCT_IMAGES" "p0"
    WHERE (("p0"."PRODUCT_ID" IS NOT NULL AND "p0"."PRODUCT_ID" IN (3, 2, 1)) AND ("p"."PRODUCT_ID" = "p0"."PRODUCT_ID"))
    ORDER BY "p0"."SORT_ORDER"
    FETCH FIRST 1 ROWS ONLY) "Url"
FROM "HEHE"."PRODUCT_IMAGES" "p"
WHERE "p"."PRODUCT_ID" IS NOT NULL AND "p"."PRODUCT_ID" IN (3, 2, 1)
GROUP BY "p"."PRODUCT_ID"
2025-09-05 14:37:26.274 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", MIN(COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")) "MinPrice"
FROM "HEHE"."PRODUCT_VARIANTS" "p"
INNER JOIN "HEHE"."PRODUCT_PRICES" "p0" ON "p"."ID" = "p0"."VARIANT_ID"
WHERE (("p"."PRODUCT_ID" IN (3, 2, 1)) AND ((("p0"."STARTS_AT" <= :now_1) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))))
GROUP BY "p"."PRODUCT_ID"
2025-09-05 14:37:26.277 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem, PHONE_STORE.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-05 14:37:26.278 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API) in 16.2772ms
2025-09-05 14:37:26.279 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 14:37:26.280 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - 200 null application/json; charset=utf-8 22.9351ms
2025-09-05 14:37:26.330 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 14:37:26.334 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:37:26.335 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 14:37:26.341 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:37:26.350 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:37:26.356 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 14:37:26.360 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 14:37:26.361 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 23.0929ms
2025-09-05 14:37:26.362 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:37:26.363 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 32.9445ms
2025-09-05 14:37:27.247 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products/galaxy-s24 - null null
2025-09-05 14:37:27.249 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API)'
2025-09-05 14:37:27.250 +07:00 [INF] Route matched with {action = "Details", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductDetail]] Details(System.String, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 14:37:27.254 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:slug_0='?' (Size = 220)], CommandType='"Text"', CommandTimeout='0']
SELECT "p2"."ID", "p2"."BRAND_ID", "p2"."CREATED_AT", "p2"."DEFAULT_CATEGORY_ID", "p2"."DESCRIPTION", "p2"."IS_ACTIVE", "p2"."NAME", "p2"."SLUG", "p2"."SPEC_JSON", "p0"."ID", "p0"."BARCODE", "p0"."COLOR", "p0"."IS_ACTIVE", "p0"."PRODUCT_ID", "p0"."SKU", "p0"."STORAGE_GB", "p0"."WEIGHT_GRAM", "p1"."ID", "p1"."ALT_TEXT", "p1"."IMAGE_URL", "p1"."IS_PRIMARY", "p1"."PRODUCT_ID", "p1"."SORT_ORDER", "p1"."VARIANT_ID"
FROM (
    SELECT "p"."ID", "p"."BRAND_ID", "p"."CREATED_AT", "p"."DEFAULT_CATEGORY_ID", "p"."DESCRIPTION", "p"."IS_ACTIVE", "p"."NAME", "p"."SLUG", "p"."SPEC_JSON"
    FROM "HEHE"."PRODUCTS" "p"
    WHERE (("p"."SLUG" = :slug_0) AND ("p"."IS_ACTIVE" = 1))
    FETCH FIRST 1 ROWS ONLY
) "p2"
LEFT JOIN "HEHE"."PRODUCT_VARIANTS" "p0" ON "p2"."ID" = "p0"."PRODUCT_ID"
LEFT JOIN "HEHE"."PRODUCT_IMAGES" "p1" ON "p2"."ID" = "p1"."PRODUCT_ID"
ORDER BY "p2"."ID", "p0"."ID"
2025-09-05 14:37:27.260 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."VARIANT_ID" "VariantId", COALESCE((
    SELECT COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")
    FROM "HEHE"."PRODUCT_PRICES" "p0"
    WHERE (((((("p0"."VARIANT_ID" = 3) AND ("p0"."STARTS_AT" <= :now_1))) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))) AND ("p"."VARIANT_ID" = "p0"."VARIANT_ID"))
    ORDER BY "p0"."STARTS_AT" DESC
    FETCH FIRST 1 ROWS ONLY), 0.0) "Price"
FROM "HEHE"."PRODUCT_PRICES" "p"
WHERE (((("p"."VARIANT_ID" = 3) AND ("p"."STARTS_AT" <= :now_1))) AND ((("p"."ENDS_AT" IS NULL) OR ("p"."ENDS_AT" > :now_2))))
GROUP BY "p"."VARIANT_ID"
2025-09-05 14:37:27.262 +07:00 [INF] Executing OkObjectResult, writing value of type 'PHONE_STORE.API.Controllers.ShopProductsController+ShopProductDetail'.
2025-09-05 14:37:27.263 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API) in 12.0611ms
2025-09-05 14:37:27.264 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API)'
2025-09-05 14:37:27.265 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products/galaxy-s24 - 200 null application/json; charset=utf-8 18.0174ms
2025-09-05 14:37:27.299 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 14:37:27.301 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:37:27.302 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 14:37:27.306 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:37:27.309 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:37:27.313 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 14:37:27.320 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 14:37:27.320 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 17.4659ms
2025-09-05 14:37:27.322 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:37:27.324 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 25.6681ms
2025-09-05 14:37:29.417 +07:00 [INF] Request starting HTTP/1.1 POST https://localhost:7277/api/shop/cart/items - application/json; charset=utf-8 null
2025-09-05 14:37:29.420 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Add (PHONE_STORE.API)'
2025-09-05 14:37:29.420 +07:00 [INF] Route matched with {action = "Add", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Add(PHONE_STORE.Application.Dtos.CartItemUpsertDto, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 14:37:29.426 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:37:29.429 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64), :dto_VariantId_1='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE"
FROM "HEHE"."CART_ITEMS" "c"
WHERE (("c"."CART_ID" = :id_0) AND ("c"."VARIANT_ID" = :dto_VariantId_1))
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:37:29.432 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[:variantId_0='?' (DbType = Int64), :now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT COALESCE("p"."SALE_PRICE", "p"."LIST_PRICE")
FROM "HEHE"."PRODUCT_PRICES" "p"
WHERE (((("p"."VARIANT_ID" = :variantId_0) AND ("p"."STARTS_AT" <= :now_1))) AND ((("p"."ENDS_AT" IS NULL) OR ("p"."ENDS_AT" > :now_2))))
ORDER BY "p"."STARTS_AT" DESC
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:37:29.435 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:p0='?' (DbType = Int64), :p1='?' (DbType = Int64), :p2='?' (DbType = DateTime), :p3='?' (Size = 2000), :p4='?' (DbType = Int32), :p5='?' (DbType = Decimal)], CommandType='"Text"', CommandTimeout='0']
DECLARE


BEGIN

INSERT INTO "HEHE"."CART_ITEMS" ("CART_ID", "VARIANT_ID", "ADDED_AT", "CURRENCY", "QUANTITY", "UNIT_PRICE")
VALUES (:p0, :p1, :p2, :p3, :p4, :p5);

END;
2025-09-05 14:37:29.454 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:37:29.460 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:37:29.463 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 14:37:29.465 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 14:37:29.466 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Add (PHONE_STORE.API) in 43.0432ms
2025-09-05 14:37:29.466 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Add (PHONE_STORE.API)'
2025-09-05 14:37:29.467 +07:00 [INF] Request finished HTTP/1.1 POST https://localhost:7277/api/shop/cart/items - 200 null application/json; charset=utf-8 50.126ms
2025-09-05 14:37:29.475 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products/galaxy-s24 - null null
2025-09-05 14:37:29.476 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API)'
2025-09-05 14:37:29.477 +07:00 [INF] Route matched with {action = "Details", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductDetail]] Details(System.String, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 14:37:29.481 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:slug_0='?' (Size = 220)], CommandType='"Text"', CommandTimeout='0']
SELECT "p2"."ID", "p2"."BRAND_ID", "p2"."CREATED_AT", "p2"."DEFAULT_CATEGORY_ID", "p2"."DESCRIPTION", "p2"."IS_ACTIVE", "p2"."NAME", "p2"."SLUG", "p2"."SPEC_JSON", "p0"."ID", "p0"."BARCODE", "p0"."COLOR", "p0"."IS_ACTIVE", "p0"."PRODUCT_ID", "p0"."SKU", "p0"."STORAGE_GB", "p0"."WEIGHT_GRAM", "p1"."ID", "p1"."ALT_TEXT", "p1"."IMAGE_URL", "p1"."IS_PRIMARY", "p1"."PRODUCT_ID", "p1"."SORT_ORDER", "p1"."VARIANT_ID"
FROM (
    SELECT "p"."ID", "p"."BRAND_ID", "p"."CREATED_AT", "p"."DEFAULT_CATEGORY_ID", "p"."DESCRIPTION", "p"."IS_ACTIVE", "p"."NAME", "p"."SLUG", "p"."SPEC_JSON"
    FROM "HEHE"."PRODUCTS" "p"
    WHERE (("p"."SLUG" = :slug_0) AND ("p"."IS_ACTIVE" = 1))
    FETCH FIRST 1 ROWS ONLY
) "p2"
LEFT JOIN "HEHE"."PRODUCT_VARIANTS" "p0" ON "p2"."ID" = "p0"."PRODUCT_ID"
LEFT JOIN "HEHE"."PRODUCT_IMAGES" "p1" ON "p2"."ID" = "p1"."PRODUCT_ID"
ORDER BY "p2"."ID", "p0"."ID"
2025-09-05 14:37:29.485 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."VARIANT_ID" "VariantId", COALESCE((
    SELECT COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")
    FROM "HEHE"."PRODUCT_PRICES" "p0"
    WHERE (((((("p0"."VARIANT_ID" = 3) AND ("p0"."STARTS_AT" <= :now_1))) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))) AND ("p"."VARIANT_ID" = "p0"."VARIANT_ID"))
    ORDER BY "p0"."STARTS_AT" DESC
    FETCH FIRST 1 ROWS ONLY), 0.0) "Price"
FROM "HEHE"."PRODUCT_PRICES" "p"
WHERE (((("p"."VARIANT_ID" = 3) AND ("p"."STARTS_AT" <= :now_1))) AND ((("p"."ENDS_AT" IS NULL) OR ("p"."ENDS_AT" > :now_2))))
GROUP BY "p"."VARIANT_ID"
2025-09-05 14:37:29.487 +07:00 [INF] Executing OkObjectResult, writing value of type 'PHONE_STORE.API.Controllers.ShopProductsController+ShopProductDetail'.
2025-09-05 14:37:29.491 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API) in 12.3572ms
2025-09-05 14:37:29.492 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API)'
2025-09-05 14:37:29.492 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products/galaxy-s24 - 200 null application/json; charset=utf-8 17.7337ms
2025-09-05 14:37:29.523 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 14:37:29.525 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:37:29.526 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 14:37:29.541 +07:00 [INF] Executed DbCommand (10ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:37:29.546 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:37:29.551 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 14:37:29.561 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 14:37:29.563 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 33.6123ms
2025-09-05 14:37:29.564 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:37:29.566 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 43.2808ms
2025-09-05 14:37:31.337 +07:00 [INF] Request starting HTTP/1.1 POST https://localhost:7277/api/auth/logout - application/json; charset=utf-8 null
2025-09-05 14:37:31.340 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.AuthController.Logout (PHONE_STORE.API)'
2025-09-05 14:37:31.345 +07:00 [INF] Route matched with {action = "Logout", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Logout(RefreshRequest, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.AuthController (PHONE_STORE.API).
2025-09-05 14:37:31.356 +07:00 [INF] Logout: revoked RT
2025-09-05 14:37:31.357 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType1`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-05 14:37:31.361 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.AuthController.Logout (PHONE_STORE.API) in 15.3093ms
2025-09-05 14:37:31.362 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.AuthController.Logout (PHONE_STORE.API)'
2025-09-05 14:37:31.363 +07:00 [INF] Request finished HTTP/1.1 POST https://localhost:7277/api/auth/logout - 200 null application/json; charset=utf-8 26.0697ms
2025-09-05 14:37:31.376 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - null null
2025-09-05 14:37:31.378 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 14:37:31.379 +07:00 [INF] Route matched with {action = "List", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem]]] List(System.String, System.Nullable`1[System.Int64], Int32, Int32, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 14:37:31.383 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:p_0='?' (DbType = Int32), :p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."ID" "Id", "p"."NAME" "Name", "p"."SLUG" "Slug"
FROM "HEHE"."PRODUCTS" "p"
WHERE "p"."IS_ACTIVE" = 1
ORDER BY "p"."CREATED_AT" DESC
OFFSET :p_0 ROWS FETCH NEXT :p_1 ROWS ONLY
2025-09-05 14:37:31.386 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", (
    SELECT "p0"."IMAGE_URL"
    FROM "HEHE"."PRODUCT_IMAGES" "p0"
    WHERE (("p0"."PRODUCT_ID" IS NOT NULL AND "p0"."PRODUCT_ID" IN (3, 2, 1)) AND ("p"."PRODUCT_ID" = "p0"."PRODUCT_ID"))
    ORDER BY "p0"."SORT_ORDER"
    FETCH FIRST 1 ROWS ONLY) "Url"
FROM "HEHE"."PRODUCT_IMAGES" "p"
WHERE "p"."PRODUCT_ID" IS NOT NULL AND "p"."PRODUCT_ID" IN (3, 2, 1)
GROUP BY "p"."PRODUCT_ID"
2025-09-05 14:37:31.390 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", MIN(COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")) "MinPrice"
FROM "HEHE"."PRODUCT_VARIANTS" "p"
INNER JOIN "HEHE"."PRODUCT_PRICES" "p0" ON "p"."ID" = "p0"."VARIANT_ID"
WHERE (("p"."PRODUCT_ID" IN (3, 2, 1)) AND ((("p0"."STARTS_AT" <= :now_1) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))))
GROUP BY "p"."PRODUCT_ID"
2025-09-05 14:37:31.393 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem, PHONE_STORE.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-05 14:37:31.397 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API) in 16.6918ms
2025-09-05 14:37:31.398 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 14:37:31.399 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - 200 null application/json; charset=utf-8 23.1526ms
2025-09-05 14:37:31.428 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 14:37:31.430 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:37:31.431 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 14:37:31.436 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:37:31.445 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:37:31.448 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 14:37:31.454 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 14:37:31.456 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 22.8607ms
2025-09-05 14:37:31.457 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:37:31.458 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 30.1214ms
2025-09-05 14:37:32.730 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 14:37:32.732 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:37:32.732 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 14:37:32.736 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:37:32.740 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:37:32.745 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 14:37:32.756 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 14:37:32.760 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 25.6906ms
2025-09-05 14:37:32.761 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:37:32.763 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 33.1448ms
2025-09-05 14:37:38.916 +07:00 [INF] Request starting HTTP/1.1 POST https://localhost:7277/api/auth/login - application/json; charset=utf-8 null
2025-09-05 14:37:38.918 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.AuthController.Login (PHONE_STORE.API)'
2025-09-05 14:37:38.918 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(LoginRequest, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.AuthController (PHONE_STORE.API).
2025-09-05 14:37:38.926 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:uname_0='?' (Size = 450), :username_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='0']
SELECT "u"."ID", "u"."CREATED_AT", "u"."EMAIL", "u"."PASSWORD_HASH", "u"."PHONE", "u"."STATUS"
FROM "USER_ACCOUNTS" "u"
WHERE (("u"."EMAIL" = :uname_0) OR ("u"."PHONE" = :username_1))
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:37:39.150 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[:userId_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "r"."CODE"
FROM "USER_ROLES" "u"
INNER JOIN "ROLES" "r" ON "u"."ROLE_ID" = "r"."ID"
WHERE "u"."USER_ID" = :userId_0
2025-09-05 14:37:39.154 +07:00 [INF] Login success [81]
2025-09-05 14:37:39.156 +07:00 [INF] Executing OkObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.AuthResponseDto'.
2025-09-05 14:37:39.157 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.AuthController.Login (PHONE_STORE.API) in 237.531ms
2025-09-05 14:37:39.158 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.AuthController.Login (PHONE_STORE.API)'
2025-09-05 14:37:39.159 +07:00 [INF] Request finished HTTP/1.1 POST https://localhost:7277/api/auth/login - 200 null application/json; charset=utf-8 243.417ms
2025-09-05 14:37:39.160 +07:00 [INF] Request starting HTTP/1.1 POST https://localhost:7277/api/shop/cart/merge - null 0
2025-09-05 14:37:39.162 +07:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2025-09-05 14:37:39.163 +07:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-09-05 14:37:39.164 +07:00 [INF] Request finished HTTP/1.1 POST https://localhost:7277/api/shop/cart/merge - 401 0 null 3.8144ms
2025-09-05 14:37:39.180 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - null null
2025-09-05 14:37:39.182 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 14:37:39.182 +07:00 [INF] Route matched with {action = "List", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem]]] List(System.String, System.Nullable`1[System.Int64], Int32, Int32, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 14:37:39.189 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[:p_0='?' (DbType = Int32), :p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."ID" "Id", "p"."NAME" "Name", "p"."SLUG" "Slug"
FROM "HEHE"."PRODUCTS" "p"
WHERE "p"."IS_ACTIVE" = 1
ORDER BY "p"."CREATED_AT" DESC
OFFSET :p_0 ROWS FETCH NEXT :p_1 ROWS ONLY
2025-09-05 14:37:39.196 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", (
    SELECT "p0"."IMAGE_URL"
    FROM "HEHE"."PRODUCT_IMAGES" "p0"
    WHERE (("p0"."PRODUCT_ID" IS NOT NULL AND "p0"."PRODUCT_ID" IN (3, 2, 1)) AND ("p"."PRODUCT_ID" = "p0"."PRODUCT_ID"))
    ORDER BY "p0"."SORT_ORDER"
    FETCH FIRST 1 ROWS ONLY) "Url"
FROM "HEHE"."PRODUCT_IMAGES" "p"
WHERE "p"."PRODUCT_ID" IS NOT NULL AND "p"."PRODUCT_ID" IN (3, 2, 1)
GROUP BY "p"."PRODUCT_ID"
2025-09-05 14:37:39.201 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", MIN(COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")) "MinPrice"
FROM "HEHE"."PRODUCT_VARIANTS" "p"
INNER JOIN "HEHE"."PRODUCT_PRICES" "p0" ON "p"."ID" = "p0"."VARIANT_ID"
WHERE (("p"."PRODUCT_ID" IN (3, 2, 1)) AND ((("p0"."STARTS_AT" <= :now_1) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))))
GROUP BY "p"."PRODUCT_ID"
2025-09-05 14:37:39.206 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem, PHONE_STORE.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-05 14:37:39.207 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API) in 23.5488ms
2025-09-05 14:37:39.208 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 14:37:39.209 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - 200 null application/json; charset=utf-8 28.8238ms
2025-09-05 14:37:39.244 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 14:37:39.246 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:37:39.247 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 14:37:39.254 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:37:39.262 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:p0='?' (DbType = DateTime), :p1='?' (Size = 2000), :p2='?' (DbType = Int64), :p3='?' (Size = 64), :p4='?' (Size = 2000), :p5='?' (DbType = DateTime), :cur0='?' (Direction = Output) (DbType = Object)], CommandType='"Text"', CommandTimeout='0']
DECLARE

TYPE "rCARTS_0" IS RECORD
(
"ID" NUMBER(19)
);
TYPE "tCARTS_0" IS TABLE OF "rCARTS_0";
"lCARTS_0" "tCARTS_0";

BEGIN

"lCARTS_0" := "tCARTS_0"();
"lCARTS_0".extend(1);
INSERT INTO "HEHE"."CARTS" ("CREATED_AT", "CURRENCY", "CUSTOMER_ID", "SESSION_TOKEN", "STATUS", "UPDATED_AT")
VALUES (:p0, :p1, :p2, :p3, :p4, :p5)
RETURNING "ID" INTO "lCARTS_0"(1)."ID";
OPEN :cur0 FOR SELECT "lCARTS_0"(1)."ID" FROM DUAL;

END;
2025-09-05 14:37:39.268 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:37:39.277 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 14:37:39.280 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 14:37:39.281 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 31.043ms
2025-09-05 14:37:39.282 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:37:39.282 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 38.6909ms
2025-09-05 14:37:41.914 +07:00 [INF] Request starting HTTP/1.1 POST https://localhost:7277/api/auth/logout - application/json; charset=utf-8 null
2025-09-05 14:37:41.916 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.AuthController.Logout (PHONE_STORE.API)'
2025-09-05 14:37:41.917 +07:00 [INF] Route matched with {action = "Logout", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Logout(RefreshRequest, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.AuthController (PHONE_STORE.API).
2025-09-05 14:37:41.919 +07:00 [INF] Logout: revoked RT
2025-09-05 14:37:41.920 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType1`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-05 14:37:41.921 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.AuthController.Logout (PHONE_STORE.API) in 3.659ms
2025-09-05 14:37:41.923 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.AuthController.Logout (PHONE_STORE.API)'
2025-09-05 14:37:41.924 +07:00 [INF] Request finished HTTP/1.1 POST https://localhost:7277/api/auth/logout - 200 null application/json; charset=utf-8 9.4888ms
2025-09-05 14:37:41.934 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - null null
2025-09-05 14:37:41.937 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 14:37:41.938 +07:00 [INF] Route matched with {action = "List", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem]]] List(System.String, System.Nullable`1[System.Int64], Int32, Int32, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 14:37:41.945 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:p_0='?' (DbType = Int32), :p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."ID" "Id", "p"."NAME" "Name", "p"."SLUG" "Slug"
FROM "HEHE"."PRODUCTS" "p"
WHERE "p"."IS_ACTIVE" = 1
ORDER BY "p"."CREATED_AT" DESC
OFFSET :p_0 ROWS FETCH NEXT :p_1 ROWS ONLY
2025-09-05 14:37:41.948 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", (
    SELECT "p0"."IMAGE_URL"
    FROM "HEHE"."PRODUCT_IMAGES" "p0"
    WHERE (("p0"."PRODUCT_ID" IS NOT NULL AND "p0"."PRODUCT_ID" IN (3, 2, 1)) AND ("p"."PRODUCT_ID" = "p0"."PRODUCT_ID"))
    ORDER BY "p0"."SORT_ORDER"
    FETCH FIRST 1 ROWS ONLY) "Url"
FROM "HEHE"."PRODUCT_IMAGES" "p"
WHERE "p"."PRODUCT_ID" IS NOT NULL AND "p"."PRODUCT_ID" IN (3, 2, 1)
GROUP BY "p"."PRODUCT_ID"
2025-09-05 14:37:41.954 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", MIN(COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")) "MinPrice"
FROM "HEHE"."PRODUCT_VARIANTS" "p"
INNER JOIN "HEHE"."PRODUCT_PRICES" "p0" ON "p"."ID" = "p0"."VARIANT_ID"
WHERE (("p"."PRODUCT_ID" IN (3, 2, 1)) AND ((("p0"."STARTS_AT" <= :now_1) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))))
GROUP BY "p"."PRODUCT_ID"
2025-09-05 14:37:41.956 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem, PHONE_STORE.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-05 14:37:41.957 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API) in 14.8399ms
2025-09-05 14:37:41.958 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 14:37:41.959 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - 200 null application/json; charset=utf-8 24.5639ms
2025-09-05 14:37:41.990 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 14:37:41.993 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:37:41.994 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 14:37:41.999 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:37:42.007 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:37:42.011 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 14:37:42.023 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 14:37:42.025 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 28.8469ms
2025-09-05 14:37:42.026 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:37:42.028 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 37.6099ms
2025-09-05 14:37:43.597 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 14:37:43.598 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:37:43.599 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 14:37:43.607 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:37:43.611 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:37:43.615 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 14:37:43.618 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 14:37:43.627 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 24.1381ms
2025-09-05 14:37:43.628 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:37:43.630 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 33.354ms
2025-09-05 14:37:48.996 +07:00 [INF] Request starting HTTP/1.1 POST https://localhost:7277/api/auth/login - application/json; charset=utf-8 null
2025-09-05 14:37:48.999 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.AuthController.Login (PHONE_STORE.API)'
2025-09-05 14:37:49.000 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(LoginRequest, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.AuthController (PHONE_STORE.API).
2025-09-05 14:37:49.008 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:uname_0='?' (Size = 450), :username_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='0']
SELECT "u"."ID", "u"."CREATED_AT", "u"."EMAIL", "u"."PASSWORD_HASH", "u"."PHONE", "u"."STATUS"
FROM "USER_ACCOUNTS" "u"
WHERE (("u"."EMAIL" = :uname_0) OR ("u"."PHONE" = :username_1))
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:37:49.271 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[:userId_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "r"."CODE"
FROM "USER_ROLES" "u"
INNER JOIN "ROLES" "r" ON "u"."ROLE_ID" = "r"."ID"
WHERE "u"."USER_ID" = :userId_0
2025-09-05 14:37:49.274 +07:00 [INF] Login success [21]
2025-09-05 14:37:49.275 +07:00 [INF] Executing OkObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.AuthResponseDto'.
2025-09-05 14:37:49.276 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.AuthController.Login (PHONE_STORE.API) in 275.0004ms
2025-09-05 14:37:49.277 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.AuthController.Login (PHONE_STORE.API)'
2025-09-05 14:37:49.278 +07:00 [INF] Request finished HTTP/1.1 POST https://localhost:7277/api/auth/login - 200 null application/json; charset=utf-8 281.8479ms
2025-09-05 14:37:49.279 +07:00 [INF] Request starting HTTP/1.1 POST https://localhost:7277/api/shop/cart/merge - null 0
2025-09-05 14:37:49.282 +07:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2025-09-05 14:37:49.282 +07:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-09-05 14:37:49.283 +07:00 [INF] Request finished HTTP/1.1 POST https://localhost:7277/api/shop/cart/merge - 401 0 null 4.4887ms
2025-09-05 14:37:49.294 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - null null
2025-09-05 14:37:49.297 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 14:37:49.297 +07:00 [INF] Route matched with {action = "List", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem]]] List(System.String, System.Nullable`1[System.Int64], Int32, Int32, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 14:37:49.306 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[:p_0='?' (DbType = Int32), :p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."ID" "Id", "p"."NAME" "Name", "p"."SLUG" "Slug"
FROM "HEHE"."PRODUCTS" "p"
WHERE "p"."IS_ACTIVE" = 1
ORDER BY "p"."CREATED_AT" DESC
OFFSET :p_0 ROWS FETCH NEXT :p_1 ROWS ONLY
2025-09-05 14:37:49.313 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", (
    SELECT "p0"."IMAGE_URL"
    FROM "HEHE"."PRODUCT_IMAGES" "p0"
    WHERE (("p0"."PRODUCT_ID" IS NOT NULL AND "p0"."PRODUCT_ID" IN (3, 2, 1)) AND ("p"."PRODUCT_ID" = "p0"."PRODUCT_ID"))
    ORDER BY "p0"."SORT_ORDER"
    FETCH FIRST 1 ROWS ONLY) "Url"
FROM "HEHE"."PRODUCT_IMAGES" "p"
WHERE "p"."PRODUCT_ID" IS NOT NULL AND "p"."PRODUCT_ID" IN (3, 2, 1)
GROUP BY "p"."PRODUCT_ID"
2025-09-05 14:37:49.320 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", MIN(COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")) "MinPrice"
FROM "HEHE"."PRODUCT_VARIANTS" "p"
INNER JOIN "HEHE"."PRODUCT_PRICES" "p0" ON "p"."ID" = "p0"."VARIANT_ID"
WHERE (("p"."PRODUCT_ID" IN (3, 2, 1)) AND ((("p0"."STARTS_AT" <= :now_1) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))))
GROUP BY "p"."PRODUCT_ID"
2025-09-05 14:37:49.324 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem, PHONE_STORE.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-05 14:37:49.325 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API) in 25.1922ms
2025-09-05 14:37:49.326 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 14:37:49.326 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - 200 null application/json; charset=utf-8 31.9869ms
2025-09-05 14:37:49.358 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 14:37:49.360 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:37:49.361 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 14:37:49.368 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:37:49.375 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:p0='?' (DbType = DateTime), :p1='?' (Size = 2000), :p2='?' (DbType = Int64), :p3='?' (Size = 64), :p4='?' (Size = 2000), :p5='?' (DbType = DateTime), :cur0='?' (Direction = Output) (DbType = Object)], CommandType='"Text"', CommandTimeout='0']
DECLARE

TYPE "rCARTS_0" IS RECORD
(
"ID" NUMBER(19)
);
TYPE "tCARTS_0" IS TABLE OF "rCARTS_0";
"lCARTS_0" "tCARTS_0";

BEGIN

"lCARTS_0" := "tCARTS_0"();
"lCARTS_0".extend(1);
INSERT INTO "HEHE"."CARTS" ("CREATED_AT", "CURRENCY", "CUSTOMER_ID", "SESSION_TOKEN", "STATUS", "UPDATED_AT")
VALUES (:p0, :p1, :p2, :p3, :p4, :p5)
RETURNING "ID" INTO "lCARTS_0"(1)."ID";
OPEN :cur0 FOR SELECT "lCARTS_0"(1)."ID" FROM DUAL;

END;
2025-09-05 14:37:49.383 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:37:49.389 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 14:37:49.403 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 14:37:49.405 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 40.6591ms
2025-09-05 14:37:49.405 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:37:49.406 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 48.1441ms
2025-09-05 14:51:46.341 +07:00 [INF] User profile is available. Using 'C:\Users\Administrator\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-09-05 14:51:46.631 +07:00 [INF] Now listening on: https://localhost:7277
2025-09-05 14:51:46.632 +07:00 [INF] Now listening on: http://localhost:5209
2025-09-05 14:51:46.744 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-05 14:51:46.745 +07:00 [INF] Hosting environment: Development
2025-09-05 14:51:46.745 +07:00 [INF] Content root path: C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.API
2025-09-05 14:51:47.765 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/swagger/index.html - null null
2025-09-05 14:51:48.204 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/swagger/index.html - 200 null text/html;charset=utf-8 450.275ms
2025-09-05 14:51:48.322 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - null null
2025-09-05 14:51:48.415 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 14:51:48.452 +07:00 [INF] Route matched with {action = "List", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem]]] List(System.String, System.Nullable`1[System.Int64], Int32, Int32, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 14:51:48.696 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/_framework/aspnetcore-browser-refresh.js - null null
2025-09-05 14:51:48.696 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/_vs/browserLink - null null
2025-09-05 14:51:48.704 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/_framework/aspnetcore-browser-refresh.js - 200 13766 application/javascript; charset=utf-8 7.6584ms
2025-09-05 14:51:48.769 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/_vs/browserLink - 200 null text/javascript; charset=UTF-8 72.5453ms
2025-09-05 14:51:49.084 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/swagger/v1/swagger.json - null null
2025-09-05 14:51:49.154 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 69.8021ms
2025-09-05 14:51:49.488 +07:00 [WRN] The decimal property 'UnitPrice' on entity type 'CartItem' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 14:51:49.490 +07:00 [WRN] The decimal property 'DiscountTotal' on entity type 'Order' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 14:51:49.491 +07:00 [WRN] The decimal property 'GrandTotal' on entity type 'Order' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 14:51:49.492 +07:00 [WRN] The decimal property 'ShippingFee' on entity type 'Order' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 14:51:49.493 +07:00 [WRN] The decimal property 'Subtotal' on entity type 'Order' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 14:51:49.494 +07:00 [WRN] The decimal property 'TaxTotal' on entity type 'Order' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 14:51:49.495 +07:00 [WRN] The decimal property 'DiscountAmount' on entity type 'OrderItem' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 14:51:49.496 +07:00 [WRN] The decimal property 'TaxAmount' on entity type 'OrderItem' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 14:51:49.497 +07:00 [WRN] The decimal property 'UnitPrice' on entity type 'OrderItem' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 14:51:49.498 +07:00 [WRN] The decimal property 'DecValue' on entity type 'ProductAttributeValue' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 14:51:49.500 +07:00 [WRN] The decimal property 'ListPrice' on entity type 'ProductPrice' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 14:51:49.501 +07:00 [WRN] The decimal property 'SalePrice' on entity type 'ProductPrice' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 14:51:49.502 +07:00 [WRN] The decimal property 'WeightGram' on entity type 'ProductVariant' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 14:51:50.359 +07:00 [INF] Executed DbCommand (127ms) [Parameters=[:p_0='?' (DbType = Int32), :p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."ID" "Id", "p"."NAME" "Name", "p"."SLUG" "Slug"
FROM "HEHE"."PRODUCTS" "p"
WHERE "p"."IS_ACTIVE" = 1
ORDER BY "p"."CREATED_AT" DESC
OFFSET :p_0 ROWS FETCH NEXT :p_1 ROWS ONLY
2025-09-05 14:51:50.498 +07:00 [INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", (
    SELECT "p0"."IMAGE_URL"
    FROM "HEHE"."PRODUCT_IMAGES" "p0"
    WHERE (("p0"."PRODUCT_ID" IS NOT NULL AND "p0"."PRODUCT_ID" IN (3, 2, 1)) AND ("p"."PRODUCT_ID" = "p0"."PRODUCT_ID"))
    ORDER BY "p0"."SORT_ORDER"
    FETCH FIRST 1 ROWS ONLY) "Url"
FROM "HEHE"."PRODUCT_IMAGES" "p"
WHERE "p"."PRODUCT_ID" IS NOT NULL AND "p"."PRODUCT_ID" IN (3, 2, 1)
GROUP BY "p"."PRODUCT_ID"
2025-09-05 14:51:50.541 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", MIN(COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")) "MinPrice"
FROM "HEHE"."PRODUCT_VARIANTS" "p"
INNER JOIN "HEHE"."PRODUCT_PRICES" "p0" ON "p"."ID" = "p0"."VARIANT_ID"
WHERE (("p"."PRODUCT_ID" IN (3, 2, 1)) AND ((("p0"."STARTS_AT" <= :now_1) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))))
GROUP BY "p"."PRODUCT_ID"
2025-09-05 14:51:50.566 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem, PHONE_STORE.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-05 14:51:50.583 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API) in 2126.3236ms
2025-09-05 14:51:50.585 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 14:51:50.596 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - 200 null application/json; charset=utf-8 2274.8561ms
2025-09-05 14:51:50.846 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 14:51:50.855 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:51:50.862 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 14:51:50.948 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:51:51.103 +07:00 [INF] Executed DbCommand (12ms) [Parameters=[:p0='?' (DbType = DateTime), :p1='?' (Size = 2000), :p2='?' (DbType = Int64), :p3='?' (Size = 64), :p4='?' (Size = 2000), :p5='?' (DbType = DateTime), :cur0='?' (Direction = Output) (DbType = Object)], CommandType='"Text"', CommandTimeout='0']
DECLARE

TYPE "rCARTS_0" IS RECORD
(
"ID" NUMBER(19)
);
TYPE "tCARTS_0" IS TABLE OF "rCARTS_0";
"lCARTS_0" "tCARTS_0";

BEGIN

"lCARTS_0" := "tCARTS_0"();
"lCARTS_0".extend(1);
INSERT INTO "HEHE"."CARTS" ("CREATED_AT", "CURRENCY", "CUSTOMER_ID", "SESSION_TOKEN", "STATUS", "UPDATED_AT")
VALUES (:p0, :p1, :p2, :p3, :p4, :p5)
RETURNING "ID" INTO "lCARTS_0"(1)."ID";
OPEN :cur0 FOR SELECT "lCARTS_0"(1)."ID" FROM DUAL;

END;
2025-09-05 14:51:51.158 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:51:51.176 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 14:51:51.183 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 14:51:51.190 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 325.2338ms
2025-09-05 14:51:51.191 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:51:51.193 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 346.4642ms
2025-09-05 14:51:54.041 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 14:51:54.076 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:51:54.081 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 14:51:54.105 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:51:54.112 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:51:54.116 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 14:51:54.118 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 14:51:54.119 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 35.6111ms
2025-09-05 14:51:54.120 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:51:54.121 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 80.1514ms
2025-09-05 14:51:59.455 +07:00 [INF] Request starting HTTP/1.1 POST https://localhost:7277/api/auth/login - application/json; charset=utf-8 null
2025-09-05 14:51:59.465 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.AuthController.Login (PHONE_STORE.API)'
2025-09-05 14:51:59.472 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(LoginRequest, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.AuthController (PHONE_STORE.API).
2025-09-05 14:51:59.751 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:uname_0='?' (Size = 450), :username_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='0']
SELECT "u"."ID", "u"."CREATED_AT", "u"."EMAIL", "u"."PASSWORD_HASH", "u"."PHONE", "u"."STATUS"
FROM "USER_ACCOUNTS" "u"
WHERE (("u"."EMAIL" = :uname_0) OR ("u"."PHONE" = :username_1))
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:52:00.365 +07:00 [WRN] Login failed: wrong password [61]
2025-09-05 14:52:00.373 +07:00 [INF] Executing UnauthorizedObjectResult, writing value of type '<>f__AnonymousType1`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-05 14:52:00.378 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.AuthController.Login (PHONE_STORE.API) in 905.2895ms
2025-09-05 14:52:00.379 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.AuthController.Login (PHONE_STORE.API)'
2025-09-05 14:52:00.381 +07:00 [INF] Request finished HTTP/1.1 POST https://localhost:7277/api/auth/login - 401 null application/json; charset=utf-8 925.1214ms
2025-09-05 14:52:00.415 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 14:52:00.417 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:52:00.417 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 14:52:00.430 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:52:00.438 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:52:00.446 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 14:52:00.449 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 14:52:00.450 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 31.4507ms
2025-09-05 14:52:00.451 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:52:00.452 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 37.4961ms
2025-09-05 14:52:09.286 +07:00 [INF] Request starting HTTP/1.1 POST https://localhost:7277/api/auth/login - application/json; charset=utf-8 null
2025-09-05 14:52:09.289 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.AuthController.Login (PHONE_STORE.API)'
2025-09-05 14:52:09.289 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(LoginRequest, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.AuthController (PHONE_STORE.API).
2025-09-05 14:52:09.300 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:uname_0='?' (Size = 450), :username_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='0']
SELECT "u"."ID", "u"."CREATED_AT", "u"."EMAIL", "u"."PASSWORD_HASH", "u"."PHONE", "u"."STATUS"
FROM "USER_ACCOUNTS" "u"
WHERE (("u"."EMAIL" = :uname_0) OR ("u"."PHONE" = :username_1))
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:52:09.696 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[:userId_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "r"."CODE"
FROM "USER_ROLES" "u"
INNER JOIN "ROLES" "r" ON "u"."ROLE_ID" = "r"."ID"
WHERE "u"."USER_ID" = :userId_0
2025-09-05 14:52:09.745 +07:00 [INF] Login success [21]
2025-09-05 14:52:09.751 +07:00 [INF] Executing OkObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.AuthResponseDto'.
2025-09-05 14:52:09.754 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.AuthController.Login (PHONE_STORE.API) in 463.1455ms
2025-09-05 14:52:09.756 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.AuthController.Login (PHONE_STORE.API)'
2025-09-05 14:52:09.757 +07:00 [INF] Request finished HTTP/1.1 POST https://localhost:7277/api/auth/login - 200 null application/json; charset=utf-8 471.2951ms
2025-09-05 14:52:09.781 +07:00 [INF] Request starting HTTP/1.1 POST https://localhost:7277/api/shop/cart/merge - null 0
2025-09-05 14:52:09.789 +07:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2025-09-05 14:52:09.795 +07:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-09-05 14:52:09.797 +07:00 [INF] Request finished HTTP/1.1 POST https://localhost:7277/api/shop/cart/merge - 401 0 null 15.2778ms
2025-09-05 14:52:09.810 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - null null
2025-09-05 14:52:09.873 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 14:52:09.876 +07:00 [INF] Route matched with {action = "List", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem]]] List(System.String, System.Nullable`1[System.Int64], Int32, Int32, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 14:52:09.883 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:p_0='?' (DbType = Int32), :p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."ID" "Id", "p"."NAME" "Name", "p"."SLUG" "Slug"
FROM "HEHE"."PRODUCTS" "p"
WHERE "p"."IS_ACTIVE" = 1
ORDER BY "p"."CREATED_AT" DESC
OFFSET :p_0 ROWS FETCH NEXT :p_1 ROWS ONLY
2025-09-05 14:52:09.898 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", (
    SELECT "p0"."IMAGE_URL"
    FROM "HEHE"."PRODUCT_IMAGES" "p0"
    WHERE (("p0"."PRODUCT_ID" IS NOT NULL AND "p0"."PRODUCT_ID" IN (3, 2, 1)) AND ("p"."PRODUCT_ID" = "p0"."PRODUCT_ID"))
    ORDER BY "p0"."SORT_ORDER"
    FETCH FIRST 1 ROWS ONLY) "Url"
FROM "HEHE"."PRODUCT_IMAGES" "p"
WHERE "p"."PRODUCT_ID" IS NOT NULL AND "p"."PRODUCT_ID" IN (3, 2, 1)
GROUP BY "p"."PRODUCT_ID"
2025-09-05 14:52:09.905 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", MIN(COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")) "MinPrice"
FROM "HEHE"."PRODUCT_VARIANTS" "p"
INNER JOIN "HEHE"."PRODUCT_PRICES" "p0" ON "p"."ID" = "p0"."VARIANT_ID"
WHERE (("p"."PRODUCT_ID" IN (3, 2, 1)) AND ((("p0"."STARTS_AT" <= :now_1) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))))
GROUP BY "p"."PRODUCT_ID"
2025-09-05 14:52:09.907 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem, PHONE_STORE.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-05 14:52:09.908 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API) in 29.1925ms
2025-09-05 14:52:09.909 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 14:52:09.909 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - 200 null application/json; charset=utf-8 98.83ms
2025-09-05 14:52:09.943 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 14:52:09.946 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:52:09.947 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 14:52:09.952 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:52:09.956 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:52:09.960 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 14:52:09.962 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 14:52:09.962 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 13.7106ms
2025-09-05 14:52:09.963 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:52:09.964 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 20.6413ms
2025-09-05 14:52:11.939 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products/galaxy-s24 - null null
2025-09-05 14:52:11.943 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API)'
2025-09-05 14:52:11.947 +07:00 [INF] Route matched with {action = "Details", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductDetail]] Details(System.String, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 14:52:11.992 +07:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-09-05 14:52:12.010 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:slug_0='?' (Size = 220)], CommandType='"Text"', CommandTimeout='0']
SELECT "p2"."ID", "p2"."BRAND_ID", "p2"."CREATED_AT", "p2"."DEFAULT_CATEGORY_ID", "p2"."DESCRIPTION", "p2"."IS_ACTIVE", "p2"."NAME", "p2"."SLUG", "p2"."SPEC_JSON", "p0"."ID", "p0"."BARCODE", "p0"."COLOR", "p0"."IS_ACTIVE", "p0"."PRODUCT_ID", "p0"."SKU", "p0"."STORAGE_GB", "p0"."WEIGHT_GRAM", "p1"."ID", "p1"."ALT_TEXT", "p1"."IMAGE_URL", "p1"."IS_PRIMARY", "p1"."PRODUCT_ID", "p1"."SORT_ORDER", "p1"."VARIANT_ID"
FROM (
    SELECT "p"."ID", "p"."BRAND_ID", "p"."CREATED_AT", "p"."DEFAULT_CATEGORY_ID", "p"."DESCRIPTION", "p"."IS_ACTIVE", "p"."NAME", "p"."SLUG", "p"."SPEC_JSON"
    FROM "HEHE"."PRODUCTS" "p"
    WHERE (("p"."SLUG" = :slug_0) AND ("p"."IS_ACTIVE" = 1))
    FETCH FIRST 1 ROWS ONLY
) "p2"
LEFT JOIN "HEHE"."PRODUCT_VARIANTS" "p0" ON "p2"."ID" = "p0"."PRODUCT_ID"
LEFT JOIN "HEHE"."PRODUCT_IMAGES" "p1" ON "p2"."ID" = "p1"."PRODUCT_ID"
ORDER BY "p2"."ID", "p0"."ID"
2025-09-05 14:52:12.061 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."VARIANT_ID" "VariantId", COALESCE((
    SELECT COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")
    FROM "HEHE"."PRODUCT_PRICES" "p0"
    WHERE (((((("p0"."VARIANT_ID" = 3) AND ("p0"."STARTS_AT" <= :now_1))) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))) AND ("p"."VARIANT_ID" = "p0"."VARIANT_ID"))
    ORDER BY "p0"."STARTS_AT" DESC
    FETCH FIRST 1 ROWS ONLY), 0.0) "Price"
FROM "HEHE"."PRODUCT_PRICES" "p"
WHERE (((("p"."VARIANT_ID" = 3) AND ("p"."STARTS_AT" <= :now_1))) AND ((("p"."ENDS_AT" IS NULL) OR ("p"."ENDS_AT" > :now_2))))
GROUP BY "p"."VARIANT_ID"
2025-09-05 14:52:12.067 +07:00 [INF] Executing OkObjectResult, writing value of type 'PHONE_STORE.API.Controllers.ShopProductsController+ShopProductDetail'.
2025-09-05 14:52:12.076 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API) in 128.4331ms
2025-09-05 14:52:12.078 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API)'
2025-09-05 14:52:12.080 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products/galaxy-s24 - 200 null application/json; charset=utf-8 140.9751ms
2025-09-05 14:52:12.128 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 14:52:12.130 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:52:12.131 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 14:52:12.135 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:52:12.139 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:52:12.145 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 14:52:12.147 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 14:52:12.148 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 16.6082ms
2025-09-05 14:52:12.149 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:52:12.150 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 22.1275ms
2025-09-05 14:52:13.156 +07:00 [INF] Request starting HTTP/1.1 POST https://localhost:7277/api/shop/cart/items - application/json; charset=utf-8 null
2025-09-05 14:52:13.161 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Add (PHONE_STORE.API)'
2025-09-05 14:52:13.164 +07:00 [INF] Route matched with {action = "Add", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Add(PHONE_STORE.Application.Dtos.CartItemUpsertDto, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 14:52:13.174 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:52:13.182 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64), :dto_VariantId_1='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE"
FROM "HEHE"."CART_ITEMS" "c"
WHERE (("c"."CART_ID" = :id_0) AND ("c"."VARIANT_ID" = :dto_VariantId_1))
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:52:13.251 +07:00 [INF] Executed DbCommand (52ms) [Parameters=[:variantId_0='?' (DbType = Int64), :now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT COALESCE("p"."SALE_PRICE", "p"."LIST_PRICE")
FROM "HEHE"."PRODUCT_PRICES" "p"
WHERE (((("p"."VARIANT_ID" = :variantId_0) AND ("p"."STARTS_AT" <= :now_1))) AND ((("p"."ENDS_AT" IS NULL) OR ("p"."ENDS_AT" > :now_2))))
ORDER BY "p"."STARTS_AT" DESC
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:52:13.324 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:p0='?' (DbType = Int64), :p1='?' (DbType = Int64), :p2='?' (DbType = DateTime), :p3='?' (Size = 2000), :p4='?' (DbType = Int32), :p5='?' (DbType = Decimal)], CommandType='"Text"', CommandTimeout='0']
DECLARE


BEGIN

INSERT INTO "HEHE"."CART_ITEMS" ("CART_ID", "VARIANT_ID", "ADDED_AT", "CURRENCY", "QUANTITY", "UNIT_PRICE")
VALUES (:p0, :p1, :p2, :p3, :p4, :p5);

END;
2025-09-05 14:52:13.340 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:52:13.343 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:52:13.346 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 14:52:13.349 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 14:52:13.351 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Add (PHONE_STORE.API) in 186.5468ms
2025-09-05 14:52:13.352 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Add (PHONE_STORE.API)'
2025-09-05 14:52:13.353 +07:00 [INF] Request finished HTTP/1.1 POST https://localhost:7277/api/shop/cart/items - 200 null application/json; charset=utf-8 196.3927ms
2025-09-05 14:52:13.358 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products/galaxy-s24 - null null
2025-09-05 14:52:13.360 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API)'
2025-09-05 14:52:13.361 +07:00 [INF] Route matched with {action = "Details", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductDetail]] Details(System.String, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 14:52:13.365 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:slug_0='?' (Size = 220)], CommandType='"Text"', CommandTimeout='0']
SELECT "p2"."ID", "p2"."BRAND_ID", "p2"."CREATED_AT", "p2"."DEFAULT_CATEGORY_ID", "p2"."DESCRIPTION", "p2"."IS_ACTIVE", "p2"."NAME", "p2"."SLUG", "p2"."SPEC_JSON", "p0"."ID", "p0"."BARCODE", "p0"."COLOR", "p0"."IS_ACTIVE", "p0"."PRODUCT_ID", "p0"."SKU", "p0"."STORAGE_GB", "p0"."WEIGHT_GRAM", "p1"."ID", "p1"."ALT_TEXT", "p1"."IMAGE_URL", "p1"."IS_PRIMARY", "p1"."PRODUCT_ID", "p1"."SORT_ORDER", "p1"."VARIANT_ID"
FROM (
    SELECT "p"."ID", "p"."BRAND_ID", "p"."CREATED_AT", "p"."DEFAULT_CATEGORY_ID", "p"."DESCRIPTION", "p"."IS_ACTIVE", "p"."NAME", "p"."SLUG", "p"."SPEC_JSON"
    FROM "HEHE"."PRODUCTS" "p"
    WHERE (("p"."SLUG" = :slug_0) AND ("p"."IS_ACTIVE" = 1))
    FETCH FIRST 1 ROWS ONLY
) "p2"
LEFT JOIN "HEHE"."PRODUCT_VARIANTS" "p0" ON "p2"."ID" = "p0"."PRODUCT_ID"
LEFT JOIN "HEHE"."PRODUCT_IMAGES" "p1" ON "p2"."ID" = "p1"."PRODUCT_ID"
ORDER BY "p2"."ID", "p0"."ID"
2025-09-05 14:52:13.369 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."VARIANT_ID" "VariantId", COALESCE((
    SELECT COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")
    FROM "HEHE"."PRODUCT_PRICES" "p0"
    WHERE (((((("p0"."VARIANT_ID" = 3) AND ("p0"."STARTS_AT" <= :now_1))) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))) AND ("p"."VARIANT_ID" = "p0"."VARIANT_ID"))
    ORDER BY "p0"."STARTS_AT" DESC
    FETCH FIRST 1 ROWS ONLY), 0.0) "Price"
FROM "HEHE"."PRODUCT_PRICES" "p"
WHERE (((("p"."VARIANT_ID" = 3) AND ("p"."STARTS_AT" <= :now_1))) AND ((("p"."ENDS_AT" IS NULL) OR ("p"."ENDS_AT" > :now_2))))
GROUP BY "p"."VARIANT_ID"
2025-09-05 14:52:13.371 +07:00 [INF] Executing OkObjectResult, writing value of type 'PHONE_STORE.API.Controllers.ShopProductsController+ShopProductDetail'.
2025-09-05 14:52:13.371 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API) in 9.7974ms
2025-09-05 14:52:13.373 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API)'
2025-09-05 14:52:13.373 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products/galaxy-s24 - 200 null application/json; charset=utf-8 14.9847ms
2025-09-05 14:52:13.402 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 14:52:13.404 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:52:13.405 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 14:52:13.410 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:52:13.415 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:52:13.419 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 14:52:13.422 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 14:52:13.423 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 15.9512ms
2025-09-05 14:52:13.424 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:52:13.424 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 21.9715ms
2025-09-05 14:52:15.628 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 14:52:15.631 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:52:15.632 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 14:52:15.637 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:52:15.640 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:52:15.643 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 14:52:15.645 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 14:52:15.646 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 11.4295ms
2025-09-05 14:52:15.647 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:52:15.648 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 19.2691ms
2025-09-05 14:52:15.684 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 14:52:15.686 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:52:15.686 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 14:52:15.691 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:52:15.695 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:52:15.701 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 14:52:15.703 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 14:52:15.705 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 17.1753ms
2025-09-05 14:52:15.706 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:52:15.707 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 23.0236ms
2025-09-05 14:52:16.997 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/me/addresses - null null
2025-09-05 14:52:17.002 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopMeController.MyAddresses (PHONE_STORE.API)'
2025-09-05 14:52:17.005 +07:00 [INF] Route matched with {action = "MyAddresses", controller = "ShopMe"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.Application.Dtos.AddressDto]]] MyAddresses(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopMeController (PHONE_STORE.API).
2025-09-05 14:52:17.013 +07:00 [INF] Executing ObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ProblemDetails'.
2025-09-05 14:52:17.035 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopMeController.MyAddresses (PHONE_STORE.API) in 26.4326ms
2025-09-05 14:52:17.038 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopMeController.MyAddresses (PHONE_STORE.API)'
2025-09-05 14:52:17.040 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/me/addresses - 401 null application/problem+json; charset=utf-8 42.9636ms
2025-09-05 14:52:21.132 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 14:52:21.135 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:52:21.137 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 14:52:21.146 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:52:21.152 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:52:21.157 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 14:52:21.159 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 14:52:21.160 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 21.4373ms
2025-09-05 14:52:21.161 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:52:21.162 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 30.7198ms
2025-09-05 14:52:23.509 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - null null
2025-09-05 14:52:23.512 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 14:52:23.513 +07:00 [INF] Route matched with {action = "List", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem]]] List(System.String, System.Nullable`1[System.Int64], Int32, Int32, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 14:52:23.520 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:p_0='?' (DbType = Int32), :p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."ID" "Id", "p"."NAME" "Name", "p"."SLUG" "Slug"
FROM "HEHE"."PRODUCTS" "p"
WHERE "p"."IS_ACTIVE" = 1
ORDER BY "p"."CREATED_AT" DESC
OFFSET :p_0 ROWS FETCH NEXT :p_1 ROWS ONLY
2025-09-05 14:52:23.527 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", (
    SELECT "p0"."IMAGE_URL"
    FROM "HEHE"."PRODUCT_IMAGES" "p0"
    WHERE (("p0"."PRODUCT_ID" IS NOT NULL AND "p0"."PRODUCT_ID" IN (3, 2, 1)) AND ("p"."PRODUCT_ID" = "p0"."PRODUCT_ID"))
    ORDER BY "p0"."SORT_ORDER"
    FETCH FIRST 1 ROWS ONLY) "Url"
FROM "HEHE"."PRODUCT_IMAGES" "p"
WHERE "p"."PRODUCT_ID" IS NOT NULL AND "p"."PRODUCT_ID" IN (3, 2, 1)
GROUP BY "p"."PRODUCT_ID"
2025-09-05 14:52:23.531 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", MIN(COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")) "MinPrice"
FROM "HEHE"."PRODUCT_VARIANTS" "p"
INNER JOIN "HEHE"."PRODUCT_PRICES" "p0" ON "p"."ID" = "p0"."VARIANT_ID"
WHERE (("p"."PRODUCT_ID" IN (3, 2, 1)) AND ((("p0"."STARTS_AT" <= :now_1) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))))
GROUP BY "p"."PRODUCT_ID"
2025-09-05 14:52:23.532 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem, PHONE_STORE.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-05 14:52:23.533 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API) in 19.0488ms
2025-09-05 14:52:23.534 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 14:52:23.535 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - 200 null application/json; charset=utf-8 25.2649ms
2025-09-05 14:52:23.565 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 14:52:23.567 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:52:23.569 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 14:52:23.575 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:52:23.579 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:52:23.585 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 14:52:23.586 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 14:52:23.587 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 17.631ms
2025-09-05 14:52:23.588 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:52:23.589 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 24.5421ms
2025-09-05 14:52:26.055 +07:00 [INF] Request starting HTTP/1.1 POST https://localhost:7277/api/auth/logout - application/json; charset=utf-8 null
2025-09-05 14:52:26.059 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.AuthController.Logout (PHONE_STORE.API)'
2025-09-05 14:52:26.063 +07:00 [INF] Route matched with {action = "Logout", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Logout(RefreshRequest, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.AuthController (PHONE_STORE.API).
2025-09-05 14:52:26.075 +07:00 [INF] Logout: revoked RT
2025-09-05 14:52:26.076 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType1`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-05 14:52:26.077 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.AuthController.Logout (PHONE_STORE.API) in 12.3468ms
2025-09-05 14:52:26.077 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.AuthController.Logout (PHONE_STORE.API)'
2025-09-05 14:52:26.078 +07:00 [INF] Request finished HTTP/1.1 POST https://localhost:7277/api/auth/logout - 200 null application/json; charset=utf-8 23.1784ms
2025-09-05 14:52:26.088 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - null null
2025-09-05 14:52:26.090 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 14:52:26.090 +07:00 [INF] Route matched with {action = "List", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem]]] List(System.String, System.Nullable`1[System.Int64], Int32, Int32, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 14:52:26.094 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:p_0='?' (DbType = Int32), :p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."ID" "Id", "p"."NAME" "Name", "p"."SLUG" "Slug"
FROM "HEHE"."PRODUCTS" "p"
WHERE "p"."IS_ACTIVE" = 1
ORDER BY "p"."CREATED_AT" DESC
OFFSET :p_0 ROWS FETCH NEXT :p_1 ROWS ONLY
2025-09-05 14:52:26.097 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", (
    SELECT "p0"."IMAGE_URL"
    FROM "HEHE"."PRODUCT_IMAGES" "p0"
    WHERE (("p0"."PRODUCT_ID" IS NOT NULL AND "p0"."PRODUCT_ID" IN (3, 2, 1)) AND ("p"."PRODUCT_ID" = "p0"."PRODUCT_ID"))
    ORDER BY "p0"."SORT_ORDER"
    FETCH FIRST 1 ROWS ONLY) "Url"
FROM "HEHE"."PRODUCT_IMAGES" "p"
WHERE "p"."PRODUCT_ID" IS NOT NULL AND "p"."PRODUCT_ID" IN (3, 2, 1)
GROUP BY "p"."PRODUCT_ID"
2025-09-05 14:52:26.100 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", MIN(COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")) "MinPrice"
FROM "HEHE"."PRODUCT_VARIANTS" "p"
INNER JOIN "HEHE"."PRODUCT_PRICES" "p0" ON "p"."ID" = "p0"."VARIANT_ID"
WHERE (("p"."PRODUCT_ID" IN (3, 2, 1)) AND ((("p0"."STARTS_AT" <= :now_1) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))))
GROUP BY "p"."PRODUCT_ID"
2025-09-05 14:52:26.101 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem, PHONE_STORE.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-05 14:52:26.102 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API) in 10.713ms
2025-09-05 14:52:26.103 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 14:52:26.104 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - 200 null application/json; charset=utf-8 15.42ms
2025-09-05 14:52:26.135 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 14:52:26.138 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:52:26.139 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 14:52:26.142 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:52:26.146 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:52:26.149 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 14:52:26.150 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 14:52:26.151 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 11.4906ms
2025-09-05 14:52:26.152 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:52:26.152 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 17.3279ms
2025-09-05 14:52:28.401 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - null null
2025-09-05 14:52:28.403 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 14:52:28.404 +07:00 [INF] Route matched with {action = "List", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem]]] List(System.String, System.Nullable`1[System.Int64], Int32, Int32, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 14:52:28.409 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:p_0='?' (DbType = Int32), :p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."ID" "Id", "p"."NAME" "Name", "p"."SLUG" "Slug"
FROM "HEHE"."PRODUCTS" "p"
WHERE "p"."IS_ACTIVE" = 1
ORDER BY "p"."CREATED_AT" DESC
OFFSET :p_0 ROWS FETCH NEXT :p_1 ROWS ONLY
2025-09-05 14:52:28.413 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", (
    SELECT "p0"."IMAGE_URL"
    FROM "HEHE"."PRODUCT_IMAGES" "p0"
    WHERE (("p0"."PRODUCT_ID" IS NOT NULL AND "p0"."PRODUCT_ID" IN (3, 2, 1)) AND ("p"."PRODUCT_ID" = "p0"."PRODUCT_ID"))
    ORDER BY "p0"."SORT_ORDER"
    FETCH FIRST 1 ROWS ONLY) "Url"
FROM "HEHE"."PRODUCT_IMAGES" "p"
WHERE "p"."PRODUCT_ID" IS NOT NULL AND "p"."PRODUCT_ID" IN (3, 2, 1)
GROUP BY "p"."PRODUCT_ID"
2025-09-05 14:52:28.417 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", MIN(COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")) "MinPrice"
FROM "HEHE"."PRODUCT_VARIANTS" "p"
INNER JOIN "HEHE"."PRODUCT_PRICES" "p0" ON "p"."ID" = "p0"."VARIANT_ID"
WHERE (("p"."PRODUCT_ID" IN (3, 2, 1)) AND ((("p0"."STARTS_AT" <= :now_1) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))))
GROUP BY "p"."PRODUCT_ID"
2025-09-05 14:52:28.418 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem, PHONE_STORE.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-05 14:52:28.419 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API) in 13.7038ms
2025-09-05 14:52:28.420 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 14:52:28.421 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - 200 null application/json; charset=utf-8 19.4463ms
2025-09-05 14:52:28.455 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 14:52:28.457 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:52:28.457 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 14:52:28.462 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:52:28.465 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:52:28.470 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 14:52:28.472 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 14:52:28.473 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 14.5359ms
2025-09-05 14:52:28.474 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:52:28.474 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 19.6562ms
2025-09-05 14:52:30.031 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 14:52:30.032 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:52:30.033 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 14:52:30.037 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:52:30.041 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:52:30.046 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 14:52:30.050 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 14:52:30.051 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 17.3548ms
2025-09-05 14:52:30.052 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:52:30.054 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 23.0546ms
2025-09-05 14:52:44.864 +07:00 [INF] Request starting HTTP/1.1 POST https://localhost:7277/api/auth/login - application/json; charset=utf-8 null
2025-09-05 14:52:44.866 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.AuthController.Login (PHONE_STORE.API)'
2025-09-05 14:52:44.867 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(LoginRequest, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.AuthController (PHONE_STORE.API).
2025-09-05 14:52:44.876 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:uname_0='?' (Size = 450), :username_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='0']
SELECT "u"."ID", "u"."CREATED_AT", "u"."EMAIL", "u"."PASSWORD_HASH", "u"."PHONE", "u"."STATUS"
FROM "USER_ACCOUNTS" "u"
WHERE (("u"."EMAIL" = :uname_0) OR ("u"."PHONE" = :username_1))
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:52:45.182 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[:userId_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "r"."CODE"
FROM "USER_ROLES" "u"
INNER JOIN "ROLES" "r" ON "u"."ROLE_ID" = "r"."ID"
WHERE "u"."USER_ID" = :userId_0
2025-09-05 14:52:45.187 +07:00 [INF] Login success [81]
2025-09-05 14:52:45.188 +07:00 [INF] Executing OkObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.AuthResponseDto'.
2025-09-05 14:52:45.189 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.AuthController.Login (PHONE_STORE.API) in 321.6274ms
2025-09-05 14:52:45.190 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.AuthController.Login (PHONE_STORE.API)'
2025-09-05 14:52:45.192 +07:00 [INF] Request finished HTTP/1.1 POST https://localhost:7277/api/auth/login - 200 null application/json; charset=utf-8 327.888ms
2025-09-05 14:52:45.192 +07:00 [INF] Request starting HTTP/1.1 POST https://localhost:7277/api/shop/cart/merge - null 0
2025-09-05 14:52:45.197 +07:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2025-09-05 14:52:45.198 +07:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-09-05 14:52:45.198 +07:00 [INF] Request finished HTTP/1.1 POST https://localhost:7277/api/shop/cart/merge - 401 0 null 5.7019ms
2025-09-05 14:52:45.208 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - null null
2025-09-05 14:52:45.210 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 14:52:45.211 +07:00 [INF] Route matched with {action = "List", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem]]] List(System.String, System.Nullable`1[System.Int64], Int32, Int32, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 14:52:45.217 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:p_0='?' (DbType = Int32), :p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."ID" "Id", "p"."NAME" "Name", "p"."SLUG" "Slug"
FROM "HEHE"."PRODUCTS" "p"
WHERE "p"."IS_ACTIVE" = 1
ORDER BY "p"."CREATED_AT" DESC
OFFSET :p_0 ROWS FETCH NEXT :p_1 ROWS ONLY
2025-09-05 14:52:45.224 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", (
    SELECT "p0"."IMAGE_URL"
    FROM "HEHE"."PRODUCT_IMAGES" "p0"
    WHERE (("p0"."PRODUCT_ID" IS NOT NULL AND "p0"."PRODUCT_ID" IN (3, 2, 1)) AND ("p"."PRODUCT_ID" = "p0"."PRODUCT_ID"))
    ORDER BY "p0"."SORT_ORDER"
    FETCH FIRST 1 ROWS ONLY) "Url"
FROM "HEHE"."PRODUCT_IMAGES" "p"
WHERE "p"."PRODUCT_ID" IS NOT NULL AND "p"."PRODUCT_ID" IN (3, 2, 1)
GROUP BY "p"."PRODUCT_ID"
2025-09-05 14:52:45.230 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", MIN(COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")) "MinPrice"
FROM "HEHE"."PRODUCT_VARIANTS" "p"
INNER JOIN "HEHE"."PRODUCT_PRICES" "p0" ON "p"."ID" = "p0"."VARIANT_ID"
WHERE (("p"."PRODUCT_ID" IN (3, 2, 1)) AND ((("p0"."STARTS_AT" <= :now_1) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))))
GROUP BY "p"."PRODUCT_ID"
2025-09-05 14:52:45.232 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem, PHONE_STORE.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-05 14:52:45.233 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API) in 21.3623ms
2025-09-05 14:52:45.234 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 14:52:45.235 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - 200 null application/json; charset=utf-8 26.4999ms
2025-09-05 14:52:45.270 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 14:52:45.273 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:52:45.274 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 14:52:45.278 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:52:45.281 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:52:45.284 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 14:52:45.287 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 14:52:45.288 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 12.7198ms
2025-09-05 14:52:45.289 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:52:45.290 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 19.5779ms
2025-09-05 14:52:46.898 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 14:52:46.902 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:52:46.904 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 14:52:46.910 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:52:46.914 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:52:46.916 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 14:52:46.918 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 14:52:46.919 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 10.7819ms
2025-09-05 14:52:46.920 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:52:46.921 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 23.0373ms
2025-09-05 14:52:46.950 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 14:52:46.952 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:52:46.952 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 14:52:46.957 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:52:46.961 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:52:46.966 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 14:52:46.968 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 14:52:46.969 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 15.4661ms
2025-09-05 14:52:46.970 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:52:46.971 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 21.4326ms
2025-09-05 14:52:49.831 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - null null
2025-09-05 14:52:49.834 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 14:52:49.835 +07:00 [INF] Route matched with {action = "List", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem]]] List(System.String, System.Nullable`1[System.Int64], Int32, Int32, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 14:52:49.841 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:p_0='?' (DbType = Int32), :p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."ID" "Id", "p"."NAME" "Name", "p"."SLUG" "Slug"
FROM "HEHE"."PRODUCTS" "p"
WHERE "p"."IS_ACTIVE" = 1
ORDER BY "p"."CREATED_AT" DESC
OFFSET :p_0 ROWS FETCH NEXT :p_1 ROWS ONLY
2025-09-05 14:52:49.844 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", (
    SELECT "p0"."IMAGE_URL"
    FROM "HEHE"."PRODUCT_IMAGES" "p0"
    WHERE (("p0"."PRODUCT_ID" IS NOT NULL AND "p0"."PRODUCT_ID" IN (3, 2, 1)) AND ("p"."PRODUCT_ID" = "p0"."PRODUCT_ID"))
    ORDER BY "p0"."SORT_ORDER"
    FETCH FIRST 1 ROWS ONLY) "Url"
FROM "HEHE"."PRODUCT_IMAGES" "p"
WHERE "p"."PRODUCT_ID" IS NOT NULL AND "p"."PRODUCT_ID" IN (3, 2, 1)
GROUP BY "p"."PRODUCT_ID"
2025-09-05 14:52:49.847 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", MIN(COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")) "MinPrice"
FROM "HEHE"."PRODUCT_VARIANTS" "p"
INNER JOIN "HEHE"."PRODUCT_PRICES" "p0" ON "p"."ID" = "p0"."VARIANT_ID"
WHERE (("p"."PRODUCT_ID" IN (3, 2, 1)) AND ((("p0"."STARTS_AT" <= :now_1) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))))
GROUP BY "p"."PRODUCT_ID"
2025-09-05 14:52:49.849 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem, PHONE_STORE.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-05 14:52:49.849 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API) in 12.9769ms
2025-09-05 14:52:49.850 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 14:52:49.851 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - 200 null application/json; charset=utf-8 20.1457ms
2025-09-05 14:52:49.896 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 14:52:49.899 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:52:49.900 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 14:52:49.905 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:52:49.908 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:52:49.910 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 14:52:49.912 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 14:52:49.913 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 10.2562ms
2025-09-05 14:52:49.913 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:52:49.914 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 17.8291ms
2025-09-05 14:52:52.231 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 14:52:52.233 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:52:52.234 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 14:52:52.239 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:52:52.242 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:52:52.245 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 14:52:52.247 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 14:52:52.248 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 11.5941ms
2025-09-05 14:52:52.248 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:52:52.249 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 18.709ms
2025-09-05 14:52:52.281 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 14:52:52.283 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:52:52.283 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 14:52:52.290 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:52:52.294 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 14:52:52.300 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 14:52:52.303 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 14:52:52.306 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 21.1ms
2025-09-05 14:52:52.308 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 14:52:52.310 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 28.8551ms
2025-09-05 14:52:53.437 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/me/addresses - null null
2025-09-05 14:52:53.439 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopMeController.MyAddresses (PHONE_STORE.API)'
2025-09-05 14:52:53.440 +07:00 [INF] Route matched with {action = "MyAddresses", controller = "ShopMe"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.Application.Dtos.AddressDto]]] MyAddresses(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopMeController (PHONE_STORE.API).
2025-09-05 14:52:53.441 +07:00 [INF] Executing ObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ProblemDetails'.
2025-09-05 14:52:53.442 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopMeController.MyAddresses (PHONE_STORE.API) in 1.0419ms
2025-09-05 14:52:53.443 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopMeController.MyAddresses (PHONE_STORE.API)'
2025-09-05 14:52:53.444 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/me/addresses - 401 null application/problem+json; charset=utf-8 6.8444ms
2025-09-05 15:01:54.429 +07:00 [INF] User profile is available. Using 'C:\Users\Administrator\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-09-05 15:01:54.534 +07:00 [INF] Now listening on: http://localhost:5209
2025-09-05 15:01:54.536 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-05 15:01:54.537 +07:00 [INF] Hosting environment: Development
2025-09-05 15:01:54.538 +07:00 [INF] Content root path: C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.API
2025-09-05 15:05:00.596 +07:00 [INF] User profile is available. Using 'C:\Users\Administrator\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-09-05 15:05:00.674 +07:00 [INF] Now listening on: http://localhost:5209
2025-09-05 15:05:00.678 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-05 15:05:00.680 +07:00 [INF] Hosting environment: Development
2025-09-05 15:05:00.681 +07:00 [INF] Content root path: C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.API
2025-09-05 15:12:58.607 +07:00 [INF] User profile is available. Using 'C:\Users\Administrator\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-09-05 15:12:58.973 +07:00 [INF] Now listening on: https://localhost:7277
2025-09-05 15:12:58.976 +07:00 [INF] Now listening on: http://localhost:5209
2025-09-05 15:12:59.104 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-05 15:12:59.105 +07:00 [INF] Hosting environment: Development
2025-09-05 15:12:59.106 +07:00 [INF] Content root path: C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.API
2025-09-05 15:12:59.981 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/swagger/index.html - null null
2025-09-05 15:13:00.484 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/_framework/aspnetcore-browser-refresh.js - null null
2025-09-05 15:13:00.485 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/swagger/index.html - 200 null text/html;charset=utf-8 513.5917ms
2025-09-05 15:13:00.486 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/_vs/browserLink - null null
2025-09-05 15:13:00.507 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/_framework/aspnetcore-browser-refresh.js - 200 13766 application/javascript; charset=utf-8 23.7546ms
2025-09-05 15:13:00.643 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/_vs/browserLink - 200 null text/javascript; charset=UTF-8 156.8075ms
2025-09-05 15:13:00.708 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/swagger/v1/swagger.json - null null
2025-09-05 15:13:00.942 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 234.0673ms
2025-09-05 15:13:39.392 +07:00 [INF] Request starting HTTP/2 POST https://localhost:7277/api/shop/checkout/preview - application/json 20
2025-09-05 15:13:39.404 +07:00 [INF] CORS policy execution failed.
2025-09-05 15:13:39.415 +07:00 [INF] Request origin https://localhost:7277 does not have permission to access the resource.
2025-09-05 15:13:39.478 +07:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2025-09-05 15:13:39.483 +07:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-09-05 15:13:39.484 +07:00 [INF] Request finished HTTP/2 POST https://localhost:7277/api/shop/checkout/preview - 401 0 null 91.6855ms
2025-09-05 15:14:43.343 +07:00 [INF] User profile is available. Using 'C:\Users\Administrator\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-09-05 15:14:43.597 +07:00 [INF] Now listening on: https://localhost:7277
2025-09-05 15:14:43.598 +07:00 [INF] Now listening on: http://localhost:5209
2025-09-05 15:14:43.685 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-05 15:14:43.686 +07:00 [INF] Hosting environment: Development
2025-09-05 15:14:43.687 +07:00 [INF] Content root path: C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.API
2025-09-05 15:14:44.200 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/swagger/index.html - null null
2025-09-05 15:14:44.399 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/swagger/index.html - 200 null text/html;charset=utf-8 205.3943ms
2025-09-05 15:14:44.415 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/_framework/aspnetcore-browser-refresh.js - null null
2025-09-05 15:14:44.416 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/_vs/browserLink - null null
2025-09-05 15:14:44.421 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/_framework/aspnetcore-browser-refresh.js - 200 13766 application/javascript; charset=utf-8 5.8073ms
2025-09-05 15:14:44.463 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/_vs/browserLink - 200 null text/javascript; charset=UTF-8 47.0819ms
2025-09-05 15:14:44.539 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/swagger/v1/swagger.json - null null
2025-09-05 15:14:44.589 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 50.7208ms
2025-09-05 15:16:28.066 +07:00 [INF] User profile is available. Using 'C:\Users\Administrator\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-09-05 15:16:28.288 +07:00 [INF] Now listening on: https://localhost:7277
2025-09-05 15:16:28.289 +07:00 [INF] Now listening on: http://localhost:5209
2025-09-05 15:16:28.373 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-05 15:16:28.375 +07:00 [INF] Hosting environment: Development
2025-09-05 15:16:28.375 +07:00 [INF] Content root path: C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.API
2025-09-05 15:16:29.164 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/swagger/index.html - null null
2025-09-05 15:16:29.402 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/swagger/index.html - 200 null text/html;charset=utf-8 247.7289ms
2025-09-05 15:16:29.414 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/_framework/aspnetcore-browser-refresh.js - null null
2025-09-05 15:16:29.416 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/_vs/browserLink - null null
2025-09-05 15:16:29.421 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/_framework/aspnetcore-browser-refresh.js - 200 13766 application/javascript; charset=utf-8 7.0444ms
2025-09-05 15:16:29.459 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/_vs/browserLink - 200 null text/javascript; charset=UTF-8 43.328ms
2025-09-05 15:16:29.468 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - null null
2025-09-05 15:16:29.513 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 15:16:29.529 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/swagger/v1/swagger.json - null null
2025-09-05 15:16:29.549 +07:00 [INF] Route matched with {action = "List", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem]]] List(System.String, System.Nullable`1[System.Int64], Int32, Int32, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 15:16:29.592 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 62.88ms
2025-09-05 15:16:30.359 +07:00 [WRN] The decimal property 'UnitPrice' on entity type 'CartItem' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 15:16:30.362 +07:00 [WRN] The decimal property 'DiscountTotal' on entity type 'Order' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 15:16:30.363 +07:00 [WRN] The decimal property 'GrandTotal' on entity type 'Order' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 15:16:30.364 +07:00 [WRN] The decimal property 'ShippingFee' on entity type 'Order' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 15:16:30.365 +07:00 [WRN] The decimal property 'Subtotal' on entity type 'Order' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 15:16:30.366 +07:00 [WRN] The decimal property 'TaxTotal' on entity type 'Order' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 15:16:30.367 +07:00 [WRN] The decimal property 'DiscountAmount' on entity type 'OrderItem' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 15:16:30.369 +07:00 [WRN] The decimal property 'TaxAmount' on entity type 'OrderItem' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 15:16:30.370 +07:00 [WRN] The decimal property 'UnitPrice' on entity type 'OrderItem' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 15:16:30.372 +07:00 [WRN] The decimal property 'DecValue' on entity type 'ProductAttributeValue' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 15:16:30.373 +07:00 [WRN] The decimal property 'ListPrice' on entity type 'ProductPrice' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 15:16:30.374 +07:00 [WRN] The decimal property 'SalePrice' on entity type 'ProductPrice' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 15:16:30.376 +07:00 [WRN] The decimal property 'WeightGram' on entity type 'ProductVariant' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 15:16:31.149 +07:00 [INF] Executed DbCommand (106ms) [Parameters=[:p_0='?' (DbType = Int32), :p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."ID" "Id", "p"."NAME" "Name", "p"."SLUG" "Slug"
FROM "HEHE"."PRODUCTS" "p"
WHERE "p"."IS_ACTIVE" = 1
ORDER BY "p"."CREATED_AT" DESC
OFFSET :p_0 ROWS FETCH NEXT :p_1 ROWS ONLY
2025-09-05 15:16:31.287 +07:00 [INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", (
    SELECT "p0"."IMAGE_URL"
    FROM "HEHE"."PRODUCT_IMAGES" "p0"
    WHERE (("p0"."PRODUCT_ID" IS NOT NULL AND "p0"."PRODUCT_ID" IN (3, 2, 1)) AND ("p"."PRODUCT_ID" = "p0"."PRODUCT_ID"))
    ORDER BY "p0"."SORT_ORDER"
    FETCH FIRST 1 ROWS ONLY) "Url"
FROM "HEHE"."PRODUCT_IMAGES" "p"
WHERE "p"."PRODUCT_ID" IS NOT NULL AND "p"."PRODUCT_ID" IN (3, 2, 1)
GROUP BY "p"."PRODUCT_ID"
2025-09-05 15:16:31.333 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", MIN(COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")) "MinPrice"
FROM "HEHE"."PRODUCT_VARIANTS" "p"
INNER JOIN "HEHE"."PRODUCT_PRICES" "p0" ON "p"."ID" = "p0"."VARIANT_ID"
WHERE (("p"."PRODUCT_ID" IN (3, 2, 1)) AND ((("p0"."STARTS_AT" <= :now_1) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))))
GROUP BY "p"."PRODUCT_ID"
2025-09-05 15:16:31.349 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem, PHONE_STORE.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-05 15:16:31.365 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API) in 1797.9627ms
2025-09-05 15:16:31.368 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 15:16:31.376 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - 200 null application/json; charset=utf-8 1909.9929ms
2025-09-05 15:16:31.593 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 15:16:31.598 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 15:16:31.604 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 15:16:31.690 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 15:16:31.762 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 15:16:31.778 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 15:16:31.790 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 15:16:31.800 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 193.403ms
2025-09-05 15:16:31.803 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 15:16:31.805 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 211.7806ms
2025-09-05 15:16:35.086 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products/galaxy-s24 - null null
2025-09-05 15:16:35.092 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API)'
2025-09-05 15:16:35.099 +07:00 [INF] Route matched with {action = "Details", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductDetail]] Details(System.String, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 15:16:35.211 +07:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-09-05 15:16:35.260 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:slug_0='?' (Size = 220)], CommandType='"Text"', CommandTimeout='0']
SELECT "p2"."ID", "p2"."BRAND_ID", "p2"."CREATED_AT", "p2"."DEFAULT_CATEGORY_ID", "p2"."DESCRIPTION", "p2"."IS_ACTIVE", "p2"."NAME", "p2"."SLUG", "p2"."SPEC_JSON", "p0"."ID", "p0"."BARCODE", "p0"."COLOR", "p0"."IS_ACTIVE", "p0"."PRODUCT_ID", "p0"."SKU", "p0"."STORAGE_GB", "p0"."WEIGHT_GRAM", "p1"."ID", "p1"."ALT_TEXT", "p1"."IMAGE_URL", "p1"."IS_PRIMARY", "p1"."PRODUCT_ID", "p1"."SORT_ORDER", "p1"."VARIANT_ID"
FROM (
    SELECT "p"."ID", "p"."BRAND_ID", "p"."CREATED_AT", "p"."DEFAULT_CATEGORY_ID", "p"."DESCRIPTION", "p"."IS_ACTIVE", "p"."NAME", "p"."SLUG", "p"."SPEC_JSON"
    FROM "HEHE"."PRODUCTS" "p"
    WHERE (("p"."SLUG" = :slug_0) AND ("p"."IS_ACTIVE" = 1))
    FETCH FIRST 1 ROWS ONLY
) "p2"
LEFT JOIN "HEHE"."PRODUCT_VARIANTS" "p0" ON "p2"."ID" = "p0"."PRODUCT_ID"
LEFT JOIN "HEHE"."PRODUCT_IMAGES" "p1" ON "p2"."ID" = "p1"."PRODUCT_ID"
ORDER BY "p2"."ID", "p0"."ID"
2025-09-05 15:16:35.354 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."VARIANT_ID" "VariantId", COALESCE((
    SELECT COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")
    FROM "HEHE"."PRODUCT_PRICES" "p0"
    WHERE (((((("p0"."VARIANT_ID" = 3) AND ("p0"."STARTS_AT" <= :now_1))) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))) AND ("p"."VARIANT_ID" = "p0"."VARIANT_ID"))
    ORDER BY "p0"."STARTS_AT" DESC
    FETCH FIRST 1 ROWS ONLY), 0.0) "Price"
FROM "HEHE"."PRODUCT_PRICES" "p"
WHERE (((("p"."VARIANT_ID" = 3) AND ("p"."STARTS_AT" <= :now_1))) AND ((("p"."ENDS_AT" IS NULL) OR ("p"."ENDS_AT" > :now_2))))
GROUP BY "p"."VARIANT_ID"
2025-09-05 15:16:35.364 +07:00 [INF] Executing OkObjectResult, writing value of type 'PHONE_STORE.API.Controllers.ShopProductsController+ShopProductDetail'.
2025-09-05 15:16:35.379 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API) in 276.8792ms
2025-09-05 15:16:35.381 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API)'
2025-09-05 15:16:35.384 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products/galaxy-s24 - 200 null application/json; charset=utf-8 298.007ms
2025-09-05 15:16:35.439 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 15:16:35.442 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 15:16:35.443 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 15:16:35.457 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 15:16:35.462 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 15:16:35.471 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 15:16:35.474 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 15:16:35.475 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 30.1776ms
2025-09-05 15:16:35.477 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 15:16:35.479 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 40.8728ms
2025-09-05 15:16:36.508 +07:00 [INF] Request starting HTTP/1.1 POST https://localhost:7277/api/shop/cart/items - application/json; charset=utf-8 null
2025-09-05 15:16:36.511 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Add (PHONE_STORE.API)'
2025-09-05 15:16:36.514 +07:00 [INF] Route matched with {action = "Add", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Add(PHONE_STORE.Application.Dtos.CartItemUpsertDto, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 15:16:36.554 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 15:16:36.565 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:id_0='?' (DbType = Int64), :dto_VariantId_1='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE"
FROM "HEHE"."CART_ITEMS" "c"
WHERE (("c"."CART_ID" = :id_0) AND ("c"."VARIANT_ID" = :dto_VariantId_1))
FETCH FIRST 1 ROWS ONLY
2025-09-05 15:16:36.647 +07:00 [INF] Executed DbCommand (58ms) [Parameters=[:variantId_0='?' (DbType = Int64), :now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT COALESCE("p"."SALE_PRICE", "p"."LIST_PRICE")
FROM "HEHE"."PRODUCT_PRICES" "p"
WHERE (((("p"."VARIANT_ID" = :variantId_0) AND ("p"."STARTS_AT" <= :now_1))) AND ((("p"."ENDS_AT" IS NULL) OR ("p"."ENDS_AT" > :now_2))))
ORDER BY "p"."STARTS_AT" DESC
FETCH FIRST 1 ROWS ONLY
2025-09-05 15:16:36.869 +07:00 [INF] Executed DbCommand (9ms) [Parameters=[:p0='?' (DbType = Int64), :p1='?' (DbType = Int64), :p2='?' (DbType = DateTime), :p3='?' (Size = 2000), :p4='?' (DbType = Int32), :p5='?' (DbType = Decimal)], CommandType='"Text"', CommandTimeout='0']
DECLARE


BEGIN

INSERT INTO "HEHE"."CART_ITEMS" ("CART_ID", "VARIANT_ID", "ADDED_AT", "CURRENCY", "QUANTITY", "UNIT_PRICE")
VALUES (:p0, :p1, :p2, :p3, :p4, :p5);

END;
2025-09-05 15:16:36.926 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 15:16:36.931 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 15:16:36.936 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 15:16:36.942 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 15:16:36.944 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Add (PHONE_STORE.API) in 428.6414ms
2025-09-05 15:16:36.945 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Add (PHONE_STORE.API)'
2025-09-05 15:16:36.946 +07:00 [INF] Request finished HTTP/1.1 POST https://localhost:7277/api/shop/cart/items - 200 null application/json; charset=utf-8 438.3485ms
2025-09-05 15:16:36.955 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products/galaxy-s24 - null null
2025-09-05 15:16:36.956 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API)'
2025-09-05 15:16:36.957 +07:00 [INF] Route matched with {action = "Details", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductDetail]] Details(System.String, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 15:16:36.961 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:slug_0='?' (Size = 220)], CommandType='"Text"', CommandTimeout='0']
SELECT "p2"."ID", "p2"."BRAND_ID", "p2"."CREATED_AT", "p2"."DEFAULT_CATEGORY_ID", "p2"."DESCRIPTION", "p2"."IS_ACTIVE", "p2"."NAME", "p2"."SLUG", "p2"."SPEC_JSON", "p0"."ID", "p0"."BARCODE", "p0"."COLOR", "p0"."IS_ACTIVE", "p0"."PRODUCT_ID", "p0"."SKU", "p0"."STORAGE_GB", "p0"."WEIGHT_GRAM", "p1"."ID", "p1"."ALT_TEXT", "p1"."IMAGE_URL", "p1"."IS_PRIMARY", "p1"."PRODUCT_ID", "p1"."SORT_ORDER", "p1"."VARIANT_ID"
FROM (
    SELECT "p"."ID", "p"."BRAND_ID", "p"."CREATED_AT", "p"."DEFAULT_CATEGORY_ID", "p"."DESCRIPTION", "p"."IS_ACTIVE", "p"."NAME", "p"."SLUG", "p"."SPEC_JSON"
    FROM "HEHE"."PRODUCTS" "p"
    WHERE (("p"."SLUG" = :slug_0) AND ("p"."IS_ACTIVE" = 1))
    FETCH FIRST 1 ROWS ONLY
) "p2"
LEFT JOIN "HEHE"."PRODUCT_VARIANTS" "p0" ON "p2"."ID" = "p0"."PRODUCT_ID"
LEFT JOIN "HEHE"."PRODUCT_IMAGES" "p1" ON "p2"."ID" = "p1"."PRODUCT_ID"
ORDER BY "p2"."ID", "p0"."ID"
2025-09-05 15:16:36.965 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."VARIANT_ID" "VariantId", COALESCE((
    SELECT COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")
    FROM "HEHE"."PRODUCT_PRICES" "p0"
    WHERE (((((("p0"."VARIANT_ID" = 3) AND ("p0"."STARTS_AT" <= :now_1))) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))) AND ("p"."VARIANT_ID" = "p0"."VARIANT_ID"))
    ORDER BY "p0"."STARTS_AT" DESC
    FETCH FIRST 1 ROWS ONLY), 0.0) "Price"
FROM "HEHE"."PRODUCT_PRICES" "p"
WHERE (((("p"."VARIANT_ID" = 3) AND ("p"."STARTS_AT" <= :now_1))) AND ((("p"."ENDS_AT" IS NULL) OR ("p"."ENDS_AT" > :now_2))))
GROUP BY "p"."VARIANT_ID"
2025-09-05 15:16:36.967 +07:00 [INF] Executing OkObjectResult, writing value of type 'PHONE_STORE.API.Controllers.ShopProductsController+ShopProductDetail'.
2025-09-05 15:16:36.969 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API) in 10.5548ms
2025-09-05 15:16:36.969 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API)'
2025-09-05 15:16:36.970 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products/galaxy-s24 - 200 null application/json; charset=utf-8 15.2094ms
2025-09-05 15:16:36.997 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 15:16:36.999 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 15:16:37.002 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 15:16:37.008 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 15:16:37.013 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 15:16:37.020 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 15:16:37.023 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 15:16:37.024 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 20.4391ms
2025-09-05 15:16:37.025 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 15:16:37.027 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 30.1699ms
2025-09-05 15:16:40.452 +07:00 [INF] Request starting HTTP/1.1 POST https://localhost:7277/api/auth/logout - application/json; charset=utf-8 null
2025-09-05 15:16:40.454 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.AuthController.Logout (PHONE_STORE.API)'
2025-09-05 15:16:40.460 +07:00 [INF] Route matched with {action = "Logout", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Logout(RefreshRequest, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.AuthController (PHONE_STORE.API).
2025-09-05 15:16:40.727 +07:00 [INF] Logout: revoked RT
2025-09-05 15:16:40.731 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType1`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-05 15:16:40.734 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.AuthController.Logout (PHONE_STORE.API) in 273.5619ms
2025-09-05 15:16:40.735 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.AuthController.Logout (PHONE_STORE.API)'
2025-09-05 15:16:40.736 +07:00 [INF] Request finished HTTP/1.1 POST https://localhost:7277/api/auth/logout - 200 null application/json; charset=utf-8 284.0049ms
2025-09-05 15:16:40.751 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - null null
2025-09-05 15:16:40.753 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 15:16:40.753 +07:00 [INF] Route matched with {action = "List", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem]]] List(System.String, System.Nullable`1[System.Int64], Int32, Int32, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 15:16:40.758 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:p_0='?' (DbType = Int32), :p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."ID" "Id", "p"."NAME" "Name", "p"."SLUG" "Slug"
FROM "HEHE"."PRODUCTS" "p"
WHERE "p"."IS_ACTIVE" = 1
ORDER BY "p"."CREATED_AT" DESC
OFFSET :p_0 ROWS FETCH NEXT :p_1 ROWS ONLY
2025-09-05 15:16:40.761 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", (
    SELECT "p0"."IMAGE_URL"
    FROM "HEHE"."PRODUCT_IMAGES" "p0"
    WHERE (("p0"."PRODUCT_ID" IS NOT NULL AND "p0"."PRODUCT_ID" IN (3, 2, 1)) AND ("p"."PRODUCT_ID" = "p0"."PRODUCT_ID"))
    ORDER BY "p0"."SORT_ORDER"
    FETCH FIRST 1 ROWS ONLY) "Url"
FROM "HEHE"."PRODUCT_IMAGES" "p"
WHERE "p"."PRODUCT_ID" IS NOT NULL AND "p"."PRODUCT_ID" IN (3, 2, 1)
GROUP BY "p"."PRODUCT_ID"
2025-09-05 15:16:40.765 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", MIN(COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")) "MinPrice"
FROM "HEHE"."PRODUCT_VARIANTS" "p"
INNER JOIN "HEHE"."PRODUCT_PRICES" "p0" ON "p"."ID" = "p0"."VARIANT_ID"
WHERE (("p"."PRODUCT_ID" IN (3, 2, 1)) AND ((("p0"."STARTS_AT" <= :now_1) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))))
GROUP BY "p"."PRODUCT_ID"
2025-09-05 15:16:40.768 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem, PHONE_STORE.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-05 15:16:40.769 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API) in 14.4083ms
2025-09-05 15:16:40.769 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 15:16:40.770 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - 200 null application/json; charset=utf-8 18.8601ms
2025-09-05 15:16:40.798 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 15:16:40.802 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 15:16:40.804 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 15:16:40.812 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 15:16:40.819 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 15:16:40.822 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 15:16:40.823 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 15:16:40.824 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 17.7262ms
2025-09-05 15:16:40.825 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 15:16:40.826 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 28.5359ms
2025-09-05 15:16:42.360 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 15:16:42.362 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 15:16:42.363 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 15:16:42.374 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 15:16:42.385 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 15:16:42.392 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 15:16:42.395 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 15:16:42.397 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 33.6751ms
2025-09-05 15:16:42.398 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 15:16:42.402 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 41.5553ms
2025-09-05 15:16:47.622 +07:00 [INF] Request starting HTTP/1.1 POST https://localhost:7277/api/auth/login - application/json; charset=utf-8 null
2025-09-05 15:16:47.633 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.AuthController.Login (PHONE_STORE.API)'
2025-09-05 15:16:47.637 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(LoginRequest, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.AuthController (PHONE_STORE.API).
2025-09-05 15:16:47.707 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:uname_0='?' (Size = 450), :username_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='0']
SELECT "u"."ID", "u"."CREATED_AT", "u"."EMAIL", "u"."PASSWORD_HASH", "u"."PHONE", "u"."STATUS"
FROM "USER_ACCOUNTS" "u"
WHERE (("u"."EMAIL" = :uname_0) OR ("u"."PHONE" = :username_1))
FETCH FIRST 1 ROWS ONLY
2025-09-05 15:16:48.304 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[:userId_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "r"."CODE"
FROM "USER_ROLES" "u"
INNER JOIN "ROLES" "r" ON "u"."ROLE_ID" = "r"."ID"
WHERE "u"."USER_ID" = :userId_0
2025-09-05 15:16:48.362 +07:00 [INF] Login success [21]
2025-09-05 15:16:48.369 +07:00 [INF] Executing OkObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.AuthResponseDto'.
2025-09-05 15:16:48.373 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.AuthController.Login (PHONE_STORE.API) in 735.2392ms
2025-09-05 15:16:48.374 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.AuthController.Login (PHONE_STORE.API)'
2025-09-05 15:16:48.376 +07:00 [INF] Request finished HTTP/1.1 POST https://localhost:7277/api/auth/login - 200 null application/json; charset=utf-8 753.6703ms
2025-09-05 15:16:48.397 +07:00 [INF] Request starting HTTP/1.1 POST https://localhost:7277/api/shop/cart/merge - null 0
2025-09-05 15:16:48.405 +07:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2025-09-05 15:16:48.410 +07:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-09-05 15:16:48.410 +07:00 [INF] Request finished HTTP/1.1 POST https://localhost:7277/api/shop/cart/merge - 401 0 null 13.0671ms
2025-09-05 15:16:48.422 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - null null
2025-09-05 15:16:48.472 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 15:16:48.474 +07:00 [INF] Route matched with {action = "List", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem]]] List(System.String, System.Nullable`1[System.Int64], Int32, Int32, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 15:16:48.484 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[:p_0='?' (DbType = Int32), :p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."ID" "Id", "p"."NAME" "Name", "p"."SLUG" "Slug"
FROM "HEHE"."PRODUCTS" "p"
WHERE "p"."IS_ACTIVE" = 1
ORDER BY "p"."CREATED_AT" DESC
OFFSET :p_0 ROWS FETCH NEXT :p_1 ROWS ONLY
2025-09-05 15:16:48.490 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", (
    SELECT "p0"."IMAGE_URL"
    FROM "HEHE"."PRODUCT_IMAGES" "p0"
    WHERE (("p0"."PRODUCT_ID" IS NOT NULL AND "p0"."PRODUCT_ID" IN (3, 2, 1)) AND ("p"."PRODUCT_ID" = "p0"."PRODUCT_ID"))
    ORDER BY "p0"."SORT_ORDER"
    FETCH FIRST 1 ROWS ONLY) "Url"
FROM "HEHE"."PRODUCT_IMAGES" "p"
WHERE "p"."PRODUCT_ID" IS NOT NULL AND "p"."PRODUCT_ID" IN (3, 2, 1)
GROUP BY "p"."PRODUCT_ID"
2025-09-05 15:16:48.495 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", MIN(COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")) "MinPrice"
FROM "HEHE"."PRODUCT_VARIANTS" "p"
INNER JOIN "HEHE"."PRODUCT_PRICES" "p0" ON "p"."ID" = "p0"."VARIANT_ID"
WHERE (("p"."PRODUCT_ID" IN (3, 2, 1)) AND ((("p0"."STARTS_AT" <= :now_1) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))))
GROUP BY "p"."PRODUCT_ID"
2025-09-05 15:16:48.497 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem, PHONE_STORE.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-05 15:16:48.498 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API) in 21.1095ms
2025-09-05 15:16:48.499 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 15:16:48.500 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - 200 null application/json; charset=utf-8 78.1451ms
2025-09-05 15:16:48.527 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 15:16:48.530 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 15:16:48.534 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 15:16:48.544 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 15:16:48.550 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 15:16:48.553 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 15:16:48.555 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 15:16:48.557 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 20.1786ms
2025-09-05 15:16:48.559 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 15:16:48.560 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 33.1197ms
2025-09-05 15:16:52.143 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 15:16:52.148 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 15:16:52.149 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 15:16:52.155 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 15:16:52.159 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 15:16:52.162 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 15:16:52.164 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 15:16:52.166 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 15.361ms
2025-09-05 15:16:52.167 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 15:16:52.167 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 24.1779ms
2025-09-05 15:16:52.201 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 15:16:52.206 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 15:16:52.207 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 15:16:52.213 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 15:16:52.220 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 15:16:52.224 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 15:16:52.227 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 15:16:52.229 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 20.2563ms
2025-09-05 15:16:52.230 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 15:16:52.231 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 30.3055ms
2025-09-05 15:16:53.342 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/me/addresses - null null
2025-09-05 15:16:53.347 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopMeController.MyAddresses (PHONE_STORE.API)'
2025-09-05 15:16:53.352 +07:00 [INF] Route matched with {action = "MyAddresses", controller = "ShopMe"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.Application.Dtos.AddressDto]]] MyAddresses(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopMeController (PHONE_STORE.API).
2025-09-05 15:16:53.358 +07:00 [INF] Executing ObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ProblemDetails'.
2025-09-05 15:16:53.376 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopMeController.MyAddresses (PHONE_STORE.API) in 21.8927ms
2025-09-05 15:16:53.377 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopMeController.MyAddresses (PHONE_STORE.API)'
2025-09-05 15:16:53.378 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/me/addresses - 401 null application/problem+json; charset=utf-8 35.5978ms
2025-09-05 15:16:54.478 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 15:16:54.482 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 15:16:54.483 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 15:16:54.486 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 15:16:54.490 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 15:16:54.493 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 15:16:54.495 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 15:16:54.495 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 11.8137ms
2025-09-05 15:16:54.496 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 15:16:54.497 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 18.8638ms
2025-09-05 15:16:56.873 +07:00 [INF] Request starting HTTP/1.1 POST https://localhost:7277/api/auth/logout - application/json; charset=utf-8 null
2025-09-05 15:16:56.875 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.AuthController.Logout (PHONE_STORE.API)'
2025-09-05 15:16:56.875 +07:00 [INF] Route matched with {action = "Logout", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Logout(RefreshRequest, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.AuthController (PHONE_STORE.API).
2025-09-05 15:16:56.881 +07:00 [INF] Logout: revoked RT
2025-09-05 15:16:56.882 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType1`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-05 15:16:56.883 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.AuthController.Logout (PHONE_STORE.API) in 6.514ms
2025-09-05 15:16:56.884 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.AuthController.Logout (PHONE_STORE.API)'
2025-09-05 15:16:56.884 +07:00 [INF] Request finished HTTP/1.1 POST https://localhost:7277/api/auth/logout - 200 null application/json; charset=utf-8 11.3775ms
2025-09-05 15:16:56.894 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - null null
2025-09-05 15:16:56.895 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 15:16:56.895 +07:00 [INF] Route matched with {action = "List", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem]]] List(System.String, System.Nullable`1[System.Int64], Int32, Int32, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 15:16:56.901 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:p_0='?' (DbType = Int32), :p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."ID" "Id", "p"."NAME" "Name", "p"."SLUG" "Slug"
FROM "HEHE"."PRODUCTS" "p"
WHERE "p"."IS_ACTIVE" = 1
ORDER BY "p"."CREATED_AT" DESC
OFFSET :p_0 ROWS FETCH NEXT :p_1 ROWS ONLY
2025-09-05 15:16:56.904 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", (
    SELECT "p0"."IMAGE_URL"
    FROM "HEHE"."PRODUCT_IMAGES" "p0"
    WHERE (("p0"."PRODUCT_ID" IS NOT NULL AND "p0"."PRODUCT_ID" IN (3, 2, 1)) AND ("p"."PRODUCT_ID" = "p0"."PRODUCT_ID"))
    ORDER BY "p0"."SORT_ORDER"
    FETCH FIRST 1 ROWS ONLY) "Url"
FROM "HEHE"."PRODUCT_IMAGES" "p"
WHERE "p"."PRODUCT_ID" IS NOT NULL AND "p"."PRODUCT_ID" IN (3, 2, 1)
GROUP BY "p"."PRODUCT_ID"
2025-09-05 15:16:56.907 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", MIN(COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")) "MinPrice"
FROM "HEHE"."PRODUCT_VARIANTS" "p"
INNER JOIN "HEHE"."PRODUCT_PRICES" "p0" ON "p"."ID" = "p0"."VARIANT_ID"
WHERE (("p"."PRODUCT_ID" IN (3, 2, 1)) AND ((("p0"."STARTS_AT" <= :now_1) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))))
GROUP BY "p"."PRODUCT_ID"
2025-09-05 15:16:56.909 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem, PHONE_STORE.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-05 15:16:56.910 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API) in 13.354ms
2025-09-05 15:16:56.911 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 15:16:56.911 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - 200 null application/json; charset=utf-8 17.726ms
2025-09-05 15:16:56.933 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 15:16:56.936 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 15:16:56.938 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 15:16:56.943 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 15:16:56.946 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 15:16:56.951 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 15:16:56.954 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 15:16:56.955 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 15.3783ms
2025-09-05 15:16:56.956 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 15:16:56.957 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 24.7701ms
2025-09-05 15:16:58.647 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 15:16:58.650 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 15:16:58.651 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 15:16:58.655 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 15:16:58.661 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 15:16:58.669 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 15:16:58.675 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 15:16:58.676 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 24.4234ms
2025-09-05 15:16:58.677 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 15:16:58.678 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 30.9789ms
2025-09-05 15:17:03.326 +07:00 [INF] Request starting HTTP/1.1 POST https://localhost:7277/api/auth/login - application/json; charset=utf-8 null
2025-09-05 15:17:03.328 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.AuthController.Login (PHONE_STORE.API)'
2025-09-05 15:17:03.328 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(LoginRequest, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.AuthController (PHONE_STORE.API).
2025-09-05 15:17:03.336 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:uname_0='?' (Size = 450), :username_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='0']
SELECT "u"."ID", "u"."CREATED_AT", "u"."EMAIL", "u"."PASSWORD_HASH", "u"."PHONE", "u"."STATUS"
FROM "USER_ACCOUNTS" "u"
WHERE (("u"."EMAIL" = :uname_0) OR ("u"."PHONE" = :username_1))
FETCH FIRST 1 ROWS ONLY
2025-09-05 15:17:03.593 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:userId_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "r"."CODE"
FROM "USER_ROLES" "u"
INNER JOIN "ROLES" "r" ON "u"."ROLE_ID" = "r"."ID"
WHERE "u"."USER_ID" = :userId_0
2025-09-05 15:17:03.598 +07:00 [INF] Login success [81]
2025-09-05 15:17:03.600 +07:00 [INF] Executing OkObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.AuthResponseDto'.
2025-09-05 15:17:03.601 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.AuthController.Login (PHONE_STORE.API) in 271.4185ms
2025-09-05 15:17:03.604 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.AuthController.Login (PHONE_STORE.API)'
2025-09-05 15:17:03.604 +07:00 [INF] Request finished HTTP/1.1 POST https://localhost:7277/api/auth/login - 200 null application/json; charset=utf-8 278.6476ms
2025-09-05 15:17:03.605 +07:00 [INF] Request starting HTTP/1.1 POST https://localhost:7277/api/shop/cart/merge - null 0
2025-09-05 15:17:03.611 +07:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2025-09-05 15:17:03.613 +07:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-09-05 15:17:03.614 +07:00 [INF] Request finished HTTP/1.1 POST https://localhost:7277/api/shop/cart/merge - 401 0 null 8.3515ms
2025-09-05 15:17:03.624 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - null null
2025-09-05 15:17:03.626 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 15:17:03.626 +07:00 [INF] Route matched with {action = "List", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem]]] List(System.String, System.Nullable`1[System.Int64], Int32, Int32, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 15:17:03.631 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:p_0='?' (DbType = Int32), :p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."ID" "Id", "p"."NAME" "Name", "p"."SLUG" "Slug"
FROM "HEHE"."PRODUCTS" "p"
WHERE "p"."IS_ACTIVE" = 1
ORDER BY "p"."CREATED_AT" DESC
OFFSET :p_0 ROWS FETCH NEXT :p_1 ROWS ONLY
2025-09-05 15:17:03.635 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", (
    SELECT "p0"."IMAGE_URL"
    FROM "HEHE"."PRODUCT_IMAGES" "p0"
    WHERE (("p0"."PRODUCT_ID" IS NOT NULL AND "p0"."PRODUCT_ID" IN (3, 2, 1)) AND ("p"."PRODUCT_ID" = "p0"."PRODUCT_ID"))
    ORDER BY "p0"."SORT_ORDER"
    FETCH FIRST 1 ROWS ONLY) "Url"
FROM "HEHE"."PRODUCT_IMAGES" "p"
WHERE "p"."PRODUCT_ID" IS NOT NULL AND "p"."PRODUCT_ID" IN (3, 2, 1)
GROUP BY "p"."PRODUCT_ID"
2025-09-05 15:17:03.639 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", MIN(COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")) "MinPrice"
FROM "HEHE"."PRODUCT_VARIANTS" "p"
INNER JOIN "HEHE"."PRODUCT_PRICES" "p0" ON "p"."ID" = "p0"."VARIANT_ID"
WHERE (("p"."PRODUCT_ID" IN (3, 2, 1)) AND ((("p0"."STARTS_AT" <= :now_1) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))))
GROUP BY "p"."PRODUCT_ID"
2025-09-05 15:17:03.641 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem, PHONE_STORE.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-05 15:17:03.642 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API) in 14.066ms
2025-09-05 15:17:03.643 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 15:17:03.643 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - 200 null application/json; charset=utf-8 19.3149ms
2025-09-05 15:17:03.673 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 15:17:03.676 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 15:17:03.678 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 15:17:03.683 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 15:17:03.687 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 15:17:03.692 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 15:17:03.695 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 15:17:03.697 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 17.7242ms
2025-09-05 15:17:03.699 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 15:17:03.700 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 26.44ms
2025-09-05 15:17:05.247 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 15:17:05.251 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 15:17:05.252 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 15:17:05.256 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 15:17:05.259 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 15:17:05.261 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 15:17:05.266 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 15:17:05.267 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 14.1204ms
2025-09-05 15:17:05.268 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 15:17:05.269 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 21.4163ms
2025-09-05 15:17:05.295 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 15:17:05.302 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 15:17:05.303 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 15:17:05.308 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 15:17:05.312 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 15:17:05.320 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 15:17:05.323 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 15:17:05.324 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 20.1515ms
2025-09-05 15:17:05.326 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 15:17:05.328 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 33.1516ms
2025-09-05 15:17:06.599 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 15:17:06.601 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 15:17:06.603 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 15:17:06.608 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 15:17:06.611 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 15:17:06.615 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 15:17:06.616 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 15:17:06.617 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 12.3938ms
2025-09-05 15:17:06.618 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 15:17:06.619 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 20.1782ms
2025-09-05 15:17:06.641 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 15:17:06.645 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 15:17:06.646 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 15:17:06.652 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 15:17:06.655 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 15:17:06.659 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 15:17:06.661 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 15:17:06.664 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 15.4691ms
2025-09-05 15:17:06.665 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 15:17:06.666 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 25.4635ms
2025-09-05 16:25:58.233 +07:00 [INF] User profile is available. Using 'C:\Users\Administrator\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-09-05 16:25:58.490 +07:00 [INF] Now listening on: https://localhost:7277
2025-09-05 16:25:58.491 +07:00 [INF] Now listening on: http://localhost:5209
2025-09-05 16:25:58.609 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-05 16:25:58.610 +07:00 [INF] Hosting environment: Development
2025-09-05 16:25:58.611 +07:00 [INF] Content root path: C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.API
2025-09-05 16:25:59.198 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/swagger/index.html - null null
2025-09-05 16:25:59.778 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/swagger/index.html - 200 null text/html;charset=utf-8 591.2564ms
2025-09-05 16:25:59.955 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/_framework/aspnetcore-browser-refresh.js - null null
2025-09-05 16:25:59.977 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/_framework/aspnetcore-browser-refresh.js - 200 13766 application/javascript; charset=utf-8 21.8601ms
2025-09-05 16:26:00.008 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/_vs/browserLink - null null
2025-09-05 16:26:00.014 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - null null
2025-09-05 16:26:00.112 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/_vs/browserLink - 200 null text/javascript; charset=UTF-8 104.8121ms
2025-09-05 16:26:00.117 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 16:26:00.160 +07:00 [INF] Route matched with {action = "List", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem]]] List(System.String, System.Nullable`1[System.Int64], Int32, Int32, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 16:26:00.492 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/swagger/v1/swagger.json - null null
2025-09-05 16:26:00.550 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 58.6828ms
2025-09-05 16:26:01.048 +07:00 [WRN] The decimal property 'UnitPrice' on entity type 'CartItem' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 16:26:01.049 +07:00 [WRN] The decimal property 'DecValue' on entity type 'ProductAttributeValue' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 16:26:01.051 +07:00 [WRN] The decimal property 'WeightGram' on entity type 'ProductVariant' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 16:26:01.767 +07:00 [INF] Executed DbCommand (109ms) [Parameters=[:p_0='?' (DbType = Int32), :p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."ID" "Id", "p"."NAME" "Name", "p"."SLUG" "Slug"
FROM "HEHE"."PRODUCTS" "p"
WHERE "p"."IS_ACTIVE" = 1
ORDER BY "p"."CREATED_AT" DESC
OFFSET :p_0 ROWS FETCH NEXT :p_1 ROWS ONLY
2025-09-05 16:26:01.899 +07:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", (
    SELECT "p0"."IMAGE_URL"
    FROM "HEHE"."PRODUCT_IMAGES" "p0"
    WHERE (("p0"."PRODUCT_ID" IS NOT NULL AND "p0"."PRODUCT_ID" IN (3, 2, 1)) AND ("p"."PRODUCT_ID" = "p0"."PRODUCT_ID"))
    ORDER BY "p0"."SORT_ORDER"
    FETCH FIRST 1 ROWS ONLY) "Url"
FROM "HEHE"."PRODUCT_IMAGES" "p"
WHERE "p"."PRODUCT_ID" IS NOT NULL AND "p"."PRODUCT_ID" IN (3, 2, 1)
GROUP BY "p"."PRODUCT_ID"
2025-09-05 16:26:01.940 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", MIN(COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")) "MinPrice"
FROM "HEHE"."PRODUCT_VARIANTS" "p"
INNER JOIN "HEHE"."PRODUCT_PRICES" "p0" ON "p"."ID" = "p0"."VARIANT_ID"
WHERE (("p"."PRODUCT_ID" IN (3, 2, 1)) AND ((("p0"."STARTS_AT" <= :now_1) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))))
GROUP BY "p"."PRODUCT_ID"
2025-09-05 16:26:01.955 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem, PHONE_STORE.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-05 16:26:01.972 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API) in 1807.0381ms
2025-09-05 16:26:01.974 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 16:26:01.981 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - 200 null application/json; charset=utf-8 1968.5859ms
2025-09-05 16:26:02.163 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 16:26:02.169 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:26:02.175 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 16:26:02.256 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:26:02.417 +07:00 [INF] Executed DbCommand (12ms) [Parameters=[:p0='?' (DbType = DateTime), :p1='?' (Size = 2000), :p2='?' (DbType = Int64), :p3='?' (Size = 64), :p4='?' (Size = 2000), :p5='?' (DbType = DateTime), :cur0='?' (Direction = Output) (DbType = Object)], CommandType='"Text"', CommandTimeout='0']
DECLARE

TYPE "rCARTS_0" IS RECORD
(
"ID" NUMBER(19)
);
TYPE "tCARTS_0" IS TABLE OF "rCARTS_0";
"lCARTS_0" "tCARTS_0";

BEGIN

"lCARTS_0" := "tCARTS_0"();
"lCARTS_0".extend(1);
INSERT INTO "HEHE"."CARTS" ("CREATED_AT", "CURRENCY", "CUSTOMER_ID", "SESSION_TOKEN", "STATUS", "UPDATED_AT")
VALUES (:p0, :p1, :p2, :p3, :p4, :p5)
RETURNING "ID" INTO "lCARTS_0"(1)."ID";
OPEN :cur0 FOR SELECT "lCARTS_0"(1)."ID" FROM DUAL;

END;
2025-09-05 16:26:02.473 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:26:02.490 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 16:26:02.497 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 16:26:02.505 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 326.0689ms
2025-09-05 16:26:02.505 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:26:02.506 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 343.2613ms
2025-09-05 16:26:06.155 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 16:26:06.159 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:26:06.160 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 16:26:06.185 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:26:06.192 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:26:06.197 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 16:26:06.199 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 16:26:06.200 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 38.7276ms
2025-09-05 16:26:06.201 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:26:06.203 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 48.1283ms
2025-09-05 16:26:19.819 +07:00 [INF] Request starting HTTP/1.1 POST https://localhost:7277/api/auth/login - application/json; charset=utf-8 null
2025-09-05 16:26:19.828 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.AuthController.Login (PHONE_STORE.API)'
2025-09-05 16:26:19.834 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(LoginRequest, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.AuthController (PHONE_STORE.API).
2025-09-05 16:26:20.066 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:uname_0='?' (Size = 450), :username_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='0']
SELECT "u"."ID", "u"."CREATED_AT", "u"."EMAIL", "u"."PASSWORD_HASH", "u"."PHONE", "u"."STATUS"
FROM "USER_ACCOUNTS" "u"
WHERE (("u"."EMAIL" = :uname_0) OR ("u"."PHONE" = :username_1))
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:26:20.660 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[:userId_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "r"."CODE"
FROM "USER_ROLES" "u"
INNER JOIN "ROLES" "r" ON "u"."ROLE_ID" = "r"."ID"
WHERE "u"."USER_ID" = :userId_0
2025-09-05 16:26:20.747 +07:00 [INF] Login success [21]
2025-09-05 16:26:20.754 +07:00 [INF] Executing OkObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.AuthResponseDto'.
2025-09-05 16:26:20.759 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.AuthController.Login (PHONE_STORE.API) in 922.7392ms
2025-09-05 16:26:20.760 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.AuthController.Login (PHONE_STORE.API)'
2025-09-05 16:26:20.762 +07:00 [INF] Request finished HTTP/1.1 POST https://localhost:7277/api/auth/login - 200 null application/json; charset=utf-8 943.4428ms
2025-09-05 16:26:20.779 +07:00 [INF] Request starting HTTP/1.1 POST https://localhost:7277/api/shop/cart/merge - null 0
2025-09-05 16:26:20.785 +07:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2025-09-05 16:26:20.790 +07:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-09-05 16:26:20.791 +07:00 [INF] Request finished HTTP/1.1 POST https://localhost:7277/api/shop/cart/merge - 401 0 null 11.7266ms
2025-09-05 16:26:20.802 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - null null
2025-09-05 16:26:20.849 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 16:26:20.851 +07:00 [INF] Route matched with {action = "List", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem]]] List(System.String, System.Nullable`1[System.Int64], Int32, Int32, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 16:26:20.863 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[:p_0='?' (DbType = Int32), :p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."ID" "Id", "p"."NAME" "Name", "p"."SLUG" "Slug"
FROM "HEHE"."PRODUCTS" "p"
WHERE "p"."IS_ACTIVE" = 1
ORDER BY "p"."CREATED_AT" DESC
OFFSET :p_0 ROWS FETCH NEXT :p_1 ROWS ONLY
2025-09-05 16:26:20.867 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", (
    SELECT "p0"."IMAGE_URL"
    FROM "HEHE"."PRODUCT_IMAGES" "p0"
    WHERE (("p0"."PRODUCT_ID" IS NOT NULL AND "p0"."PRODUCT_ID" IN (3, 2, 1)) AND ("p"."PRODUCT_ID" = "p0"."PRODUCT_ID"))
    ORDER BY "p0"."SORT_ORDER"
    FETCH FIRST 1 ROWS ONLY) "Url"
FROM "HEHE"."PRODUCT_IMAGES" "p"
WHERE "p"."PRODUCT_ID" IS NOT NULL AND "p"."PRODUCT_ID" IN (3, 2, 1)
GROUP BY "p"."PRODUCT_ID"
2025-09-05 16:26:20.875 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", MIN(COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")) "MinPrice"
FROM "HEHE"."PRODUCT_VARIANTS" "p"
INNER JOIN "HEHE"."PRODUCT_PRICES" "p0" ON "p"."ID" = "p0"."VARIANT_ID"
WHERE (("p"."PRODUCT_ID" IN (3, 2, 1)) AND ((("p0"."STARTS_AT" <= :now_1) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))))
GROUP BY "p"."PRODUCT_ID"
2025-09-05 16:26:20.877 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem, PHONE_STORE.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-05 16:26:20.878 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API) in 23.5855ms
2025-09-05 16:26:20.878 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 16:26:20.879 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - 200 null application/json; charset=utf-8 77.0545ms
2025-09-05 16:26:20.900 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 16:26:20.904 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:26:20.905 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 16:26:20.914 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:26:20.921 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:26:20.925 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 16:26:20.927 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 16:26:20.928 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 21.215ms
2025-09-05 16:26:20.929 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:26:20.930 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 30.0629ms
2025-09-05 16:26:22.687 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products/galaxy-s24 - null null
2025-09-05 16:26:22.690 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API)'
2025-09-05 16:26:22.695 +07:00 [INF] Route matched with {action = "Details", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductDetail]] Details(System.String, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 16:26:22.741 +07:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-09-05 16:26:22.761 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:slug_0='?' (Size = 220)], CommandType='"Text"', CommandTimeout='0']
SELECT "p2"."ID", "p2"."BRAND_ID", "p2"."CREATED_AT", "p2"."DEFAULT_CATEGORY_ID", "p2"."DESCRIPTION", "p2"."IS_ACTIVE", "p2"."NAME", "p2"."SLUG", "p2"."SPEC_JSON", "p0"."ID", "p0"."BARCODE", "p0"."COLOR", "p0"."IS_ACTIVE", "p0"."PRODUCT_ID", "p0"."SKU", "p0"."STORAGE_GB", "p0"."WEIGHT_GRAM", "p1"."ID", "p1"."ALT_TEXT", "p1"."IMAGE_URL", "p1"."IS_PRIMARY", "p1"."PRODUCT_ID", "p1"."SORT_ORDER", "p1"."VARIANT_ID"
FROM (
    SELECT "p"."ID", "p"."BRAND_ID", "p"."CREATED_AT", "p"."DEFAULT_CATEGORY_ID", "p"."DESCRIPTION", "p"."IS_ACTIVE", "p"."NAME", "p"."SLUG", "p"."SPEC_JSON"
    FROM "HEHE"."PRODUCTS" "p"
    WHERE (("p"."SLUG" = :slug_0) AND ("p"."IS_ACTIVE" = 1))
    FETCH FIRST 1 ROWS ONLY
) "p2"
LEFT JOIN "HEHE"."PRODUCT_VARIANTS" "p0" ON "p2"."ID" = "p0"."PRODUCT_ID"
LEFT JOIN "HEHE"."PRODUCT_IMAGES" "p1" ON "p2"."ID" = "p1"."PRODUCT_ID"
ORDER BY "p2"."ID", "p0"."ID"
2025-09-05 16:26:22.818 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."VARIANT_ID" "VariantId", COALESCE((
    SELECT COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")
    FROM "HEHE"."PRODUCT_PRICES" "p0"
    WHERE (((((("p0"."VARIANT_ID" = 3) AND ("p0"."STARTS_AT" <= :now_1))) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))) AND ("p"."VARIANT_ID" = "p0"."VARIANT_ID"))
    ORDER BY "p0"."STARTS_AT" DESC
    FETCH FIRST 1 ROWS ONLY), 0.0) "Price"
FROM "HEHE"."PRODUCT_PRICES" "p"
WHERE (((("p"."VARIANT_ID" = 3) AND ("p"."STARTS_AT" <= :now_1))) AND ((("p"."ENDS_AT" IS NULL) OR ("p"."ENDS_AT" > :now_2))))
GROUP BY "p"."VARIANT_ID"
2025-09-05 16:26:22.823 +07:00 [INF] Executing OkObjectResult, writing value of type 'PHONE_STORE.API.Controllers.ShopProductsController+ShopProductDetail'.
2025-09-05 16:26:22.832 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API) in 135.5591ms
2025-09-05 16:26:22.834 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API)'
2025-09-05 16:26:22.834 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products/galaxy-s24 - 200 null application/json; charset=utf-8 147.4846ms
2025-09-05 16:26:22.865 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 16:26:22.870 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:26:22.872 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 16:26:22.878 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:26:22.881 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:26:22.884 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 16:26:22.886 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 16:26:22.886 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 12.8065ms
2025-09-05 16:26:22.887 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:26:22.888 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 22.6822ms
2025-09-05 16:26:23.822 +07:00 [INF] Request starting HTTP/1.1 POST https://localhost:7277/api/shop/cart/items - application/json; charset=utf-8 null
2025-09-05 16:26:23.828 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Add (PHONE_STORE.API)'
2025-09-05 16:26:23.831 +07:00 [INF] Route matched with {action = "Add", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Add(PHONE_STORE.Application.Dtos.CartItemUpsertDto, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 16:26:23.843 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:26:23.852 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64), :dto_VariantId_1='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE"
FROM "HEHE"."CART_ITEMS" "c"
WHERE (("c"."CART_ID" = :id_0) AND ("c"."VARIANT_ID" = :dto_VariantId_1))
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:26:23.921 +07:00 [INF] Executed DbCommand (51ms) [Parameters=[:variantId_0='?' (DbType = Int64), :now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT COALESCE("p"."SALE_PRICE", "p"."LIST_PRICE")
FROM "HEHE"."PRODUCT_PRICES" "p"
WHERE (((("p"."VARIANT_ID" = :variantId_0) AND ("p"."STARTS_AT" <= :now_1))) AND ((("p"."ENDS_AT" IS NULL) OR ("p"."ENDS_AT" >= :now_2))))
ORDER BY "p"."STARTS_AT" DESC
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:26:23.987 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:p0='?' (DbType = Int64), :p1='?' (DbType = Int64), :p2='?' (DbType = DateTime), :p3='?' (Size = 2000), :p4='?' (DbType = Int32), :p5='?' (DbType = Decimal)], CommandType='"Text"', CommandTimeout='0']
DECLARE


BEGIN

INSERT INTO "HEHE"."CART_ITEMS" ("CART_ID", "VARIANT_ID", "ADDED_AT", "CURRENCY", "QUANTITY", "UNIT_PRICE")
VALUES (:p0, :p1, :p2, :p3, :p4, :p5);

END;
2025-09-05 16:26:23.993 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:26:23.996 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:26:23.999 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 16:26:24.002 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 16:26:24.004 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Add (PHONE_STORE.API) in 171.8877ms
2025-09-05 16:26:24.005 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Add (PHONE_STORE.API)'
2025-09-05 16:26:24.006 +07:00 [INF] Request finished HTTP/1.1 POST https://localhost:7277/api/shop/cart/items - 200 null application/json; charset=utf-8 183.8705ms
2025-09-05 16:26:24.012 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products/galaxy-s24 - null null
2025-09-05 16:26:24.014 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API)'
2025-09-05 16:26:24.015 +07:00 [INF] Route matched with {action = "Details", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductDetail]] Details(System.String, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 16:26:24.018 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:slug_0='?' (Size = 220)], CommandType='"Text"', CommandTimeout='0']
SELECT "p2"."ID", "p2"."BRAND_ID", "p2"."CREATED_AT", "p2"."DEFAULT_CATEGORY_ID", "p2"."DESCRIPTION", "p2"."IS_ACTIVE", "p2"."NAME", "p2"."SLUG", "p2"."SPEC_JSON", "p0"."ID", "p0"."BARCODE", "p0"."COLOR", "p0"."IS_ACTIVE", "p0"."PRODUCT_ID", "p0"."SKU", "p0"."STORAGE_GB", "p0"."WEIGHT_GRAM", "p1"."ID", "p1"."ALT_TEXT", "p1"."IMAGE_URL", "p1"."IS_PRIMARY", "p1"."PRODUCT_ID", "p1"."SORT_ORDER", "p1"."VARIANT_ID"
FROM (
    SELECT "p"."ID", "p"."BRAND_ID", "p"."CREATED_AT", "p"."DEFAULT_CATEGORY_ID", "p"."DESCRIPTION", "p"."IS_ACTIVE", "p"."NAME", "p"."SLUG", "p"."SPEC_JSON"
    FROM "HEHE"."PRODUCTS" "p"
    WHERE (("p"."SLUG" = :slug_0) AND ("p"."IS_ACTIVE" = 1))
    FETCH FIRST 1 ROWS ONLY
) "p2"
LEFT JOIN "HEHE"."PRODUCT_VARIANTS" "p0" ON "p2"."ID" = "p0"."PRODUCT_ID"
LEFT JOIN "HEHE"."PRODUCT_IMAGES" "p1" ON "p2"."ID" = "p1"."PRODUCT_ID"
ORDER BY "p2"."ID", "p0"."ID"
2025-09-05 16:26:24.023 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."VARIANT_ID" "VariantId", COALESCE((
    SELECT COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")
    FROM "HEHE"."PRODUCT_PRICES" "p0"
    WHERE (((((("p0"."VARIANT_ID" = 3) AND ("p0"."STARTS_AT" <= :now_1))) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))) AND ("p"."VARIANT_ID" = "p0"."VARIANT_ID"))
    ORDER BY "p0"."STARTS_AT" DESC
    FETCH FIRST 1 ROWS ONLY), 0.0) "Price"
FROM "HEHE"."PRODUCT_PRICES" "p"
WHERE (((("p"."VARIANT_ID" = 3) AND ("p"."STARTS_AT" <= :now_1))) AND ((("p"."ENDS_AT" IS NULL) OR ("p"."ENDS_AT" > :now_2))))
GROUP BY "p"."VARIANT_ID"
2025-09-05 16:26:24.025 +07:00 [INF] Executing OkObjectResult, writing value of type 'PHONE_STORE.API.Controllers.ShopProductsController+ShopProductDetail'.
2025-09-05 16:26:24.026 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API) in 10.0259ms
2025-09-05 16:26:24.026 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API)'
2025-09-05 16:26:24.027 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products/galaxy-s24 - 200 null application/json; charset=utf-8 14.5798ms
2025-09-05 16:26:24.052 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 16:26:24.056 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:26:24.057 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 16:26:24.062 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:26:24.064 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:26:24.068 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 16:26:24.069 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 16:26:24.070 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 11.3696ms
2025-09-05 16:26:24.071 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:26:24.071 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 18.9095ms
2025-09-05 16:26:27.682 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 16:26:27.684 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:26:27.684 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 16:26:27.688 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:26:27.691 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:26:27.694 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 16:26:27.696 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 16:26:27.696 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 11.0862ms
2025-09-05 16:26:27.697 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:26:27.698 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 15.8809ms
2025-09-05 16:26:27.722 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 16:26:27.724 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:26:27.725 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 16:26:27.729 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:26:27.733 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:26:27.736 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 16:26:27.739 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 16:26:27.740 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 13.6702ms
2025-09-05 16:26:27.741 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:26:27.741 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 19.9537ms
2025-09-05 16:26:30.622 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/me/addresses - null null
2025-09-05 16:26:30.629 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopMeController.MyAddresses (PHONE_STORE.API)'
2025-09-05 16:26:30.633 +07:00 [INF] Route matched with {action = "MyAddresses", controller = "ShopMe"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.Application.Dtos.AddressDto]]] MyAddresses(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopMeController (PHONE_STORE.API).
2025-09-05 16:26:30.639 +07:00 [INF] Executing ObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ProblemDetails'.
2025-09-05 16:26:30.657 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopMeController.MyAddresses (PHONE_STORE.API) in 21.542ms
2025-09-05 16:26:30.660 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopMeController.MyAddresses (PHONE_STORE.API)'
2025-09-05 16:26:30.661 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/me/addresses - 401 null application/problem+json; charset=utf-8 39.4506ms
2025-09-05 16:26:31.554 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 16:26:31.557 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:26:31.557 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 16:26:31.561 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:26:31.564 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:26:31.567 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 16:26:31.568 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 16:26:31.569 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 10.5337ms
2025-09-05 16:26:31.570 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:26:31.570 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 16.231ms
2025-09-05 16:26:35.287 +07:00 [INF] Request starting HTTP/1.1 POST https://localhost:7277/api/auth/logout - application/json; charset=utf-8 null
2025-09-05 16:26:35.292 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.AuthController.Logout (PHONE_STORE.API)'
2025-09-05 16:26:35.299 +07:00 [INF] Route matched with {action = "Logout", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Logout(RefreshRequest, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.AuthController (PHONE_STORE.API).
2025-09-05 16:26:35.315 +07:00 [INF] Logout: revoked RT
2025-09-05 16:26:35.316 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType1`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-05 16:26:35.321 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.AuthController.Logout (PHONE_STORE.API) in 19.0492ms
2025-09-05 16:26:35.324 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.AuthController.Logout (PHONE_STORE.API)'
2025-09-05 16:26:35.325 +07:00 [INF] Request finished HTTP/1.1 POST https://localhost:7277/api/auth/logout - 200 null application/json; charset=utf-8 38.3467ms
2025-09-05 16:26:35.334 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - null null
2025-09-05 16:26:35.336 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 16:26:35.336 +07:00 [INF] Route matched with {action = "List", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem]]] List(System.String, System.Nullable`1[System.Int64], Int32, Int32, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 16:26:35.342 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:p_0='?' (DbType = Int32), :p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."ID" "Id", "p"."NAME" "Name", "p"."SLUG" "Slug"
FROM "HEHE"."PRODUCTS" "p"
WHERE "p"."IS_ACTIVE" = 1
ORDER BY "p"."CREATED_AT" DESC
OFFSET :p_0 ROWS FETCH NEXT :p_1 ROWS ONLY
2025-09-05 16:26:35.347 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", (
    SELECT "p0"."IMAGE_URL"
    FROM "HEHE"."PRODUCT_IMAGES" "p0"
    WHERE (("p0"."PRODUCT_ID" IS NOT NULL AND "p0"."PRODUCT_ID" IN (3, 2, 1)) AND ("p"."PRODUCT_ID" = "p0"."PRODUCT_ID"))
    ORDER BY "p0"."SORT_ORDER"
    FETCH FIRST 1 ROWS ONLY) "Url"
FROM "HEHE"."PRODUCT_IMAGES" "p"
WHERE "p"."PRODUCT_ID" IS NOT NULL AND "p"."PRODUCT_ID" IN (3, 2, 1)
GROUP BY "p"."PRODUCT_ID"
2025-09-05 16:26:35.351 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", MIN(COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")) "MinPrice"
FROM "HEHE"."PRODUCT_VARIANTS" "p"
INNER JOIN "HEHE"."PRODUCT_PRICES" "p0" ON "p"."ID" = "p0"."VARIANT_ID"
WHERE (("p"."PRODUCT_ID" IN (3, 2, 1)) AND ((("p0"."STARTS_AT" <= :now_1) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))))
GROUP BY "p"."PRODUCT_ID"
2025-09-05 16:26:35.353 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem, PHONE_STORE.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-05 16:26:35.354 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API) in 16.8361ms
2025-09-05 16:26:35.355 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 16:26:35.356 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - 200 null application/json; charset=utf-8 21.4837ms
2025-09-05 16:26:35.373 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 16:26:35.375 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:26:35.377 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 16:26:35.385 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:26:35.388 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:26:35.393 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 16:26:35.395 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 16:26:35.395 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 15.1523ms
2025-09-05 16:26:35.396 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:26:35.397 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 24.6647ms
2025-09-05 16:26:37.363 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 16:26:37.366 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:26:37.366 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 16:26:37.370 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:26:37.374 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:26:37.378 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 16:26:37.381 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 16:26:37.382 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 14.3648ms
2025-09-05 16:26:37.382 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:26:37.383 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 19.8113ms
2025-09-05 16:26:45.014 +07:00 [INF] Request starting HTTP/1.1 POST https://localhost:7277/api/auth/login - application/json; charset=utf-8 null
2025-09-05 16:26:45.017 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.AuthController.Login (PHONE_STORE.API)'
2025-09-05 16:26:45.017 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(LoginRequest, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.AuthController (PHONE_STORE.API).
2025-09-05 16:26:45.030 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:uname_0='?' (Size = 450), :username_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='0']
SELECT "u"."ID", "u"."CREATED_AT", "u"."EMAIL", "u"."PASSWORD_HASH", "u"."PHONE", "u"."STATUS"
FROM "USER_ACCOUNTS" "u"
WHERE (("u"."EMAIL" = :uname_0) OR ("u"."PHONE" = :username_1))
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:26:45.346 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[:userId_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "r"."CODE"
FROM "USER_ROLES" "u"
INNER JOIN "ROLES" "r" ON "u"."ROLE_ID" = "r"."ID"
WHERE "u"."USER_ID" = :userId_0
2025-09-05 16:26:45.350 +07:00 [INF] Login success [81]
2025-09-05 16:26:45.352 +07:00 [INF] Executing OkObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.AuthResponseDto'.
2025-09-05 16:26:45.353 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.AuthController.Login (PHONE_STORE.API) in 334.8285ms
2025-09-05 16:26:45.354 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.AuthController.Login (PHONE_STORE.API)'
2025-09-05 16:26:45.355 +07:00 [INF] Request finished HTTP/1.1 POST https://localhost:7277/api/auth/login - 200 null application/json; charset=utf-8 340.9241ms
2025-09-05 16:26:45.356 +07:00 [INF] Request starting HTTP/1.1 POST https://localhost:7277/api/shop/cart/merge - null 0
2025-09-05 16:26:45.359 +07:00 [INF] Authorization failed. These requirements were not met:
DenyAnonymousAuthorizationRequirement: Requires an authenticated user.
2025-09-05 16:26:45.360 +07:00 [INF] AuthenticationScheme: Bearer was challenged.
2025-09-05 16:26:45.360 +07:00 [INF] Request finished HTTP/1.1 POST https://localhost:7277/api/shop/cart/merge - 401 0 null 4.2652ms
2025-09-05 16:26:45.368 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - null null
2025-09-05 16:26:45.370 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 16:26:45.370 +07:00 [INF] Route matched with {action = "List", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem]]] List(System.String, System.Nullable`1[System.Int64], Int32, Int32, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 16:26:45.377 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:p_0='?' (DbType = Int32), :p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."ID" "Id", "p"."NAME" "Name", "p"."SLUG" "Slug"
FROM "HEHE"."PRODUCTS" "p"
WHERE "p"."IS_ACTIVE" = 1
ORDER BY "p"."CREATED_AT" DESC
OFFSET :p_0 ROWS FETCH NEXT :p_1 ROWS ONLY
2025-09-05 16:26:45.383 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", (
    SELECT "p0"."IMAGE_URL"
    FROM "HEHE"."PRODUCT_IMAGES" "p0"
    WHERE (("p0"."PRODUCT_ID" IS NOT NULL AND "p0"."PRODUCT_ID" IN (3, 2, 1)) AND ("p"."PRODUCT_ID" = "p0"."PRODUCT_ID"))
    ORDER BY "p0"."SORT_ORDER"
    FETCH FIRST 1 ROWS ONLY) "Url"
FROM "HEHE"."PRODUCT_IMAGES" "p"
WHERE "p"."PRODUCT_ID" IS NOT NULL AND "p"."PRODUCT_ID" IN (3, 2, 1)
GROUP BY "p"."PRODUCT_ID"
2025-09-05 16:26:45.388 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", MIN(COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")) "MinPrice"
FROM "HEHE"."PRODUCT_VARIANTS" "p"
INNER JOIN "HEHE"."PRODUCT_PRICES" "p0" ON "p"."ID" = "p0"."VARIANT_ID"
WHERE (("p"."PRODUCT_ID" IN (3, 2, 1)) AND ((("p0"."STARTS_AT" <= :now_1) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))))
GROUP BY "p"."PRODUCT_ID"
2025-09-05 16:26:45.390 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem, PHONE_STORE.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-05 16:26:45.391 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API) in 18.8921ms
2025-09-05 16:26:45.391 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 16:26:45.392 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - 200 null application/json; charset=utf-8 23.9091ms
2025-09-05 16:26:45.415 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 16:26:45.418 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:26:45.419 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 16:26:45.423 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:26:45.427 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:26:45.431 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 16:26:45.433 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 16:26:45.434 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 13.6015ms
2025-09-05 16:26:45.435 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:26:45.435 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 20.3043ms
2025-09-05 16:26:48.962 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 16:26:48.966 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:26:48.966 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 16:26:48.972 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:26:48.974 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:26:48.977 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 16:26:48.979 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 16:26:48.979 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 12.1587ms
2025-09-05 16:26:48.980 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:26:48.981 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 18.4487ms
2025-09-05 16:26:49.006 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 16:26:49.010 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:26:49.010 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 16:26:49.015 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:26:49.018 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:26:49.022 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 16:26:49.023 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 16:26:49.024 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 11.6563ms
2025-09-05 16:26:49.025 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:26:49.025 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 19.895ms
2025-09-05 16:26:51.990 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - null null
2025-09-05 16:26:51.994 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 16:26:51.994 +07:00 [INF] Route matched with {action = "List", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem]]] List(System.String, System.Nullable`1[System.Int64], Int32, Int32, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 16:26:51.998 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:p_0='?' (DbType = Int32), :p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."ID" "Id", "p"."NAME" "Name", "p"."SLUG" "Slug"
FROM "HEHE"."PRODUCTS" "p"
WHERE "p"."IS_ACTIVE" = 1
ORDER BY "p"."CREATED_AT" DESC
OFFSET :p_0 ROWS FETCH NEXT :p_1 ROWS ONLY
2025-09-05 16:26:52.000 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", (
    SELECT "p0"."IMAGE_URL"
    FROM "HEHE"."PRODUCT_IMAGES" "p0"
    WHERE (("p0"."PRODUCT_ID" IS NOT NULL AND "p0"."PRODUCT_ID" IN (3, 2, 1)) AND ("p"."PRODUCT_ID" = "p0"."PRODUCT_ID"))
    ORDER BY "p0"."SORT_ORDER"
    FETCH FIRST 1 ROWS ONLY) "Url"
FROM "HEHE"."PRODUCT_IMAGES" "p"
WHERE "p"."PRODUCT_ID" IS NOT NULL AND "p"."PRODUCT_ID" IN (3, 2, 1)
GROUP BY "p"."PRODUCT_ID"
2025-09-05 16:26:52.006 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", MIN(COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")) "MinPrice"
FROM "HEHE"."PRODUCT_VARIANTS" "p"
INNER JOIN "HEHE"."PRODUCT_PRICES" "p0" ON "p"."ID" = "p0"."VARIANT_ID"
WHERE (("p"."PRODUCT_ID" IN (3, 2, 1)) AND ((("p0"."STARTS_AT" <= :now_1) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))))
GROUP BY "p"."PRODUCT_ID"
2025-09-05 16:26:52.008 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem, PHONE_STORE.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-05 16:26:52.009 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API) in 13.3884ms
2025-09-05 16:26:52.009 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 16:26:52.010 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - 200 null application/json; charset=utf-8 19.6312ms
2025-09-05 16:26:52.031 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 16:26:52.034 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:26:52.035 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 16:26:52.045 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:26:52.051 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:26:52.057 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 16:26:52.060 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 16:26:52.062 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 23.433ms
2025-09-05 16:26:52.063 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:26:52.064 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 33.1695ms
2025-09-05 16:26:53.564 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products/galaxy-s24 - null null
2025-09-05 16:26:53.566 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API)'
2025-09-05 16:26:53.566 +07:00 [INF] Route matched with {action = "Details", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductDetail]] Details(System.String, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 16:26:53.571 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:slug_0='?' (Size = 220)], CommandType='"Text"', CommandTimeout='0']
SELECT "p2"."ID", "p2"."BRAND_ID", "p2"."CREATED_AT", "p2"."DEFAULT_CATEGORY_ID", "p2"."DESCRIPTION", "p2"."IS_ACTIVE", "p2"."NAME", "p2"."SLUG", "p2"."SPEC_JSON", "p0"."ID", "p0"."BARCODE", "p0"."COLOR", "p0"."IS_ACTIVE", "p0"."PRODUCT_ID", "p0"."SKU", "p0"."STORAGE_GB", "p0"."WEIGHT_GRAM", "p1"."ID", "p1"."ALT_TEXT", "p1"."IMAGE_URL", "p1"."IS_PRIMARY", "p1"."PRODUCT_ID", "p1"."SORT_ORDER", "p1"."VARIANT_ID"
FROM (
    SELECT "p"."ID", "p"."BRAND_ID", "p"."CREATED_AT", "p"."DEFAULT_CATEGORY_ID", "p"."DESCRIPTION", "p"."IS_ACTIVE", "p"."NAME", "p"."SLUG", "p"."SPEC_JSON"
    FROM "HEHE"."PRODUCTS" "p"
    WHERE (("p"."SLUG" = :slug_0) AND ("p"."IS_ACTIVE" = 1))
    FETCH FIRST 1 ROWS ONLY
) "p2"
LEFT JOIN "HEHE"."PRODUCT_VARIANTS" "p0" ON "p2"."ID" = "p0"."PRODUCT_ID"
LEFT JOIN "HEHE"."PRODUCT_IMAGES" "p1" ON "p2"."ID" = "p1"."PRODUCT_ID"
ORDER BY "p2"."ID", "p0"."ID"
2025-09-05 16:26:53.575 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."VARIANT_ID" "VariantId", COALESCE((
    SELECT COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")
    FROM "HEHE"."PRODUCT_PRICES" "p0"
    WHERE (((((("p0"."VARIANT_ID" = 3) AND ("p0"."STARTS_AT" <= :now_1))) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))) AND ("p"."VARIANT_ID" = "p0"."VARIANT_ID"))
    ORDER BY "p0"."STARTS_AT" DESC
    FETCH FIRST 1 ROWS ONLY), 0.0) "Price"
FROM "HEHE"."PRODUCT_PRICES" "p"
WHERE (((("p"."VARIANT_ID" = 3) AND ("p"."STARTS_AT" <= :now_1))) AND ((("p"."ENDS_AT" IS NULL) OR ("p"."ENDS_AT" > :now_2))))
GROUP BY "p"."VARIANT_ID"
2025-09-05 16:26:53.576 +07:00 [INF] Executing OkObjectResult, writing value of type 'PHONE_STORE.API.Controllers.ShopProductsController+ShopProductDetail'.
2025-09-05 16:26:53.577 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API) in 9.8528ms
2025-09-05 16:26:53.578 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API)'
2025-09-05 16:26:53.578 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products/galaxy-s24 - 200 null application/json; charset=utf-8 14.4662ms
2025-09-05 16:26:53.596 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 16:26:53.598 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:26:53.599 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 16:26:53.604 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:26:53.609 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:26:53.612 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 16:26:53.614 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 16:26:53.614 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 13.2126ms
2025-09-05 16:26:53.615 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:26:53.616 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 20.0281ms
2025-09-05 16:26:57.516 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - null null
2025-09-05 16:26:57.518 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 16:26:57.519 +07:00 [INF] Route matched with {action = "List", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem]]] List(System.String, System.Nullable`1[System.Int64], Int32, Int32, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 16:26:57.523 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:p_0='?' (DbType = Int32), :p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."ID" "Id", "p"."NAME" "Name", "p"."SLUG" "Slug"
FROM "HEHE"."PRODUCTS" "p"
WHERE "p"."IS_ACTIVE" = 1
ORDER BY "p"."CREATED_AT" DESC
OFFSET :p_0 ROWS FETCH NEXT :p_1 ROWS ONLY
2025-09-05 16:26:57.526 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", (
    SELECT "p0"."IMAGE_URL"
    FROM "HEHE"."PRODUCT_IMAGES" "p0"
    WHERE (("p0"."PRODUCT_ID" IS NOT NULL AND "p0"."PRODUCT_ID" IN (3, 2, 1)) AND ("p"."PRODUCT_ID" = "p0"."PRODUCT_ID"))
    ORDER BY "p0"."SORT_ORDER"
    FETCH FIRST 1 ROWS ONLY) "Url"
FROM "HEHE"."PRODUCT_IMAGES" "p"
WHERE "p"."PRODUCT_ID" IS NOT NULL AND "p"."PRODUCT_ID" IN (3, 2, 1)
GROUP BY "p"."PRODUCT_ID"
2025-09-05 16:26:57.530 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", MIN(COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")) "MinPrice"
FROM "HEHE"."PRODUCT_VARIANTS" "p"
INNER JOIN "HEHE"."PRODUCT_PRICES" "p0" ON "p"."ID" = "p0"."VARIANT_ID"
WHERE (("p"."PRODUCT_ID" IN (3, 2, 1)) AND ((("p0"."STARTS_AT" <= :now_1) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))))
GROUP BY "p"."PRODUCT_ID"
2025-09-05 16:26:57.531 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem, PHONE_STORE.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-05 16:26:57.532 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API) in 11.6957ms
2025-09-05 16:26:57.533 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 16:26:57.533 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - 200 null application/json; charset=utf-8 17.7602ms
2025-09-05 16:26:59.995 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 16:26:59.997 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:26:59.997 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 16:27:00.005 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:27:00.015 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:27:00.019 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 16:27:00.021 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 16:27:00.023 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 23.6897ms
2025-09-05 16:27:00.024 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:27:00.025 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 30.3257ms
2025-09-05 16:27:01.204 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - null null
2025-09-05 16:27:01.208 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 16:27:01.208 +07:00 [INF] Route matched with {action = "List", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem]]] List(System.String, System.Nullable`1[System.Int64], Int32, Int32, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 16:27:01.213 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:p_0='?' (DbType = Int32), :p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."ID" "Id", "p"."NAME" "Name", "p"."SLUG" "Slug"
FROM "HEHE"."PRODUCTS" "p"
WHERE "p"."IS_ACTIVE" = 1
ORDER BY "p"."CREATED_AT" DESC
OFFSET :p_0 ROWS FETCH NEXT :p_1 ROWS ONLY
2025-09-05 16:27:01.215 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", (
    SELECT "p0"."IMAGE_URL"
    FROM "HEHE"."PRODUCT_IMAGES" "p0"
    WHERE (("p0"."PRODUCT_ID" IS NOT NULL AND "p0"."PRODUCT_ID" IN (3, 2, 1)) AND ("p"."PRODUCT_ID" = "p0"."PRODUCT_ID"))
    ORDER BY "p0"."SORT_ORDER"
    FETCH FIRST 1 ROWS ONLY) "Url"
FROM "HEHE"."PRODUCT_IMAGES" "p"
WHERE "p"."PRODUCT_ID" IS NOT NULL AND "p"."PRODUCT_ID" IN (3, 2, 1)
GROUP BY "p"."PRODUCT_ID"
2025-09-05 16:27:01.219 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", MIN(COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")) "MinPrice"
FROM "HEHE"."PRODUCT_VARIANTS" "p"
INNER JOIN "HEHE"."PRODUCT_PRICES" "p0" ON "p"."ID" = "p0"."VARIANT_ID"
WHERE (("p"."PRODUCT_ID" IN (3, 2, 1)) AND ((("p0"."STARTS_AT" <= :now_1) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))))
GROUP BY "p"."PRODUCT_ID"
2025-09-05 16:27:01.221 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem, PHONE_STORE.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-05 16:27:01.221 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API) in 11.6996ms
2025-09-05 16:27:01.222 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 16:27:01.222 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - 200 null application/json; charset=utf-8 18.1098ms
2025-09-05 16:42:43.546 +07:00 [INF] User profile is available. Using 'C:\Users\Administrator\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-09-05 16:42:43.765 +07:00 [INF] Now listening on: https://localhost:7277
2025-09-05 16:42:43.766 +07:00 [INF] Now listening on: http://localhost:5209
2025-09-05 16:42:43.868 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-05 16:42:43.870 +07:00 [INF] Hosting environment: Development
2025-09-05 16:42:43.871 +07:00 [INF] Content root path: C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.API
2025-09-05 16:42:44.191 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/swagger/index.html - null null
2025-09-05 16:42:44.833 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/swagger/index.html - 200 null text/html;charset=utf-8 653.9798ms
2025-09-05 16:42:44.919 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/_framework/aspnetcore-browser-refresh.js - null null
2025-09-05 16:42:44.919 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/_vs/browserLink - null null
2025-09-05 16:42:44.983 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/_framework/aspnetcore-browser-refresh.js - 200 13766 application/javascript; charset=utf-8 73.4284ms
2025-09-05 16:42:45.233 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/_vs/browserLink - 200 null text/javascript; charset=UTF-8 313.4872ms
2025-09-05 16:42:46.037 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/swagger/v1/swagger.json - null null
2025-09-05 16:42:46.090 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 54.1605ms
2025-09-05 16:42:46.282 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - null null
2025-09-05 16:42:46.326 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 16:42:46.348 +07:00 [INF] Route matched with {action = "List", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem]]] List(System.String, System.Nullable`1[System.Int64], Int32, Int32, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 16:42:47.008 +07:00 [WRN] The decimal property 'UnitPrice' on entity type 'CartItem' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 16:42:47.011 +07:00 [WRN] The decimal property 'DecValue' on entity type 'ProductAttributeValue' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 16:42:47.012 +07:00 [WRN] The decimal property 'WeightGram' on entity type 'ProductVariant' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 16:42:47.691 +07:00 [INF] Executed DbCommand (95ms) [Parameters=[:p_0='?' (DbType = Int32), :p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."ID" "Id", "p"."NAME" "Name", "p"."SLUG" "Slug"
FROM "HEHE"."PRODUCTS" "p"
WHERE "p"."IS_ACTIVE" = 1
ORDER BY "p"."CREATED_AT" DESC
OFFSET :p_0 ROWS FETCH NEXT :p_1 ROWS ONLY
2025-09-05 16:42:47.803 +07:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", (
    SELECT "p0"."IMAGE_URL"
    FROM "HEHE"."PRODUCT_IMAGES" "p0"
    WHERE (("p0"."PRODUCT_ID" IS NOT NULL AND "p0"."PRODUCT_ID" IN (3, 2, 1)) AND ("p"."PRODUCT_ID" = "p0"."PRODUCT_ID"))
    ORDER BY "p0"."SORT_ORDER"
    FETCH FIRST 1 ROWS ONLY) "Url"
FROM "HEHE"."PRODUCT_IMAGES" "p"
WHERE "p"."PRODUCT_ID" IS NOT NULL AND "p"."PRODUCT_ID" IN (3, 2, 1)
GROUP BY "p"."PRODUCT_ID"
2025-09-05 16:42:47.846 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", MIN(COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")) "MinPrice"
FROM "HEHE"."PRODUCT_VARIANTS" "p"
INNER JOIN "HEHE"."PRODUCT_PRICES" "p0" ON "p"."ID" = "p0"."VARIANT_ID"
WHERE (("p"."PRODUCT_ID" IN (3, 2, 1)) AND ((("p0"."STARTS_AT" <= :now_1) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))))
GROUP BY "p"."PRODUCT_ID"
2025-09-05 16:42:47.860 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem, PHONE_STORE.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-05 16:42:47.874 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API) in 1522.7525ms
2025-09-05 16:42:47.877 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 16:42:47.883 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - 200 null application/json; charset=utf-8 1603.0966ms
2025-09-05 16:42:48.063 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 16:42:48.071 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:42:48.076 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 16:42:48.154 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:42:48.235 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:42:48.256 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 16:42:48.269 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 16:42:48.288 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 211.3676ms
2025-09-05 16:42:48.290 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:42:48.291 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 228.2088ms
2025-09-05 16:42:51.316 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 16:42:51.321 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:42:51.322 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 16:42:51.343 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:42:51.348 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:42:51.354 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 16:42:51.357 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 16:42:51.358 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 35.6695ms
2025-09-05 16:42:51.360 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:42:51.361 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 45.1347ms
2025-09-05 16:42:51.399 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 16:42:51.402 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:42:51.403 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 16:42:51.414 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:42:51.420 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:42:51.426 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 16:42:51.430 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 16:42:51.432 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 27.2907ms
2025-09-05 16:42:51.433 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:42:51.435 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 35.5798ms
2025-09-05 16:42:53.473 +07:00 [INF] Request starting HTTP/1.1 DELETE https://localhost:7277/api/shop/cart/items/3 - null null
2025-09-05 16:42:53.475 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Remove (PHONE_STORE.API)'
2025-09-05 16:42:53.483 +07:00 [INF] Route matched with {action = "Remove", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task Remove(Int64, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 16:42:53.491 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:42:53.502 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64), :itemId_1='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE"
FROM "HEHE"."CART_ITEMS" "c"
WHERE (("c"."CART_ID" = :id_0) AND ("c"."VARIANT_ID" = :itemId_1))
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:42:53.739 +07:00 [INF] Executed DbCommand (29ms) [Parameters=[:p0='?' (DbType = Int64), :p1='?' (DbType = Int64), :cur0='?' (Direction = Output) (DbType = Object)], CommandType='"Text"', CommandTimeout='0']
DECLARE

v_RowCount INTEGER;

BEGIN

DELETE FROM "HEHE"."CART_ITEMS"
WHERE "CART_ID" = :p0 AND "VARIANT_ID" = :p1;
v_RowCount := SQL%ROWCOUNT;
OPEN :cur0 FOR SELECT v_RowCount FROM DUAL;

END;
2025-09-05 16:42:53.793 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Remove (PHONE_STORE.API) in 308.5895ms
2025-09-05 16:42:53.796 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Remove (PHONE_STORE.API)'
2025-09-05 16:42:53.797 +07:00 [INF] Request finished HTTP/1.1 DELETE https://localhost:7277/api/shop/cart/items/3 - 200 0 null 324.7337ms
2025-09-05 16:42:53.804 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 16:42:53.805 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:42:53.806 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 16:42:53.810 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:42:53.814 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:42:53.817 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 16:42:53.819 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 16:42:53.820 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 12.7706ms
2025-09-05 16:42:53.821 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:42:53.822 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 17.8498ms
2025-09-05 16:42:53.843 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 16:42:53.845 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:42:53.846 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 16:42:53.854 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:42:53.859 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:42:53.864 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 16:42:53.868 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 16:42:53.869 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 21.1518ms
2025-09-05 16:42:53.870 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:42:53.871 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 27.7828ms
2025-09-05 16:43:47.081 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 16:43:47.083 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:43:47.084 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 16:43:47.101 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:43:47.143 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:p0='?' (DbType = DateTime), :p1='?' (Size = 2000), :p2='?' (DbType = Int64), :p3='?' (Size = 64), :p4='?' (Size = 2000), :p5='?' (DbType = DateTime), :cur0='?' (Direction = Output) (DbType = Object)], CommandType='"Text"', CommandTimeout='0']
DECLARE

TYPE "rCARTS_0" IS RECORD
(
"ID" NUMBER(19)
);
TYPE "tCARTS_0" IS TABLE OF "rCARTS_0";
"lCARTS_0" "tCARTS_0";

BEGIN

"lCARTS_0" := "tCARTS_0"();
"lCARTS_0".extend(1);
INSERT INTO "HEHE"."CARTS" ("CREATED_AT", "CURRENCY", "CUSTOMER_ID", "SESSION_TOKEN", "STATUS", "UPDATED_AT")
VALUES (:p0, :p1, :p2, :p3, :p4, :p5)
RETURNING "ID" INTO "lCARTS_0"(1)."ID";
OPEN :cur0 FOR SELECT "lCARTS_0"(1)."ID" FROM DUAL;

END;
2025-09-05 16:43:47.166 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:43:47.173 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 16:43:47.175 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 16:43:47.175 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 90.0167ms
2025-09-05 16:43:47.176 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:43:47.177 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 96.114ms
2025-09-05 16:43:52.893 +07:00 [INF] Request starting HTTP/1.1 POST https://localhost:7277/api/auth/login - application/json; charset=utf-8 null
2025-09-05 16:43:52.901 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.AuthController.Login (PHONE_STORE.API)'
2025-09-05 16:43:52.906 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(LoginRequest, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.AuthController (PHONE_STORE.API).
2025-09-05 16:43:53.202 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:uname_0='?' (Size = 450), :username_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='0']
SELECT "u"."ID", "u"."CREATED_AT", "u"."EMAIL", "u"."PASSWORD_HASH", "u"."PHONE", "u"."STATUS"
FROM "USER_ACCOUNTS" "u"
WHERE (("u"."EMAIL" = :uname_0) OR ("u"."PHONE" = :username_1))
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:43:53.658 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[:userId_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "r"."CODE"
FROM "USER_ROLES" "u"
INNER JOIN "ROLES" "r" ON "u"."ROLE_ID" = "r"."ID"
WHERE "u"."USER_ID" = :userId_0
2025-09-05 16:43:53.735 +07:00 [INF] Login success [21]
2025-09-05 16:43:53.744 +07:00 [INF] Executing OkObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.AuthResponseDto'.
2025-09-05 16:43:53.751 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.AuthController.Login (PHONE_STORE.API) in 842.7658ms
2025-09-05 16:43:53.754 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.AuthController.Login (PHONE_STORE.API)'
2025-09-05 16:43:53.758 +07:00 [INF] Request finished HTTP/1.1 POST https://localhost:7277/api/auth/login - 200 null application/json; charset=utf-8 864.7954ms
2025-09-05 16:43:53.777 +07:00 [INF] Request starting HTTP/1.1 POST https://localhost:7277/api/shop/cart/merge - null 0
2025-09-05 16:43:53.828 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Merge (PHONE_STORE.API)'
2025-09-05 16:43:53.831 +07:00 [INF] Route matched with {action = "Merge", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Merge(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 16:43:53.836 +07:00 [INF] Executing StatusCodeResult, setting HTTP status code 200
2025-09-05 16:43:53.837 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Merge (PHONE_STORE.API) in 4.7018ms
2025-09-05 16:43:53.838 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Merge (PHONE_STORE.API)'
2025-09-05 16:43:53.841 +07:00 [INF] Request finished HTTP/1.1 POST https://localhost:7277/api/shop/cart/merge - 200 0 null 63.8324ms
2025-09-05 16:43:53.852 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - null null
2025-09-05 16:43:53.855 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 16:43:53.855 +07:00 [INF] Route matched with {action = "List", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem]]] List(System.String, System.Nullable`1[System.Int64], Int32, Int32, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 16:43:53.861 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:p_0='?' (DbType = Int32), :p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."ID" "Id", "p"."NAME" "Name", "p"."SLUG" "Slug"
FROM "HEHE"."PRODUCTS" "p"
WHERE "p"."IS_ACTIVE" = 1
ORDER BY "p"."CREATED_AT" DESC
OFFSET :p_0 ROWS FETCH NEXT :p_1 ROWS ONLY
2025-09-05 16:43:53.865 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", (
    SELECT "p0"."IMAGE_URL"
    FROM "HEHE"."PRODUCT_IMAGES" "p0"
    WHERE (("p0"."PRODUCT_ID" IS NOT NULL AND "p0"."PRODUCT_ID" IN (3, 2, 1)) AND ("p"."PRODUCT_ID" = "p0"."PRODUCT_ID"))
    ORDER BY "p0"."SORT_ORDER"
    FETCH FIRST 1 ROWS ONLY) "Url"
FROM "HEHE"."PRODUCT_IMAGES" "p"
WHERE "p"."PRODUCT_ID" IS NOT NULL AND "p"."PRODUCT_ID" IN (3, 2, 1)
GROUP BY "p"."PRODUCT_ID"
2025-09-05 16:43:53.873 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", MIN(COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")) "MinPrice"
FROM "HEHE"."PRODUCT_VARIANTS" "p"
INNER JOIN "HEHE"."PRODUCT_PRICES" "p0" ON "p"."ID" = "p0"."VARIANT_ID"
WHERE (("p"."PRODUCT_ID" IN (3, 2, 1)) AND ((("p0"."STARTS_AT" <= :now_1) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))))
GROUP BY "p"."PRODUCT_ID"
2025-09-05 16:43:53.875 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem, PHONE_STORE.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-05 16:43:53.876 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API) in 19.9073ms
2025-09-05 16:43:53.877 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 16:43:53.878 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - 200 null application/json; charset=utf-8 25.2086ms
2025-09-05 16:43:53.906 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 16:43:53.908 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:43:53.909 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 16:43:53.916 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:43:53.919 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:43:53.923 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 16:43:53.925 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 16:43:53.926 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 15.4182ms
2025-09-05 16:43:53.928 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:43:53.928 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 22.6071ms
2025-09-05 16:43:57.177 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products/iphone-15 - null null
2025-09-05 16:43:57.180 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API)'
2025-09-05 16:43:57.184 +07:00 [INF] Route matched with {action = "Details", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductDetail]] Details(System.String, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 16:43:57.242 +07:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-09-05 16:43:57.282 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[:slug_0='?' (Size = 220)], CommandType='"Text"', CommandTimeout='0']
SELECT "p2"."ID", "p2"."BRAND_ID", "p2"."CREATED_AT", "p2"."DEFAULT_CATEGORY_ID", "p2"."DESCRIPTION", "p2"."IS_ACTIVE", "p2"."NAME", "p2"."SLUG", "p2"."SPEC_JSON", "p0"."ID", "p0"."BARCODE", "p0"."COLOR", "p0"."IS_ACTIVE", "p0"."PRODUCT_ID", "p0"."SKU", "p0"."STORAGE_GB", "p0"."WEIGHT_GRAM", "p1"."ID", "p1"."ALT_TEXT", "p1"."IMAGE_URL", "p1"."IS_PRIMARY", "p1"."PRODUCT_ID", "p1"."SORT_ORDER", "p1"."VARIANT_ID"
FROM (
    SELECT "p"."ID", "p"."BRAND_ID", "p"."CREATED_AT", "p"."DEFAULT_CATEGORY_ID", "p"."DESCRIPTION", "p"."IS_ACTIVE", "p"."NAME", "p"."SLUG", "p"."SPEC_JSON"
    FROM "HEHE"."PRODUCTS" "p"
    WHERE (("p"."SLUG" = :slug_0) AND ("p"."IS_ACTIVE" = 1))
    FETCH FIRST 1 ROWS ONLY
) "p2"
LEFT JOIN "HEHE"."PRODUCT_VARIANTS" "p0" ON "p2"."ID" = "p0"."PRODUCT_ID"
LEFT JOIN "HEHE"."PRODUCT_IMAGES" "p1" ON "p2"."ID" = "p1"."PRODUCT_ID"
ORDER BY "p2"."ID", "p0"."ID"
2025-09-05 16:43:57.338 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."VARIANT_ID" "VariantId", COALESCE((
    SELECT COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")
    FROM "HEHE"."PRODUCT_PRICES" "p0"
    WHERE (((((("p0"."VARIANT_ID" IN (1, 2)) AND ("p0"."STARTS_AT" <= :now_1))) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))) AND ("p"."VARIANT_ID" = "p0"."VARIANT_ID"))
    ORDER BY "p0"."STARTS_AT" DESC
    FETCH FIRST 1 ROWS ONLY), 0.0) "Price"
FROM "HEHE"."PRODUCT_PRICES" "p"
WHERE (((("p"."VARIANT_ID" IN (1, 2)) AND ("p"."STARTS_AT" <= :now_1))) AND ((("p"."ENDS_AT" IS NULL) OR ("p"."ENDS_AT" > :now_2))))
GROUP BY "p"."VARIANT_ID"
2025-09-05 16:43:57.343 +07:00 [INF] Executing OkObjectResult, writing value of type 'PHONE_STORE.API.Controllers.ShopProductsController+ShopProductDetail'.
2025-09-05 16:43:57.354 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API) in 167.7787ms
2025-09-05 16:43:57.355 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API)'
2025-09-05 16:43:57.356 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products/iphone-15 - 200 null application/json; charset=utf-8 179.0691ms
2025-09-05 16:43:57.401 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 16:43:57.404 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:43:57.405 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 16:43:57.409 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:43:57.412 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:43:57.416 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 16:43:57.417 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 16:43:57.418 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 12.0095ms
2025-09-05 16:43:57.419 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:43:57.420 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 18.8406ms
2025-09-05 16:44:00.617 +07:00 [INF] Request starting HTTP/1.1 POST https://localhost:7277/api/shop/cart/items - application/json; charset=utf-8 null
2025-09-05 16:44:00.619 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Add (PHONE_STORE.API)'
2025-09-05 16:44:00.624 +07:00 [INF] Route matched with {action = "Add", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Add(PHONE_STORE.Application.Dtos.CartItemUpsertDto, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 16:44:00.634 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:44:00.642 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64), :dto_VariantId_1='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE"
FROM "HEHE"."CART_ITEMS" "c"
WHERE (("c"."CART_ID" = :id_0) AND ("c"."VARIANT_ID" = :dto_VariantId_1))
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:44:00.698 +07:00 [INF] Executed DbCommand (39ms) [Parameters=[:variantId_0='?' (DbType = Int64), :now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT COALESCE("p"."SALE_PRICE", "p"."LIST_PRICE")
FROM "HEHE"."PRODUCT_PRICES" "p"
WHERE (((("p"."VARIANT_ID" = :variantId_0) AND ("p"."STARTS_AT" <= :now_1))) AND ((("p"."ENDS_AT" IS NULL) OR ("p"."ENDS_AT" >= :now_2))))
ORDER BY "p"."STARTS_AT" DESC
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:44:00.727 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:p0='?' (DbType = Int64), :p1='?' (DbType = Int64), :p2='?' (DbType = DateTime), :p3='?' (Size = 2000), :p4='?' (DbType = Int32), :p5='?' (DbType = Decimal)], CommandType='"Text"', CommandTimeout='0']
DECLARE


BEGIN

INSERT INTO "HEHE"."CART_ITEMS" ("CART_ID", "VARIANT_ID", "ADDED_AT", "CURRENCY", "QUANTITY", "UNIT_PRICE")
VALUES (:p0, :p1, :p2, :p3, :p4, :p5);

END;
2025-09-05 16:44:00.735 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:44:00.739 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:44:00.741 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 16:44:00.743 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 16:44:00.743 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Add (PHONE_STORE.API) in 118.6817ms
2025-09-05 16:44:00.744 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Add (PHONE_STORE.API)'
2025-09-05 16:44:00.745 +07:00 [INF] Request finished HTTP/1.1 POST https://localhost:7277/api/shop/cart/items - 200 null application/json; charset=utf-8 128.2106ms
2025-09-05 16:44:00.751 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products/iphone-15 - null null
2025-09-05 16:44:00.753 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API)'
2025-09-05 16:44:00.754 +07:00 [INF] Route matched with {action = "Details", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductDetail]] Details(System.String, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 16:44:00.758 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:slug_0='?' (Size = 220)], CommandType='"Text"', CommandTimeout='0']
SELECT "p2"."ID", "p2"."BRAND_ID", "p2"."CREATED_AT", "p2"."DEFAULT_CATEGORY_ID", "p2"."DESCRIPTION", "p2"."IS_ACTIVE", "p2"."NAME", "p2"."SLUG", "p2"."SPEC_JSON", "p0"."ID", "p0"."BARCODE", "p0"."COLOR", "p0"."IS_ACTIVE", "p0"."PRODUCT_ID", "p0"."SKU", "p0"."STORAGE_GB", "p0"."WEIGHT_GRAM", "p1"."ID", "p1"."ALT_TEXT", "p1"."IMAGE_URL", "p1"."IS_PRIMARY", "p1"."PRODUCT_ID", "p1"."SORT_ORDER", "p1"."VARIANT_ID"
FROM (
    SELECT "p"."ID", "p"."BRAND_ID", "p"."CREATED_AT", "p"."DEFAULT_CATEGORY_ID", "p"."DESCRIPTION", "p"."IS_ACTIVE", "p"."NAME", "p"."SLUG", "p"."SPEC_JSON"
    FROM "HEHE"."PRODUCTS" "p"
    WHERE (("p"."SLUG" = :slug_0) AND ("p"."IS_ACTIVE" = 1))
    FETCH FIRST 1 ROWS ONLY
) "p2"
LEFT JOIN "HEHE"."PRODUCT_VARIANTS" "p0" ON "p2"."ID" = "p0"."PRODUCT_ID"
LEFT JOIN "HEHE"."PRODUCT_IMAGES" "p1" ON "p2"."ID" = "p1"."PRODUCT_ID"
ORDER BY "p2"."ID", "p0"."ID"
2025-09-05 16:44:00.762 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."VARIANT_ID" "VariantId", COALESCE((
    SELECT COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")
    FROM "HEHE"."PRODUCT_PRICES" "p0"
    WHERE (((((("p0"."VARIANT_ID" IN (1, 2)) AND ("p0"."STARTS_AT" <= :now_1))) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))) AND ("p"."VARIANT_ID" = "p0"."VARIANT_ID"))
    ORDER BY "p0"."STARTS_AT" DESC
    FETCH FIRST 1 ROWS ONLY), 0.0) "Price"
FROM "HEHE"."PRODUCT_PRICES" "p"
WHERE (((("p"."VARIANT_ID" IN (1, 2)) AND ("p"."STARTS_AT" <= :now_1))) AND ((("p"."ENDS_AT" IS NULL) OR ("p"."ENDS_AT" > :now_2))))
GROUP BY "p"."VARIANT_ID"
2025-09-05 16:44:00.764 +07:00 [INF] Executing OkObjectResult, writing value of type 'PHONE_STORE.API.Controllers.ShopProductsController+ShopProductDetail'.
2025-09-05 16:44:00.765 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API) in 9.3226ms
2025-09-05 16:44:00.765 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API)'
2025-09-05 16:44:00.766 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products/iphone-15 - 200 null application/json; charset=utf-8 14.7743ms
2025-09-05 16:44:00.788 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 16:44:00.791 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:44:00.792 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 16:44:00.796 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:44:00.798 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:44:00.801 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 16:44:00.803 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 16:44:00.804 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 11.0711ms
2025-09-05 16:44:00.805 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:44:00.806 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 17.9652ms
2025-09-05 16:44:04.156 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 16:44:04.159 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:44:04.162 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 16:44:04.167 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:44:04.171 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:44:04.174 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 16:44:04.175 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 16:44:04.176 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 12.6487ms
2025-09-05 16:44:04.177 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:44:04.178 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 21.8317ms
2025-09-05 16:44:04.199 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 16:44:04.202 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:44:04.203 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 16:44:04.208 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:44:04.212 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:44:04.219 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 16:44:04.221 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 16:44:04.222 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 18.2082ms
2025-09-05 16:44:04.224 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:44:04.225 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 25.6198ms
2025-09-05 16:44:05.579 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/me/addresses - null null
2025-09-05 16:44:05.583 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopMeController.MyAddresses (PHONE_STORE.API)'
2025-09-05 16:44:05.588 +07:00 [INF] Route matched with {action = "MyAddresses", controller = "ShopMe"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.Application.Dtos.AddressDto]]] MyAddresses(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopMeController (PHONE_STORE.API).
2025-09-05 16:44:05.594 +07:00 [INF] Executing ObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ProblemDetails'.
2025-09-05 16:44:05.610 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopMeController.MyAddresses (PHONE_STORE.API) in 20.5393ms
2025-09-05 16:44:05.611 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopMeController.MyAddresses (PHONE_STORE.API)'
2025-09-05 16:44:05.614 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/me/addresses - 401 null application/problem+json; charset=utf-8 35.6058ms
2025-09-05 16:44:07.587 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 16:44:07.589 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:44:07.589 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 16:44:07.593 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:44:07.596 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:44:07.598 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 16:44:07.600 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 16:44:07.601 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 10.8235ms
2025-09-05 16:44:07.602 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:44:07.603 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 16.4238ms
2025-09-05 16:44:09.379 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - null null
2025-09-05 16:44:09.380 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 16:44:09.381 +07:00 [INF] Route matched with {action = "List", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem]]] List(System.String, System.Nullable`1[System.Int64], Int32, Int32, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 16:44:09.389 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[:p_0='?' (DbType = Int32), :p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."ID" "Id", "p"."NAME" "Name", "p"."SLUG" "Slug"
FROM "HEHE"."PRODUCTS" "p"
WHERE "p"."IS_ACTIVE" = 1
ORDER BY "p"."CREATED_AT" DESC
OFFSET :p_0 ROWS FETCH NEXT :p_1 ROWS ONLY
2025-09-05 16:44:09.396 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", (
    SELECT "p0"."IMAGE_URL"
    FROM "HEHE"."PRODUCT_IMAGES" "p0"
    WHERE (("p0"."PRODUCT_ID" IS NOT NULL AND "p0"."PRODUCT_ID" IN (3, 2, 1)) AND ("p"."PRODUCT_ID" = "p0"."PRODUCT_ID"))
    ORDER BY "p0"."SORT_ORDER"
    FETCH FIRST 1 ROWS ONLY) "Url"
FROM "HEHE"."PRODUCT_IMAGES" "p"
WHERE "p"."PRODUCT_ID" IS NOT NULL AND "p"."PRODUCT_ID" IN (3, 2, 1)
GROUP BY "p"."PRODUCT_ID"
2025-09-05 16:44:09.400 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", MIN(COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")) "MinPrice"
FROM "HEHE"."PRODUCT_VARIANTS" "p"
INNER JOIN "HEHE"."PRODUCT_PRICES" "p0" ON "p"."ID" = "p0"."VARIANT_ID"
WHERE (("p"."PRODUCT_ID" IN (3, 2, 1)) AND ((("p0"."STARTS_AT" <= :now_1) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))))
GROUP BY "p"."PRODUCT_ID"
2025-09-05 16:44:09.402 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem, PHONE_STORE.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-05 16:44:09.403 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API) in 20.2323ms
2025-09-05 16:44:09.404 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 16:44:09.405 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - 200 null application/json; charset=utf-8 25.976ms
2025-09-05 16:44:09.426 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 16:44:09.429 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:44:09.431 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 16:44:09.436 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:44:09.440 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:44:09.444 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 16:44:09.446 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 16:44:09.447 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 15.2486ms
2025-09-05 16:44:09.448 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:44:09.449 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 23.5926ms
2025-09-05 16:44:12.100 +07:00 [INF] Request starting HTTP/1.1 POST https://localhost:7277/api/auth/logout - application/json; charset=utf-8 null
2025-09-05 16:44:12.103 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.AuthController.Logout (PHONE_STORE.API)'
2025-09-05 16:44:12.107 +07:00 [INF] Route matched with {action = "Logout", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Logout(RefreshRequest, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.AuthController (PHONE_STORE.API).
2025-09-05 16:44:12.115 +07:00 [INF] Logout: revoked RT
2025-09-05 16:44:12.115 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType1`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-05 16:44:12.119 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.AuthController.Logout (PHONE_STORE.API) in 11.1631ms
2025-09-05 16:44:12.120 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.AuthController.Logout (PHONE_STORE.API)'
2025-09-05 16:44:12.121 +07:00 [INF] Request finished HTTP/1.1 POST https://localhost:7277/api/auth/logout - 200 null application/json; charset=utf-8 20.951ms
2025-09-05 16:44:12.131 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - null null
2025-09-05 16:44:12.132 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 16:44:12.133 +07:00 [INF] Route matched with {action = "List", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem]]] List(System.String, System.Nullable`1[System.Int64], Int32, Int32, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 16:44:12.137 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:p_0='?' (DbType = Int32), :p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."ID" "Id", "p"."NAME" "Name", "p"."SLUG" "Slug"
FROM "HEHE"."PRODUCTS" "p"
WHERE "p"."IS_ACTIVE" = 1
ORDER BY "p"."CREATED_AT" DESC
OFFSET :p_0 ROWS FETCH NEXT :p_1 ROWS ONLY
2025-09-05 16:44:12.140 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", (
    SELECT "p0"."IMAGE_URL"
    FROM "HEHE"."PRODUCT_IMAGES" "p0"
    WHERE (("p0"."PRODUCT_ID" IS NOT NULL AND "p0"."PRODUCT_ID" IN (3, 2, 1)) AND ("p"."PRODUCT_ID" = "p0"."PRODUCT_ID"))
    ORDER BY "p0"."SORT_ORDER"
    FETCH FIRST 1 ROWS ONLY) "Url"
FROM "HEHE"."PRODUCT_IMAGES" "p"
WHERE "p"."PRODUCT_ID" IS NOT NULL AND "p"."PRODUCT_ID" IN (3, 2, 1)
GROUP BY "p"."PRODUCT_ID"
2025-09-05 16:44:12.143 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", MIN(COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")) "MinPrice"
FROM "HEHE"."PRODUCT_VARIANTS" "p"
INNER JOIN "HEHE"."PRODUCT_PRICES" "p0" ON "p"."ID" = "p0"."VARIANT_ID"
WHERE (("p"."PRODUCT_ID" IN (3, 2, 1)) AND ((("p0"."STARTS_AT" <= :now_1) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))))
GROUP BY "p"."PRODUCT_ID"
2025-09-05 16:44:12.145 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem, PHONE_STORE.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-05 16:44:12.146 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API) in 12.7047ms
2025-09-05 16:44:12.147 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 16:44:12.148 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - 200 null application/json; charset=utf-8 17.2072ms
2025-09-05 16:44:12.168 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 16:44:12.170 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:44:12.171 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 16:44:12.175 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:44:12.178 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:44:12.182 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 16:44:12.184 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 16:44:12.185 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 13.103ms
2025-09-05 16:44:12.187 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:44:12.187 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 19.8707ms
2025-09-05 16:44:14.513 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - null null
2025-09-05 16:44:14.515 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 16:44:14.515 +07:00 [INF] Route matched with {action = "List", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem]]] List(System.String, System.Nullable`1[System.Int64], Int32, Int32, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 16:44:14.519 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:p_0='?' (DbType = Int32), :p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."ID" "Id", "p"."NAME" "Name", "p"."SLUG" "Slug"
FROM "HEHE"."PRODUCTS" "p"
WHERE "p"."IS_ACTIVE" = 1
ORDER BY "p"."CREATED_AT" DESC
OFFSET :p_0 ROWS FETCH NEXT :p_1 ROWS ONLY
2025-09-05 16:44:14.522 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", (
    SELECT "p0"."IMAGE_URL"
    FROM "HEHE"."PRODUCT_IMAGES" "p0"
    WHERE (("p0"."PRODUCT_ID" IS NOT NULL AND "p0"."PRODUCT_ID" IN (3, 2, 1)) AND ("p"."PRODUCT_ID" = "p0"."PRODUCT_ID"))
    ORDER BY "p0"."SORT_ORDER"
    FETCH FIRST 1 ROWS ONLY) "Url"
FROM "HEHE"."PRODUCT_IMAGES" "p"
WHERE "p"."PRODUCT_ID" IS NOT NULL AND "p"."PRODUCT_ID" IN (3, 2, 1)
GROUP BY "p"."PRODUCT_ID"
2025-09-05 16:44:14.525 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", MIN(COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")) "MinPrice"
FROM "HEHE"."PRODUCT_VARIANTS" "p"
INNER JOIN "HEHE"."PRODUCT_PRICES" "p0" ON "p"."ID" = "p0"."VARIANT_ID"
WHERE (("p"."PRODUCT_ID" IN (3, 2, 1)) AND ((("p0"."STARTS_AT" <= :now_1) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))))
GROUP BY "p"."PRODUCT_ID"
2025-09-05 16:44:14.526 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem, PHONE_STORE.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-05 16:44:14.527 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API) in 11.1201ms
2025-09-05 16:44:14.528 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 16:44:14.529 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - 200 null application/json; charset=utf-8 15.7309ms
2025-09-05 16:44:14.553 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 16:44:14.555 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:44:14.556 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 16:44:14.561 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:44:14.566 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:44:14.569 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 16:44:14.571 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 16:44:14.572 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 14.7642ms
2025-09-05 16:44:14.573 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:44:14.574 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 20.7886ms
2025-09-05 16:44:34.108 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 16:44:34.110 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:44:34.111 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 16:44:34.119 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:44:34.131 +07:00 [INF] Executed DbCommand (8ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:44:34.139 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 16:44:34.142 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 16:44:34.144 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 30.7825ms
2025-09-05 16:44:34.145 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:44:34.145 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 37.7391ms
2025-09-05 16:44:40.540 +07:00 [INF] Request starting HTTP/1.1 POST https://localhost:7277/api/auth/login - application/json; charset=utf-8 null
2025-09-05 16:44:40.542 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.AuthController.Login (PHONE_STORE.API)'
2025-09-05 16:44:40.542 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(LoginRequest, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.AuthController (PHONE_STORE.API).
2025-09-05 16:44:40.552 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:uname_0='?' (Size = 450), :username_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='0']
SELECT "u"."ID", "u"."CREATED_AT", "u"."EMAIL", "u"."PASSWORD_HASH", "u"."PHONE", "u"."STATUS"
FROM "USER_ACCOUNTS" "u"
WHERE (("u"."EMAIL" = :uname_0) OR ("u"."PHONE" = :username_1))
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:44:40.852 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:userId_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "r"."CODE"
FROM "USER_ROLES" "u"
INNER JOIN "ROLES" "r" ON "u"."ROLE_ID" = "r"."ID"
WHERE "u"."USER_ID" = :userId_0
2025-09-05 16:44:40.861 +07:00 [INF] Login success [21]
2025-09-05 16:44:40.863 +07:00 [INF] Executing OkObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.AuthResponseDto'.
2025-09-05 16:44:40.866 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.AuthController.Login (PHONE_STORE.API) in 323.1464ms
2025-09-05 16:44:40.867 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.AuthController.Login (PHONE_STORE.API)'
2025-09-05 16:44:40.867 +07:00 [INF] Request finished HTTP/1.1 POST https://localhost:7277/api/auth/login - 200 null application/json; charset=utf-8 327.5618ms
2025-09-05 16:44:40.869 +07:00 [INF] Request starting HTTP/1.1 POST https://localhost:7277/api/shop/cart/merge - null 0
2025-09-05 16:44:40.871 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Merge (PHONE_STORE.API)'
2025-09-05 16:44:40.872 +07:00 [INF] Route matched with {action = "Merge", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Merge(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 16:44:40.874 +07:00 [INF] Executing StatusCodeResult, setting HTTP status code 200
2025-09-05 16:44:40.874 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Merge (PHONE_STORE.API) in 1.2828ms
2025-09-05 16:44:40.876 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Merge (PHONE_STORE.API)'
2025-09-05 16:44:40.877 +07:00 [INF] Request finished HTTP/1.1 POST https://localhost:7277/api/shop/cart/merge - 200 0 null 7.8908ms
2025-09-05 16:44:40.888 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - null null
2025-09-05 16:44:40.889 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 16:44:40.890 +07:00 [INF] Route matched with {action = "List", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem]]] List(System.String, System.Nullable`1[System.Int64], Int32, Int32, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 16:44:40.893 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:p_0='?' (DbType = Int32), :p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."ID" "Id", "p"."NAME" "Name", "p"."SLUG" "Slug"
FROM "HEHE"."PRODUCTS" "p"
WHERE "p"."IS_ACTIVE" = 1
ORDER BY "p"."CREATED_AT" DESC
OFFSET :p_0 ROWS FETCH NEXT :p_1 ROWS ONLY
2025-09-05 16:44:40.901 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", (
    SELECT "p0"."IMAGE_URL"
    FROM "HEHE"."PRODUCT_IMAGES" "p0"
    WHERE (("p0"."PRODUCT_ID" IS NOT NULL AND "p0"."PRODUCT_ID" IN (3, 2, 1)) AND ("p"."PRODUCT_ID" = "p0"."PRODUCT_ID"))
    ORDER BY "p0"."SORT_ORDER"
    FETCH FIRST 1 ROWS ONLY) "Url"
FROM "HEHE"."PRODUCT_IMAGES" "p"
WHERE "p"."PRODUCT_ID" IS NOT NULL AND "p"."PRODUCT_ID" IN (3, 2, 1)
GROUP BY "p"."PRODUCT_ID"
2025-09-05 16:44:40.908 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", MIN(COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")) "MinPrice"
FROM "HEHE"."PRODUCT_VARIANTS" "p"
INNER JOIN "HEHE"."PRODUCT_PRICES" "p0" ON "p"."ID" = "p0"."VARIANT_ID"
WHERE (("p"."PRODUCT_ID" IN (3, 2, 1)) AND ((("p0"."STARTS_AT" <= :now_1) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))))
GROUP BY "p"."PRODUCT_ID"
2025-09-05 16:44:40.910 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem, PHONE_STORE.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-05 16:44:40.912 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API) in 20.52ms
2025-09-05 16:44:40.912 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 16:44:40.914 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - 200 null application/json; charset=utf-8 26.2301ms
2025-09-05 16:44:40.937 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 16:44:40.939 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:44:40.941 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 16:44:40.945 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:44:40.950 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:44:40.954 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 16:44:40.956 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 16:44:40.958 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 15.4301ms
2025-09-05 16:44:40.959 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:44:40.959 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 22.5315ms
2025-09-05 16:44:43.752 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products/iphone-15 - null null
2025-09-05 16:44:43.754 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API)'
2025-09-05 16:44:43.756 +07:00 [INF] Route matched with {action = "Details", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductDetail]] Details(System.String, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 16:44:43.771 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:slug_0='?' (Size = 220)], CommandType='"Text"', CommandTimeout='0']
SELECT "p2"."ID", "p2"."BRAND_ID", "p2"."CREATED_AT", "p2"."DEFAULT_CATEGORY_ID", "p2"."DESCRIPTION", "p2"."IS_ACTIVE", "p2"."NAME", "p2"."SLUG", "p2"."SPEC_JSON", "p0"."ID", "p0"."BARCODE", "p0"."COLOR", "p0"."IS_ACTIVE", "p0"."PRODUCT_ID", "p0"."SKU", "p0"."STORAGE_GB", "p0"."WEIGHT_GRAM", "p1"."ID", "p1"."ALT_TEXT", "p1"."IMAGE_URL", "p1"."IS_PRIMARY", "p1"."PRODUCT_ID", "p1"."SORT_ORDER", "p1"."VARIANT_ID"
FROM (
    SELECT "p"."ID", "p"."BRAND_ID", "p"."CREATED_AT", "p"."DEFAULT_CATEGORY_ID", "p"."DESCRIPTION", "p"."IS_ACTIVE", "p"."NAME", "p"."SLUG", "p"."SPEC_JSON"
    FROM "HEHE"."PRODUCTS" "p"
    WHERE (("p"."SLUG" = :slug_0) AND ("p"."IS_ACTIVE" = 1))
    FETCH FIRST 1 ROWS ONLY
) "p2"
LEFT JOIN "HEHE"."PRODUCT_VARIANTS" "p0" ON "p2"."ID" = "p0"."PRODUCT_ID"
LEFT JOIN "HEHE"."PRODUCT_IMAGES" "p1" ON "p2"."ID" = "p1"."PRODUCT_ID"
ORDER BY "p2"."ID", "p0"."ID"
2025-09-05 16:44:43.776 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."VARIANT_ID" "VariantId", COALESCE((
    SELECT COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")
    FROM "HEHE"."PRODUCT_PRICES" "p0"
    WHERE (((((("p0"."VARIANT_ID" IN (1, 2)) AND ("p0"."STARTS_AT" <= :now_1))) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))) AND ("p"."VARIANT_ID" = "p0"."VARIANT_ID"))
    ORDER BY "p0"."STARTS_AT" DESC
    FETCH FIRST 1 ROWS ONLY), 0.0) "Price"
FROM "HEHE"."PRODUCT_PRICES" "p"
WHERE (((("p"."VARIANT_ID" IN (1, 2)) AND ("p"."STARTS_AT" <= :now_1))) AND ((("p"."ENDS_AT" IS NULL) OR ("p"."ENDS_AT" > :now_2))))
GROUP BY "p"."VARIANT_ID"
2025-09-05 16:44:43.778 +07:00 [INF] Executing OkObjectResult, writing value of type 'PHONE_STORE.API.Controllers.ShopProductsController+ShopProductDetail'.
2025-09-05 16:44:43.779 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API) in 21.5727ms
2025-09-05 16:44:43.780 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API)'
2025-09-05 16:44:43.781 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products/iphone-15 - 200 null application/json; charset=utf-8 28.5636ms
2025-09-05 16:44:43.805 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 16:44:43.808 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:44:43.809 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 16:44:43.812 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:44:43.816 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:44:43.818 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 16:44:43.820 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 16:44:43.821 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 10.7696ms
2025-09-05 16:44:43.822 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:44:43.823 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 18.2854ms
2025-09-05 16:44:46.379 +07:00 [INF] Request starting HTTP/1.1 POST https://localhost:7277/api/shop/cart/items - application/json; charset=utf-8 null
2025-09-05 16:44:46.381 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Add (PHONE_STORE.API)'
2025-09-05 16:44:46.382 +07:00 [INF] Route matched with {action = "Add", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Add(PHONE_STORE.Application.Dtos.CartItemUpsertDto, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 16:44:46.386 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:44:46.389 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64), :dto_VariantId_1='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE"
FROM "HEHE"."CART_ITEMS" "c"
WHERE (("c"."CART_ID" = :id_0) AND ("c"."VARIANT_ID" = :dto_VariantId_1))
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:44:46.391 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[:variantId_0='?' (DbType = Int64), :now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT COALESCE("p"."SALE_PRICE", "p"."LIST_PRICE")
FROM "HEHE"."PRODUCT_PRICES" "p"
WHERE (((("p"."VARIANT_ID" = :variantId_0) AND ("p"."STARTS_AT" <= :now_1))) AND ((("p"."ENDS_AT" IS NULL) OR ("p"."ENDS_AT" >= :now_2))))
ORDER BY "p"."STARTS_AT" DESC
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:44:46.394 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:p0='?' (DbType = Int64), :p1='?' (DbType = Int64), :p2='?' (DbType = DateTime), :p3='?' (Size = 2000), :p4='?' (DbType = Int32), :p5='?' (DbType = Decimal)], CommandType='"Text"', CommandTimeout='0']
DECLARE


BEGIN

INSERT INTO "HEHE"."CART_ITEMS" ("CART_ID", "VARIANT_ID", "ADDED_AT", "CURRENCY", "QUANTITY", "UNIT_PRICE")
VALUES (:p0, :p1, :p2, :p3, :p4, :p5);

END;
2025-09-05 16:44:46.408 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:44:46.410 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:44:46.412 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 16:44:46.415 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 16:44:46.415 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Add (PHONE_STORE.API) in 31.6865ms
2025-09-05 16:44:46.416 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Add (PHONE_STORE.API)'
2025-09-05 16:44:46.417 +07:00 [INF] Request finished HTTP/1.1 POST https://localhost:7277/api/shop/cart/items - 200 null application/json; charset=utf-8 37.1874ms
2025-09-05 16:44:46.421 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products/iphone-15 - null null
2025-09-05 16:44:46.422 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API)'
2025-09-05 16:44:46.423 +07:00 [INF] Route matched with {action = "Details", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductDetail]] Details(System.String, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 16:44:46.426 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:slug_0='?' (Size = 220)], CommandType='"Text"', CommandTimeout='0']
SELECT "p2"."ID", "p2"."BRAND_ID", "p2"."CREATED_AT", "p2"."DEFAULT_CATEGORY_ID", "p2"."DESCRIPTION", "p2"."IS_ACTIVE", "p2"."NAME", "p2"."SLUG", "p2"."SPEC_JSON", "p0"."ID", "p0"."BARCODE", "p0"."COLOR", "p0"."IS_ACTIVE", "p0"."PRODUCT_ID", "p0"."SKU", "p0"."STORAGE_GB", "p0"."WEIGHT_GRAM", "p1"."ID", "p1"."ALT_TEXT", "p1"."IMAGE_URL", "p1"."IS_PRIMARY", "p1"."PRODUCT_ID", "p1"."SORT_ORDER", "p1"."VARIANT_ID"
FROM (
    SELECT "p"."ID", "p"."BRAND_ID", "p"."CREATED_AT", "p"."DEFAULT_CATEGORY_ID", "p"."DESCRIPTION", "p"."IS_ACTIVE", "p"."NAME", "p"."SLUG", "p"."SPEC_JSON"
    FROM "HEHE"."PRODUCTS" "p"
    WHERE (("p"."SLUG" = :slug_0) AND ("p"."IS_ACTIVE" = 1))
    FETCH FIRST 1 ROWS ONLY
) "p2"
LEFT JOIN "HEHE"."PRODUCT_VARIANTS" "p0" ON "p2"."ID" = "p0"."PRODUCT_ID"
LEFT JOIN "HEHE"."PRODUCT_IMAGES" "p1" ON "p2"."ID" = "p1"."PRODUCT_ID"
ORDER BY "p2"."ID", "p0"."ID"
2025-09-05 16:44:46.429 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."VARIANT_ID" "VariantId", COALESCE((
    SELECT COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")
    FROM "HEHE"."PRODUCT_PRICES" "p0"
    WHERE (((((("p0"."VARIANT_ID" IN (1, 2)) AND ("p0"."STARTS_AT" <= :now_1))) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))) AND ("p"."VARIANT_ID" = "p0"."VARIANT_ID"))
    ORDER BY "p0"."STARTS_AT" DESC
    FETCH FIRST 1 ROWS ONLY), 0.0) "Price"
FROM "HEHE"."PRODUCT_PRICES" "p"
WHERE (((("p"."VARIANT_ID" IN (1, 2)) AND ("p"."STARTS_AT" <= :now_1))) AND ((("p"."ENDS_AT" IS NULL) OR ("p"."ENDS_AT" > :now_2))))
GROUP BY "p"."VARIANT_ID"
2025-09-05 16:44:46.432 +07:00 [INF] Executing OkObjectResult, writing value of type 'PHONE_STORE.API.Controllers.ShopProductsController+ShopProductDetail'.
2025-09-05 16:44:46.433 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API) in 8.8603ms
2025-09-05 16:44:46.433 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API)'
2025-09-05 16:44:46.434 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products/iphone-15 - 200 null application/json; charset=utf-8 12.9611ms
2025-09-05 16:44:46.454 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 16:44:46.456 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:44:46.456 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 16:44:46.460 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:44:46.462 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:44:46.466 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 16:44:46.468 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 16:44:46.468 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 10.8567ms
2025-09-05 16:44:46.469 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:44:46.470 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 15.6487ms
2025-09-05 16:44:47.766 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 16:44:47.768 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:44:47.769 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 16:44:47.772 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:44:47.775 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:44:47.778 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 16:44:47.780 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 16:44:47.781 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 11.7853ms
2025-09-05 16:44:47.782 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:44:47.783 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 16.8798ms
2025-09-05 16:44:47.803 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 16:44:47.805 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:44:47.806 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 16:44:47.811 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:44:47.816 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:44:47.821 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 16:44:47.823 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 16:44:47.825 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 17.529ms
2025-09-05 16:44:47.826 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:44:47.826 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 23.8655ms
2025-09-05 16:44:50.343 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - null null
2025-09-05 16:44:50.345 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 16:44:50.346 +07:00 [INF] Route matched with {action = "List", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem]]] List(System.String, System.Nullable`1[System.Int64], Int32, Int32, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 16:44:50.350 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:p_0='?' (DbType = Int32), :p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."ID" "Id", "p"."NAME" "Name", "p"."SLUG" "Slug"
FROM "HEHE"."PRODUCTS" "p"
WHERE "p"."IS_ACTIVE" = 1
ORDER BY "p"."CREATED_AT" DESC
OFFSET :p_0 ROWS FETCH NEXT :p_1 ROWS ONLY
2025-09-05 16:44:50.354 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", (
    SELECT "p0"."IMAGE_URL"
    FROM "HEHE"."PRODUCT_IMAGES" "p0"
    WHERE (("p0"."PRODUCT_ID" IS NOT NULL AND "p0"."PRODUCT_ID" IN (3, 2, 1)) AND ("p"."PRODUCT_ID" = "p0"."PRODUCT_ID"))
    ORDER BY "p0"."SORT_ORDER"
    FETCH FIRST 1 ROWS ONLY) "Url"
FROM "HEHE"."PRODUCT_IMAGES" "p"
WHERE "p"."PRODUCT_ID" IS NOT NULL AND "p"."PRODUCT_ID" IN (3, 2, 1)
GROUP BY "p"."PRODUCT_ID"
2025-09-05 16:44:50.357 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", MIN(COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")) "MinPrice"
FROM "HEHE"."PRODUCT_VARIANTS" "p"
INNER JOIN "HEHE"."PRODUCT_PRICES" "p0" ON "p"."ID" = "p0"."VARIANT_ID"
WHERE (("p"."PRODUCT_ID" IN (3, 2, 1)) AND ((("p0"."STARTS_AT" <= :now_1) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))))
GROUP BY "p"."PRODUCT_ID"
2025-09-05 16:44:50.358 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem, PHONE_STORE.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-05 16:44:50.359 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API) in 11.8677ms
2025-09-05 16:44:50.360 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 16:44:50.361 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - 200 null application/json; charset=utf-8 17.4634ms
2025-09-05 16:44:50.380 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 16:44:50.383 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:44:50.384 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 16:44:50.387 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:44:50.391 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:44:50.394 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 16:44:50.396 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 16:44:50.397 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 12.1229ms
2025-09-05 16:44:50.399 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:44:50.399 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 18.9858ms
2025-09-05 16:47:24.736 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - null null
2025-09-05 16:47:24.777 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 16:47:24.778 +07:00 [INF] Route matched with {action = "List", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem]]] List(System.String, System.Nullable`1[System.Int64], Int32, Int32, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 16:47:24.785 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:p_0='?' (DbType = Int32), :p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."ID" "Id", "p"."NAME" "Name", "p"."SLUG" "Slug"
FROM "HEHE"."PRODUCTS" "p"
WHERE "p"."IS_ACTIVE" = 1
ORDER BY "p"."CREATED_AT" DESC
OFFSET :p_0 ROWS FETCH NEXT :p_1 ROWS ONLY
2025-09-05 16:47:24.796 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", (
    SELECT "p0"."IMAGE_URL"
    FROM "HEHE"."PRODUCT_IMAGES" "p0"
    WHERE (("p0"."PRODUCT_ID" IS NOT NULL AND "p0"."PRODUCT_ID" IN (3, 2, 1)) AND ("p"."PRODUCT_ID" = "p0"."PRODUCT_ID"))
    ORDER BY "p0"."SORT_ORDER"
    FETCH FIRST 1 ROWS ONLY) "Url"
FROM "HEHE"."PRODUCT_IMAGES" "p"
WHERE "p"."PRODUCT_ID" IS NOT NULL AND "p"."PRODUCT_ID" IN (3, 2, 1)
GROUP BY "p"."PRODUCT_ID"
2025-09-05 16:47:24.801 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", MIN(COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")) "MinPrice"
FROM "HEHE"."PRODUCT_VARIANTS" "p"
INNER JOIN "HEHE"."PRODUCT_PRICES" "p0" ON "p"."ID" = "p0"."VARIANT_ID"
WHERE (("p"."PRODUCT_ID" IN (3, 2, 1)) AND ((("p0"."STARTS_AT" <= :now_1) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))))
GROUP BY "p"."PRODUCT_ID"
2025-09-05 16:47:24.803 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem, PHONE_STORE.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-05 16:47:24.804 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API) in 24.6077ms
2025-09-05 16:47:24.805 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 16:47:24.805 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - 200 null application/json; charset=utf-8 69.1369ms
2025-09-05 16:47:24.841 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 16:47:24.845 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:47:24.846 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 16:47:24.855 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:47:24.867 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:47:24.870 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 16:47:24.872 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 16:47:24.873 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 24.7895ms
2025-09-05 16:47:24.873 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:47:24.874 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 33.3262ms
2025-09-05 16:47:26.373 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 16:47:26.376 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:47:26.377 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 16:47:26.380 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:47:26.383 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:47:26.385 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 16:47:26.387 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 16:47:26.387 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 9.7712ms
2025-09-05 16:47:26.388 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:47:26.389 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 15.9066ms
2025-09-05 16:47:26.414 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 16:47:26.416 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:47:26.417 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 16:47:26.422 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:47:26.426 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:47:26.430 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 16:47:26.432 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 16:47:26.433 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 15.3679ms
2025-09-05 16:47:26.434 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:47:26.435 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 20.8018ms
2025-09-05 16:47:28.020 +07:00 [INF] Request starting HTTP/1.1 PUT https://localhost:7277/api/shop/cart/items/1?qty=1 - null 0
2025-09-05 16:47:28.022 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Update (PHONE_STORE.API)'
2025-09-05 16:47:28.025 +07:00 [INF] Route matched with {action = "Update", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Update(Int64, Int32, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 16:47:28.031 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:47:28.034 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64), :itemId_1='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE"
FROM "HEHE"."CART_ITEMS" "c"
WHERE (("c"."CART_ID" = :id_0) AND ("c"."VARIANT_ID" = :itemId_1))
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:47:28.037 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:47:28.039 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:47:28.041 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 16:47:28.043 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 16:47:28.044 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Update (PHONE_STORE.API) in 17.6296ms
2025-09-05 16:47:28.045 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Update (PHONE_STORE.API)'
2025-09-05 16:47:28.046 +07:00 [INF] Request finished HTTP/1.1 PUT https://localhost:7277/api/shop/cart/items/1?qty=1 - 200 null application/json; charset=utf-8 26.0565ms
2025-09-05 16:47:28.050 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 16:47:28.051 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:47:28.052 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 16:47:28.055 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:47:28.057 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:47:28.060 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 16:47:28.062 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 16:47:28.062 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 9.4151ms
2025-09-05 16:47:28.063 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:47:28.063 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 13.5246ms
2025-09-05 16:47:28.083 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 16:47:28.087 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:47:28.087 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 16:47:28.091 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:47:28.094 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:47:28.098 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 16:47:28.100 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 16:47:28.102 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 13.5267ms
2025-09-05 16:47:28.103 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:47:28.103 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 20.6434ms
2025-09-05 16:47:30.678 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - null null
2025-09-05 16:47:30.681 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 16:47:30.682 +07:00 [INF] Route matched with {action = "List", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem]]] List(System.String, System.Nullable`1[System.Int64], Int32, Int32, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 16:47:30.685 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:p_0='?' (DbType = Int32), :p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."ID" "Id", "p"."NAME" "Name", "p"."SLUG" "Slug"
FROM "HEHE"."PRODUCTS" "p"
WHERE "p"."IS_ACTIVE" = 1
ORDER BY "p"."CREATED_AT" DESC
OFFSET :p_0 ROWS FETCH NEXT :p_1 ROWS ONLY
2025-09-05 16:47:30.689 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", (
    SELECT "p0"."IMAGE_URL"
    FROM "HEHE"."PRODUCT_IMAGES" "p0"
    WHERE (("p0"."PRODUCT_ID" IS NOT NULL AND "p0"."PRODUCT_ID" IN (3, 2, 1)) AND ("p"."PRODUCT_ID" = "p0"."PRODUCT_ID"))
    ORDER BY "p0"."SORT_ORDER"
    FETCH FIRST 1 ROWS ONLY) "Url"
FROM "HEHE"."PRODUCT_IMAGES" "p"
WHERE "p"."PRODUCT_ID" IS NOT NULL AND "p"."PRODUCT_ID" IN (3, 2, 1)
GROUP BY "p"."PRODUCT_ID"
2025-09-05 16:47:30.692 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", MIN(COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")) "MinPrice"
FROM "HEHE"."PRODUCT_VARIANTS" "p"
INNER JOIN "HEHE"."PRODUCT_PRICES" "p0" ON "p"."ID" = "p0"."VARIANT_ID"
WHERE (("p"."PRODUCT_ID" IN (3, 2, 1)) AND ((("p0"."STARTS_AT" <= :now_1) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))))
GROUP BY "p"."PRODUCT_ID"
2025-09-05 16:47:30.694 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem, PHONE_STORE.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-05 16:47:30.695 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API) in 11.9089ms
2025-09-05 16:47:30.696 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 16:47:30.696 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - 200 null application/json; charset=utf-8 18.2825ms
2025-09-05 16:47:30.728 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 16:47:30.734 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:47:30.736 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 16:47:30.742 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:47:30.745 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:47:30.748 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 16:47:30.750 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 16:47:30.750 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 12.5589ms
2025-09-05 16:47:30.751 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:47:30.752 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 23.7242ms
2025-09-05 16:47:32.505 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products/iphone-15 - null null
2025-09-05 16:47:32.507 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API)'
2025-09-05 16:47:32.508 +07:00 [INF] Route matched with {action = "Details", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductDetail]] Details(System.String, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 16:47:32.512 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:slug_0='?' (Size = 220)], CommandType='"Text"', CommandTimeout='0']
SELECT "p2"."ID", "p2"."BRAND_ID", "p2"."CREATED_AT", "p2"."DEFAULT_CATEGORY_ID", "p2"."DESCRIPTION", "p2"."IS_ACTIVE", "p2"."NAME", "p2"."SLUG", "p2"."SPEC_JSON", "p0"."ID", "p0"."BARCODE", "p0"."COLOR", "p0"."IS_ACTIVE", "p0"."PRODUCT_ID", "p0"."SKU", "p0"."STORAGE_GB", "p0"."WEIGHT_GRAM", "p1"."ID", "p1"."ALT_TEXT", "p1"."IMAGE_URL", "p1"."IS_PRIMARY", "p1"."PRODUCT_ID", "p1"."SORT_ORDER", "p1"."VARIANT_ID"
FROM (
    SELECT "p"."ID", "p"."BRAND_ID", "p"."CREATED_AT", "p"."DEFAULT_CATEGORY_ID", "p"."DESCRIPTION", "p"."IS_ACTIVE", "p"."NAME", "p"."SLUG", "p"."SPEC_JSON"
    FROM "HEHE"."PRODUCTS" "p"
    WHERE (("p"."SLUG" = :slug_0) AND ("p"."IS_ACTIVE" = 1))
    FETCH FIRST 1 ROWS ONLY
) "p2"
LEFT JOIN "HEHE"."PRODUCT_VARIANTS" "p0" ON "p2"."ID" = "p0"."PRODUCT_ID"
LEFT JOIN "HEHE"."PRODUCT_IMAGES" "p1" ON "p2"."ID" = "p1"."PRODUCT_ID"
ORDER BY "p2"."ID", "p0"."ID"
2025-09-05 16:47:32.516 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."VARIANT_ID" "VariantId", COALESCE((
    SELECT COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")
    FROM "HEHE"."PRODUCT_PRICES" "p0"
    WHERE (((((("p0"."VARIANT_ID" IN (1, 2)) AND ("p0"."STARTS_AT" <= :now_1))) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))) AND ("p"."VARIANT_ID" = "p0"."VARIANT_ID"))
    ORDER BY "p0"."STARTS_AT" DESC
    FETCH FIRST 1 ROWS ONLY), 0.0) "Price"
FROM "HEHE"."PRODUCT_PRICES" "p"
WHERE (((("p"."VARIANT_ID" IN (1, 2)) AND ("p"."STARTS_AT" <= :now_1))) AND ((("p"."ENDS_AT" IS NULL) OR ("p"."ENDS_AT" > :now_2))))
GROUP BY "p"."VARIANT_ID"
2025-09-05 16:47:32.518 +07:00 [INF] Executing OkObjectResult, writing value of type 'PHONE_STORE.API.Controllers.ShopProductsController+ShopProductDetail'.
2025-09-05 16:47:32.519 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API) in 9.5021ms
2025-09-05 16:47:32.520 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API)'
2025-09-05 16:47:32.520 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products/iphone-15 - 200 null application/json; charset=utf-8 15.5085ms
2025-09-05 16:47:32.539 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 16:47:32.543 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:47:32.545 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 16:47:32.552 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:47:32.555 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:47:32.558 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 16:47:32.560 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 16:47:32.560 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 11.2439ms
2025-09-05 16:47:32.561 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:47:32.562 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 22.7325ms
2025-09-05 16:47:34.002 +07:00 [INF] Request starting HTTP/1.1 POST https://localhost:7277/api/shop/cart/items - application/json; charset=utf-8 null
2025-09-05 16:47:34.004 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Add (PHONE_STORE.API)'
2025-09-05 16:47:34.005 +07:00 [INF] Route matched with {action = "Add", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Add(PHONE_STORE.Application.Dtos.CartItemUpsertDto, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 16:47:34.008 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:47:34.012 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64), :dto_VariantId_1='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE"
FROM "HEHE"."CART_ITEMS" "c"
WHERE (("c"."CART_ID" = :id_0) AND ("c"."VARIANT_ID" = :dto_VariantId_1))
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:47:34.018 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:p1='?' (DbType = Int64), :p2='?' (DbType = Int64), :p0='?' (DbType = Int32), :cur0='?' (Direction = Output) (DbType = Object)], CommandType='"Text"', CommandTimeout='0']
DECLARE

v_RowCount INTEGER;

BEGIN

UPDATE "HEHE"."CART_ITEMS" SET "QUANTITY" = :p0
WHERE "CART_ID" = :p1 AND "VARIANT_ID" = :p2;
v_RowCount := SQL%ROWCOUNT;
OPEN :cur0 FOR SELECT v_RowCount FROM DUAL;

END;
2025-09-05 16:47:34.031 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:47:34.034 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:47:34.036 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 16:47:34.037 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 16:47:34.038 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Add (PHONE_STORE.API) in 32.7319ms
2025-09-05 16:47:34.039 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Add (PHONE_STORE.API)'
2025-09-05 16:47:34.039 +07:00 [INF] Request finished HTTP/1.1 POST https://localhost:7277/api/shop/cart/items - 200 null application/json; charset=utf-8 37.126ms
2025-09-05 16:47:34.046 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products/iphone-15 - null null
2025-09-05 16:47:34.048 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API)'
2025-09-05 16:47:34.049 +07:00 [INF] Route matched with {action = "Details", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductDetail]] Details(System.String, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 16:47:34.053 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:slug_0='?' (Size = 220)], CommandType='"Text"', CommandTimeout='0']
SELECT "p2"."ID", "p2"."BRAND_ID", "p2"."CREATED_AT", "p2"."DEFAULT_CATEGORY_ID", "p2"."DESCRIPTION", "p2"."IS_ACTIVE", "p2"."NAME", "p2"."SLUG", "p2"."SPEC_JSON", "p0"."ID", "p0"."BARCODE", "p0"."COLOR", "p0"."IS_ACTIVE", "p0"."PRODUCT_ID", "p0"."SKU", "p0"."STORAGE_GB", "p0"."WEIGHT_GRAM", "p1"."ID", "p1"."ALT_TEXT", "p1"."IMAGE_URL", "p1"."IS_PRIMARY", "p1"."PRODUCT_ID", "p1"."SORT_ORDER", "p1"."VARIANT_ID"
FROM (
    SELECT "p"."ID", "p"."BRAND_ID", "p"."CREATED_AT", "p"."DEFAULT_CATEGORY_ID", "p"."DESCRIPTION", "p"."IS_ACTIVE", "p"."NAME", "p"."SLUG", "p"."SPEC_JSON"
    FROM "HEHE"."PRODUCTS" "p"
    WHERE (("p"."SLUG" = :slug_0) AND ("p"."IS_ACTIVE" = 1))
    FETCH FIRST 1 ROWS ONLY
) "p2"
LEFT JOIN "HEHE"."PRODUCT_VARIANTS" "p0" ON "p2"."ID" = "p0"."PRODUCT_ID"
LEFT JOIN "HEHE"."PRODUCT_IMAGES" "p1" ON "p2"."ID" = "p1"."PRODUCT_ID"
ORDER BY "p2"."ID", "p0"."ID"
2025-09-05 16:47:34.057 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."VARIANT_ID" "VariantId", COALESCE((
    SELECT COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")
    FROM "HEHE"."PRODUCT_PRICES" "p0"
    WHERE (((((("p0"."VARIANT_ID" IN (1, 2)) AND ("p0"."STARTS_AT" <= :now_1))) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))) AND ("p"."VARIANT_ID" = "p0"."VARIANT_ID"))
    ORDER BY "p0"."STARTS_AT" DESC
    FETCH FIRST 1 ROWS ONLY), 0.0) "Price"
FROM "HEHE"."PRODUCT_PRICES" "p"
WHERE (((("p"."VARIANT_ID" IN (1, 2)) AND ("p"."STARTS_AT" <= :now_1))) AND ((("p"."ENDS_AT" IS NULL) OR ("p"."ENDS_AT" > :now_2))))
GROUP BY "p"."VARIANT_ID"
2025-09-05 16:47:34.060 +07:00 [INF] Executing OkObjectResult, writing value of type 'PHONE_STORE.API.Controllers.ShopProductsController+ShopProductDetail'.
2025-09-05 16:47:34.061 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API) in 10.002ms
2025-09-05 16:47:34.061 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API)'
2025-09-05 16:47:34.062 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products/iphone-15 - 200 null application/json; charset=utf-8 15.2698ms
2025-09-05 16:47:34.082 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 16:47:34.086 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:47:34.087 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 16:47:34.091 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:47:34.095 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:47:34.098 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 16:47:34.099 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 16:47:34.100 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 12.0212ms
2025-09-05 16:47:34.101 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:47:34.102 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 19.9843ms
2025-09-05 16:47:52.575 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 16:47:52.578 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:47:52.579 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 16:47:52.585 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:47:52.594 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:47:52.599 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 16:47:52.600 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 16:47:52.601 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 20.9928ms
2025-09-05 16:47:52.601 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:47:52.602 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 26.5836ms
2025-09-05 16:47:52.622 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 16:47:52.624 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:47:52.625 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 16:47:52.633 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:47:52.641 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:47:52.645 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 16:47:52.647 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 16:47:52.648 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 21.364ms
2025-09-05 16:47:52.650 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:47:52.651 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 28.3353ms
2025-09-05 16:47:53.717 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/me/addresses - null null
2025-09-05 16:47:53.719 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopMeController.MyAddresses (PHONE_STORE.API)'
2025-09-05 16:47:53.720 +07:00 [INF] Route matched with {action = "MyAddresses", controller = "ShopMe"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.Application.Dtos.AddressDto]]] MyAddresses(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopMeController (PHONE_STORE.API).
2025-09-05 16:47:53.721 +07:00 [INF] Executing ObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ProblemDetails'.
2025-09-05 16:47:53.722 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopMeController.MyAddresses (PHONE_STORE.API) in 1.1414ms
2025-09-05 16:47:53.723 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopMeController.MyAddresses (PHONE_STORE.API)'
2025-09-05 16:47:53.724 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/me/addresses - 401 null application/problem+json; charset=utf-8 7.1831ms
2025-09-05 16:47:55.580 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 16:47:55.582 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:47:55.583 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 16:47:55.586 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:47:55.590 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:47:55.592 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 16:47:55.594 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 16:47:55.595 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 10.8176ms
2025-09-05 16:47:55.596 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:47:55.596 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 16.1708ms
2025-09-05 16:48:01.206 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 16:48:01.208 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:48:01.209 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 16:48:01.217 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:48:01.223 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:48:01.228 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 16:48:01.230 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 16:48:01.231 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 20.4355ms
2025-09-05 16:48:01.232 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:48:01.232 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 26.7066ms
2025-09-05 16:48:01.249 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 16:48:01.251 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:48:01.251 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 16:48:01.257 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:48:01.267 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:48:01.272 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 16:48:01.274 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 16:48:01.274 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 21.7393ms
2025-09-05 16:48:01.275 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:48:01.277 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 28.1582ms
2025-09-05 16:48:02.720 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 16:48:02.723 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:48:02.724 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 16:48:02.727 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:48:02.730 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:48:02.732 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 16:48:02.734 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 16:48:02.735 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 10.141ms
2025-09-05 16:48:02.736 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:48:02.736 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 16.3357ms
2025-09-05 16:48:02.760 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 16:48:02.763 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:48:02.765 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 16:48:02.769 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:48:02.774 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:48:02.779 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 16:48:02.782 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 16:48:02.783 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 16.395ms
2025-09-05 16:48:02.784 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:48:02.785 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 24.6193ms
2025-09-05 16:48:04.131 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/me/addresses - null null
2025-09-05 16:48:04.133 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopMeController.MyAddresses (PHONE_STORE.API)'
2025-09-05 16:48:04.134 +07:00 [INF] Route matched with {action = "MyAddresses", controller = "ShopMe"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.Application.Dtos.AddressDto]]] MyAddresses(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopMeController (PHONE_STORE.API).
2025-09-05 16:48:04.136 +07:00 [INF] Executing ObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ProblemDetails'.
2025-09-05 16:48:04.137 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopMeController.MyAddresses (PHONE_STORE.API) in 1.3845ms
2025-09-05 16:48:04.138 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopMeController.MyAddresses (PHONE_STORE.API)'
2025-09-05 16:48:04.140 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/me/addresses - 401 null application/problem+json; charset=utf-8 8.4748ms
2025-09-05 16:48:23.546 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 16:48:23.548 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:48:23.549 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 16:48:23.555 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:48:23.561 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:48:23.567 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 16:48:23.570 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 16:48:23.571 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 20.8085ms
2025-09-05 16:48:23.571 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:48:23.572 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 25.6862ms
2025-09-05 16:48:25.851 +07:00 [INF] Request starting HTTP/1.1 POST https://localhost:7277/api/auth/logout - application/json; charset=utf-8 null
2025-09-05 16:48:25.853 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.AuthController.Logout (PHONE_STORE.API)'
2025-09-05 16:48:25.853 +07:00 [INF] Route matched with {action = "Logout", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Logout(RefreshRequest, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.AuthController (PHONE_STORE.API).
2025-09-05 16:48:25.855 +07:00 [INF] Logout: revoked RT
2025-09-05 16:48:25.856 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType1`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-05 16:48:25.857 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.AuthController.Logout (PHONE_STORE.API) in 2.8737ms
2025-09-05 16:48:25.858 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.AuthController.Logout (PHONE_STORE.API)'
2025-09-05 16:48:25.859 +07:00 [INF] Request finished HTTP/1.1 POST https://localhost:7277/api/auth/logout - 200 null application/json; charset=utf-8 7.7252ms
2025-09-05 16:48:25.868 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - null null
2025-09-05 16:48:25.870 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 16:48:25.871 +07:00 [INF] Route matched with {action = "List", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem]]] List(System.String, System.Nullable`1[System.Int64], Int32, Int32, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 16:48:25.876 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:p_0='?' (DbType = Int32), :p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."ID" "Id", "p"."NAME" "Name", "p"."SLUG" "Slug"
FROM "HEHE"."PRODUCTS" "p"
WHERE "p"."IS_ACTIVE" = 1
ORDER BY "p"."CREATED_AT" DESC
OFFSET :p_0 ROWS FETCH NEXT :p_1 ROWS ONLY
2025-09-05 16:48:25.883 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", (
    SELECT "p0"."IMAGE_URL"
    FROM "HEHE"."PRODUCT_IMAGES" "p0"
    WHERE (("p0"."PRODUCT_ID" IS NOT NULL AND "p0"."PRODUCT_ID" IN (3, 2, 1)) AND ("p"."PRODUCT_ID" = "p0"."PRODUCT_ID"))
    ORDER BY "p0"."SORT_ORDER"
    FETCH FIRST 1 ROWS ONLY) "Url"
FROM "HEHE"."PRODUCT_IMAGES" "p"
WHERE "p"."PRODUCT_ID" IS NOT NULL AND "p"."PRODUCT_ID" IN (3, 2, 1)
GROUP BY "p"."PRODUCT_ID"
2025-09-05 16:48:25.887 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", MIN(COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")) "MinPrice"
FROM "HEHE"."PRODUCT_VARIANTS" "p"
INNER JOIN "HEHE"."PRODUCT_PRICES" "p0" ON "p"."ID" = "p0"."VARIANT_ID"
WHERE (("p"."PRODUCT_ID" IN (3, 2, 1)) AND ((("p0"."STARTS_AT" <= :now_1) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))))
GROUP BY "p"."PRODUCT_ID"
2025-09-05 16:48:25.888 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem, PHONE_STORE.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-05 16:48:25.889 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API) in 17.1575ms
2025-09-05 16:48:25.890 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 16:48:25.891 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - 200 null application/json; charset=utf-8 22.4503ms
2025-09-05 16:48:25.919 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 16:48:25.921 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:48:25.922 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 16:48:25.927 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:48:25.930 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:48:25.933 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 16:48:25.935 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 16:48:25.936 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 12.0556ms
2025-09-05 16:48:25.937 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:48:25.938 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 18.1646ms
2025-09-05 16:48:27.630 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 16:48:27.631 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:48:27.632 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 16:48:27.635 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:48:27.638 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:48:27.641 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 16:48:27.643 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 16:48:27.643 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 10.4255ms
2025-09-05 16:48:27.644 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:48:27.645 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 15.047ms
2025-09-05 16:48:27.662 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 16:48:27.664 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:48:27.665 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 16:48:27.670 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:48:27.674 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:48:27.677 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 16:48:27.680 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 16:48:27.681 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 14.7369ms
2025-09-05 16:48:27.682 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:48:27.683 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 20.8712ms
2025-09-05 16:48:29.145 +07:00 [INF] Request starting HTTP/1.1 DELETE https://localhost:7277/api/shop/cart/items/1 - null null
2025-09-05 16:48:29.147 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Remove (PHONE_STORE.API)'
2025-09-05 16:48:29.147 +07:00 [INF] Route matched with {action = "Remove", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task Remove(Int64, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 16:48:29.150 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:48:29.153 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64), :itemId_1='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE"
FROM "HEHE"."CART_ITEMS" "c"
WHERE (("c"."CART_ID" = :id_0) AND ("c"."VARIANT_ID" = :itemId_1))
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:48:29.157 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:p0='?' (DbType = Int64), :p1='?' (DbType = Int64), :cur0='?' (Direction = Output) (DbType = Object)], CommandType='"Text"', CommandTimeout='0']
DECLARE

v_RowCount INTEGER;

BEGIN

DELETE FROM "HEHE"."CART_ITEMS"
WHERE "CART_ID" = :p0 AND "VARIANT_ID" = :p1;
v_RowCount := SQL%ROWCOUNT;
OPEN :cur0 FOR SELECT v_RowCount FROM DUAL;

END;
2025-09-05 16:48:29.159 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Remove (PHONE_STORE.API) in 11.517ms
2025-09-05 16:48:29.160 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Remove (PHONE_STORE.API)'
2025-09-05 16:48:29.161 +07:00 [INF] Request finished HTTP/1.1 DELETE https://localhost:7277/api/shop/cart/items/1 - 200 0 null 16.1375ms
2025-09-05 16:48:29.166 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 16:48:29.167 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:48:29.168 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 16:48:29.171 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:48:29.174 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:48:29.176 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 16:48:29.178 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 16:48:29.178 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 9.0233ms
2025-09-05 16:48:29.179 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:48:29.180 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 14.1745ms
2025-09-05 16:48:29.197 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 16:48:29.199 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:48:29.200 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 16:48:29.204 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:48:29.207 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:48:29.212 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 16:48:29.214 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 16:48:29.215 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 13.2653ms
2025-09-05 16:48:29.216 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:48:29.217 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 19.2477ms
2025-09-05 16:48:29.761 +07:00 [INF] Request starting HTTP/1.1 DELETE https://localhost:7277/api/shop/cart/items/2 - null null
2025-09-05 16:48:29.763 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Remove (PHONE_STORE.API)'
2025-09-05 16:48:29.763 +07:00 [INF] Route matched with {action = "Remove", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task Remove(Int64, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 16:48:29.766 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:48:29.769 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64), :itemId_1='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE"
FROM "HEHE"."CART_ITEMS" "c"
WHERE (("c"."CART_ID" = :id_0) AND ("c"."VARIANT_ID" = :itemId_1))
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:48:29.773 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:p0='?' (DbType = Int64), :p1='?' (DbType = Int64), :cur0='?' (Direction = Output) (DbType = Object)], CommandType='"Text"', CommandTimeout='0']
DECLARE

v_RowCount INTEGER;

BEGIN

DELETE FROM "HEHE"."CART_ITEMS"
WHERE "CART_ID" = :p0 AND "VARIANT_ID" = :p1;
v_RowCount := SQL%ROWCOUNT;
OPEN :cur0 FOR SELECT v_RowCount FROM DUAL;

END;
2025-09-05 16:48:29.776 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Remove (PHONE_STORE.API) in 11.1987ms
2025-09-05 16:48:29.776 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Remove (PHONE_STORE.API)'
2025-09-05 16:48:29.777 +07:00 [INF] Request finished HTTP/1.1 DELETE https://localhost:7277/api/shop/cart/items/2 - 200 0 null 15.9099ms
2025-09-05 16:48:29.781 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 16:48:29.783 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:48:29.783 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 16:48:29.787 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:48:29.790 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:48:29.792 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 16:48:29.794 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 16:48:29.794 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 10.0309ms
2025-09-05 16:48:29.795 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:48:29.795 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 14.1935ms
2025-09-05 16:48:29.810 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 16:48:29.813 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:48:29.814 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 16:48:29.819 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:48:29.822 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:48:29.826 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 16:48:29.828 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 16:48:29.829 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 12.7473ms
2025-09-05 16:48:29.830 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:48:29.831 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 20.1054ms
2025-09-05 16:48:31.502 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - null null
2025-09-05 16:48:31.505 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 16:48:31.505 +07:00 [INF] Route matched with {action = "List", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem]]] List(System.String, System.Nullable`1[System.Int64], Int32, Int32, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 16:48:31.508 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:p_0='?' (DbType = Int32), :p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."ID" "Id", "p"."NAME" "Name", "p"."SLUG" "Slug"
FROM "HEHE"."PRODUCTS" "p"
WHERE "p"."IS_ACTIVE" = 1
ORDER BY "p"."CREATED_AT" DESC
OFFSET :p_0 ROWS FETCH NEXT :p_1 ROWS ONLY
2025-09-05 16:48:31.511 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", (
    SELECT "p0"."IMAGE_URL"
    FROM "HEHE"."PRODUCT_IMAGES" "p0"
    WHERE (("p0"."PRODUCT_ID" IS NOT NULL AND "p0"."PRODUCT_ID" IN (3, 2, 1)) AND ("p"."PRODUCT_ID" = "p0"."PRODUCT_ID"))
    ORDER BY "p0"."SORT_ORDER"
    FETCH FIRST 1 ROWS ONLY) "Url"
FROM "HEHE"."PRODUCT_IMAGES" "p"
WHERE "p"."PRODUCT_ID" IS NOT NULL AND "p"."PRODUCT_ID" IN (3, 2, 1)
GROUP BY "p"."PRODUCT_ID"
2025-09-05 16:48:31.515 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", MIN(COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")) "MinPrice"
FROM "HEHE"."PRODUCT_VARIANTS" "p"
INNER JOIN "HEHE"."PRODUCT_PRICES" "p0" ON "p"."ID" = "p0"."VARIANT_ID"
WHERE (("p"."PRODUCT_ID" IN (3, 2, 1)) AND ((("p0"."STARTS_AT" <= :now_1) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))))
GROUP BY "p"."PRODUCT_ID"
2025-09-05 16:48:31.516 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem, PHONE_STORE.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-05 16:48:31.517 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API) in 10.4497ms
2025-09-05 16:48:31.518 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 16:48:31.518 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - 200 null application/json; charset=utf-8 16.4432ms
2025-09-05 16:48:31.540 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 16:48:31.542 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:48:31.543 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 16:48:31.547 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:48:31.550 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:48:31.554 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 16:48:31.556 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 16:48:31.557 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 12.3053ms
2025-09-05 16:48:31.558 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:48:31.558 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 18.1174ms
2025-09-05 16:48:38.447 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 16:48:38.449 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:48:38.449 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 16:48:38.457 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:48:38.464 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:48:38.472 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 16:48:38.475 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 16:48:38.476 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 24.7791ms
2025-09-05 16:48:38.477 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:48:38.477 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 30.6346ms
2025-09-05 16:48:44.776 +07:00 [INF] Request starting HTTP/1.1 POST https://localhost:7277/api/auth/login - application/json; charset=utf-8 null
2025-09-05 16:48:44.778 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.AuthController.Login (PHONE_STORE.API)'
2025-09-05 16:48:44.779 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(LoginRequest, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.AuthController (PHONE_STORE.API).
2025-09-05 16:48:44.787 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:uname_0='?' (Size = 450), :username_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='0']
SELECT "u"."ID", "u"."CREATED_AT", "u"."EMAIL", "u"."PASSWORD_HASH", "u"."PHONE", "u"."STATUS"
FROM "USER_ACCOUNTS" "u"
WHERE (("u"."EMAIL" = :uname_0) OR ("u"."PHONE" = :username_1))
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:48:45.005 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[:userId_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "r"."CODE"
FROM "USER_ROLES" "u"
INNER JOIN "ROLES" "r" ON "u"."ROLE_ID" = "r"."ID"
WHERE "u"."USER_ID" = :userId_0
2025-09-05 16:48:45.008 +07:00 [INF] Login success [21]
2025-09-05 16:48:45.009 +07:00 [INF] Executing OkObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.AuthResponseDto'.
2025-09-05 16:48:45.010 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.AuthController.Login (PHONE_STORE.API) in 229.4308ms
2025-09-05 16:48:45.011 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.AuthController.Login (PHONE_STORE.API)'
2025-09-05 16:48:45.011 +07:00 [INF] Request finished HTTP/1.1 POST https://localhost:7277/api/auth/login - 200 null application/json; charset=utf-8 235.3592ms
2025-09-05 16:48:45.013 +07:00 [INF] Request starting HTTP/1.1 POST https://localhost:7277/api/shop/cart/merge - null 0
2025-09-05 16:48:45.014 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Merge (PHONE_STORE.API)'
2025-09-05 16:48:45.015 +07:00 [INF] Route matched with {action = "Merge", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Merge(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 16:48:45.016 +07:00 [INF] Executing StatusCodeResult, setting HTTP status code 200
2025-09-05 16:48:45.016 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Merge (PHONE_STORE.API) in 0.5395ms
2025-09-05 16:48:45.017 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Merge (PHONE_STORE.API)'
2025-09-05 16:48:45.017 +07:00 [INF] Request finished HTTP/1.1 POST https://localhost:7277/api/shop/cart/merge - 200 0 null 4.1138ms
2025-09-05 16:48:45.025 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - null null
2025-09-05 16:48:45.027 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 16:48:45.027 +07:00 [INF] Route matched with {action = "List", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem]]] List(System.String, System.Nullable`1[System.Int64], Int32, Int32, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 16:48:45.032 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:p_0='?' (DbType = Int32), :p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."ID" "Id", "p"."NAME" "Name", "p"."SLUG" "Slug"
FROM "HEHE"."PRODUCTS" "p"
WHERE "p"."IS_ACTIVE" = 1
ORDER BY "p"."CREATED_AT" DESC
OFFSET :p_0 ROWS FETCH NEXT :p_1 ROWS ONLY
2025-09-05 16:48:45.038 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", (
    SELECT "p0"."IMAGE_URL"
    FROM "HEHE"."PRODUCT_IMAGES" "p0"
    WHERE (("p0"."PRODUCT_ID" IS NOT NULL AND "p0"."PRODUCT_ID" IN (3, 2, 1)) AND ("p"."PRODUCT_ID" = "p0"."PRODUCT_ID"))
    ORDER BY "p0"."SORT_ORDER"
    FETCH FIRST 1 ROWS ONLY) "Url"
FROM "HEHE"."PRODUCT_IMAGES" "p"
WHERE "p"."PRODUCT_ID" IS NOT NULL AND "p"."PRODUCT_ID" IN (3, 2, 1)
GROUP BY "p"."PRODUCT_ID"
2025-09-05 16:48:45.044 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", MIN(COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")) "MinPrice"
FROM "HEHE"."PRODUCT_VARIANTS" "p"
INNER JOIN "HEHE"."PRODUCT_PRICES" "p0" ON "p"."ID" = "p0"."VARIANT_ID"
WHERE (("p"."PRODUCT_ID" IN (3, 2, 1)) AND ((("p0"."STARTS_AT" <= :now_1) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))))
GROUP BY "p"."PRODUCT_ID"
2025-09-05 16:48:45.045 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem, PHONE_STORE.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-05 16:48:45.046 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API) in 17.4582ms
2025-09-05 16:48:45.047 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 16:48:45.047 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - 200 null application/json; charset=utf-8 22.0067ms
2025-09-05 16:48:45.065 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 16:48:45.067 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:48:45.068 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 16:48:45.072 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:48:45.076 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:48:45.079 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 16:48:45.080 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 16:48:45.081 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 11.6458ms
2025-09-05 16:48:45.083 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:48:45.084 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 19.2466ms
2025-09-05 16:48:47.686 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products/galaxy-s24 - null null
2025-09-05 16:48:47.688 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API)'
2025-09-05 16:48:47.689 +07:00 [INF] Route matched with {action = "Details", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductDetail]] Details(System.String, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 16:48:47.692 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:slug_0='?' (Size = 220)], CommandType='"Text"', CommandTimeout='0']
SELECT "p2"."ID", "p2"."BRAND_ID", "p2"."CREATED_AT", "p2"."DEFAULT_CATEGORY_ID", "p2"."DESCRIPTION", "p2"."IS_ACTIVE", "p2"."NAME", "p2"."SLUG", "p2"."SPEC_JSON", "p0"."ID", "p0"."BARCODE", "p0"."COLOR", "p0"."IS_ACTIVE", "p0"."PRODUCT_ID", "p0"."SKU", "p0"."STORAGE_GB", "p0"."WEIGHT_GRAM", "p1"."ID", "p1"."ALT_TEXT", "p1"."IMAGE_URL", "p1"."IS_PRIMARY", "p1"."PRODUCT_ID", "p1"."SORT_ORDER", "p1"."VARIANT_ID"
FROM (
    SELECT "p"."ID", "p"."BRAND_ID", "p"."CREATED_AT", "p"."DEFAULT_CATEGORY_ID", "p"."DESCRIPTION", "p"."IS_ACTIVE", "p"."NAME", "p"."SLUG", "p"."SPEC_JSON"
    FROM "HEHE"."PRODUCTS" "p"
    WHERE (("p"."SLUG" = :slug_0) AND ("p"."IS_ACTIVE" = 1))
    FETCH FIRST 1 ROWS ONLY
) "p2"
LEFT JOIN "HEHE"."PRODUCT_VARIANTS" "p0" ON "p2"."ID" = "p0"."PRODUCT_ID"
LEFT JOIN "HEHE"."PRODUCT_IMAGES" "p1" ON "p2"."ID" = "p1"."PRODUCT_ID"
ORDER BY "p2"."ID", "p0"."ID"
2025-09-05 16:48:47.696 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."VARIANT_ID" "VariantId", COALESCE((
    SELECT COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")
    FROM "HEHE"."PRODUCT_PRICES" "p0"
    WHERE (((((("p0"."VARIANT_ID" = 3) AND ("p0"."STARTS_AT" <= :now_1))) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))) AND ("p"."VARIANT_ID" = "p0"."VARIANT_ID"))
    ORDER BY "p0"."STARTS_AT" DESC
    FETCH FIRST 1 ROWS ONLY), 0.0) "Price"
FROM "HEHE"."PRODUCT_PRICES" "p"
WHERE (((("p"."VARIANT_ID" = 3) AND ("p"."STARTS_AT" <= :now_1))) AND ((("p"."ENDS_AT" IS NULL) OR ("p"."ENDS_AT" > :now_2))))
GROUP BY "p"."VARIANT_ID"
2025-09-05 16:48:47.698 +07:00 [INF] Executing OkObjectResult, writing value of type 'PHONE_STORE.API.Controllers.ShopProductsController+ShopProductDetail'.
2025-09-05 16:48:47.699 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API) in 9.378ms
2025-09-05 16:48:47.700 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API)'
2025-09-05 16:48:47.701 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products/galaxy-s24 - 200 null application/json; charset=utf-8 15.5616ms
2025-09-05 16:48:47.722 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 16:48:47.724 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:48:47.724 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 16:48:47.730 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:48:47.739 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:48:47.742 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 16:48:47.744 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 16:48:47.744 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 18.5715ms
2025-09-05 16:48:47.745 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:48:47.746 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 24.053ms
2025-09-05 16:48:48.625 +07:00 [INF] Request starting HTTP/1.1 POST https://localhost:7277/api/shop/cart/items - application/json; charset=utf-8 null
2025-09-05 16:48:48.627 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Add (PHONE_STORE.API)'
2025-09-05 16:48:48.628 +07:00 [INF] Route matched with {action = "Add", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Add(PHONE_STORE.Application.Dtos.CartItemUpsertDto, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 16:48:48.632 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:48:48.636 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64), :dto_VariantId_1='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE"
FROM "HEHE"."CART_ITEMS" "c"
WHERE (("c"."CART_ID" = :id_0) AND ("c"."VARIANT_ID" = :dto_VariantId_1))
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:48:48.638 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[:variantId_0='?' (DbType = Int64), :now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT COALESCE("p"."SALE_PRICE", "p"."LIST_PRICE")
FROM "HEHE"."PRODUCT_PRICES" "p"
WHERE (((("p"."VARIANT_ID" = :variantId_0) AND ("p"."STARTS_AT" <= :now_1))) AND ((("p"."ENDS_AT" IS NULL) OR ("p"."ENDS_AT" >= :now_2))))
ORDER BY "p"."STARTS_AT" DESC
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:48:48.642 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:p0='?' (DbType = Int64), :p1='?' (DbType = Int64), :p2='?' (DbType = DateTime), :p3='?' (Size = 2000), :p4='?' (DbType = Int32), :p5='?' (DbType = Decimal)], CommandType='"Text"', CommandTimeout='0']
DECLARE


BEGIN

INSERT INTO "HEHE"."CART_ITEMS" ("CART_ID", "VARIANT_ID", "ADDED_AT", "CURRENCY", "QUANTITY", "UNIT_PRICE")
VALUES (:p0, :p1, :p2, :p3, :p4, :p5);

END;
2025-09-05 16:48:48.655 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:48:48.657 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:48:48.660 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 16:48:48.661 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 16:48:48.662 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Add (PHONE_STORE.API) in 32.6649ms
2025-09-05 16:48:48.663 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Add (PHONE_STORE.API)'
2025-09-05 16:48:48.663 +07:00 [INF] Request finished HTTP/1.1 POST https://localhost:7277/api/shop/cart/items - 200 null application/json; charset=utf-8 37.9828ms
2025-09-05 16:48:48.668 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products/galaxy-s24 - null null
2025-09-05 16:48:48.670 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API)'
2025-09-05 16:48:48.670 +07:00 [INF] Route matched with {action = "Details", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductDetail]] Details(System.String, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 16:48:48.673 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:slug_0='?' (Size = 220)], CommandType='"Text"', CommandTimeout='0']
SELECT "p2"."ID", "p2"."BRAND_ID", "p2"."CREATED_AT", "p2"."DEFAULT_CATEGORY_ID", "p2"."DESCRIPTION", "p2"."IS_ACTIVE", "p2"."NAME", "p2"."SLUG", "p2"."SPEC_JSON", "p0"."ID", "p0"."BARCODE", "p0"."COLOR", "p0"."IS_ACTIVE", "p0"."PRODUCT_ID", "p0"."SKU", "p0"."STORAGE_GB", "p0"."WEIGHT_GRAM", "p1"."ID", "p1"."ALT_TEXT", "p1"."IMAGE_URL", "p1"."IS_PRIMARY", "p1"."PRODUCT_ID", "p1"."SORT_ORDER", "p1"."VARIANT_ID"
FROM (
    SELECT "p"."ID", "p"."BRAND_ID", "p"."CREATED_AT", "p"."DEFAULT_CATEGORY_ID", "p"."DESCRIPTION", "p"."IS_ACTIVE", "p"."NAME", "p"."SLUG", "p"."SPEC_JSON"
    FROM "HEHE"."PRODUCTS" "p"
    WHERE (("p"."SLUG" = :slug_0) AND ("p"."IS_ACTIVE" = 1))
    FETCH FIRST 1 ROWS ONLY
) "p2"
LEFT JOIN "HEHE"."PRODUCT_VARIANTS" "p0" ON "p2"."ID" = "p0"."PRODUCT_ID"
LEFT JOIN "HEHE"."PRODUCT_IMAGES" "p1" ON "p2"."ID" = "p1"."PRODUCT_ID"
ORDER BY "p2"."ID", "p0"."ID"
2025-09-05 16:48:48.677 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."VARIANT_ID" "VariantId", COALESCE((
    SELECT COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")
    FROM "HEHE"."PRODUCT_PRICES" "p0"
    WHERE (((((("p0"."VARIANT_ID" = 3) AND ("p0"."STARTS_AT" <= :now_1))) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))) AND ("p"."VARIANT_ID" = "p0"."VARIANT_ID"))
    ORDER BY "p0"."STARTS_AT" DESC
    FETCH FIRST 1 ROWS ONLY), 0.0) "Price"
FROM "HEHE"."PRODUCT_PRICES" "p"
WHERE (((("p"."VARIANT_ID" = 3) AND ("p"."STARTS_AT" <= :now_1))) AND ((("p"."ENDS_AT" IS NULL) OR ("p"."ENDS_AT" > :now_2))))
GROUP BY "p"."VARIANT_ID"
2025-09-05 16:48:48.678 +07:00 [INF] Executing OkObjectResult, writing value of type 'PHONE_STORE.API.Controllers.ShopProductsController+ShopProductDetail'.
2025-09-05 16:48:48.679 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API) in 8.1805ms
2025-09-05 16:48:48.680 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API)'
2025-09-05 16:48:48.681 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products/galaxy-s24 - 200 null application/json; charset=utf-8 12.618ms
2025-09-05 16:48:48.706 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 16:48:48.710 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:48:48.711 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 16:48:48.716 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:48:48.721 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:48:48.725 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 16:48:48.726 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 16:48:48.727 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 14.3259ms
2025-09-05 16:48:48.728 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:48:48.728 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 21.8878ms
2025-09-05 16:48:58.093 +07:00 [INF] Request starting HTTP/1.1 POST https://localhost:7277/api/shop/cart/items - application/json; charset=utf-8 null
2025-09-05 16:48:58.096 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Add (PHONE_STORE.API)'
2025-09-05 16:48:58.097 +07:00 [INF] Route matched with {action = "Add", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Add(PHONE_STORE.Application.Dtos.CartItemUpsertDto, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 16:48:58.106 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:48:58.110 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:id_0='?' (DbType = Int64), :dto_VariantId_1='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE"
FROM "HEHE"."CART_ITEMS" "c"
WHERE (("c"."CART_ID" = :id_0) AND ("c"."VARIANT_ID" = :dto_VariantId_1))
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:48:58.116 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[:p1='?' (DbType = Int64), :p2='?' (DbType = Int64), :p0='?' (DbType = Int32), :cur0='?' (Direction = Output) (DbType = Object)], CommandType='"Text"', CommandTimeout='0']
DECLARE

v_RowCount INTEGER;

BEGIN

UPDATE "HEHE"."CART_ITEMS" SET "QUANTITY" = :p0
WHERE "CART_ID" = :p1 AND "VARIANT_ID" = :p2;
v_RowCount := SQL%ROWCOUNT;
OPEN :cur0 FOR SELECT v_RowCount FROM DUAL;

END;
2025-09-05 16:48:58.123 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:48:58.129 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:48:58.132 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 16:48:58.134 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 16:48:58.135 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Add (PHONE_STORE.API) in 36.0961ms
2025-09-05 16:48:58.135 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Add (PHONE_STORE.API)'
2025-09-05 16:48:58.136 +07:00 [INF] Request finished HTTP/1.1 POST https://localhost:7277/api/shop/cart/items - 200 null application/json; charset=utf-8 42.4602ms
2025-09-05 16:48:58.140 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products/galaxy-s24 - null null
2025-09-05 16:48:58.142 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API)'
2025-09-05 16:48:58.142 +07:00 [INF] Route matched with {action = "Details", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductDetail]] Details(System.String, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 16:48:58.145 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:slug_0='?' (Size = 220)], CommandType='"Text"', CommandTimeout='0']
SELECT "p2"."ID", "p2"."BRAND_ID", "p2"."CREATED_AT", "p2"."DEFAULT_CATEGORY_ID", "p2"."DESCRIPTION", "p2"."IS_ACTIVE", "p2"."NAME", "p2"."SLUG", "p2"."SPEC_JSON", "p0"."ID", "p0"."BARCODE", "p0"."COLOR", "p0"."IS_ACTIVE", "p0"."PRODUCT_ID", "p0"."SKU", "p0"."STORAGE_GB", "p0"."WEIGHT_GRAM", "p1"."ID", "p1"."ALT_TEXT", "p1"."IMAGE_URL", "p1"."IS_PRIMARY", "p1"."PRODUCT_ID", "p1"."SORT_ORDER", "p1"."VARIANT_ID"
FROM (
    SELECT "p"."ID", "p"."BRAND_ID", "p"."CREATED_AT", "p"."DEFAULT_CATEGORY_ID", "p"."DESCRIPTION", "p"."IS_ACTIVE", "p"."NAME", "p"."SLUG", "p"."SPEC_JSON"
    FROM "HEHE"."PRODUCTS" "p"
    WHERE (("p"."SLUG" = :slug_0) AND ("p"."IS_ACTIVE" = 1))
    FETCH FIRST 1 ROWS ONLY
) "p2"
LEFT JOIN "HEHE"."PRODUCT_VARIANTS" "p0" ON "p2"."ID" = "p0"."PRODUCT_ID"
LEFT JOIN "HEHE"."PRODUCT_IMAGES" "p1" ON "p2"."ID" = "p1"."PRODUCT_ID"
ORDER BY "p2"."ID", "p0"."ID"
2025-09-05 16:48:58.150 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."VARIANT_ID" "VariantId", COALESCE((
    SELECT COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")
    FROM "HEHE"."PRODUCT_PRICES" "p0"
    WHERE (((((("p0"."VARIANT_ID" = 3) AND ("p0"."STARTS_AT" <= :now_1))) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))) AND ("p"."VARIANT_ID" = "p0"."VARIANT_ID"))
    ORDER BY "p0"."STARTS_AT" DESC
    FETCH FIRST 1 ROWS ONLY), 0.0) "Price"
FROM "HEHE"."PRODUCT_PRICES" "p"
WHERE (((("p"."VARIANT_ID" = 3) AND ("p"."STARTS_AT" <= :now_1))) AND ((("p"."ENDS_AT" IS NULL) OR ("p"."ENDS_AT" > :now_2))))
GROUP BY "p"."VARIANT_ID"
2025-09-05 16:48:58.151 +07:00 [INF] Executing OkObjectResult, writing value of type 'PHONE_STORE.API.Controllers.ShopProductsController+ShopProductDetail'.
2025-09-05 16:48:58.152 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API) in 8.6923ms
2025-09-05 16:48:58.153 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API)'
2025-09-05 16:48:58.153 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products/galaxy-s24 - 200 null application/json; charset=utf-8 12.9404ms
2025-09-05 16:48:58.172 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 16:48:58.174 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:48:58.175 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 16:48:58.179 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:48:58.184 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:48:58.188 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 16:48:58.191 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 16:48:58.192 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 15.3398ms
2025-09-05 16:48:58.193 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:48:58.193 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 21.5088ms
2025-09-05 16:48:58.639 +07:00 [INF] Request starting HTTP/1.1 POST https://localhost:7277/api/shop/cart/items - application/json; charset=utf-8 null
2025-09-05 16:48:58.642 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Add (PHONE_STORE.API)'
2025-09-05 16:48:58.643 +07:00 [INF] Route matched with {action = "Add", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Add(PHONE_STORE.Application.Dtos.CartItemUpsertDto, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 16:48:58.647 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:48:58.650 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64), :dto_VariantId_1='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE"
FROM "HEHE"."CART_ITEMS" "c"
WHERE (("c"."CART_ID" = :id_0) AND ("c"."VARIANT_ID" = :dto_VariantId_1))
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:48:58.654 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:p1='?' (DbType = Int64), :p2='?' (DbType = Int64), :p0='?' (DbType = Int32), :cur0='?' (Direction = Output) (DbType = Object)], CommandType='"Text"', CommandTimeout='0']
DECLARE

v_RowCount INTEGER;

BEGIN

UPDATE "HEHE"."CART_ITEMS" SET "QUANTITY" = :p0
WHERE "CART_ID" = :p1 AND "VARIANT_ID" = :p2;
v_RowCount := SQL%ROWCOUNT;
OPEN :cur0 FOR SELECT v_RowCount FROM DUAL;

END;
2025-09-05 16:48:58.658 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:48:58.660 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:48:58.664 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 16:48:58.666 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 16:48:58.667 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Add (PHONE_STORE.API) in 22.971ms
2025-09-05 16:48:58.667 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Add (PHONE_STORE.API)'
2025-09-05 16:48:58.668 +07:00 [INF] Request finished HTTP/1.1 POST https://localhost:7277/api/shop/cart/items - 200 null application/json; charset=utf-8 28.9496ms
2025-09-05 16:48:58.672 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products/galaxy-s24 - null null
2025-09-05 16:48:58.674 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API)'
2025-09-05 16:48:58.674 +07:00 [INF] Route matched with {action = "Details", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductDetail]] Details(System.String, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 16:48:58.677 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:slug_0='?' (Size = 220)], CommandType='"Text"', CommandTimeout='0']
SELECT "p2"."ID", "p2"."BRAND_ID", "p2"."CREATED_AT", "p2"."DEFAULT_CATEGORY_ID", "p2"."DESCRIPTION", "p2"."IS_ACTIVE", "p2"."NAME", "p2"."SLUG", "p2"."SPEC_JSON", "p0"."ID", "p0"."BARCODE", "p0"."COLOR", "p0"."IS_ACTIVE", "p0"."PRODUCT_ID", "p0"."SKU", "p0"."STORAGE_GB", "p0"."WEIGHT_GRAM", "p1"."ID", "p1"."ALT_TEXT", "p1"."IMAGE_URL", "p1"."IS_PRIMARY", "p1"."PRODUCT_ID", "p1"."SORT_ORDER", "p1"."VARIANT_ID"
FROM (
    SELECT "p"."ID", "p"."BRAND_ID", "p"."CREATED_AT", "p"."DEFAULT_CATEGORY_ID", "p"."DESCRIPTION", "p"."IS_ACTIVE", "p"."NAME", "p"."SLUG", "p"."SPEC_JSON"
    FROM "HEHE"."PRODUCTS" "p"
    WHERE (("p"."SLUG" = :slug_0) AND ("p"."IS_ACTIVE" = 1))
    FETCH FIRST 1 ROWS ONLY
) "p2"
LEFT JOIN "HEHE"."PRODUCT_VARIANTS" "p0" ON "p2"."ID" = "p0"."PRODUCT_ID"
LEFT JOIN "HEHE"."PRODUCT_IMAGES" "p1" ON "p2"."ID" = "p1"."PRODUCT_ID"
ORDER BY "p2"."ID", "p0"."ID"
2025-09-05 16:48:58.682 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."VARIANT_ID" "VariantId", COALESCE((
    SELECT COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")
    FROM "HEHE"."PRODUCT_PRICES" "p0"
    WHERE (((((("p0"."VARIANT_ID" = 3) AND ("p0"."STARTS_AT" <= :now_1))) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))) AND ("p"."VARIANT_ID" = "p0"."VARIANT_ID"))
    ORDER BY "p0"."STARTS_AT" DESC
    FETCH FIRST 1 ROWS ONLY), 0.0) "Price"
FROM "HEHE"."PRODUCT_PRICES" "p"
WHERE (((("p"."VARIANT_ID" = 3) AND ("p"."STARTS_AT" <= :now_1))) AND ((("p"."ENDS_AT" IS NULL) OR ("p"."ENDS_AT" > :now_2))))
GROUP BY "p"."VARIANT_ID"
2025-09-05 16:48:58.684 +07:00 [INF] Executing OkObjectResult, writing value of type 'PHONE_STORE.API.Controllers.ShopProductsController+ShopProductDetail'.
2025-09-05 16:48:58.685 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API) in 10.0184ms
2025-09-05 16:48:58.686 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API)'
2025-09-05 16:48:58.687 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products/galaxy-s24 - 200 null application/json; charset=utf-8 14.4741ms
2025-09-05 16:48:58.704 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 16:48:58.707 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:48:58.709 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 16:48:58.714 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:48:58.719 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:48:58.724 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 16:48:58.727 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 16:48:58.729 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 18.2429ms
2025-09-05 16:48:58.730 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:48:58.731 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 26.9962ms
2025-09-05 16:48:58.989 +07:00 [INF] Request starting HTTP/1.1 POST https://localhost:7277/api/shop/cart/items - application/json; charset=utf-8 null
2025-09-05 16:48:58.991 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Add (PHONE_STORE.API)'
2025-09-05 16:48:58.991 +07:00 [INF] Route matched with {action = "Add", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Add(PHONE_STORE.Application.Dtos.CartItemUpsertDto, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 16:48:58.994 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:48:58.997 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64), :dto_VariantId_1='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE"
FROM "HEHE"."CART_ITEMS" "c"
WHERE (("c"."CART_ID" = :id_0) AND ("c"."VARIANT_ID" = :dto_VariantId_1))
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:48:59.001 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:p1='?' (DbType = Int64), :p2='?' (DbType = Int64), :p0='?' (DbType = Int32), :cur0='?' (Direction = Output) (DbType = Object)], CommandType='"Text"', CommandTimeout='0']
DECLARE

v_RowCount INTEGER;

BEGIN

UPDATE "HEHE"."CART_ITEMS" SET "QUANTITY" = :p0
WHERE "CART_ID" = :p1 AND "VARIANT_ID" = :p2;
v_RowCount := SQL%ROWCOUNT;
OPEN :cur0 FOR SELECT v_RowCount FROM DUAL;

END;
2025-09-05 16:48:59.005 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:48:59.007 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:48:59.010 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 16:48:59.011 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 16:48:59.012 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Add (PHONE_STORE.API) in 20.1158ms
2025-09-05 16:48:59.013 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Add (PHONE_STORE.API)'
2025-09-05 16:48:59.014 +07:00 [INF] Request finished HTTP/1.1 POST https://localhost:7277/api/shop/cart/items - 200 null application/json; charset=utf-8 24.5072ms
2025-09-05 16:48:59.019 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products/galaxy-s24 - null null
2025-09-05 16:48:59.020 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API)'
2025-09-05 16:48:59.021 +07:00 [INF] Route matched with {action = "Details", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductDetail]] Details(System.String, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 16:48:59.024 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:slug_0='?' (Size = 220)], CommandType='"Text"', CommandTimeout='0']
SELECT "p2"."ID", "p2"."BRAND_ID", "p2"."CREATED_AT", "p2"."DEFAULT_CATEGORY_ID", "p2"."DESCRIPTION", "p2"."IS_ACTIVE", "p2"."NAME", "p2"."SLUG", "p2"."SPEC_JSON", "p0"."ID", "p0"."BARCODE", "p0"."COLOR", "p0"."IS_ACTIVE", "p0"."PRODUCT_ID", "p0"."SKU", "p0"."STORAGE_GB", "p0"."WEIGHT_GRAM", "p1"."ID", "p1"."ALT_TEXT", "p1"."IMAGE_URL", "p1"."IS_PRIMARY", "p1"."PRODUCT_ID", "p1"."SORT_ORDER", "p1"."VARIANT_ID"
FROM (
    SELECT "p"."ID", "p"."BRAND_ID", "p"."CREATED_AT", "p"."DEFAULT_CATEGORY_ID", "p"."DESCRIPTION", "p"."IS_ACTIVE", "p"."NAME", "p"."SLUG", "p"."SPEC_JSON"
    FROM "HEHE"."PRODUCTS" "p"
    WHERE (("p"."SLUG" = :slug_0) AND ("p"."IS_ACTIVE" = 1))
    FETCH FIRST 1 ROWS ONLY
) "p2"
LEFT JOIN "HEHE"."PRODUCT_VARIANTS" "p0" ON "p2"."ID" = "p0"."PRODUCT_ID"
LEFT JOIN "HEHE"."PRODUCT_IMAGES" "p1" ON "p2"."ID" = "p1"."PRODUCT_ID"
ORDER BY "p2"."ID", "p0"."ID"
2025-09-05 16:48:59.027 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."VARIANT_ID" "VariantId", COALESCE((
    SELECT COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")
    FROM "HEHE"."PRODUCT_PRICES" "p0"
    WHERE (((((("p0"."VARIANT_ID" = 3) AND ("p0"."STARTS_AT" <= :now_1))) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))) AND ("p"."VARIANT_ID" = "p0"."VARIANT_ID"))
    ORDER BY "p0"."STARTS_AT" DESC
    FETCH FIRST 1 ROWS ONLY), 0.0) "Price"
FROM "HEHE"."PRODUCT_PRICES" "p"
WHERE (((("p"."VARIANT_ID" = 3) AND ("p"."STARTS_AT" <= :now_1))) AND ((("p"."ENDS_AT" IS NULL) OR ("p"."ENDS_AT" > :now_2))))
GROUP BY "p"."VARIANT_ID"
2025-09-05 16:48:59.029 +07:00 [INF] Executing OkObjectResult, writing value of type 'PHONE_STORE.API.Controllers.ShopProductsController+ShopProductDetail'.
2025-09-05 16:48:59.029 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API) in 7.8217ms
2025-09-05 16:48:59.030 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API)'
2025-09-05 16:48:59.031 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products/galaxy-s24 - 200 null application/json; charset=utf-8 12.6088ms
2025-09-05 16:48:59.048 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 16:48:59.051 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:48:59.052 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 16:48:59.056 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:48:59.060 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:48:59.065 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 16:48:59.068 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 16:48:59.069 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 15.5937ms
2025-09-05 16:48:59.070 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:48:59.071 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 22.5449ms
2025-09-05 16:49:00.257 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 16:49:00.258 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:49:00.259 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 16:49:00.262 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:49:00.265 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:49:00.268 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 16:49:00.269 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 16:49:00.269 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 9.4192ms
2025-09-05 16:49:00.270 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:49:00.271 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 14.2403ms
2025-09-05 16:49:00.287 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 16:49:00.289 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:49:00.290 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 16:49:00.294 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:49:00.297 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:49:00.302 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 16:49:00.305 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 16:49:00.306 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 14.9243ms
2025-09-05 16:49:00.307 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:49:00.308 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 20.9452ms
2025-09-05 16:49:02.323 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - null null
2025-09-05 16:49:02.326 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 16:49:02.326 +07:00 [INF] Route matched with {action = "List", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem]]] List(System.String, System.Nullable`1[System.Int64], Int32, Int32, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 16:49:02.329 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:p_0='?' (DbType = Int32), :p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."ID" "Id", "p"."NAME" "Name", "p"."SLUG" "Slug"
FROM "HEHE"."PRODUCTS" "p"
WHERE "p"."IS_ACTIVE" = 1
ORDER BY "p"."CREATED_AT" DESC
OFFSET :p_0 ROWS FETCH NEXT :p_1 ROWS ONLY
2025-09-05 16:49:02.333 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", (
    SELECT "p0"."IMAGE_URL"
    FROM "HEHE"."PRODUCT_IMAGES" "p0"
    WHERE (("p0"."PRODUCT_ID" IS NOT NULL AND "p0"."PRODUCT_ID" IN (3, 2, 1)) AND ("p"."PRODUCT_ID" = "p0"."PRODUCT_ID"))
    ORDER BY "p0"."SORT_ORDER"
    FETCH FIRST 1 ROWS ONLY) "Url"
FROM "HEHE"."PRODUCT_IMAGES" "p"
WHERE "p"."PRODUCT_ID" IS NOT NULL AND "p"."PRODUCT_ID" IN (3, 2, 1)
GROUP BY "p"."PRODUCT_ID"
2025-09-05 16:49:02.336 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", MIN(COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")) "MinPrice"
FROM "HEHE"."PRODUCT_VARIANTS" "p"
INNER JOIN "HEHE"."PRODUCT_PRICES" "p0" ON "p"."ID" = "p0"."VARIANT_ID"
WHERE (("p"."PRODUCT_ID" IN (3, 2, 1)) AND ((("p0"."STARTS_AT" <= :now_1) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))))
GROUP BY "p"."PRODUCT_ID"
2025-09-05 16:49:02.338 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem, PHONE_STORE.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-05 16:49:02.339 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API) in 11.525ms
2025-09-05 16:49:02.340 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 16:49:02.340 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - 200 null application/json; charset=utf-8 17.2824ms
2025-09-05 16:49:02.358 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 16:49:02.361 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:49:02.362 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 16:49:02.367 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:49:02.371 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:49:02.375 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 16:49:02.377 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 16:49:02.378 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 12.8472ms
2025-09-05 16:49:02.379 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:49:02.380 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 22.0312ms
2025-09-05 16:49:04.480 +07:00 [INF] Request starting HTTP/1.1 POST https://localhost:7277/api/auth/logout - application/json; charset=utf-8 null
2025-09-05 16:49:04.483 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.AuthController.Logout (PHONE_STORE.API)'
2025-09-05 16:49:04.484 +07:00 [INF] Route matched with {action = "Logout", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Logout(RefreshRequest, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.AuthController (PHONE_STORE.API).
2025-09-05 16:49:04.486 +07:00 [INF] Logout: revoked RT
2025-09-05 16:49:04.486 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType1`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-05 16:49:04.487 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.AuthController.Logout (PHONE_STORE.API) in 2.5925ms
2025-09-05 16:49:04.488 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.AuthController.Logout (PHONE_STORE.API)'
2025-09-05 16:49:04.489 +07:00 [INF] Request finished HTTP/1.1 POST https://localhost:7277/api/auth/logout - 200 null application/json; charset=utf-8 8.2988ms
2025-09-05 16:49:04.498 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - null null
2025-09-05 16:49:04.499 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 16:49:04.500 +07:00 [INF] Route matched with {action = "List", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem]]] List(System.String, System.Nullable`1[System.Int64], Int32, Int32, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 16:49:04.503 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:p_0='?' (DbType = Int32), :p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."ID" "Id", "p"."NAME" "Name", "p"."SLUG" "Slug"
FROM "HEHE"."PRODUCTS" "p"
WHERE "p"."IS_ACTIVE" = 1
ORDER BY "p"."CREATED_AT" DESC
OFFSET :p_0 ROWS FETCH NEXT :p_1 ROWS ONLY
2025-09-05 16:49:04.506 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", (
    SELECT "p0"."IMAGE_URL"
    FROM "HEHE"."PRODUCT_IMAGES" "p0"
    WHERE (("p0"."PRODUCT_ID" IS NOT NULL AND "p0"."PRODUCT_ID" IN (3, 2, 1)) AND ("p"."PRODUCT_ID" = "p0"."PRODUCT_ID"))
    ORDER BY "p0"."SORT_ORDER"
    FETCH FIRST 1 ROWS ONLY) "Url"
FROM "HEHE"."PRODUCT_IMAGES" "p"
WHERE "p"."PRODUCT_ID" IS NOT NULL AND "p"."PRODUCT_ID" IN (3, 2, 1)
GROUP BY "p"."PRODUCT_ID"
2025-09-05 16:49:04.509 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", MIN(COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")) "MinPrice"
FROM "HEHE"."PRODUCT_VARIANTS" "p"
INNER JOIN "HEHE"."PRODUCT_PRICES" "p0" ON "p"."ID" = "p0"."VARIANT_ID"
WHERE (("p"."PRODUCT_ID" IN (3, 2, 1)) AND ((("p0"."STARTS_AT" <= :now_1) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))))
GROUP BY "p"."PRODUCT_ID"
2025-09-05 16:49:04.511 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem, PHONE_STORE.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-05 16:49:04.511 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API) in 10.7414ms
2025-09-05 16:49:04.512 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 16:49:04.513 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - 200 null application/json; charset=utf-8 15.3954ms
2025-09-05 16:49:04.529 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 16:49:04.531 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:49:04.532 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 16:49:04.537 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:49:04.540 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:49:04.543 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 16:49:04.545 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 16:49:04.546 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 12.5779ms
2025-09-05 16:49:04.548 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:49:04.549 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 19.9493ms
2025-09-05 16:49:20.476 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 16:49:20.478 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:49:20.478 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 16:49:20.485 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:49:20.509 +07:00 [INF] Executed DbCommand (17ms) [Parameters=[:p0='?' (DbType = DateTime), :p1='?' (Size = 2000), :p2='?' (DbType = Int64), :p3='?' (Size = 64), :p4='?' (Size = 2000), :p5='?' (DbType = DateTime), :cur0='?' (Direction = Output) (DbType = Object)], CommandType='"Text"', CommandTimeout='0']
DECLARE

TYPE "rCARTS_0" IS RECORD
(
"ID" NUMBER(19)
);
TYPE "tCARTS_0" IS TABLE OF "rCARTS_0";
"lCARTS_0" "tCARTS_0";

BEGIN

"lCARTS_0" := "tCARTS_0"();
"lCARTS_0".extend(1);
INSERT INTO "HEHE"."CARTS" ("CREATED_AT", "CURRENCY", "CUSTOMER_ID", "SESSION_TOKEN", "STATUS", "UPDATED_AT")
VALUES (:p0, :p1, :p2, :p3, :p4, :p5)
RETURNING "ID" INTO "lCARTS_0"(1)."ID";
OPEN :cur0 FOR SELECT "lCARTS_0"(1)."ID" FROM DUAL;

END;
2025-09-05 16:49:20.518 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:49:20.524 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 16:49:20.526 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 16:49:20.526 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 46.5013ms
2025-09-05 16:49:20.528 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:49:20.529 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 53.1393ms
2025-09-05 16:49:29.089 +07:00 [INF] Request starting HTTP/1.1 POST https://localhost:7277/api/auth/login - application/json; charset=utf-8 null
2025-09-05 16:49:29.091 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.AuthController.Login (PHONE_STORE.API)'
2025-09-05 16:49:29.091 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(LoginRequest, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.AuthController (PHONE_STORE.API).
2025-09-05 16:49:29.099 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:uname_0='?' (Size = 450), :username_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='0']
SELECT "u"."ID", "u"."CREATED_AT", "u"."EMAIL", "u"."PASSWORD_HASH", "u"."PHONE", "u"."STATUS"
FROM "USER_ACCOUNTS" "u"
WHERE (("u"."EMAIL" = :uname_0) OR ("u"."PHONE" = :username_1))
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:49:29.325 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[:userId_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "r"."CODE"
FROM "USER_ROLES" "u"
INNER JOIN "ROLES" "r" ON "u"."ROLE_ID" = "r"."ID"
WHERE "u"."USER_ID" = :userId_0
2025-09-05 16:49:29.328 +07:00 [INF] Login success [21]
2025-09-05 16:49:29.330 +07:00 [INF] Executing OkObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.AuthResponseDto'.
2025-09-05 16:49:29.330 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.AuthController.Login (PHONE_STORE.API) in 238.5051ms
2025-09-05 16:49:29.331 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.AuthController.Login (PHONE_STORE.API)'
2025-09-05 16:49:29.332 +07:00 [INF] Request finished HTTP/1.1 POST https://localhost:7277/api/auth/login - 200 null application/json; charset=utf-8 243.3602ms
2025-09-05 16:49:29.334 +07:00 [INF] Request starting HTTP/1.1 POST https://localhost:7277/api/shop/cart/merge - null 0
2025-09-05 16:49:29.335 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Merge (PHONE_STORE.API)'
2025-09-05 16:49:29.336 +07:00 [INF] Route matched with {action = "Merge", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Merge(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 16:49:29.337 +07:00 [INF] Executing StatusCodeResult, setting HTTP status code 200
2025-09-05 16:49:29.338 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Merge (PHONE_STORE.API) in 0.7561ms
2025-09-05 16:49:29.339 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Merge (PHONE_STORE.API)'
2025-09-05 16:49:29.340 +07:00 [INF] Request finished HTTP/1.1 POST https://localhost:7277/api/shop/cart/merge - 200 0 null 6.1604ms
2025-09-05 16:49:29.352 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - null null
2025-09-05 16:49:29.354 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 16:49:29.354 +07:00 [INF] Route matched with {action = "List", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem]]] List(System.String, System.Nullable`1[System.Int64], Int32, Int32, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 16:49:29.360 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:p_0='?' (DbType = Int32), :p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."ID" "Id", "p"."NAME" "Name", "p"."SLUG" "Slug"
FROM "HEHE"."PRODUCTS" "p"
WHERE "p"."IS_ACTIVE" = 1
ORDER BY "p"."CREATED_AT" DESC
OFFSET :p_0 ROWS FETCH NEXT :p_1 ROWS ONLY
2025-09-05 16:49:29.366 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", (
    SELECT "p0"."IMAGE_URL"
    FROM "HEHE"."PRODUCT_IMAGES" "p0"
    WHERE (("p0"."PRODUCT_ID" IS NOT NULL AND "p0"."PRODUCT_ID" IN (3, 2, 1)) AND ("p"."PRODUCT_ID" = "p0"."PRODUCT_ID"))
    ORDER BY "p0"."SORT_ORDER"
    FETCH FIRST 1 ROWS ONLY) "Url"
FROM "HEHE"."PRODUCT_IMAGES" "p"
WHERE "p"."PRODUCT_ID" IS NOT NULL AND "p"."PRODUCT_ID" IN (3, 2, 1)
GROUP BY "p"."PRODUCT_ID"
2025-09-05 16:49:29.372 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", MIN(COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")) "MinPrice"
FROM "HEHE"."PRODUCT_VARIANTS" "p"
INNER JOIN "HEHE"."PRODUCT_PRICES" "p0" ON "p"."ID" = "p0"."VARIANT_ID"
WHERE (("p"."PRODUCT_ID" IN (3, 2, 1)) AND ((("p0"."STARTS_AT" <= :now_1) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))))
GROUP BY "p"."PRODUCT_ID"
2025-09-05 16:49:29.374 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem, PHONE_STORE.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-05 16:49:29.375 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API) in 19.9372ms
2025-09-05 16:49:29.376 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 16:49:29.377 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - 200 null application/json; charset=utf-8 24.6276ms
2025-09-05 16:49:29.394 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 16:49:29.397 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:49:29.399 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 16:49:29.405 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:49:29.410 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:49:29.419 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 16:49:29.421 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 16:49:29.422 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 20.3476ms
2025-09-05 16:49:29.423 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:49:29.424 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 29.5773ms
2025-09-05 16:49:31.926 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products/galaxy-s24 - null null
2025-09-05 16:49:31.928 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API)'
2025-09-05 16:49:31.929 +07:00 [INF] Route matched with {action = "Details", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductDetail]] Details(System.String, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 16:49:31.933 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:slug_0='?' (Size = 220)], CommandType='"Text"', CommandTimeout='0']
SELECT "p2"."ID", "p2"."BRAND_ID", "p2"."CREATED_AT", "p2"."DEFAULT_CATEGORY_ID", "p2"."DESCRIPTION", "p2"."IS_ACTIVE", "p2"."NAME", "p2"."SLUG", "p2"."SPEC_JSON", "p0"."ID", "p0"."BARCODE", "p0"."COLOR", "p0"."IS_ACTIVE", "p0"."PRODUCT_ID", "p0"."SKU", "p0"."STORAGE_GB", "p0"."WEIGHT_GRAM", "p1"."ID", "p1"."ALT_TEXT", "p1"."IMAGE_URL", "p1"."IS_PRIMARY", "p1"."PRODUCT_ID", "p1"."SORT_ORDER", "p1"."VARIANT_ID"
FROM (
    SELECT "p"."ID", "p"."BRAND_ID", "p"."CREATED_AT", "p"."DEFAULT_CATEGORY_ID", "p"."DESCRIPTION", "p"."IS_ACTIVE", "p"."NAME", "p"."SLUG", "p"."SPEC_JSON"
    FROM "HEHE"."PRODUCTS" "p"
    WHERE (("p"."SLUG" = :slug_0) AND ("p"."IS_ACTIVE" = 1))
    FETCH FIRST 1 ROWS ONLY
) "p2"
LEFT JOIN "HEHE"."PRODUCT_VARIANTS" "p0" ON "p2"."ID" = "p0"."PRODUCT_ID"
LEFT JOIN "HEHE"."PRODUCT_IMAGES" "p1" ON "p2"."ID" = "p1"."PRODUCT_ID"
ORDER BY "p2"."ID", "p0"."ID"
2025-09-05 16:49:31.937 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."VARIANT_ID" "VariantId", COALESCE((
    SELECT COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")
    FROM "HEHE"."PRODUCT_PRICES" "p0"
    WHERE (((((("p0"."VARIANT_ID" = 3) AND ("p0"."STARTS_AT" <= :now_1))) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))) AND ("p"."VARIANT_ID" = "p0"."VARIANT_ID"))
    ORDER BY "p0"."STARTS_AT" DESC
    FETCH FIRST 1 ROWS ONLY), 0.0) "Price"
FROM "HEHE"."PRODUCT_PRICES" "p"
WHERE (((("p"."VARIANT_ID" = 3) AND ("p"."STARTS_AT" <= :now_1))) AND ((("p"."ENDS_AT" IS NULL) OR ("p"."ENDS_AT" > :now_2))))
GROUP BY "p"."VARIANT_ID"
2025-09-05 16:49:31.938 +07:00 [INF] Executing OkObjectResult, writing value of type 'PHONE_STORE.API.Controllers.ShopProductsController+ShopProductDetail'.
2025-09-05 16:49:31.939 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API) in 8.4692ms
2025-09-05 16:49:31.940 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API)'
2025-09-05 16:49:31.941 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products/galaxy-s24 - 200 null application/json; charset=utf-8 14.2431ms
2025-09-05 16:49:31.958 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 16:49:31.960 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:49:31.961 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 16:49:31.964 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:49:31.967 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:49:31.970 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 16:49:31.973 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 16:49:31.974 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 11.5104ms
2025-09-05 16:49:31.975 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:49:31.975 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 17.1643ms
2025-09-05 16:49:32.853 +07:00 [INF] Request starting HTTP/1.1 POST https://localhost:7277/api/shop/cart/items - application/json; charset=utf-8 null
2025-09-05 16:49:32.855 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Add (PHONE_STORE.API)'
2025-09-05 16:49:32.856 +07:00 [INF] Route matched with {action = "Add", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Add(PHONE_STORE.Application.Dtos.CartItemUpsertDto, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 16:49:32.859 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:49:32.863 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64), :dto_VariantId_1='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE"
FROM "HEHE"."CART_ITEMS" "c"
WHERE (("c"."CART_ID" = :id_0) AND ("c"."VARIANT_ID" = :dto_VariantId_1))
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:49:32.865 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[:variantId_0='?' (DbType = Int64), :now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT COALESCE("p"."SALE_PRICE", "p"."LIST_PRICE")
FROM "HEHE"."PRODUCT_PRICES" "p"
WHERE (((("p"."VARIANT_ID" = :variantId_0) AND ("p"."STARTS_AT" <= :now_1))) AND ((("p"."ENDS_AT" IS NULL) OR ("p"."ENDS_AT" >= :now_2))))
ORDER BY "p"."STARTS_AT" DESC
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:49:32.869 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:p0='?' (DbType = Int64), :p1='?' (DbType = Int64), :p2='?' (DbType = DateTime), :p3='?' (Size = 2000), :p4='?' (DbType = Int32), :p5='?' (DbType = Decimal)], CommandType='"Text"', CommandTimeout='0']
DECLARE


BEGIN

INSERT INTO "HEHE"."CART_ITEMS" ("CART_ID", "VARIANT_ID", "ADDED_AT", "CURRENCY", "QUANTITY", "UNIT_PRICE")
VALUES (:p0, :p1, :p2, :p3, :p4, :p5);

END;
2025-09-05 16:49:32.883 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:49:32.886 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:49:32.888 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 16:49:32.889 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 16:49:32.890 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Add (PHONE_STORE.API) in 33.5618ms
2025-09-05 16:49:32.891 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Add (PHONE_STORE.API)'
2025-09-05 16:49:32.891 +07:00 [INF] Request finished HTTP/1.1 POST https://localhost:7277/api/shop/cart/items - 200 null application/json; charset=utf-8 38.7327ms
2025-09-05 16:49:32.896 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products/galaxy-s24 - null null
2025-09-05 16:49:32.898 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API)'
2025-09-05 16:49:32.898 +07:00 [INF] Route matched with {action = "Details", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductDetail]] Details(System.String, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 16:49:32.901 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:slug_0='?' (Size = 220)], CommandType='"Text"', CommandTimeout='0']
SELECT "p2"."ID", "p2"."BRAND_ID", "p2"."CREATED_AT", "p2"."DEFAULT_CATEGORY_ID", "p2"."DESCRIPTION", "p2"."IS_ACTIVE", "p2"."NAME", "p2"."SLUG", "p2"."SPEC_JSON", "p0"."ID", "p0"."BARCODE", "p0"."COLOR", "p0"."IS_ACTIVE", "p0"."PRODUCT_ID", "p0"."SKU", "p0"."STORAGE_GB", "p0"."WEIGHT_GRAM", "p1"."ID", "p1"."ALT_TEXT", "p1"."IMAGE_URL", "p1"."IS_PRIMARY", "p1"."PRODUCT_ID", "p1"."SORT_ORDER", "p1"."VARIANT_ID"
FROM (
    SELECT "p"."ID", "p"."BRAND_ID", "p"."CREATED_AT", "p"."DEFAULT_CATEGORY_ID", "p"."DESCRIPTION", "p"."IS_ACTIVE", "p"."NAME", "p"."SLUG", "p"."SPEC_JSON"
    FROM "HEHE"."PRODUCTS" "p"
    WHERE (("p"."SLUG" = :slug_0) AND ("p"."IS_ACTIVE" = 1))
    FETCH FIRST 1 ROWS ONLY
) "p2"
LEFT JOIN "HEHE"."PRODUCT_VARIANTS" "p0" ON "p2"."ID" = "p0"."PRODUCT_ID"
LEFT JOIN "HEHE"."PRODUCT_IMAGES" "p1" ON "p2"."ID" = "p1"."PRODUCT_ID"
ORDER BY "p2"."ID", "p0"."ID"
2025-09-05 16:49:32.905 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."VARIANT_ID" "VariantId", COALESCE((
    SELECT COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")
    FROM "HEHE"."PRODUCT_PRICES" "p0"
    WHERE (((((("p0"."VARIANT_ID" = 3) AND ("p0"."STARTS_AT" <= :now_1))) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))) AND ("p"."VARIANT_ID" = "p0"."VARIANT_ID"))
    ORDER BY "p0"."STARTS_AT" DESC
    FETCH FIRST 1 ROWS ONLY), 0.0) "Price"
FROM "HEHE"."PRODUCT_PRICES" "p"
WHERE (((("p"."VARIANT_ID" = 3) AND ("p"."STARTS_AT" <= :now_1))) AND ((("p"."ENDS_AT" IS NULL) OR ("p"."ENDS_AT" > :now_2))))
GROUP BY "p"."VARIANT_ID"
2025-09-05 16:49:32.907 +07:00 [INF] Executing OkObjectResult, writing value of type 'PHONE_STORE.API.Controllers.ShopProductsController+ShopProductDetail'.
2025-09-05 16:49:32.907 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API) in 8.3126ms
2025-09-05 16:49:32.908 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API)'
2025-09-05 16:49:32.909 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products/galaxy-s24 - 200 null application/json; charset=utf-8 12.5935ms
2025-09-05 16:49:32.926 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 16:49:32.928 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:49:32.929 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 16:49:32.933 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:49:32.937 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 16:49:32.940 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 16:49:32.942 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 16:49:32.943 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 12.7137ms
2025-09-05 16:49:32.945 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 16:49:32.945 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 19.3186ms
2025-09-05 17:08:03.483 +07:00 [INF] User profile is available. Using 'C:\Users\Administrator\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-09-05 17:08:03.787 +07:00 [INF] Now listening on: https://localhost:7277
2025-09-05 17:08:03.789 +07:00 [INF] Now listening on: http://localhost:5209
2025-09-05 17:08:03.875 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-05 17:08:03.876 +07:00 [INF] Hosting environment: Development
2025-09-05 17:08:03.877 +07:00 [INF] Content root path: C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.API
2025-09-05 17:08:04.757 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/swagger/index.html - null null
2025-09-05 17:08:05.123 +07:00 [INF] REQ GET /swagger/index.html sid=0d2b62340b9744f1ad754dc55f322048 sub=null
2025-09-05 17:08:05.292 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/swagger/index.html - 200 null text/html;charset=utf-8 546.3361ms
2025-09-05 17:08:05.313 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/_vs/browserLink - null null
2025-09-05 17:08:05.314 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/_framework/aspnetcore-browser-refresh.js - null null
2025-09-05 17:08:05.384 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/_framework/aspnetcore-browser-refresh.js - 200 13766 application/javascript; charset=utf-8 70.4639ms
2025-09-05 17:08:05.488 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/_vs/browserLink - 200 null text/javascript; charset=UTF-8 175.2083ms
2025-09-05 17:08:05.525 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - null null
2025-09-05 17:08:05.543 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/swagger/v1/swagger.json - null null
2025-09-05 17:08:05.544 +07:00 [INF] REQ GET /api/shop/products sid=0d2b62340b9744f1ad754dc55f322048 sub=null
2025-09-05 17:08:05.545 +07:00 [INF] REQ GET /swagger/v1/swagger.json sid=0d2b62340b9744f1ad754dc55f322048 sub=null
2025-09-05 17:08:05.619 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 17:08:05.657 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 113.6396ms
2025-09-05 17:08:05.660 +07:00 [INF] Route matched with {action = "List", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem]]] List(System.String, System.Nullable`1[System.Int64], Int32, Int32, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 17:08:06.428 +07:00 [WRN] The decimal property 'UnitPrice' on entity type 'CartItem' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 17:08:06.431 +07:00 [WRN] The decimal property 'DecValue' on entity type 'ProductAttributeValue' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 17:08:06.433 +07:00 [WRN] The decimal property 'WeightGram' on entity type 'ProductVariant' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 17:08:07.165 +07:00 [INF] Executed DbCommand (130ms) [Parameters=[:p_0='?' (DbType = Int32), :p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."ID" "Id", "p"."NAME" "Name", "p"."SLUG" "Slug"
FROM "HEHE"."PRODUCTS" "p"
WHERE "p"."IS_ACTIVE" = 1
ORDER BY "p"."CREATED_AT" DESC
OFFSET :p_0 ROWS FETCH NEXT :p_1 ROWS ONLY
2025-09-05 17:08:07.278 +07:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", (
    SELECT "p0"."IMAGE_URL"
    FROM "HEHE"."PRODUCT_IMAGES" "p0"
    WHERE (("p0"."PRODUCT_ID" IS NOT NULL AND "p0"."PRODUCT_ID" IN (3, 2, 1)) AND ("p"."PRODUCT_ID" = "p0"."PRODUCT_ID"))
    ORDER BY "p0"."SORT_ORDER"
    FETCH FIRST 1 ROWS ONLY) "Url"
FROM "HEHE"."PRODUCT_IMAGES" "p"
WHERE "p"."PRODUCT_ID" IS NOT NULL AND "p"."PRODUCT_ID" IN (3, 2, 1)
GROUP BY "p"."PRODUCT_ID"
2025-09-05 17:08:07.328 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", MIN(COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")) "MinPrice"
FROM "HEHE"."PRODUCT_VARIANTS" "p"
INNER JOIN "HEHE"."PRODUCT_PRICES" "p0" ON "p"."ID" = "p0"."VARIANT_ID"
WHERE (("p"."PRODUCT_ID" IN (3, 2, 1)) AND ((("p0"."STARTS_AT" <= :now_1) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))))
GROUP BY "p"."PRODUCT_ID"
2025-09-05 17:08:07.344 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem, PHONE_STORE.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-05 17:08:07.359 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API) in 1695.0748ms
2025-09-05 17:08:07.361 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 17:08:07.368 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - 200 null application/json; charset=utf-8 1845.2824ms
2025-09-05 17:08:07.577 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 17:08:07.584 +07:00 [INF] REQ GET /api/shop/cart sid=0d2b62340b9744f1ad754dc55f322048 sub=null
2025-09-05 17:08:07.588 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 17:08:07.594 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 17:08:07.599 +07:00 [INF] GetCustomerId: no auth (sub missing). Using guest cart. sid=0d2b62340b9744f1ad754dc55f322048
2025-09-05 17:08:07.601 +07:00 [INF] Cart GET: customerId=null, sid=0d2b62340b9744f1ad754dc55f322048
2025-09-05 17:08:07.677 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:08:07.738 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:08:07.764 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 17:08:07.773 +07:00 [INF] Cart GET result: cartId=88, items=1, customerId=null, sid=0d2b62340b9744f1ad754dc55f322048
2025-09-05 17:08:07.775 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 17:08:07.783 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 187.276ms
2025-09-05 17:08:07.784 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 17:08:07.785 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 207.5316ms
2025-09-05 17:08:12.011 +07:00 [INF] Request starting HTTP/1.1 POST https://localhost:7277/api/auth/logout - application/json; charset=utf-8 null
2025-09-05 17:08:12.013 +07:00 [INF] REQ POST /api/auth/logout sid=null sub=null
2025-09-05 17:08:12.017 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.AuthController.Logout (PHONE_STORE.API)'
2025-09-05 17:08:12.021 +07:00 [INF] Route matched with {action = "Logout", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Logout(RefreshRequest, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.AuthController (PHONE_STORE.API).
2025-09-05 17:08:12.265 +07:00 [INF] Logout: revoked RT
2025-09-05 17:08:12.266 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType1`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-05 17:08:12.272 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.AuthController.Logout (PHONE_STORE.API) in 249.4831ms
2025-09-05 17:08:12.273 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.AuthController.Logout (PHONE_STORE.API)'
2025-09-05 17:08:12.274 +07:00 [INF] Request finished HTTP/1.1 POST https://localhost:7277/api/auth/logout - 200 null application/json; charset=utf-8 263.2889ms
2025-09-05 17:08:12.293 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - null null
2025-09-05 17:08:12.294 +07:00 [INF] REQ GET /api/shop/products sid=0d2b62340b9744f1ad754dc55f322048 sub=null
2025-09-05 17:08:12.295 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 17:08:12.296 +07:00 [INF] Route matched with {action = "List", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem]]] List(System.String, System.Nullable`1[System.Int64], Int32, Int32, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 17:08:12.316 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:p_0='?' (DbType = Int32), :p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."ID" "Id", "p"."NAME" "Name", "p"."SLUG" "Slug"
FROM "HEHE"."PRODUCTS" "p"
WHERE "p"."IS_ACTIVE" = 1
ORDER BY "p"."CREATED_AT" DESC
OFFSET :p_0 ROWS FETCH NEXT :p_1 ROWS ONLY
2025-09-05 17:08:12.320 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", (
    SELECT "p0"."IMAGE_URL"
    FROM "HEHE"."PRODUCT_IMAGES" "p0"
    WHERE (("p0"."PRODUCT_ID" IS NOT NULL AND "p0"."PRODUCT_ID" IN (3, 2, 1)) AND ("p"."PRODUCT_ID" = "p0"."PRODUCT_ID"))
    ORDER BY "p0"."SORT_ORDER"
    FETCH FIRST 1 ROWS ONLY) "Url"
FROM "HEHE"."PRODUCT_IMAGES" "p"
WHERE "p"."PRODUCT_ID" IS NOT NULL AND "p"."PRODUCT_ID" IN (3, 2, 1)
GROUP BY "p"."PRODUCT_ID"
2025-09-05 17:08:12.324 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", MIN(COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")) "MinPrice"
FROM "HEHE"."PRODUCT_VARIANTS" "p"
INNER JOIN "HEHE"."PRODUCT_PRICES" "p0" ON "p"."ID" = "p0"."VARIANT_ID"
WHERE (("p"."PRODUCT_ID" IN (3, 2, 1)) AND ((("p0"."STARTS_AT" <= :now_1) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))))
GROUP BY "p"."PRODUCT_ID"
2025-09-05 17:08:12.327 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem, PHONE_STORE.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-05 17:08:12.328 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API) in 31.4754ms
2025-09-05 17:08:12.330 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 17:08:12.331 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - 200 null application/json; charset=utf-8 38.065ms
2025-09-05 17:08:12.371 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 17:08:12.373 +07:00 [INF] REQ GET /api/shop/cart sid=0d2b62340b9744f1ad754dc55f322048 sub=null
2025-09-05 17:08:12.375 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 17:08:12.375 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 17:08:12.378 +07:00 [INF] GetCustomerId: no auth (sub missing). Using guest cart. sid=0d2b62340b9744f1ad754dc55f322048
2025-09-05 17:08:12.379 +07:00 [INF] Cart GET: customerId=null, sid=0d2b62340b9744f1ad754dc55f322048
2025-09-05 17:08:12.387 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:08:12.393 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:08:12.399 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 17:08:12.402 +07:00 [INF] Cart GET result: cartId=88, items=1, customerId=null, sid=0d2b62340b9744f1ad754dc55f322048
2025-09-05 17:08:12.403 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 17:08:12.404 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 26.805ms
2025-09-05 17:08:12.405 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 17:08:12.406 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 35.7151ms
2025-09-05 17:08:14.437 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 17:08:14.439 +07:00 [INF] REQ GET /api/shop/cart sid=0d2b62340b9744f1ad754dc55f322048 sub=null
2025-09-05 17:08:14.439 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 17:08:14.440 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 17:08:14.443 +07:00 [INF] GetCustomerId: no auth (sub missing). Using guest cart. sid=0d2b62340b9744f1ad754dc55f322048
2025-09-05 17:08:14.443 +07:00 [INF] Cart GET: customerId=null, sid=0d2b62340b9744f1ad754dc55f322048
2025-09-05 17:08:14.448 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:08:14.453 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:08:14.457 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 17:08:14.460 +07:00 [INF] Cart GET result: cartId=88, items=1, customerId=null, sid=0d2b62340b9744f1ad754dc55f322048
2025-09-05 17:08:14.461 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 17:08:14.462 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 20.8666ms
2025-09-05 17:08:14.463 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 17:08:14.464 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 27.1927ms
2025-09-05 17:08:19.753 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 17:08:19.755 +07:00 [INF] REQ GET /api/shop/cart sid=0d2b62340b9744f1ad754dc55f322048 sub=null
2025-09-05 17:08:19.757 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 17:08:19.757 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 17:08:19.759 +07:00 [INF] GetCustomerId: no auth (sub missing). Using guest cart. sid=0d2b62340b9744f1ad754dc55f322048
2025-09-05 17:08:19.760 +07:00 [INF] Cart GET: customerId=null, sid=0d2b62340b9744f1ad754dc55f322048
2025-09-05 17:08:19.770 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:08:19.778 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:08:19.788 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 17:08:19.791 +07:00 [INF] Cart GET result: cartId=88, items=1, customerId=null, sid=0d2b62340b9744f1ad754dc55f322048
2025-09-05 17:08:19.792 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 17:08:19.793 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 34.327ms
2025-09-05 17:08:19.795 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 17:08:19.796 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 42.5153ms
2025-09-05 17:08:38.869 +07:00 [INF] Request starting HTTP/1.1 POST https://localhost:7277/api/auth/register - application/json; charset=utf-8 null
2025-09-05 17:08:38.873 +07:00 [INF] REQ POST /api/auth/register sid=null sub=null
2025-09-05 17:08:38.874 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.AuthController.Register (PHONE_STORE.API)'
2025-09-05 17:08:38.878 +07:00 [INF] Route matched with {action = "Register", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Register(RegisterRequest, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.AuthController (PHONE_STORE.API).
2025-09-05 17:08:38.917 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[:em_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='0']
SELECT COUNT(*)
FROM "USER_ACCOUNTS" "u"
WHERE "u"."EMAIL" = :em_0
2025-09-05 17:08:38.932 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[:ph_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='0']
SELECT COUNT(*)
FROM "USER_ACCOUNTS" "u"
WHERE "u"."PHONE" = :ph_0
2025-09-05 17:08:38.935 +07:00 [INF] Executing BadRequestObjectResult, writing value of type '<>f__AnonymousType1`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-05 17:08:38.936 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.AuthController.Register (PHONE_STORE.API) in 56.156ms
2025-09-05 17:08:38.937 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.AuthController.Register (PHONE_STORE.API)'
2025-09-05 17:08:38.938 +07:00 [INF] Request finished HTTP/1.1 POST https://localhost:7277/api/auth/register - 400 null application/json; charset=utf-8 68.2749ms
2025-09-05 17:08:38.962 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 17:08:38.964 +07:00 [INF] REQ GET /api/shop/cart sid=0d2b62340b9744f1ad754dc55f322048 sub=null
2025-09-05 17:08:38.965 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 17:08:38.966 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 17:08:38.967 +07:00 [INF] GetCustomerId: no auth (sub missing). Using guest cart. sid=0d2b62340b9744f1ad754dc55f322048
2025-09-05 17:08:38.967 +07:00 [INF] Cart GET: customerId=null, sid=0d2b62340b9744f1ad754dc55f322048
2025-09-05 17:08:38.972 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:08:38.983 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:08:38.991 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 17:08:38.993 +07:00 [INF] Cart GET result: cartId=88, items=1, customerId=null, sid=0d2b62340b9744f1ad754dc55f322048
2025-09-05 17:08:38.994 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 17:08:38.996 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 29.2783ms
2025-09-05 17:08:38.997 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 17:08:38.998 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 35.6025ms
2025-09-05 17:08:55.869 +07:00 [INF] Request starting HTTP/1.1 POST https://localhost:7277/api/auth/register - application/json; charset=utf-8 null
2025-09-05 17:08:55.871 +07:00 [INF] REQ POST /api/auth/register sid=null sub=null
2025-09-05 17:08:55.871 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.AuthController.Register (PHONE_STORE.API)'
2025-09-05 17:08:55.872 +07:00 [INF] Route matched with {action = "Register", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Register(RegisterRequest, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.AuthController (PHONE_STORE.API).
2025-09-05 17:08:55.884 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:em_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='0']
SELECT COUNT(*)
FROM "USER_ACCOUNTS" "u"
WHERE "u"."EMAIL" = :em_0
2025-09-05 17:08:55.890 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:ph_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='0']
SELECT COUNT(*)
FROM "USER_ACCOUNTS" "u"
WHERE "u"."PHONE" = :ph_0
2025-09-05 17:08:56.331 +07:00 [INF] Executed DbCommand (37ms) [Parameters=[:p0='?' (DbType = DateTime), :p1='?' (Size = 450), :p2='?' (Size = 2000), :p3='?' (Size = 450), :p4='?' (Size = 2000), :cur0='?' (Direction = Output) (DbType = Object)], CommandType='"Text"', CommandTimeout='0']
DECLARE

TYPE "rUSER_ACCOUNTS_0" IS RECORD
(
"ID" NUMBER(19)
);
TYPE "tUSER_ACCOUNTS_0" IS TABLE OF "rUSER_ACCOUNTS_0";
"lUSER_ACCOUNTS_0" "tUSER_ACCOUNTS_0";

BEGIN

"lUSER_ACCOUNTS_0" := "tUSER_ACCOUNTS_0"();
"lUSER_ACCOUNTS_0".extend(1);
INSERT INTO "USER_ACCOUNTS" ("CREATED_AT", "EMAIL", "PASSWORD_HASH", "PHONE", "STATUS")
VALUES (:p0, :p1, :p2, :p3, :p4)
RETURNING "ID" INTO "lUSER_ACCOUNTS_0"(1)."ID";
OPEN :cur0 FOR SELECT "lUSER_ACCOUNTS_0"(1)."ID" FROM DUAL;

END;
2025-09-05 17:08:56.409 +07:00 [INF] Executed DbCommand (11ms) [Parameters=[:code_0='?' (Size = 2000)], CommandType='"Text"', CommandTimeout='0']
SELECT "r"."ID"
FROM "ROLES" "r"
WHERE UPPER("r"."CODE") = :code_0
FETCH FIRST 2 ROWS ONLY
2025-09-05 17:08:56.431 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[:p0='?' (DbType = Int64), :p1='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
DECLARE


BEGIN

INSERT INTO "USER_ROLES" ("ROLE_ID", "USER_ID")
VALUES (:p0, :p1);

END;
2025-09-05 17:08:56.434 +07:00 [INF] Register success [121]
2025-09-05 17:08:56.435 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType1`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-05 17:08:56.436 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.AuthController.Register (PHONE_STORE.API) in 561.8959ms
2025-09-05 17:08:56.437 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.AuthController.Register (PHONE_STORE.API)'
2025-09-05 17:08:56.438 +07:00 [INF] Request finished HTTP/1.1 POST https://localhost:7277/api/auth/register - 200 null application/json; charset=utf-8 568.9759ms
2025-09-05 17:08:56.467 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 17:08:56.470 +07:00 [INF] REQ GET /api/shop/cart sid=0d2b62340b9744f1ad754dc55f322048 sub=null
2025-09-05 17:08:56.471 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 17:08:56.472 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 17:08:56.475 +07:00 [INF] GetCustomerId: no auth (sub missing). Using guest cart. sid=0d2b62340b9744f1ad754dc55f322048
2025-09-05 17:08:56.476 +07:00 [INF] Cart GET: customerId=null, sid=0d2b62340b9744f1ad754dc55f322048
2025-09-05 17:08:56.485 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:08:56.495 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:08:56.502 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 17:08:56.508 +07:00 [INF] Cart GET result: cartId=88, items=1, customerId=null, sid=0d2b62340b9744f1ad754dc55f322048
2025-09-05 17:08:56.510 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 17:08:56.511 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 36.3959ms
2025-09-05 17:08:56.512 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 17:08:56.513 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 46.6934ms
2025-09-05 17:09:08.360 +07:00 [INF] Request starting HTTP/1.1 POST https://localhost:7277/api/auth/login - application/json; charset=utf-8 null
2025-09-05 17:09:08.362 +07:00 [INF] REQ POST /api/auth/login sid=null sub=null
2025-09-05 17:09:08.369 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.AuthController.Login (PHONE_STORE.API)'
2025-09-05 17:09:08.372 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(LoginRequest, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.AuthController (PHONE_STORE.API).
2025-09-05 17:09:08.394 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:uname_0='?' (Size = 450), :username_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='0']
SELECT "u"."ID", "u"."CREATED_AT", "u"."EMAIL", "u"."PASSWORD_HASH", "u"."PHONE", "u"."STATUS"
FROM "USER_ACCOUNTS" "u"
WHERE (("u"."EMAIL" = :uname_0) OR ("u"."PHONE" = :username_1))
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:09:08.656 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[:userId_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "r"."CODE"
FROM "USER_ROLES" "u"
INNER JOIN "ROLES" "r" ON "u"."ROLE_ID" = "r"."ID"
WHERE "u"."USER_ID" = :userId_0
2025-09-05 17:09:08.704 +07:00 [INF] Login success [121]
2025-09-05 17:09:08.711 +07:00 [INF] Executing OkObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.AuthResponseDto'.
2025-09-05 17:09:08.716 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.AuthController.Login (PHONE_STORE.API) in 342.692ms
2025-09-05 17:09:08.717 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.AuthController.Login (PHONE_STORE.API)'
2025-09-05 17:09:08.719 +07:00 [INF] Request finished HTTP/1.1 POST https://localhost:7277/api/auth/login - 200 null application/json; charset=utf-8 359.0994ms
2025-09-05 17:09:08.736 +07:00 [INF] Request starting HTTP/1.1 POST https://localhost:7277/api/shop/cart/merge - null 0
2025-09-05 17:09:08.737 +07:00 [INF] REQ POST /api/shop/cart/merge sid=0d2b62340b9744f1ad754dc55f322048 sub=null
2025-09-05 17:09:08.784 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Merge (PHONE_STORE.API)'
2025-09-05 17:09:08.787 +07:00 [INF] Route matched with {action = "Merge", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Merge(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 17:09:08.792 +07:00 [INF] GetCustomerId: no auth (sub missing). Using guest cart. sid=0d2b62340b9744f1ad754dc55f322048
2025-09-05 17:09:08.793 +07:00 [WRN] Cart MERGE: authenticated but no customer row. sid=0d2b62340b9744f1ad754dc55f322048
2025-09-05 17:09:08.796 +07:00 [INF] Executing StatusCodeResult, setting HTTP status code 200
2025-09-05 17:09:08.797 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Merge (PHONE_STORE.API) in 7.0554ms
2025-09-05 17:09:08.798 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Merge (PHONE_STORE.API)'
2025-09-05 17:09:08.799 +07:00 [INF] Request finished HTTP/1.1 POST https://localhost:7277/api/shop/cart/merge - 200 0 null 63.0419ms
2025-09-05 17:09:08.809 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - null null
2025-09-05 17:09:08.810 +07:00 [INF] REQ GET /api/shop/products sid=0d2b62340b9744f1ad754dc55f322048 sub=null
2025-09-05 17:09:08.812 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 17:09:08.812 +07:00 [INF] Route matched with {action = "List", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem]]] List(System.String, System.Nullable`1[System.Int64], Int32, Int32, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 17:09:08.818 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:p_0='?' (DbType = Int32), :p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."ID" "Id", "p"."NAME" "Name", "p"."SLUG" "Slug"
FROM "HEHE"."PRODUCTS" "p"
WHERE "p"."IS_ACTIVE" = 1
ORDER BY "p"."CREATED_AT" DESC
OFFSET :p_0 ROWS FETCH NEXT :p_1 ROWS ONLY
2025-09-05 17:09:08.825 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", (
    SELECT "p0"."IMAGE_URL"
    FROM "HEHE"."PRODUCT_IMAGES" "p0"
    WHERE (("p0"."PRODUCT_ID" IS NOT NULL AND "p0"."PRODUCT_ID" IN (3, 2, 1)) AND ("p"."PRODUCT_ID" = "p0"."PRODUCT_ID"))
    ORDER BY "p0"."SORT_ORDER"
    FETCH FIRST 1 ROWS ONLY) "Url"
FROM "HEHE"."PRODUCT_IMAGES" "p"
WHERE "p"."PRODUCT_ID" IS NOT NULL AND "p"."PRODUCT_ID" IN (3, 2, 1)
GROUP BY "p"."PRODUCT_ID"
2025-09-05 17:09:08.831 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", MIN(COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")) "MinPrice"
FROM "HEHE"."PRODUCT_VARIANTS" "p"
INNER JOIN "HEHE"."PRODUCT_PRICES" "p0" ON "p"."ID" = "p0"."VARIANT_ID"
WHERE (("p"."PRODUCT_ID" IN (3, 2, 1)) AND ((("p0"."STARTS_AT" <= :now_1) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))))
GROUP BY "p"."PRODUCT_ID"
2025-09-05 17:09:08.835 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem, PHONE_STORE.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-05 17:09:08.836 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API) in 22.7431ms
2025-09-05 17:09:08.837 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 17:09:08.838 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - 200 null application/json; charset=utf-8 28.9439ms
2025-09-05 17:09:08.860 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 17:09:08.862 +07:00 [INF] REQ GET /api/shop/cart sid=0d2b62340b9744f1ad754dc55f322048 sub=null
2025-09-05 17:09:08.864 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 17:09:08.865 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 17:09:08.867 +07:00 [INF] GetCustomerId: no auth (sub missing). Using guest cart. sid=0d2b62340b9744f1ad754dc55f322048
2025-09-05 17:09:08.867 +07:00 [INF] Cart GET: customerId=null, sid=0d2b62340b9744f1ad754dc55f322048
2025-09-05 17:09:08.871 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:09:08.875 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:09:08.886 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 17:09:08.897 +07:00 [INF] Cart GET result: cartId=88, items=1, customerId=null, sid=0d2b62340b9744f1ad754dc55f322048
2025-09-05 17:09:08.900 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 17:09:08.903 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 36.2911ms
2025-09-05 17:09:08.910 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 17:09:08.912 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 52.2963ms
2025-09-05 17:09:11.681 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products/iphone-15 - null null
2025-09-05 17:09:11.684 +07:00 [INF] REQ GET /api/shop/products/iphone-15 sid=0d2b62340b9744f1ad754dc55f322048 sub=null
2025-09-05 17:09:11.685 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API)'
2025-09-05 17:09:11.691 +07:00 [INF] Route matched with {action = "Details", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductDetail]] Details(System.String, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 17:09:11.737 +07:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-09-05 17:09:11.758 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:slug_0='?' (Size = 220)], CommandType='"Text"', CommandTimeout='0']
SELECT "p2"."ID", "p2"."BRAND_ID", "p2"."CREATED_AT", "p2"."DEFAULT_CATEGORY_ID", "p2"."DESCRIPTION", "p2"."IS_ACTIVE", "p2"."NAME", "p2"."SLUG", "p2"."SPEC_JSON", "p0"."ID", "p0"."BARCODE", "p0"."COLOR", "p0"."IS_ACTIVE", "p0"."PRODUCT_ID", "p0"."SKU", "p0"."STORAGE_GB", "p0"."WEIGHT_GRAM", "p1"."ID", "p1"."ALT_TEXT", "p1"."IMAGE_URL", "p1"."IS_PRIMARY", "p1"."PRODUCT_ID", "p1"."SORT_ORDER", "p1"."VARIANT_ID"
FROM (
    SELECT "p"."ID", "p"."BRAND_ID", "p"."CREATED_AT", "p"."DEFAULT_CATEGORY_ID", "p"."DESCRIPTION", "p"."IS_ACTIVE", "p"."NAME", "p"."SLUG", "p"."SPEC_JSON"
    FROM "HEHE"."PRODUCTS" "p"
    WHERE (("p"."SLUG" = :slug_0) AND ("p"."IS_ACTIVE" = 1))
    FETCH FIRST 1 ROWS ONLY
) "p2"
LEFT JOIN "HEHE"."PRODUCT_VARIANTS" "p0" ON "p2"."ID" = "p0"."PRODUCT_ID"
LEFT JOIN "HEHE"."PRODUCT_IMAGES" "p1" ON "p2"."ID" = "p1"."PRODUCT_ID"
ORDER BY "p2"."ID", "p0"."ID"
2025-09-05 17:09:11.803 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."VARIANT_ID" "VariantId", COALESCE((
    SELECT COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")
    FROM "HEHE"."PRODUCT_PRICES" "p0"
    WHERE (((((("p0"."VARIANT_ID" IN (1, 2)) AND ("p0"."STARTS_AT" <= :now_1))) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))) AND ("p"."VARIANT_ID" = "p0"."VARIANT_ID"))
    ORDER BY "p0"."STARTS_AT" DESC
    FETCH FIRST 1 ROWS ONLY), 0.0) "Price"
FROM "HEHE"."PRODUCT_PRICES" "p"
WHERE (((("p"."VARIANT_ID" IN (1, 2)) AND ("p"."STARTS_AT" <= :now_1))) AND ((("p"."ENDS_AT" IS NULL) OR ("p"."ENDS_AT" > :now_2))))
GROUP BY "p"."VARIANT_ID"
2025-09-05 17:09:11.810 +07:00 [INF] Executing OkObjectResult, writing value of type 'PHONE_STORE.API.Controllers.ShopProductsController+ShopProductDetail'.
2025-09-05 17:09:11.817 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API) in 123.3554ms
2025-09-05 17:09:11.817 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API)'
2025-09-05 17:09:11.821 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products/iphone-15 - 200 null application/json; charset=utf-8 139.5119ms
2025-09-05 17:09:11.858 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 17:09:11.860 +07:00 [INF] REQ GET /api/shop/cart sid=0d2b62340b9744f1ad754dc55f322048 sub=null
2025-09-05 17:09:11.862 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 17:09:11.863 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 17:09:11.865 +07:00 [INF] GetCustomerId: no auth (sub missing). Using guest cart. sid=0d2b62340b9744f1ad754dc55f322048
2025-09-05 17:09:11.866 +07:00 [INF] Cart GET: customerId=null, sid=0d2b62340b9744f1ad754dc55f322048
2025-09-05 17:09:11.870 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:09:11.875 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:09:11.878 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 17:09:11.880 +07:00 [INF] Cart GET result: cartId=88, items=1, customerId=null, sid=0d2b62340b9744f1ad754dc55f322048
2025-09-05 17:09:11.885 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 17:09:11.887 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 23.0855ms
2025-09-05 17:09:11.888 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 17:09:11.889 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 31.7494ms
2025-09-05 17:09:13.208 +07:00 [INF] Request starting HTTP/1.1 POST https://localhost:7277/api/shop/cart/items - application/json; charset=utf-8 null
2025-09-05 17:09:13.211 +07:00 [INF] REQ POST /api/shop/cart/items sid=0d2b62340b9744f1ad754dc55f322048 sub=null
2025-09-05 17:09:13.212 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Add (PHONE_STORE.API)'
2025-09-05 17:09:13.215 +07:00 [INF] Route matched with {action = "Add", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Add(PHONE_STORE.Application.Dtos.CartItemUpsertDto, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 17:09:13.221 +07:00 [INF] GetCustomerId: no auth (sub missing). Using guest cart. sid=0d2b62340b9744f1ad754dc55f322048
2025-09-05 17:09:13.222 +07:00 [INF] Cart ADD: variant=1, qty=1, customerId=null, sid=0d2b62340b9744f1ad754dc55f322048
2025-09-05 17:09:13.227 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:09:13.237 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64), :dto_VariantId_1='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE"
FROM "HEHE"."CART_ITEMS" "c"
WHERE (("c"."CART_ID" = :id_0) AND ("c"."VARIANT_ID" = :dto_VariantId_1))
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:09:13.310 +07:00 [INF] Executed DbCommand (56ms) [Parameters=[:variantId_0='?' (DbType = Int64), :now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT COALESCE("p"."SALE_PRICE", "p"."LIST_PRICE")
FROM "HEHE"."PRODUCT_PRICES" "p"
WHERE (((("p"."VARIANT_ID" = :variantId_0) AND ("p"."STARTS_AT" <= :now_1))) AND ((("p"."ENDS_AT" IS NULL) OR ("p"."ENDS_AT" >= :now_2))))
ORDER BY "p"."STARTS_AT" DESC
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:09:13.356 +07:00 [INF] AddItem: cartId=88, variant=1, qty=1, unit=18990000
2025-09-05 17:09:13.392 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:p0='?' (DbType = Int64), :p1='?' (DbType = Int64), :p2='?' (DbType = DateTime), :p3='?' (Size = 2000), :p4='?' (DbType = Int32), :p5='?' (DbType = Decimal)], CommandType='"Text"', CommandTimeout='0']
DECLARE


BEGIN

INSERT INTO "HEHE"."CART_ITEMS" ("CART_ID", "VARIANT_ID", "ADDED_AT", "CURRENCY", "QUANTITY", "UNIT_PRICE")
VALUES (:p0, :p1, :p2, :p3, :p4, :p5);

END;
2025-09-05 17:09:13.408 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:09:13.411 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:09:13.414 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 17:09:13.420 +07:00 [INF] Cart ADD result: cartId=88, items=2, customerId=null, sid=0d2b62340b9744f1ad754dc55f322048
2025-09-05 17:09:13.421 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 17:09:13.422 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Add (PHONE_STORE.API) in 206.1378ms
2025-09-05 17:09:13.423 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Add (PHONE_STORE.API)'
2025-09-05 17:09:13.425 +07:00 [INF] Request finished HTTP/1.1 POST https://localhost:7277/api/shop/cart/items - 200 null application/json; charset=utf-8 217.0732ms
2025-09-05 17:09:13.432 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products/iphone-15 - null null
2025-09-05 17:09:13.433 +07:00 [INF] REQ GET /api/shop/products/iphone-15 sid=0d2b62340b9744f1ad754dc55f322048 sub=null
2025-09-05 17:09:13.434 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API)'
2025-09-05 17:09:13.435 +07:00 [INF] Route matched with {action = "Details", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductDetail]] Details(System.String, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 17:09:13.438 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:slug_0='?' (Size = 220)], CommandType='"Text"', CommandTimeout='0']
SELECT "p2"."ID", "p2"."BRAND_ID", "p2"."CREATED_AT", "p2"."DEFAULT_CATEGORY_ID", "p2"."DESCRIPTION", "p2"."IS_ACTIVE", "p2"."NAME", "p2"."SLUG", "p2"."SPEC_JSON", "p0"."ID", "p0"."BARCODE", "p0"."COLOR", "p0"."IS_ACTIVE", "p0"."PRODUCT_ID", "p0"."SKU", "p0"."STORAGE_GB", "p0"."WEIGHT_GRAM", "p1"."ID", "p1"."ALT_TEXT", "p1"."IMAGE_URL", "p1"."IS_PRIMARY", "p1"."PRODUCT_ID", "p1"."SORT_ORDER", "p1"."VARIANT_ID"
FROM (
    SELECT "p"."ID", "p"."BRAND_ID", "p"."CREATED_AT", "p"."DEFAULT_CATEGORY_ID", "p"."DESCRIPTION", "p"."IS_ACTIVE", "p"."NAME", "p"."SLUG", "p"."SPEC_JSON"
    FROM "HEHE"."PRODUCTS" "p"
    WHERE (("p"."SLUG" = :slug_0) AND ("p"."IS_ACTIVE" = 1))
    FETCH FIRST 1 ROWS ONLY
) "p2"
LEFT JOIN "HEHE"."PRODUCT_VARIANTS" "p0" ON "p2"."ID" = "p0"."PRODUCT_ID"
LEFT JOIN "HEHE"."PRODUCT_IMAGES" "p1" ON "p2"."ID" = "p1"."PRODUCT_ID"
ORDER BY "p2"."ID", "p0"."ID"
2025-09-05 17:09:13.443 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."VARIANT_ID" "VariantId", COALESCE((
    SELECT COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")
    FROM "HEHE"."PRODUCT_PRICES" "p0"
    WHERE (((((("p0"."VARIANT_ID" IN (1, 2)) AND ("p0"."STARTS_AT" <= :now_1))) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))) AND ("p"."VARIANT_ID" = "p0"."VARIANT_ID"))
    ORDER BY "p0"."STARTS_AT" DESC
    FETCH FIRST 1 ROWS ONLY), 0.0) "Price"
FROM "HEHE"."PRODUCT_PRICES" "p"
WHERE (((("p"."VARIANT_ID" IN (1, 2)) AND ("p"."STARTS_AT" <= :now_1))) AND ((("p"."ENDS_AT" IS NULL) OR ("p"."ENDS_AT" > :now_2))))
GROUP BY "p"."VARIANT_ID"
2025-09-05 17:09:13.446 +07:00 [INF] Executing OkObjectResult, writing value of type 'PHONE_STORE.API.Controllers.ShopProductsController+ShopProductDetail'.
2025-09-05 17:09:13.449 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API) in 12.6181ms
2025-09-05 17:09:13.450 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API)'
2025-09-05 17:09:13.450 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products/iphone-15 - 200 null application/json; charset=utf-8 18.7578ms
2025-09-05 17:09:13.472 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 17:09:13.474 +07:00 [INF] REQ GET /api/shop/cart sid=0d2b62340b9744f1ad754dc55f322048 sub=null
2025-09-05 17:09:13.476 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 17:09:13.478 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 17:09:13.480 +07:00 [INF] GetCustomerId: no auth (sub missing). Using guest cart. sid=0d2b62340b9744f1ad754dc55f322048
2025-09-05 17:09:13.483 +07:00 [INF] Cart GET: customerId=null, sid=0d2b62340b9744f1ad754dc55f322048
2025-09-05 17:09:13.486 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:09:13.489 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:09:13.497 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 17:09:13.500 +07:00 [INF] Cart GET result: cartId=88, items=2, customerId=null, sid=0d2b62340b9744f1ad754dc55f322048
2025-09-05 17:09:13.501 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 17:09:13.503 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 22.7184ms
2025-09-05 17:09:13.503 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 17:09:13.504 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 32.8441ms
2025-09-05 17:09:37.314 +07:00 [INF] Request starting HTTP/1.1 POST https://localhost:7277/api/shop/cart/items - application/json; charset=utf-8 null
2025-09-05 17:09:37.316 +07:00 [INF] REQ POST /api/shop/cart/items sid=0d2b62340b9744f1ad754dc55f322048 sub=null
2025-09-05 17:09:37.317 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Add (PHONE_STORE.API)'
2025-09-05 17:09:37.319 +07:00 [INF] Route matched with {action = "Add", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Add(PHONE_STORE.Application.Dtos.CartItemUpsertDto, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 17:09:37.321 +07:00 [INF] GetCustomerId: no auth (sub missing). Using guest cart. sid=0d2b62340b9744f1ad754dc55f322048
2025-09-05 17:09:37.321 +07:00 [INF] Cart ADD: variant=1, qty=1, customerId=null, sid=0d2b62340b9744f1ad754dc55f322048
2025-09-05 17:09:37.329 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:09:37.336 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:id_0='?' (DbType = Int64), :dto_VariantId_1='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE"
FROM "HEHE"."CART_ITEMS" "c"
WHERE (("c"."CART_ID" = :id_0) AND ("c"."VARIANT_ID" = :dto_VariantId_1))
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:09:37.341 +07:00 [INF] UpdateItemQty: cartId=88, variant=1, qty=2
2025-09-05 17:09:37.350 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[:p1='?' (DbType = Int64), :p2='?' (DbType = Int64), :p0='?' (DbType = Int32), :cur0='?' (Direction = Output) (DbType = Object)], CommandType='"Text"', CommandTimeout='0']
DECLARE

v_RowCount INTEGER;

BEGIN

UPDATE "HEHE"."CART_ITEMS" SET "QUANTITY" = :p0
WHERE "CART_ID" = :p1 AND "VARIANT_ID" = :p2;
v_RowCount := SQL%ROWCOUNT;
OPEN :cur0 FOR SELECT v_RowCount FROM DUAL;

END;
2025-09-05 17:09:37.360 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:09:37.368 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:09:37.373 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 17:09:37.375 +07:00 [INF] Cart ADD result: cartId=88, items=2, customerId=null, sid=0d2b62340b9744f1ad754dc55f322048
2025-09-05 17:09:37.375 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 17:09:37.376 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Add (PHONE_STORE.API) in 56.2703ms
2025-09-05 17:09:37.377 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Add (PHONE_STORE.API)'
2025-09-05 17:09:37.377 +07:00 [INF] Request finished HTTP/1.1 POST https://localhost:7277/api/shop/cart/items - 200 null application/json; charset=utf-8 63.5521ms
2025-09-05 17:09:37.383 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products/iphone-15 - null null
2025-09-05 17:09:37.384 +07:00 [INF] REQ GET /api/shop/products/iphone-15 sid=0d2b62340b9744f1ad754dc55f322048 sub=null
2025-09-05 17:09:37.385 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API)'
2025-09-05 17:09:37.385 +07:00 [INF] Route matched with {action = "Details", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductDetail]] Details(System.String, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 17:09:37.390 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:slug_0='?' (Size = 220)], CommandType='"Text"', CommandTimeout='0']
SELECT "p2"."ID", "p2"."BRAND_ID", "p2"."CREATED_AT", "p2"."DEFAULT_CATEGORY_ID", "p2"."DESCRIPTION", "p2"."IS_ACTIVE", "p2"."NAME", "p2"."SLUG", "p2"."SPEC_JSON", "p0"."ID", "p0"."BARCODE", "p0"."COLOR", "p0"."IS_ACTIVE", "p0"."PRODUCT_ID", "p0"."SKU", "p0"."STORAGE_GB", "p0"."WEIGHT_GRAM", "p1"."ID", "p1"."ALT_TEXT", "p1"."IMAGE_URL", "p1"."IS_PRIMARY", "p1"."PRODUCT_ID", "p1"."SORT_ORDER", "p1"."VARIANT_ID"
FROM (
    SELECT "p"."ID", "p"."BRAND_ID", "p"."CREATED_AT", "p"."DEFAULT_CATEGORY_ID", "p"."DESCRIPTION", "p"."IS_ACTIVE", "p"."NAME", "p"."SLUG", "p"."SPEC_JSON"
    FROM "HEHE"."PRODUCTS" "p"
    WHERE (("p"."SLUG" = :slug_0) AND ("p"."IS_ACTIVE" = 1))
    FETCH FIRST 1 ROWS ONLY
) "p2"
LEFT JOIN "HEHE"."PRODUCT_VARIANTS" "p0" ON "p2"."ID" = "p0"."PRODUCT_ID"
LEFT JOIN "HEHE"."PRODUCT_IMAGES" "p1" ON "p2"."ID" = "p1"."PRODUCT_ID"
ORDER BY "p2"."ID", "p0"."ID"
2025-09-05 17:09:37.395 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."VARIANT_ID" "VariantId", COALESCE((
    SELECT COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")
    FROM "HEHE"."PRODUCT_PRICES" "p0"
    WHERE (((((("p0"."VARIANT_ID" IN (1, 2)) AND ("p0"."STARTS_AT" <= :now_1))) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))) AND ("p"."VARIANT_ID" = "p0"."VARIANT_ID"))
    ORDER BY "p0"."STARTS_AT" DESC
    FETCH FIRST 1 ROWS ONLY), 0.0) "Price"
FROM "HEHE"."PRODUCT_PRICES" "p"
WHERE (((("p"."VARIANT_ID" IN (1, 2)) AND ("p"."STARTS_AT" <= :now_1))) AND ((("p"."ENDS_AT" IS NULL) OR ("p"."ENDS_AT" > :now_2))))
GROUP BY "p"."VARIANT_ID"
2025-09-05 17:09:37.399 +07:00 [INF] Executing OkObjectResult, writing value of type 'PHONE_STORE.API.Controllers.ShopProductsController+ShopProductDetail'.
2025-09-05 17:09:37.400 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API) in 12.7258ms
2025-09-05 17:09:37.401 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API)'
2025-09-05 17:09:37.401 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products/iphone-15 - 200 null application/json; charset=utf-8 18.7292ms
2025-09-05 17:09:37.429 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 17:09:37.433 +07:00 [INF] REQ GET /api/shop/cart sid=0d2b62340b9744f1ad754dc55f322048 sub=null
2025-09-05 17:09:37.434 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 17:09:37.436 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 17:09:37.439 +07:00 [INF] GetCustomerId: no auth (sub missing). Using guest cart. sid=0d2b62340b9744f1ad754dc55f322048
2025-09-05 17:09:37.439 +07:00 [INF] Cart GET: customerId=null, sid=0d2b62340b9744f1ad754dc55f322048
2025-09-05 17:09:37.444 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:09:37.448 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:09:37.452 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 17:09:37.458 +07:00 [INF] Cart GET result: cartId=88, items=2, customerId=null, sid=0d2b62340b9744f1ad754dc55f322048
2025-09-05 17:09:37.459 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 17:09:37.460 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 21.9582ms
2025-09-05 17:09:37.461 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 17:09:37.462 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 33.7977ms
2025-09-05 17:09:38.541 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 17:09:38.544 +07:00 [INF] REQ GET /api/shop/cart sid=0d2b62340b9744f1ad754dc55f322048 sub=null
2025-09-05 17:09:38.545 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 17:09:38.546 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 17:09:38.547 +07:00 [INF] GetCustomerId: no auth (sub missing). Using guest cart. sid=0d2b62340b9744f1ad754dc55f322048
2025-09-05 17:09:38.548 +07:00 [INF] Cart GET: customerId=null, sid=0d2b62340b9744f1ad754dc55f322048
2025-09-05 17:09:38.551 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:09:38.555 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:09:38.561 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 17:09:38.564 +07:00 [INF] Cart GET result: cartId=88, items=2, customerId=null, sid=0d2b62340b9744f1ad754dc55f322048
2025-09-05 17:09:38.565 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 17:09:38.566 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 18.4389ms
2025-09-05 17:09:38.566 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 17:09:38.568 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 26.7481ms
2025-09-05 17:09:38.600 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 17:09:38.603 +07:00 [INF] REQ GET /api/shop/cart sid=0d2b62340b9744f1ad754dc55f322048 sub=null
2025-09-05 17:09:38.606 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 17:09:38.607 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 17:09:38.609 +07:00 [INF] GetCustomerId: no auth (sub missing). Using guest cart. sid=0d2b62340b9744f1ad754dc55f322048
2025-09-05 17:09:38.609 +07:00 [INF] Cart GET: customerId=null, sid=0d2b62340b9744f1ad754dc55f322048
2025-09-05 17:09:38.613 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:09:38.618 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:09:38.627 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 17:09:38.629 +07:00 [INF] Cart GET result: cartId=88, items=2, customerId=null, sid=0d2b62340b9744f1ad754dc55f322048
2025-09-05 17:09:38.630 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 17:09:38.631 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 22.228ms
2025-09-05 17:09:38.631 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 17:09:38.633 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 33.0492ms
2025-09-05 17:09:40.391 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - null null
2025-09-05 17:09:40.393 +07:00 [INF] REQ GET /api/shop/products sid=0d2b62340b9744f1ad754dc55f322048 sub=null
2025-09-05 17:09:40.394 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 17:09:40.395 +07:00 [INF] Route matched with {action = "List", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem]]] List(System.String, System.Nullable`1[System.Int64], Int32, Int32, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 17:09:40.399 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:p_0='?' (DbType = Int32), :p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."ID" "Id", "p"."NAME" "Name", "p"."SLUG" "Slug"
FROM "HEHE"."PRODUCTS" "p"
WHERE "p"."IS_ACTIVE" = 1
ORDER BY "p"."CREATED_AT" DESC
OFFSET :p_0 ROWS FETCH NEXT :p_1 ROWS ONLY
2025-09-05 17:09:40.403 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", (
    SELECT "p0"."IMAGE_URL"
    FROM "HEHE"."PRODUCT_IMAGES" "p0"
    WHERE (("p0"."PRODUCT_ID" IS NOT NULL AND "p0"."PRODUCT_ID" IN (3, 2, 1)) AND ("p"."PRODUCT_ID" = "p0"."PRODUCT_ID"))
    ORDER BY "p0"."SORT_ORDER"
    FETCH FIRST 1 ROWS ONLY) "Url"
FROM "HEHE"."PRODUCT_IMAGES" "p"
WHERE "p"."PRODUCT_ID" IS NOT NULL AND "p"."PRODUCT_ID" IN (3, 2, 1)
GROUP BY "p"."PRODUCT_ID"
2025-09-05 17:09:40.408 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", MIN(COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")) "MinPrice"
FROM "HEHE"."PRODUCT_VARIANTS" "p"
INNER JOIN "HEHE"."PRODUCT_PRICES" "p0" ON "p"."ID" = "p0"."VARIANT_ID"
WHERE (("p"."PRODUCT_ID" IN (3, 2, 1)) AND ((("p0"."STARTS_AT" <= :now_1) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))))
GROUP BY "p"."PRODUCT_ID"
2025-09-05 17:09:40.413 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem, PHONE_STORE.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-05 17:09:40.414 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API) in 17.5423ms
2025-09-05 17:09:40.415 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 17:09:40.416 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - 200 null application/json; charset=utf-8 24.8693ms
2025-09-05 17:09:40.435 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 17:09:40.437 +07:00 [INF] REQ GET /api/shop/cart sid=0d2b62340b9744f1ad754dc55f322048 sub=null
2025-09-05 17:09:40.441 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 17:09:40.443 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCartController (PHONE_STORE.API).
2025-09-05 17:09:40.447 +07:00 [INF] GetCustomerId: no auth (sub missing). Using guest cart. sid=0d2b62340b9744f1ad754dc55f322048
2025-09-05 17:09:40.447 +07:00 [INF] Cart GET: customerId=null, sid=0d2b62340b9744f1ad754dc55f322048
2025-09-05 17:09:40.458 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:09:40.466 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:09:40.481 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 17:09:40.483 +07:00 [INF] Cart GET result: cartId=88, items=2, customerId=null, sid=0d2b62340b9744f1ad754dc55f322048
2025-09-05 17:09:40.487 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 17:09:40.490 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API) in 43.5863ms
2025-09-05 17:09:40.490 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 17:09:40.491 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 56.8117ms
2025-09-05 17:26:07.494 +07:00 [INF] User profile is available. Using 'C:\Users\Administrator\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2025-09-05 17:26:07.731 +07:00 [INF] Now listening on: https://localhost:7277
2025-09-05 17:26:07.732 +07:00 [INF] Now listening on: http://localhost:5209
2025-09-05 17:26:07.824 +07:00 [INF] Application started. Press Ctrl+C to shut down.
2025-09-05 17:26:07.826 +07:00 [INF] Hosting environment: Development
2025-09-05 17:26:07.826 +07:00 [INF] Content root path: C:\Users\Administrator\Desktop\TongHopKienThuc\CSharp\PHONE_STORE\PHONE_STORE.API
2025-09-05 17:26:08.518 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/swagger/index.html - null null
2025-09-05 17:26:08.894 +07:00 [INF] REQ GET /swagger/index.html sid=0d2b62340b9744f1ad754dc55f322048 sub=null
2025-09-05 17:26:09.088 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/swagger/index.html - 200 null text/html;charset=utf-8 584.8854ms
2025-09-05 17:26:09.166 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/_framework/aspnetcore-browser-refresh.js - null null
2025-09-05 17:26:09.170 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/_vs/browserLink - null null
2025-09-05 17:26:09.174 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/_framework/aspnetcore-browser-refresh.js - 200 13766 application/javascript; charset=utf-8 7.9417ms
2025-09-05 17:26:09.224 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/_vs/browserLink - 200 null text/javascript; charset=UTF-8 53.2216ms
2025-09-05 17:26:09.243 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - null null
2025-09-05 17:26:09.285 +07:00 [INF] REQ GET /api/shop/products sid=0d2b62340b9744f1ad754dc55f322048 sub=null
2025-09-05 17:26:09.349 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 17:26:09.385 +07:00 [INF] Route matched with {action = "List", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem]]] List(System.String, System.Nullable`1[System.Int64], Int32, Int32, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 17:26:09.406 +07:00 [INF] Request starting HTTP/2 GET https://localhost:7277/swagger/v1/swagger.json - null null
2025-09-05 17:26:09.409 +07:00 [INF] REQ GET /swagger/v1/swagger.json sid=0d2b62340b9744f1ad754dc55f322048 sub=null
2025-09-05 17:26:09.478 +07:00 [INF] Request finished HTTP/2 GET https://localhost:7277/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 71.7173ms
2025-09-05 17:26:10.141 +07:00 [WRN] The decimal property 'UnitPrice' on entity type 'CartItem' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 17:26:10.143 +07:00 [WRN] The decimal property 'DecValue' on entity type 'ProductAttributeValue' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 17:26:10.144 +07:00 [WRN] The decimal property 'WeightGram' on entity type 'ProductVariant' does not have a store type specified. This may lead to a precision loss if the values do not fit in the default precision and scale. Oracle recommends to explicitly specify the column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-09-05 17:26:10.867 +07:00 [INF] Executed DbCommand (111ms) [Parameters=[:p_0='?' (DbType = Int32), :p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."ID" "Id", "p"."NAME" "Name", "p"."SLUG" "Slug"
FROM "HEHE"."PRODUCTS" "p"
WHERE "p"."IS_ACTIVE" = 1
ORDER BY "p"."CREATED_AT" DESC
OFFSET :p_0 ROWS FETCH NEXT :p_1 ROWS ONLY
2025-09-05 17:26:11.001 +07:00 [INF] Executed DbCommand (8ms) [Parameters=[], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", (
    SELECT "p0"."IMAGE_URL"
    FROM "HEHE"."PRODUCT_IMAGES" "p0"
    WHERE (("p0"."PRODUCT_ID" IS NOT NULL AND "p0"."PRODUCT_ID" IN (3, 2, 1)) AND ("p"."PRODUCT_ID" = "p0"."PRODUCT_ID"))
    ORDER BY "p0"."SORT_ORDER"
    FETCH FIRST 1 ROWS ONLY) "Url"
FROM "HEHE"."PRODUCT_IMAGES" "p"
WHERE "p"."PRODUCT_ID" IS NOT NULL AND "p"."PRODUCT_ID" IN (3, 2, 1)
GROUP BY "p"."PRODUCT_ID"
2025-09-05 17:26:11.055 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", MIN(COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")) "MinPrice"
FROM "HEHE"."PRODUCT_VARIANTS" "p"
INNER JOIN "HEHE"."PRODUCT_PRICES" "p0" ON "p"."ID" = "p0"."VARIANT_ID"
WHERE (("p"."PRODUCT_ID" IN (3, 2, 1)) AND ((("p0"."STARTS_AT" <= :now_1) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))))
GROUP BY "p"."PRODUCT_ID"
2025-09-05 17:26:11.070 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem, PHONE_STORE.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-05 17:26:11.086 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API) in 1697.2425ms
2025-09-05 17:26:11.087 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 17:26:11.094 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - 200 null application/json; charset=utf-8 1852.0895ms
2025-09-05 17:26:11.299 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 17:26:11.302 +07:00 [INF] REQ GET /api/shop/cart sid=0d2b62340b9744f1ad754dc55f322048 sub=null
2025-09-05 17:26:11.303 +07:00 [INF] Executing endpoint 'ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 17:26:11.307 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller ShopCartController (PHONE_STORE.API).
2025-09-05 17:26:11.331 +07:00 [INF] GetCustomerId: no auth (sub missing). Using guest cart. sid=0d2b62340b9744f1ad754dc55f322048
2025-09-05 17:26:11.333 +07:00 [INF] Cart GET: customerId=null, sid=0d2b62340b9744f1ad754dc55f322048
2025-09-05 17:26:11.411 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:26:11.485 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:26:11.501 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 17:26:11.511 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 17:26:11.519 +07:00 [INF] Executed action ShopCartController.Get (PHONE_STORE.API) in 210.0213ms
2025-09-05 17:26:11.520 +07:00 [INF] Executed endpoint 'ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 17:26:11.521 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 221.6657ms
2025-09-05 17:26:17.400 +07:00 [INF] Request starting HTTP/1.1 POST https://localhost:7277/api/auth/logout - application/json; charset=utf-8 null
2025-09-05 17:26:17.402 +07:00 [INF] REQ POST /api/auth/logout sid=null sub=null
2025-09-05 17:26:17.404 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.AuthController.Logout (PHONE_STORE.API)'
2025-09-05 17:26:17.409 +07:00 [INF] Route matched with {action = "Logout", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Logout(RefreshRequest, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.AuthController (PHONE_STORE.API).
2025-09-05 17:26:17.577 +07:00 [INF] Logout: revoked RT
2025-09-05 17:26:17.578 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType1`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-05 17:26:17.581 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.AuthController.Logout (PHONE_STORE.API) in 171.4428ms
2025-09-05 17:26:17.582 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.AuthController.Logout (PHONE_STORE.API)'
2025-09-05 17:26:17.583 +07:00 [INF] Request finished HTTP/1.1 POST https://localhost:7277/api/auth/logout - 200 null application/json; charset=utf-8 182.9868ms
2025-09-05 17:26:17.610 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - null null
2025-09-05 17:26:17.611 +07:00 [INF] REQ GET /api/shop/products sid=0d2b62340b9744f1ad754dc55f322048 sub=null
2025-09-05 17:26:17.612 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 17:26:17.613 +07:00 [INF] Route matched with {action = "List", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem]]] List(System.String, System.Nullable`1[System.Int64], Int32, Int32, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 17:26:17.633 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:p_0='?' (DbType = Int32), :p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."ID" "Id", "p"."NAME" "Name", "p"."SLUG" "Slug"
FROM "HEHE"."PRODUCTS" "p"
WHERE "p"."IS_ACTIVE" = 1
ORDER BY "p"."CREATED_AT" DESC
OFFSET :p_0 ROWS FETCH NEXT :p_1 ROWS ONLY
2025-09-05 17:26:17.639 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", (
    SELECT "p0"."IMAGE_URL"
    FROM "HEHE"."PRODUCT_IMAGES" "p0"
    WHERE (("p0"."PRODUCT_ID" IS NOT NULL AND "p0"."PRODUCT_ID" IN (3, 2, 1)) AND ("p"."PRODUCT_ID" = "p0"."PRODUCT_ID"))
    ORDER BY "p0"."SORT_ORDER"
    FETCH FIRST 1 ROWS ONLY) "Url"
FROM "HEHE"."PRODUCT_IMAGES" "p"
WHERE "p"."PRODUCT_ID" IS NOT NULL AND "p"."PRODUCT_ID" IN (3, 2, 1)
GROUP BY "p"."PRODUCT_ID"
2025-09-05 17:26:17.645 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", MIN(COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")) "MinPrice"
FROM "HEHE"."PRODUCT_VARIANTS" "p"
INNER JOIN "HEHE"."PRODUCT_PRICES" "p0" ON "p"."ID" = "p0"."VARIANT_ID"
WHERE (("p"."PRODUCT_ID" IN (3, 2, 1)) AND ((("p0"."STARTS_AT" <= :now_1) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))))
GROUP BY "p"."PRODUCT_ID"
2025-09-05 17:26:17.646 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem, PHONE_STORE.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-05 17:26:17.647 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API) in 33.6494ms
2025-09-05 17:26:17.648 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 17:26:17.648 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - 200 null application/json; charset=utf-8 38.984ms
2025-09-05 17:26:17.709 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 17:26:17.712 +07:00 [INF] REQ GET /api/shop/cart sid=0d2b62340b9744f1ad754dc55f322048 sub=null
2025-09-05 17:26:17.715 +07:00 [INF] Executing endpoint 'ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 17:26:17.716 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller ShopCartController (PHONE_STORE.API).
2025-09-05 17:26:17.719 +07:00 [INF] GetCustomerId: no auth (sub missing). Using guest cart. sid=0d2b62340b9744f1ad754dc55f322048
2025-09-05 17:26:17.719 +07:00 [INF] Cart GET: customerId=null, sid=0d2b62340b9744f1ad754dc55f322048
2025-09-05 17:26:17.726 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:26:17.734 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:26:17.738 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 17:26:17.740 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 17:26:17.742 +07:00 [INF] Executed action ShopCartController.Get (PHONE_STORE.API) in 23.8826ms
2025-09-05 17:26:17.743 +07:00 [INF] Executed endpoint 'ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 17:26:17.744 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 35.1347ms
2025-09-05 17:26:19.920 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 17:26:19.922 +07:00 [INF] REQ GET /api/shop/cart sid=0d2b62340b9744f1ad754dc55f322048 sub=null
2025-09-05 17:26:19.924 +07:00 [INF] Executing endpoint 'ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 17:26:19.925 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller ShopCartController (PHONE_STORE.API).
2025-09-05 17:26:19.926 +07:00 [INF] GetCustomerId: no auth (sub missing). Using guest cart. sid=0d2b62340b9744f1ad754dc55f322048
2025-09-05 17:26:19.927 +07:00 [INF] Cart GET: customerId=null, sid=0d2b62340b9744f1ad754dc55f322048
2025-09-05 17:26:19.930 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:26:19.933 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:26:19.936 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 17:26:19.937 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 17:26:19.938 +07:00 [INF] Executed action ShopCartController.Get (PHONE_STORE.API) in 12.2839ms
2025-09-05 17:26:19.938 +07:00 [INF] Executed endpoint 'ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 17:26:19.940 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 20.2342ms
2025-09-05 17:26:19.978 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 17:26:19.980 +07:00 [INF] REQ GET /api/shop/cart sid=0d2b62340b9744f1ad754dc55f322048 sub=null
2025-09-05 17:26:19.982 +07:00 [INF] Executing endpoint 'ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 17:26:19.983 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller ShopCartController (PHONE_STORE.API).
2025-09-05 17:26:19.984 +07:00 [INF] GetCustomerId: no auth (sub missing). Using guest cart. sid=0d2b62340b9744f1ad754dc55f322048
2025-09-05 17:26:19.985 +07:00 [INF] Cart GET: customerId=null, sid=0d2b62340b9744f1ad754dc55f322048
2025-09-05 17:26:19.990 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:26:19.995 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:26:20.000 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 17:26:20.002 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 17:26:20.004 +07:00 [INF] Executed action ShopCartController.Get (PHONE_STORE.API) in 19.6901ms
2025-09-05 17:26:20.005 +07:00 [INF] Executed endpoint 'ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 17:26:20.006 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 27.8725ms
2025-09-05 17:26:22.381 +07:00 [INF] Request starting HTTP/1.1 DELETE https://localhost:7277/api/shop/cart/items/1 - null null
2025-09-05 17:26:22.383 +07:00 [INF] REQ DELETE /api/shop/cart/items/1 sid=0d2b62340b9744f1ad754dc55f322048 sub=null
2025-09-05 17:26:22.384 +07:00 [INF] Executing endpoint 'ShopCartController.Remove (PHONE_STORE.API)'
2025-09-05 17:26:22.388 +07:00 [INF] Route matched with {action = "Remove", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task Remove(Int64, System.Threading.CancellationToken) on controller ShopCartController (PHONE_STORE.API).
2025-09-05 17:26:22.392 +07:00 [INF] GetCustomerId: no auth (sub missing). Using guest cart. sid=0d2b62340b9744f1ad754dc55f322048
2025-09-05 17:26:22.396 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:26:22.404 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64), :itemId_1='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE"
FROM "HEHE"."CART_ITEMS" "c"
WHERE (("c"."CART_ID" = :id_0) AND ("c"."VARIANT_ID" = :itemId_1))
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:26:22.514 +07:00 [INF] Executed DbCommand (10ms) [Parameters=[:p0='?' (DbType = Int64), :p1='?' (DbType = Int64), :cur0='?' (Direction = Output) (DbType = Object)], CommandType='"Text"', CommandTimeout='0']
DECLARE

v_RowCount INTEGER;

BEGIN

DELETE FROM "HEHE"."CART_ITEMS"
WHERE "CART_ID" = :p0 AND "VARIANT_ID" = :p1;
v_RowCount := SQL%ROWCOUNT;
OPEN :cur0 FOR SELECT v_RowCount FROM DUAL;

END;
2025-09-05 17:26:22.556 +07:00 [INF] RemoveItem: cartId=88, variant=1
2025-09-05 17:26:22.559 +07:00 [INF] Executed action ShopCartController.Remove (PHONE_STORE.API) in 169.6677ms
2025-09-05 17:26:22.560 +07:00 [INF] Executed endpoint 'ShopCartController.Remove (PHONE_STORE.API)'
2025-09-05 17:26:22.561 +07:00 [INF] Request finished HTTP/1.1 DELETE https://localhost:7277/api/shop/cart/items/1 - 200 0 null 179.7871ms
2025-09-05 17:26:22.575 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 17:26:22.576 +07:00 [INF] REQ GET /api/shop/cart sid=0d2b62340b9744f1ad754dc55f322048 sub=null
2025-09-05 17:26:22.577 +07:00 [INF] Executing endpoint 'ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 17:26:22.578 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller ShopCartController (PHONE_STORE.API).
2025-09-05 17:26:22.579 +07:00 [INF] GetCustomerId: no auth (sub missing). Using guest cart. sid=0d2b62340b9744f1ad754dc55f322048
2025-09-05 17:26:22.579 +07:00 [INF] Cart GET: customerId=null, sid=0d2b62340b9744f1ad754dc55f322048
2025-09-05 17:26:22.582 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:26:22.584 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:26:22.587 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 17:26:22.588 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 17:26:22.589 +07:00 [INF] Executed action ShopCartController.Get (PHONE_STORE.API) in 10.5232ms
2025-09-05 17:26:22.590 +07:00 [INF] Executed endpoint 'ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 17:26:22.590 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 15.5915ms
2025-09-05 17:26:22.623 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 17:26:22.626 +07:00 [INF] REQ GET /api/shop/cart sid=0d2b62340b9744f1ad754dc55f322048 sub=null
2025-09-05 17:26:22.628 +07:00 [INF] Executing endpoint 'ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 17:26:22.629 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller ShopCartController (PHONE_STORE.API).
2025-09-05 17:26:22.631 +07:00 [INF] GetCustomerId: no auth (sub missing). Using guest cart. sid=0d2b62340b9744f1ad754dc55f322048
2025-09-05 17:26:22.631 +07:00 [INF] Cart GET: customerId=null, sid=0d2b62340b9744f1ad754dc55f322048
2025-09-05 17:26:22.636 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:26:22.640 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:26:22.645 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 17:26:22.647 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 17:26:22.648 +07:00 [INF] Executed action ShopCartController.Get (PHONE_STORE.API) in 17.6801ms
2025-09-05 17:26:22.649 +07:00 [INF] Executed endpoint 'ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 17:26:22.650 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 26.801ms
2025-09-05 17:26:23.087 +07:00 [INF] Request starting HTTP/1.1 DELETE https://localhost:7277/api/shop/cart/items/3 - null null
2025-09-05 17:26:23.090 +07:00 [INF] REQ DELETE /api/shop/cart/items/3 sid=0d2b62340b9744f1ad754dc55f322048 sub=null
2025-09-05 17:26:23.092 +07:00 [INF] Executing endpoint 'ShopCartController.Remove (PHONE_STORE.API)'
2025-09-05 17:26:23.092 +07:00 [INF] Route matched with {action = "Remove", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task Remove(Int64, System.Threading.CancellationToken) on controller ShopCartController (PHONE_STORE.API).
2025-09-05 17:26:23.094 +07:00 [INF] GetCustomerId: no auth (sub missing). Using guest cart. sid=0d2b62340b9744f1ad754dc55f322048
2025-09-05 17:26:23.097 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:26:23.099 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64), :itemId_1='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE"
FROM "HEHE"."CART_ITEMS" "c"
WHERE (("c"."CART_ID" = :id_0) AND ("c"."VARIANT_ID" = :itemId_1))
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:26:23.103 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:p0='?' (DbType = Int64), :p1='?' (DbType = Int64), :cur0='?' (Direction = Output) (DbType = Object)], CommandType='"Text"', CommandTimeout='0']
DECLARE

v_RowCount INTEGER;

BEGIN

DELETE FROM "HEHE"."CART_ITEMS"
WHERE "CART_ID" = :p0 AND "VARIANT_ID" = :p1;
v_RowCount := SQL%ROWCOUNT;
OPEN :cur0 FOR SELECT v_RowCount FROM DUAL;

END;
2025-09-05 17:26:23.105 +07:00 [INF] RemoveItem: cartId=88, variant=3
2025-09-05 17:26:23.106 +07:00 [INF] Executed action ShopCartController.Remove (PHONE_STORE.API) in 13.1184ms
2025-09-05 17:26:23.107 +07:00 [INF] Executed endpoint 'ShopCartController.Remove (PHONE_STORE.API)'
2025-09-05 17:26:23.108 +07:00 [INF] Request finished HTTP/1.1 DELETE https://localhost:7277/api/shop/cart/items/3 - 200 0 null 20.6113ms
2025-09-05 17:26:23.120 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 17:26:23.122 +07:00 [INF] REQ GET /api/shop/cart sid=0d2b62340b9744f1ad754dc55f322048 sub=null
2025-09-05 17:26:23.123 +07:00 [INF] Executing endpoint 'ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 17:26:23.124 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller ShopCartController (PHONE_STORE.API).
2025-09-05 17:26:23.125 +07:00 [INF] GetCustomerId: no auth (sub missing). Using guest cart. sid=0d2b62340b9744f1ad754dc55f322048
2025-09-05 17:26:23.126 +07:00 [INF] Cart GET: customerId=null, sid=0d2b62340b9744f1ad754dc55f322048
2025-09-05 17:26:23.129 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:26:23.131 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:26:23.134 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 17:26:23.135 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 17:26:23.136 +07:00 [INF] Executed action ShopCartController.Get (PHONE_STORE.API) in 11.18ms
2025-09-05 17:26:23.137 +07:00 [INF] Executed endpoint 'ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 17:26:23.137 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 16.873ms
2025-09-05 17:26:23.171 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 17:26:23.173 +07:00 [INF] REQ GET /api/shop/cart sid=0d2b62340b9744f1ad754dc55f322048 sub=null
2025-09-05 17:26:23.174 +07:00 [INF] Executing endpoint 'ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 17:26:23.175 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller ShopCartController (PHONE_STORE.API).
2025-09-05 17:26:23.177 +07:00 [INF] GetCustomerId: no auth (sub missing). Using guest cart. sid=0d2b62340b9744f1ad754dc55f322048
2025-09-05 17:26:23.178 +07:00 [INF] Cart GET: customerId=null, sid=0d2b62340b9744f1ad754dc55f322048
2025-09-05 17:26:23.182 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:26:23.185 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:26:23.189 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 17:26:23.191 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 17:26:23.192 +07:00 [INF] Executed action ShopCartController.Get (PHONE_STORE.API) in 14.7825ms
2025-09-05 17:26:23.192 +07:00 [INF] Executed endpoint 'ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 17:26:23.193 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 21.9899ms
2025-09-05 17:26:24.466 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 17:26:24.468 +07:00 [INF] REQ GET /api/shop/cart sid=0d2b62340b9744f1ad754dc55f322048 sub=null
2025-09-05 17:26:24.469 +07:00 [INF] Executing endpoint 'ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 17:26:24.470 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller ShopCartController (PHONE_STORE.API).
2025-09-05 17:26:24.472 +07:00 [INF] GetCustomerId: no auth (sub missing). Using guest cart. sid=0d2b62340b9744f1ad754dc55f322048
2025-09-05 17:26:24.475 +07:00 [INF] Cart GET: customerId=null, sid=0d2b62340b9744f1ad754dc55f322048
2025-09-05 17:26:24.481 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:26:24.486 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:26:24.489 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 17:26:24.491 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 17:26:24.493 +07:00 [INF] Executed action ShopCartController.Get (PHONE_STORE.API) in 21.0243ms
2025-09-05 17:26:24.493 +07:00 [INF] Executed endpoint 'ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 17:26:24.494 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 28.3431ms
2025-09-05 17:26:30.823 +07:00 [INF] Request starting HTTP/1.1 POST https://localhost:7277/api/auth/login - application/json; charset=utf-8 null
2025-09-05 17:26:30.826 +07:00 [INF] REQ POST /api/auth/login sid=null sub=null
2025-09-05 17:26:30.831 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.AuthController.Login (PHONE_STORE.API)'
2025-09-05 17:26:30.834 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(LoginRequest, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.AuthController (PHONE_STORE.API).
2025-09-05 17:26:30.859 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:uname_0='?' (Size = 450), :username_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='0']
SELECT "u"."ID", "u"."CREATED_AT", "u"."EMAIL", "u"."PASSWORD_HASH", "u"."PHONE", "u"."STATUS"
FROM "USER_ACCOUNTS" "u"
WHERE (("u"."EMAIL" = :uname_0) OR ("u"."PHONE" = :username_1))
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:26:31.108 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[:userId_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "r"."CODE"
FROM "USER_ROLES" "u"
INNER JOIN "ROLES" "r" ON "u"."ROLE_ID" = "r"."ID"
WHERE "u"."USER_ID" = :userId_0
2025-09-05 17:26:31.140 +07:00 [INF] Login success [21]
2025-09-05 17:26:31.145 +07:00 [INF] Executing OkObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.AuthResponseDto'.
2025-09-05 17:26:31.148 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.AuthController.Login (PHONE_STORE.API) in 312.9505ms
2025-09-05 17:26:31.149 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.AuthController.Login (PHONE_STORE.API)'
2025-09-05 17:26:31.150 +07:00 [INF] Request finished HTTP/1.1 POST https://localhost:7277/api/auth/login - 200 null application/json; charset=utf-8 327.7807ms
2025-09-05 17:26:31.174 +07:00 [INF] Request starting HTTP/1.1 POST https://localhost:7277/api/shop/cart/merge - null 0
2025-09-05 17:26:31.176 +07:00 [INF] REQ POST /api/shop/cart/merge sid=0d2b62340b9744f1ad754dc55f322048 sub=null
2025-09-05 17:26:31.212 +07:00 [INF] Executing endpoint 'ShopCartController.Merge (PHONE_STORE.API)'
2025-09-05 17:26:31.216 +07:00 [INF] Route matched with {action = "Merge", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Merge(System.Threading.CancellationToken) on controller ShopCartController (PHONE_STORE.API).
2025-09-05 17:26:31.231 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[:uid_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID"
FROM "HEHE"."CUSTOMERS" "c"
WHERE "c"."USER_ACCOUNT_ID" = :uid_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:26:31.236 +07:00 [INF] Merge: sid=0d2b62340b9744f1ad754dc55f322048 -> customerId=2
2025-09-05 17:26:31.278 +07:00 [INF] Executed DbCommand (7ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c1"."ID", "c1"."CREATED_AT", "c1"."CURRENCY", "c1"."CUSTOMER_ID", "c1"."SESSION_TOKEN", "c1"."STATUS", "c1"."UPDATED_AT", "c0"."CART_ID", "c0"."VARIANT_ID", "c0"."ADDED_AT", "c0"."CURRENCY", "c0"."QUANTITY", "c0"."UNIT_PRICE"
FROM (
    SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
    FROM "HEHE"."CARTS" "c"
    WHERE "c"."SESSION_TOKEN" = :sessionId_0
    FETCH FIRST 1 ROWS ONLY
) "c1"
LEFT JOIN "HEHE"."CART_ITEMS" "c0" ON "c1"."ID" = "c0"."CART_ID"
ORDER BY "c1"."ID", "c0"."CART_ID"
2025-09-05 17:26:31.297 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[:customerId_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c1"."ID", "c1"."CREATED_AT", "c1"."CURRENCY", "c1"."CUSTOMER_ID", "c1"."SESSION_TOKEN", "c1"."STATUS", "c1"."UPDATED_AT", "c0"."CART_ID", "c0"."VARIANT_ID", "c0"."ADDED_AT", "c0"."CURRENCY", "c0"."QUANTITY", "c0"."UNIT_PRICE"
FROM (
    SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
    FROM "HEHE"."CARTS" "c"
    WHERE "c"."CUSTOMER_ID" = :customerId_0
    FETCH FIRST 1 ROWS ONLY
) "c1"
LEFT JOIN "HEHE"."CART_ITEMS" "c0" ON "c1"."ID" = "c0"."CART_ID"
ORDER BY "c1"."ID", "c0"."CART_ID"
2025-09-05 17:26:31.312 +07:00 [INF] Merge: created user cart for customerId=2
2025-09-05 17:26:31.332 +07:00 [INF] Executed DbCommand (6ms) [Parameters=[:p0='?' (DbType = Int64), :cur0='?' (Direction = Output) (DbType = Object), :p1='?' (DbType = DateTime), :p2='?' (Size = 2000), :p3='?' (DbType = Int64), :p4='?' (Size = 64), :p5='?' (Size = 2000), :p6='?' (DbType = DateTime), :cur1='?' (Direction = Output) (DbType = Object)], CommandType='"Text"', CommandTimeout='0']
DECLARE

v_RowCount INTEGER;
TYPE "rCARTS_1" IS RECORD
(
"ID" NUMBER(19)
);
TYPE "tCARTS_1" IS TABLE OF "rCARTS_1";
"lCARTS_1" "tCARTS_1";

BEGIN

DELETE FROM "HEHE"."CARTS"
WHERE "ID" = :p0;
v_RowCount := SQL%ROWCOUNT;
OPEN :cur0 FOR SELECT v_RowCount FROM DUAL;
"lCARTS_1" := "tCARTS_1"();
"lCARTS_1".extend(1);
INSERT INTO "HEHE"."CARTS" ("CREATED_AT", "CURRENCY", "CUSTOMER_ID", "SESSION_TOKEN", "STATUS", "UPDATED_AT")
VALUES (:p1, :p2, :p3, :p4, :p5, :p6)
RETURNING "ID" INTO "lCARTS_1"(1)."ID";
OPEN :cur1 FOR SELECT "lCARTS_1"(1)."ID" FROM DUAL;

END;
2025-09-05 17:26:31.347 +07:00 [INF] Merge: done. guest cart removed.
2025-09-05 17:26:31.349 +07:00 [INF] Executing StatusCodeResult, setting HTTP status code 200
2025-09-05 17:26:31.350 +07:00 [INF] Executed action ShopCartController.Merge (PHONE_STORE.API) in 132.8441ms
2025-09-05 17:26:31.350 +07:00 [INF] Executed endpoint 'ShopCartController.Merge (PHONE_STORE.API)'
2025-09-05 17:26:31.351 +07:00 [INF] Request finished HTTP/1.1 POST https://localhost:7277/api/shop/cart/merge - 200 0 null 176.3181ms
2025-09-05 17:26:31.377 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - null null
2025-09-05 17:26:31.378 +07:00 [INF] REQ GET /api/shop/products sid=0d2b62340b9744f1ad754dc55f322048 sub=null
2025-09-05 17:26:31.380 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 17:26:31.380 +07:00 [INF] Route matched with {action = "List", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem]]] List(System.String, System.Nullable`1[System.Int64], Int32, Int32, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 17:26:31.384 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:p_0='?' (DbType = Int32), :p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."ID" "Id", "p"."NAME" "Name", "p"."SLUG" "Slug"
FROM "HEHE"."PRODUCTS" "p"
WHERE "p"."IS_ACTIVE" = 1
ORDER BY "p"."CREATED_AT" DESC
OFFSET :p_0 ROWS FETCH NEXT :p_1 ROWS ONLY
2025-09-05 17:26:31.387 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", (
    SELECT "p0"."IMAGE_URL"
    FROM "HEHE"."PRODUCT_IMAGES" "p0"
    WHERE (("p0"."PRODUCT_ID" IS NOT NULL AND "p0"."PRODUCT_ID" IN (3, 2, 1)) AND ("p"."PRODUCT_ID" = "p0"."PRODUCT_ID"))
    ORDER BY "p0"."SORT_ORDER"
    FETCH FIRST 1 ROWS ONLY) "Url"
FROM "HEHE"."PRODUCT_IMAGES" "p"
WHERE "p"."PRODUCT_ID" IS NOT NULL AND "p"."PRODUCT_ID" IN (3, 2, 1)
GROUP BY "p"."PRODUCT_ID"
2025-09-05 17:26:31.391 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", MIN(COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")) "MinPrice"
FROM "HEHE"."PRODUCT_VARIANTS" "p"
INNER JOIN "HEHE"."PRODUCT_PRICES" "p0" ON "p"."ID" = "p0"."VARIANT_ID"
WHERE (("p"."PRODUCT_ID" IN (3, 2, 1)) AND ((("p0"."STARTS_AT" <= :now_1) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))))
GROUP BY "p"."PRODUCT_ID"
2025-09-05 17:26:31.393 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem, PHONE_STORE.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-05 17:26:31.394 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API) in 12.3454ms
2025-09-05 17:26:31.394 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 17:26:31.395 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - 200 null application/json; charset=utf-8 18.0984ms
2025-09-05 17:26:31.451 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 17:26:31.454 +07:00 [INF] REQ GET /api/shop/cart sid=0d2b62340b9744f1ad754dc55f322048 sub=null
2025-09-05 17:26:31.456 +07:00 [INF] Executing endpoint 'ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 17:26:31.457 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller ShopCartController (PHONE_STORE.API).
2025-09-05 17:26:31.463 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:uid_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID"
FROM "HEHE"."CUSTOMERS" "c"
WHERE "c"."USER_ACCOUNT_ID" = :uid_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:26:31.465 +07:00 [INF] Cart GET: customerId=2, sid=0d2b62340b9744f1ad754dc55f322048
2025-09-05 17:26:31.474 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[:customerId_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."CUSTOMER_ID" = :customerId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:26:31.477 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:26:31.480 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:26:31.483 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 17:26:31.485 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 17:26:31.486 +07:00 [INF] Executed action ShopCartController.Get (PHONE_STORE.API) in 28.4654ms
2025-09-05 17:26:31.487 +07:00 [INF] Executed endpoint 'ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 17:26:31.488 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 37.0828ms
2025-09-05 17:26:33.452 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products/galaxy-s24 - null null
2025-09-05 17:26:33.453 +07:00 [INF] REQ GET /api/shop/products/galaxy-s24 sid=0d2b62340b9744f1ad754dc55f322048 sub=null
2025-09-05 17:26:33.455 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API)'
2025-09-05 17:26:33.459 +07:00 [INF] Route matched with {action = "Details", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductDetail]] Details(System.String, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 17:26:33.471 +07:00 [WRN] Compiling a query which loads related collections for more than one collection navigation, either via 'Include' or through projection, but no 'QuerySplittingBehavior' has been configured. By default, Entity Framework will use 'QuerySplittingBehavior.SingleQuery', which can potentially result in slow query performance. See https://go.microsoft.com/fwlink/?linkid=2134277 for more information. To identify the query that's triggering this warning call 'ConfigureWarnings(w => w.Throw(RelationalEventId.MultipleCollectionIncludeWarning))'.
2025-09-05 17:26:33.486 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:slug_0='?' (Size = 220)], CommandType='"Text"', CommandTimeout='0']
SELECT "p2"."ID", "p2"."BRAND_ID", "p2"."CREATED_AT", "p2"."DEFAULT_CATEGORY_ID", "p2"."DESCRIPTION", "p2"."IS_ACTIVE", "p2"."NAME", "p2"."SLUG", "p2"."SPEC_JSON", "p0"."ID", "p0"."BARCODE", "p0"."COLOR", "p0"."IS_ACTIVE", "p0"."PRODUCT_ID", "p0"."SKU", "p0"."STORAGE_GB", "p0"."WEIGHT_GRAM", "p1"."ID", "p1"."ALT_TEXT", "p1"."IMAGE_URL", "p1"."IS_PRIMARY", "p1"."PRODUCT_ID", "p1"."SORT_ORDER", "p1"."VARIANT_ID"
FROM (
    SELECT "p"."ID", "p"."BRAND_ID", "p"."CREATED_AT", "p"."DEFAULT_CATEGORY_ID", "p"."DESCRIPTION", "p"."IS_ACTIVE", "p"."NAME", "p"."SLUG", "p"."SPEC_JSON"
    FROM "HEHE"."PRODUCTS" "p"
    WHERE (("p"."SLUG" = :slug_0) AND ("p"."IS_ACTIVE" = 1))
    FETCH FIRST 1 ROWS ONLY
) "p2"
LEFT JOIN "HEHE"."PRODUCT_VARIANTS" "p0" ON "p2"."ID" = "p0"."PRODUCT_ID"
LEFT JOIN "HEHE"."PRODUCT_IMAGES" "p1" ON "p2"."ID" = "p1"."PRODUCT_ID"
ORDER BY "p2"."ID", "p0"."ID"
2025-09-05 17:26:33.516 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."VARIANT_ID" "VariantId", COALESCE((
    SELECT COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")
    FROM "HEHE"."PRODUCT_PRICES" "p0"
    WHERE (((((("p0"."VARIANT_ID" = 3) AND ("p0"."STARTS_AT" <= :now_1))) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))) AND ("p"."VARIANT_ID" = "p0"."VARIANT_ID"))
    ORDER BY "p0"."STARTS_AT" DESC
    FETCH FIRST 1 ROWS ONLY), 0.0) "Price"
FROM "HEHE"."PRODUCT_PRICES" "p"
WHERE (((("p"."VARIANT_ID" = 3) AND ("p"."STARTS_AT" <= :now_1))) AND ((("p"."ENDS_AT" IS NULL) OR ("p"."ENDS_AT" > :now_2))))
GROUP BY "p"."VARIANT_ID"
2025-09-05 17:26:33.521 +07:00 [INF] Executing OkObjectResult, writing value of type 'PHONE_STORE.API.Controllers.ShopProductsController+ShopProductDetail'.
2025-09-05 17:26:33.526 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API) in 66.1984ms
2025-09-05 17:26:33.527 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API)'
2025-09-05 17:26:33.528 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products/galaxy-s24 - 200 null application/json; charset=utf-8 75.7534ms
2025-09-05 17:26:33.573 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 17:26:33.576 +07:00 [INF] REQ GET /api/shop/cart sid=0d2b62340b9744f1ad754dc55f322048 sub=null
2025-09-05 17:26:33.576 +07:00 [INF] Executing endpoint 'ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 17:26:33.577 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller ShopCartController (PHONE_STORE.API).
2025-09-05 17:26:33.580 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:uid_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID"
FROM "HEHE"."CUSTOMERS" "c"
WHERE "c"."USER_ACCOUNT_ID" = :uid_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:26:33.583 +07:00 [INF] Cart GET: customerId=2, sid=0d2b62340b9744f1ad754dc55f322048
2025-09-05 17:26:33.585 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:customerId_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."CUSTOMER_ID" = :customerId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:26:33.588 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:26:33.591 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:26:33.595 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 17:26:33.598 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 17:26:33.599 +07:00 [INF] Executed action ShopCartController.Get (PHONE_STORE.API) in 21.4805ms
2025-09-05 17:26:33.600 +07:00 [INF] Executed endpoint 'ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 17:26:33.601 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 27.2707ms
2025-09-05 17:26:34.395 +07:00 [INF] Request starting HTTP/1.1 POST https://localhost:7277/api/shop/cart/items - application/json; charset=utf-8 null
2025-09-05 17:26:34.396 +07:00 [INF] REQ POST /api/shop/cart/items sid=0d2b62340b9744f1ad754dc55f322048 sub=null
2025-09-05 17:26:34.397 +07:00 [INF] Executing endpoint 'ShopCartController.Add (PHONE_STORE.API)'
2025-09-05 17:26:34.400 +07:00 [INF] Route matched with {action = "Add", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Add(PHONE_STORE.Application.Dtos.CartItemUpsertDto, System.Threading.CancellationToken) on controller ShopCartController (PHONE_STORE.API).
2025-09-05 17:26:34.411 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:uid_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID"
FROM "HEHE"."CUSTOMERS" "c"
WHERE "c"."USER_ACCOUNT_ID" = :uid_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:26:34.413 +07:00 [INF] Cart ADD: variant=3, qty=1, customerId=2, sid=0d2b62340b9744f1ad754dc55f322048
2025-09-05 17:26:34.416 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:customerId_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."CUSTOMER_ID" = :customerId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:26:34.419 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:26:34.426 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64), :dto_VariantId_1='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE"
FROM "HEHE"."CART_ITEMS" "c"
WHERE (("c"."CART_ID" = :id_0) AND ("c"."VARIANT_ID" = :dto_VariantId_1))
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:26:34.467 +07:00 [INF] Executed DbCommand (27ms) [Parameters=[:variantId_0='?' (DbType = Int64), :now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT COALESCE("p"."SALE_PRICE", "p"."LIST_PRICE")
FROM "HEHE"."PRODUCT_PRICES" "p"
WHERE (((("p"."VARIANT_ID" = :variantId_0) AND ("p"."STARTS_AT" <= :now_1))) AND ((("p"."ENDS_AT" IS NULL) OR ("p"."ENDS_AT" >= :now_2))))
ORDER BY "p"."STARTS_AT" DESC
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:26:34.481 +07:00 [INF] AddItem: cartId=89, variant=3, qty=1, unit=17990000
2025-09-05 17:26:34.486 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:p0='?' (DbType = Int64), :p1='?' (DbType = Int64), :p2='?' (DbType = DateTime), :p3='?' (Size = 2000), :p4='?' (DbType = Int32), :p5='?' (DbType = Decimal)], CommandType='"Text"', CommandTimeout='0']
DECLARE


BEGIN

INSERT INTO "HEHE"."CART_ITEMS" ("CART_ID", "VARIANT_ID", "ADDED_AT", "CURRENCY", "QUANTITY", "UNIT_PRICE")
VALUES (:p0, :p1, :p2, :p3, :p4, :p5);

END;
2025-09-05 17:26:34.491 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:customerId_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."CUSTOMER_ID" = :customerId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:26:34.493 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:26:34.495 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:26:34.497 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 17:26:34.499 +07:00 [INF] Cart ADD result: cartId=89, items=1, customerId=2, sid=null
2025-09-05 17:26:34.499 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 17:26:34.500 +07:00 [INF] Executed action ShopCartController.Add (PHONE_STORE.API) in 99.4478ms
2025-09-05 17:26:34.501 +07:00 [INF] Executed endpoint 'ShopCartController.Add (PHONE_STORE.API)'
2025-09-05 17:26:34.501 +07:00 [INF] Request finished HTTP/1.1 POST https://localhost:7277/api/shop/cart/items - 200 null application/json; charset=utf-8 106.6514ms
2025-09-05 17:26:34.514 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products/galaxy-s24 - null null
2025-09-05 17:26:34.515 +07:00 [INF] REQ GET /api/shop/products/galaxy-s24 sid=0d2b62340b9744f1ad754dc55f322048 sub=null
2025-09-05 17:26:34.516 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API)'
2025-09-05 17:26:34.516 +07:00 [INF] Route matched with {action = "Details", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductDetail]] Details(System.String, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 17:26:34.520 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:slug_0='?' (Size = 220)], CommandType='"Text"', CommandTimeout='0']
SELECT "p2"."ID", "p2"."BRAND_ID", "p2"."CREATED_AT", "p2"."DEFAULT_CATEGORY_ID", "p2"."DESCRIPTION", "p2"."IS_ACTIVE", "p2"."NAME", "p2"."SLUG", "p2"."SPEC_JSON", "p0"."ID", "p0"."BARCODE", "p0"."COLOR", "p0"."IS_ACTIVE", "p0"."PRODUCT_ID", "p0"."SKU", "p0"."STORAGE_GB", "p0"."WEIGHT_GRAM", "p1"."ID", "p1"."ALT_TEXT", "p1"."IMAGE_URL", "p1"."IS_PRIMARY", "p1"."PRODUCT_ID", "p1"."SORT_ORDER", "p1"."VARIANT_ID"
FROM (
    SELECT "p"."ID", "p"."BRAND_ID", "p"."CREATED_AT", "p"."DEFAULT_CATEGORY_ID", "p"."DESCRIPTION", "p"."IS_ACTIVE", "p"."NAME", "p"."SLUG", "p"."SPEC_JSON"
    FROM "HEHE"."PRODUCTS" "p"
    WHERE (("p"."SLUG" = :slug_0) AND ("p"."IS_ACTIVE" = 1))
    FETCH FIRST 1 ROWS ONLY
) "p2"
LEFT JOIN "HEHE"."PRODUCT_VARIANTS" "p0" ON "p2"."ID" = "p0"."PRODUCT_ID"
LEFT JOIN "HEHE"."PRODUCT_IMAGES" "p1" ON "p2"."ID" = "p1"."PRODUCT_ID"
ORDER BY "p2"."ID", "p0"."ID"
2025-09-05 17:26:34.524 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."VARIANT_ID" "VariantId", COALESCE((
    SELECT COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")
    FROM "HEHE"."PRODUCT_PRICES" "p0"
    WHERE (((((("p0"."VARIANT_ID" = 3) AND ("p0"."STARTS_AT" <= :now_1))) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))) AND ("p"."VARIANT_ID" = "p0"."VARIANT_ID"))
    ORDER BY "p0"."STARTS_AT" DESC
    FETCH FIRST 1 ROWS ONLY), 0.0) "Price"
FROM "HEHE"."PRODUCT_PRICES" "p"
WHERE (((("p"."VARIANT_ID" = 3) AND ("p"."STARTS_AT" <= :now_1))) AND ((("p"."ENDS_AT" IS NULL) OR ("p"."ENDS_AT" > :now_2))))
GROUP BY "p"."VARIANT_ID"
2025-09-05 17:26:34.526 +07:00 [INF] Executing OkObjectResult, writing value of type 'PHONE_STORE.API.Controllers.ShopProductsController+ShopProductDetail'.
2025-09-05 17:26:34.527 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API) in 9.4138ms
2025-09-05 17:26:34.527 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.Details (PHONE_STORE.API)'
2025-09-05 17:26:34.528 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products/galaxy-s24 - 200 null application/json; charset=utf-8 14.0787ms
2025-09-05 17:26:34.563 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 17:26:34.565 +07:00 [INF] REQ GET /api/shop/cart sid=0d2b62340b9744f1ad754dc55f322048 sub=null
2025-09-05 17:26:34.566 +07:00 [INF] Executing endpoint 'ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 17:26:34.567 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller ShopCartController (PHONE_STORE.API).
2025-09-05 17:26:34.577 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:uid_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID"
FROM "HEHE"."CUSTOMERS" "c"
WHERE "c"."USER_ACCOUNT_ID" = :uid_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:26:34.579 +07:00 [INF] Cart GET: customerId=2, sid=0d2b62340b9744f1ad754dc55f322048
2025-09-05 17:26:34.582 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:customerId_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."CUSTOMER_ID" = :customerId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:26:34.586 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:26:34.601 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:26:34.609 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 17:26:34.613 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 17:26:34.617 +07:00 [INF] Executed action ShopCartController.Get (PHONE_STORE.API) in 48.1455ms
2025-09-05 17:26:34.618 +07:00 [INF] Executed endpoint 'ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 17:26:34.619 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 56.2959ms
2025-09-05 17:26:36.830 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - null null
2025-09-05 17:26:36.831 +07:00 [INF] REQ GET /api/shop/products sid=0d2b62340b9744f1ad754dc55f322048 sub=null
2025-09-05 17:26:36.832 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 17:26:36.833 +07:00 [INF] Route matched with {action = "List", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem]]] List(System.String, System.Nullable`1[System.Int64], Int32, Int32, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 17:26:36.836 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:p_0='?' (DbType = Int32), :p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."ID" "Id", "p"."NAME" "Name", "p"."SLUG" "Slug"
FROM "HEHE"."PRODUCTS" "p"
WHERE "p"."IS_ACTIVE" = 1
ORDER BY "p"."CREATED_AT" DESC
OFFSET :p_0 ROWS FETCH NEXT :p_1 ROWS ONLY
2025-09-05 17:26:36.842 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", (
    SELECT "p0"."IMAGE_URL"
    FROM "HEHE"."PRODUCT_IMAGES" "p0"
    WHERE (("p0"."PRODUCT_ID" IS NOT NULL AND "p0"."PRODUCT_ID" IN (3, 2, 1)) AND ("p"."PRODUCT_ID" = "p0"."PRODUCT_ID"))
    ORDER BY "p0"."SORT_ORDER"
    FETCH FIRST 1 ROWS ONLY) "Url"
FROM "HEHE"."PRODUCT_IMAGES" "p"
WHERE "p"."PRODUCT_ID" IS NOT NULL AND "p"."PRODUCT_ID" IN (3, 2, 1)
GROUP BY "p"."PRODUCT_ID"
2025-09-05 17:26:36.847 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", MIN(COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")) "MinPrice"
FROM "HEHE"."PRODUCT_VARIANTS" "p"
INNER JOIN "HEHE"."PRODUCT_PRICES" "p0" ON "p"."ID" = "p0"."VARIANT_ID"
WHERE (("p"."PRODUCT_ID" IN (3, 2, 1)) AND ((("p0"."STARTS_AT" <= :now_1) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))))
GROUP BY "p"."PRODUCT_ID"
2025-09-05 17:26:36.848 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem, PHONE_STORE.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-05 17:26:36.849 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API) in 15.2041ms
2025-09-05 17:26:36.849 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 17:26:36.850 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - 200 null application/json; charset=utf-8 20.2882ms
2025-09-05 17:26:36.889 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 17:26:36.892 +07:00 [INF] REQ GET /api/shop/cart sid=0d2b62340b9744f1ad754dc55f322048 sub=null
2025-09-05 17:26:36.893 +07:00 [INF] Executing endpoint 'ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 17:26:36.895 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller ShopCartController (PHONE_STORE.API).
2025-09-05 17:26:36.903 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:uid_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID"
FROM "HEHE"."CUSTOMERS" "c"
WHERE "c"."USER_ACCOUNT_ID" = :uid_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:26:36.906 +07:00 [INF] Cart GET: customerId=2, sid=0d2b62340b9744f1ad754dc55f322048
2025-09-05 17:26:36.909 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:customerId_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."CUSTOMER_ID" = :customerId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:26:36.913 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:26:36.917 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:26:36.921 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 17:26:36.923 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 17:26:36.924 +07:00 [INF] Executed action ShopCartController.Get (PHONE_STORE.API) in 26.7551ms
2025-09-05 17:26:36.925 +07:00 [INF] Executed endpoint 'ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 17:26:36.925 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 36.6062ms
2025-09-05 17:26:39.435 +07:00 [INF] Request starting HTTP/1.1 POST https://localhost:7277/api/auth/logout - application/json; charset=utf-8 null
2025-09-05 17:26:39.437 +07:00 [INF] REQ POST /api/auth/logout sid=null sub=null
2025-09-05 17:26:39.438 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.AuthController.Logout (PHONE_STORE.API)'
2025-09-05 17:26:39.439 +07:00 [INF] Route matched with {action = "Logout", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Logout(RefreshRequest, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.AuthController (PHONE_STORE.API).
2025-09-05 17:26:39.444 +07:00 [INF] Logout: revoked RT
2025-09-05 17:26:39.444 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType1`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-05 17:26:39.445 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.AuthController.Logout (PHONE_STORE.API) in 5.3769ms
2025-09-05 17:26:39.446 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.AuthController.Logout (PHONE_STORE.API)'
2025-09-05 17:26:39.446 +07:00 [INF] Request finished HTTP/1.1 POST https://localhost:7277/api/auth/logout - 200 null application/json; charset=utf-8 11.2075ms
2025-09-05 17:26:39.467 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - null null
2025-09-05 17:26:39.468 +07:00 [INF] REQ GET /api/shop/products sid=0d2b62340b9744f1ad754dc55f322048 sub=null
2025-09-05 17:26:39.469 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 17:26:39.470 +07:00 [INF] Route matched with {action = "List", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem]]] List(System.String, System.Nullable`1[System.Int64], Int32, Int32, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 17:26:39.473 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:p_0='?' (DbType = Int32), :p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."ID" "Id", "p"."NAME" "Name", "p"."SLUG" "Slug"
FROM "HEHE"."PRODUCTS" "p"
WHERE "p"."IS_ACTIVE" = 1
ORDER BY "p"."CREATED_AT" DESC
OFFSET :p_0 ROWS FETCH NEXT :p_1 ROWS ONLY
2025-09-05 17:26:39.476 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", (
    SELECT "p0"."IMAGE_URL"
    FROM "HEHE"."PRODUCT_IMAGES" "p0"
    WHERE (("p0"."PRODUCT_ID" IS NOT NULL AND "p0"."PRODUCT_ID" IN (3, 2, 1)) AND ("p"."PRODUCT_ID" = "p0"."PRODUCT_ID"))
    ORDER BY "p0"."SORT_ORDER"
    FETCH FIRST 1 ROWS ONLY) "Url"
FROM "HEHE"."PRODUCT_IMAGES" "p"
WHERE "p"."PRODUCT_ID" IS NOT NULL AND "p"."PRODUCT_ID" IN (3, 2, 1)
GROUP BY "p"."PRODUCT_ID"
2025-09-05 17:26:39.479 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", MIN(COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")) "MinPrice"
FROM "HEHE"."PRODUCT_VARIANTS" "p"
INNER JOIN "HEHE"."PRODUCT_PRICES" "p0" ON "p"."ID" = "p0"."VARIANT_ID"
WHERE (("p"."PRODUCT_ID" IN (3, 2, 1)) AND ((("p0"."STARTS_AT" <= :now_1) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))))
GROUP BY "p"."PRODUCT_ID"
2025-09-05 17:26:39.480 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem, PHONE_STORE.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-05 17:26:39.481 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API) in 9.8728ms
2025-09-05 17:26:39.481 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 17:26:39.482 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - 200 null application/json; charset=utf-8 14.8107ms
2025-09-05 17:26:39.517 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 17:26:39.519 +07:00 [INF] REQ GET /api/shop/cart sid=0d2b62340b9744f1ad754dc55f322048 sub=null
2025-09-05 17:26:39.519 +07:00 [INF] Executing endpoint 'ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 17:26:39.520 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller ShopCartController (PHONE_STORE.API).
2025-09-05 17:26:39.522 +07:00 [INF] GetCustomerId: no auth (sub missing). Using guest cart. sid=0d2b62340b9744f1ad754dc55f322048
2025-09-05 17:26:39.523 +07:00 [INF] Cart GET: customerId=null, sid=0d2b62340b9744f1ad754dc55f322048
2025-09-05 17:26:39.527 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:26:39.533 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:p0='?' (DbType = DateTime), :p1='?' (Size = 2000), :p2='?' (DbType = Int64), :p3='?' (Size = 64), :p4='?' (Size = 2000), :p5='?' (DbType = DateTime), :cur0='?' (Direction = Output) (DbType = Object)], CommandType='"Text"', CommandTimeout='0']
DECLARE

TYPE "rCARTS_0" IS RECORD
(
"ID" NUMBER(19)
);
TYPE "tCARTS_0" IS TABLE OF "rCARTS_0";
"lCARTS_0" "tCARTS_0";

BEGIN

"lCARTS_0" := "tCARTS_0"();
"lCARTS_0".extend(1);
INSERT INTO "HEHE"."CARTS" ("CREATED_AT", "CURRENCY", "CUSTOMER_ID", "SESSION_TOKEN", "STATUS", "UPDATED_AT")
VALUES (:p0, :p1, :p2, :p3, :p4, :p5)
RETURNING "ID" INTO "lCARTS_0"(1)."ID";
OPEN :cur0 FOR SELECT "lCARTS_0"(1)."ID" FROM DUAL;

END;
2025-09-05 17:26:39.536 +07:00 [INF] EnsureCartId: created new cart #90 (customerId=null, sid=0d2b62340b9744f1ad754dc55f322048)
2025-09-05 17:26:39.540 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:26:39.544 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 17:26:39.545 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 17:26:39.546 +07:00 [INF] Executed action ShopCartController.Get (PHONE_STORE.API) in 24.5783ms
2025-09-05 17:26:39.547 +07:00 [INF] Executed endpoint 'ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 17:26:39.548 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 30.3773ms
2025-09-05 17:26:45.772 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 17:26:45.774 +07:00 [INF] REQ GET /api/shop/cart sid=0d2b62340b9744f1ad754dc55f322048 sub=null
2025-09-05 17:26:45.776 +07:00 [INF] Executing endpoint 'ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 17:26:45.777 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller ShopCartController (PHONE_STORE.API).
2025-09-05 17:26:45.779 +07:00 [INF] GetCustomerId: no auth (sub missing). Using guest cart. sid=0d2b62340b9744f1ad754dc55f322048
2025-09-05 17:26:45.780 +07:00 [INF] Cart GET: customerId=null, sid=0d2b62340b9744f1ad754dc55f322048
2025-09-05 17:26:45.786 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:26:45.792 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:26:45.797 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 17:26:45.799 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 17:26:45.800 +07:00 [INF] Executed action ShopCartController.Get (PHONE_STORE.API) in 20.8454ms
2025-09-05 17:26:45.800 +07:00 [INF] Executed endpoint 'ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 17:26:45.801 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 29.7578ms
2025-09-05 17:26:52.100 +07:00 [INF] Request starting HTTP/1.1 POST https://localhost:7277/api/auth/login - application/json; charset=utf-8 null
2025-09-05 17:26:52.102 +07:00 [INF] REQ POST /api/auth/login sid=null sub=null
2025-09-05 17:26:52.103 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.AuthController.Login (PHONE_STORE.API)'
2025-09-05 17:26:52.104 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(LoginRequest, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.AuthController (PHONE_STORE.API).
2025-09-05 17:26:52.111 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:uname_0='?' (Size = 450), :username_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='0']
SELECT "u"."ID", "u"."CREATED_AT", "u"."EMAIL", "u"."PASSWORD_HASH", "u"."PHONE", "u"."STATUS"
FROM "USER_ACCOUNTS" "u"
WHERE (("u"."EMAIL" = :uname_0) OR ("u"."PHONE" = :username_1))
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:26:52.291 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[:userId_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "r"."CODE"
FROM "USER_ROLES" "u"
INNER JOIN "ROLES" "r" ON "u"."ROLE_ID" = "r"."ID"
WHERE "u"."USER_ID" = :userId_0
2025-09-05 17:26:52.293 +07:00 [INF] Login success [81]
2025-09-05 17:26:52.294 +07:00 [INF] Executing OkObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.AuthResponseDto'.
2025-09-05 17:26:52.295 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.AuthController.Login (PHONE_STORE.API) in 190.1611ms
2025-09-05 17:26:52.296 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.AuthController.Login (PHONE_STORE.API)'
2025-09-05 17:26:52.296 +07:00 [INF] Request finished HTTP/1.1 POST https://localhost:7277/api/auth/login - 200 null application/json; charset=utf-8 196.1154ms
2025-09-05 17:26:52.299 +07:00 [INF] Request starting HTTP/1.1 POST https://localhost:7277/api/shop/cart/merge - null 0
2025-09-05 17:26:52.300 +07:00 [INF] REQ POST /api/shop/cart/merge sid=0d2b62340b9744f1ad754dc55f322048 sub=null
2025-09-05 17:26:52.303 +07:00 [INF] Executing endpoint 'ShopCartController.Merge (PHONE_STORE.API)'
2025-09-05 17:26:52.303 +07:00 [INF] Route matched with {action = "Merge", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Merge(System.Threading.CancellationToken) on controller ShopCartController (PHONE_STORE.API).
2025-09-05 17:26:52.308 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:uid_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID"
FROM "HEHE"."CUSTOMERS" "c"
WHERE "c"."USER_ACCOUNT_ID" = :uid_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:26:52.343 +07:00 [INF] Executed DbCommand (17ms) [Parameters=[:p0='?' (DbType = DateTime), :p1='?' (Size = 150), :p2='?' (Size = 150), :p3='?' (Size = 20), :p4='?' (DbType = DateTime), :p5='?' (DbType = Int64), :cur0='?' (Direction = Output) (DbType = Object)], CommandType='"Text"', CommandTimeout='0']
DECLARE

TYPE "rCUSTOMERS_0" IS RECORD
(
"ID" NUMBER(19)
);
TYPE "tCUSTOMERS_0" IS TABLE OF "rCUSTOMERS_0";
"lCUSTOMERS_0" "tCUSTOMERS_0";

BEGIN

"lCUSTOMERS_0" := "tCUSTOMERS_0"();
"lCUSTOMERS_0".extend(1);
INSERT INTO "HEHE"."CUSTOMERS" ("CREATED_AT", "EMAIL", "FULL_NAME", "PHONE", "UPDATED_AT", "USER_ACCOUNT_ID")
VALUES (:p0, :p1, :p2, :p3, :p4, :p5)
RETURNING "ID" INTO "lCUSTOMERS_0"(1)."ID";
OPEN :cur0 FOR SELECT "lCUSTOMERS_0"(1)."ID" FROM DUAL;

END;
2025-09-05 17:26:52.348 +07:00 [INF] Auto-created Customer row id=21 for user id=81
2025-09-05 17:26:52.349 +07:00 [INF] Merge: sid=0d2b62340b9744f1ad754dc55f322048 -> customerId=21
2025-09-05 17:26:52.354 +07:00 [INF] Executed DbCommand (4ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c1"."ID", "c1"."CREATED_AT", "c1"."CURRENCY", "c1"."CUSTOMER_ID", "c1"."SESSION_TOKEN", "c1"."STATUS", "c1"."UPDATED_AT", "c0"."CART_ID", "c0"."VARIANT_ID", "c0"."ADDED_AT", "c0"."CURRENCY", "c0"."QUANTITY", "c0"."UNIT_PRICE"
FROM (
    SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
    FROM "HEHE"."CARTS" "c"
    WHERE "c"."SESSION_TOKEN" = :sessionId_0
    FETCH FIRST 1 ROWS ONLY
) "c1"
LEFT JOIN "HEHE"."CART_ITEMS" "c0" ON "c1"."ID" = "c0"."CART_ID"
ORDER BY "c1"."ID", "c0"."CART_ID"
2025-09-05 17:26:52.356 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:customerId_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c1"."ID", "c1"."CREATED_AT", "c1"."CURRENCY", "c1"."CUSTOMER_ID", "c1"."SESSION_TOKEN", "c1"."STATUS", "c1"."UPDATED_AT", "c0"."CART_ID", "c0"."VARIANT_ID", "c0"."ADDED_AT", "c0"."CURRENCY", "c0"."QUANTITY", "c0"."UNIT_PRICE"
FROM (
    SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
    FROM "HEHE"."CARTS" "c"
    WHERE "c"."CUSTOMER_ID" = :customerId_0
    FETCH FIRST 1 ROWS ONLY
) "c1"
LEFT JOIN "HEHE"."CART_ITEMS" "c0" ON "c1"."ID" = "c0"."CART_ID"
ORDER BY "c1"."ID", "c0"."CART_ID"
2025-09-05 17:26:52.358 +07:00 [INF] Merge: created user cart for customerId=21
2025-09-05 17:26:52.360 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:p0='?' (DbType = Int64), :cur0='?' (Direction = Output) (DbType = Object), :p1='?' (DbType = DateTime), :p2='?' (Size = 2000), :p3='?' (DbType = Int64), :p4='?' (Size = 64), :p5='?' (Size = 2000), :p6='?' (DbType = DateTime), :cur1='?' (Direction = Output) (DbType = Object)], CommandType='"Text"', CommandTimeout='0']
DECLARE

v_RowCount INTEGER;
TYPE "rCARTS_1" IS RECORD
(
"ID" NUMBER(19)
);
TYPE "tCARTS_1" IS TABLE OF "rCARTS_1";
"lCARTS_1" "tCARTS_1";

BEGIN

DELETE FROM "HEHE"."CARTS"
WHERE "ID" = :p0;
v_RowCount := SQL%ROWCOUNT;
OPEN :cur0 FOR SELECT v_RowCount FROM DUAL;
"lCARTS_1" := "tCARTS_1"();
"lCARTS_1".extend(1);
INSERT INTO "HEHE"."CARTS" ("CREATED_AT", "CURRENCY", "CUSTOMER_ID", "SESSION_TOKEN", "STATUS", "UPDATED_AT")
VALUES (:p1, :p2, :p3, :p4, :p5, :p6)
RETURNING "ID" INTO "lCARTS_1"(1)."ID";
OPEN :cur1 FOR SELECT "lCARTS_1"(1)."ID" FROM DUAL;

END;
2025-09-05 17:26:52.363 +07:00 [INF] Merge: done. guest cart removed.
2025-09-05 17:26:52.364 +07:00 [INF] Executing StatusCodeResult, setting HTTP status code 200
2025-09-05 17:26:52.364 +07:00 [INF] Executed action ShopCartController.Merge (PHONE_STORE.API) in 60.1391ms
2025-09-05 17:26:52.365 +07:00 [INF] Executed endpoint 'ShopCartController.Merge (PHONE_STORE.API)'
2025-09-05 17:26:52.365 +07:00 [INF] Request finished HTTP/1.1 POST https://localhost:7277/api/shop/cart/merge - 200 0 null 65.6924ms
2025-09-05 17:26:52.387 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - null null
2025-09-05 17:26:52.388 +07:00 [INF] REQ GET /api/shop/products sid=0d2b62340b9744f1ad754dc55f322048 sub=null
2025-09-05 17:26:52.389 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 17:26:52.390 +07:00 [INF] Route matched with {action = "List", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem]]] List(System.String, System.Nullable`1[System.Int64], Int32, Int32, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 17:26:52.393 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:p_0='?' (DbType = Int32), :p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."ID" "Id", "p"."NAME" "Name", "p"."SLUG" "Slug"
FROM "HEHE"."PRODUCTS" "p"
WHERE "p"."IS_ACTIVE" = 1
ORDER BY "p"."CREATED_AT" DESC
OFFSET :p_0 ROWS FETCH NEXT :p_1 ROWS ONLY
2025-09-05 17:26:52.396 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", (
    SELECT "p0"."IMAGE_URL"
    FROM "HEHE"."PRODUCT_IMAGES" "p0"
    WHERE (("p0"."PRODUCT_ID" IS NOT NULL AND "p0"."PRODUCT_ID" IN (3, 2, 1)) AND ("p"."PRODUCT_ID" = "p0"."PRODUCT_ID"))
    ORDER BY "p0"."SORT_ORDER"
    FETCH FIRST 1 ROWS ONLY) "Url"
FROM "HEHE"."PRODUCT_IMAGES" "p"
WHERE "p"."PRODUCT_ID" IS NOT NULL AND "p"."PRODUCT_ID" IN (3, 2, 1)
GROUP BY "p"."PRODUCT_ID"
2025-09-05 17:26:52.398 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", MIN(COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")) "MinPrice"
FROM "HEHE"."PRODUCT_VARIANTS" "p"
INNER JOIN "HEHE"."PRODUCT_PRICES" "p0" ON "p"."ID" = "p0"."VARIANT_ID"
WHERE (("p"."PRODUCT_ID" IN (3, 2, 1)) AND ((("p0"."STARTS_AT" <= :now_1) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))))
GROUP BY "p"."PRODUCT_ID"
2025-09-05 17:26:52.399 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem, PHONE_STORE.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-05 17:26:52.400 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API) in 9.158ms
2025-09-05 17:26:52.400 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 17:26:52.401 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - 200 null application/json; charset=utf-8 14.2901ms
2025-09-05 17:26:52.448 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 17:26:52.450 +07:00 [INF] REQ GET /api/shop/cart sid=0d2b62340b9744f1ad754dc55f322048 sub=null
2025-09-05 17:26:52.452 +07:00 [INF] Executing endpoint 'ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 17:26:52.453 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller ShopCartController (PHONE_STORE.API).
2025-09-05 17:26:52.458 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:uid_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID"
FROM "HEHE"."CUSTOMERS" "c"
WHERE "c"."USER_ACCOUNT_ID" = :uid_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:26:52.460 +07:00 [INF] Cart GET: customerId=21, sid=0d2b62340b9744f1ad754dc55f322048
2025-09-05 17:26:52.462 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:customerId_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."CUSTOMER_ID" = :customerId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:26:52.468 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:26:52.476 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:26:52.482 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 17:26:52.484 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 17:26:52.486 +07:00 [INF] Executed action ShopCartController.Get (PHONE_STORE.API) in 31.6042ms
2025-09-05 17:26:52.487 +07:00 [INF] Executed endpoint 'ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 17:26:52.489 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 40.7525ms
2025-09-05 17:26:54.945 +07:00 [INF] Request starting HTTP/1.1 POST https://localhost:7277/api/auth/logout - application/json; charset=utf-8 null
2025-09-05 17:26:54.947 +07:00 [INF] REQ POST /api/auth/logout sid=null sub=null
2025-09-05 17:26:54.948 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.AuthController.Logout (PHONE_STORE.API)'
2025-09-05 17:26:54.948 +07:00 [INF] Route matched with {action = "Logout", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Logout(RefreshRequest, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.AuthController (PHONE_STORE.API).
2025-09-05 17:26:54.951 +07:00 [INF] Logout: revoked RT
2025-09-05 17:26:54.953 +07:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType1`1[[System.String, System.Private.CoreLib, Version=8.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2025-09-05 17:26:54.954 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.AuthController.Logout (PHONE_STORE.API) in 4.3383ms
2025-09-05 17:26:54.955 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.AuthController.Logout (PHONE_STORE.API)'
2025-09-05 17:26:54.955 +07:00 [INF] Request finished HTTP/1.1 POST https://localhost:7277/api/auth/logout - 200 null application/json; charset=utf-8 10.7149ms
2025-09-05 17:26:54.978 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - null null
2025-09-05 17:26:54.980 +07:00 [INF] REQ GET /api/shop/products sid=0d2b62340b9744f1ad754dc55f322048 sub=null
2025-09-05 17:26:54.980 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 17:26:54.981 +07:00 [INF] Route matched with {action = "List", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem]]] List(System.String, System.Nullable`1[System.Int64], Int32, Int32, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 17:26:54.984 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:p_0='?' (DbType = Int32), :p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."ID" "Id", "p"."NAME" "Name", "p"."SLUG" "Slug"
FROM "HEHE"."PRODUCTS" "p"
WHERE "p"."IS_ACTIVE" = 1
ORDER BY "p"."CREATED_AT" DESC
OFFSET :p_0 ROWS FETCH NEXT :p_1 ROWS ONLY
2025-09-05 17:26:54.989 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", (
    SELECT "p0"."IMAGE_URL"
    FROM "HEHE"."PRODUCT_IMAGES" "p0"
    WHERE (("p0"."PRODUCT_ID" IS NOT NULL AND "p0"."PRODUCT_ID" IN (3, 2, 1)) AND ("p"."PRODUCT_ID" = "p0"."PRODUCT_ID"))
    ORDER BY "p0"."SORT_ORDER"
    FETCH FIRST 1 ROWS ONLY) "Url"
FROM "HEHE"."PRODUCT_IMAGES" "p"
WHERE "p"."PRODUCT_ID" IS NOT NULL AND "p"."PRODUCT_ID" IN (3, 2, 1)
GROUP BY "p"."PRODUCT_ID"
2025-09-05 17:26:54.991 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", MIN(COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")) "MinPrice"
FROM "HEHE"."PRODUCT_VARIANTS" "p"
INNER JOIN "HEHE"."PRODUCT_PRICES" "p0" ON "p"."ID" = "p0"."VARIANT_ID"
WHERE (("p"."PRODUCT_ID" IN (3, 2, 1)) AND ((("p0"."STARTS_AT" <= :now_1) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))))
GROUP BY "p"."PRODUCT_ID"
2025-09-05 17:26:54.993 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem, PHONE_STORE.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-05 17:26:54.993 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API) in 11.617ms
2025-09-05 17:26:54.994 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 17:26:54.995 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - 200 null application/json; charset=utf-8 16.6226ms
2025-09-05 17:26:55.048 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 17:26:55.050 +07:00 [INF] REQ GET /api/shop/cart sid=0d2b62340b9744f1ad754dc55f322048 sub=null
2025-09-05 17:26:55.051 +07:00 [INF] Executing endpoint 'ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 17:26:55.052 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller ShopCartController (PHONE_STORE.API).
2025-09-05 17:26:55.053 +07:00 [INF] GetCustomerId: no auth (sub missing). Using guest cart. sid=0d2b62340b9744f1ad754dc55f322048
2025-09-05 17:26:55.054 +07:00 [INF] Cart GET: customerId=null, sid=0d2b62340b9744f1ad754dc55f322048
2025-09-05 17:26:55.058 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:26:55.063 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:p0='?' (DbType = DateTime), :p1='?' (Size = 2000), :p2='?' (DbType = Int64), :p3='?' (Size = 64), :p4='?' (Size = 2000), :p5='?' (DbType = DateTime), :cur0='?' (Direction = Output) (DbType = Object)], CommandType='"Text"', CommandTimeout='0']
DECLARE

TYPE "rCARTS_0" IS RECORD
(
"ID" NUMBER(19)
);
TYPE "tCARTS_0" IS TABLE OF "rCARTS_0";
"lCARTS_0" "tCARTS_0";

BEGIN

"lCARTS_0" := "tCARTS_0"();
"lCARTS_0".extend(1);
INSERT INTO "HEHE"."CARTS" ("CREATED_AT", "CURRENCY", "CUSTOMER_ID", "SESSION_TOKEN", "STATUS", "UPDATED_AT")
VALUES (:p0, :p1, :p2, :p3, :p4, :p5)
RETURNING "ID" INTO "lCARTS_0"(1)."ID";
OPEN :cur0 FOR SELECT "lCARTS_0"(1)."ID" FROM DUAL;

END;
2025-09-05 17:26:55.067 +07:00 [INF] EnsureCartId: created new cart #92 (customerId=null, sid=0d2b62340b9744f1ad754dc55f322048)
2025-09-05 17:26:55.070 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:26:55.073 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 17:26:55.075 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 17:26:55.076 +07:00 [INF] Executed action ShopCartController.Get (PHONE_STORE.API) in 22.368ms
2025-09-05 17:26:55.076 +07:00 [INF] Executed endpoint 'ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 17:26:55.077 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 29.5079ms
2025-09-05 17:26:56.796 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 17:26:56.799 +07:00 [INF] REQ GET /api/shop/cart sid=0d2b62340b9744f1ad754dc55f322048 sub=null
2025-09-05 17:26:56.800 +07:00 [INF] Executing endpoint 'ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 17:26:56.801 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller ShopCartController (PHONE_STORE.API).
2025-09-05 17:26:56.803 +07:00 [INF] GetCustomerId: no auth (sub missing). Using guest cart. sid=0d2b62340b9744f1ad754dc55f322048
2025-09-05 17:26:56.803 +07:00 [INF] Cart GET: customerId=null, sid=0d2b62340b9744f1ad754dc55f322048
2025-09-05 17:26:56.807 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:26:56.811 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:26:56.815 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 17:26:56.818 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 17:26:56.819 +07:00 [INF] Executed action ShopCartController.Get (PHONE_STORE.API) in 16.8282ms
2025-09-05 17:26:56.821 +07:00 [INF] Executed endpoint 'ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 17:26:56.822 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 25.8076ms
2025-09-05 17:27:04.666 +07:00 [INF] Request starting HTTP/1.1 POST https://localhost:7277/api/auth/login - application/json; charset=utf-8 null
2025-09-05 17:27:04.668 +07:00 [INF] REQ POST /api/auth/login sid=null sub=null
2025-09-05 17:27:04.670 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.AuthController.Login (PHONE_STORE.API)'
2025-09-05 17:27:04.670 +07:00 [INF] Route matched with {action = "Login", controller = "Auth"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Login(LoginRequest, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.AuthController (PHONE_STORE.API).
2025-09-05 17:27:04.677 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:uname_0='?' (Size = 450), :username_1='?' (Size = 450)], CommandType='"Text"', CommandTimeout='0']
SELECT "u"."ID", "u"."CREATED_AT", "u"."EMAIL", "u"."PASSWORD_HASH", "u"."PHONE", "u"."STATUS"
FROM "USER_ACCOUNTS" "u"
WHERE (("u"."EMAIL" = :uname_0) OR ("u"."PHONE" = :username_1))
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:27:04.822 +07:00 [INF] Executed DbCommand (5ms) [Parameters=[:userId_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "r"."CODE"
FROM "USER_ROLES" "u"
INNER JOIN "ROLES" "r" ON "u"."ROLE_ID" = "r"."ID"
WHERE "u"."USER_ID" = :userId_0
2025-09-05 17:27:04.824 +07:00 [INF] Login success [21]
2025-09-05 17:27:04.825 +07:00 [INF] Executing OkObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.AuthResponseDto'.
2025-09-05 17:27:04.825 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.AuthController.Login (PHONE_STORE.API) in 154.0125ms
2025-09-05 17:27:04.826 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.AuthController.Login (PHONE_STORE.API)'
2025-09-05 17:27:04.827 +07:00 [INF] Request finished HTTP/1.1 POST https://localhost:7277/api/auth/login - 200 null application/json; charset=utf-8 160.8207ms
2025-09-05 17:27:04.830 +07:00 [INF] Request starting HTTP/1.1 POST https://localhost:7277/api/shop/cart/merge - null 0
2025-09-05 17:27:04.831 +07:00 [INF] REQ POST /api/shop/cart/merge sid=0d2b62340b9744f1ad754dc55f322048 sub=null
2025-09-05 17:27:04.832 +07:00 [INF] Executing endpoint 'ShopCartController.Merge (PHONE_STORE.API)'
2025-09-05 17:27:04.833 +07:00 [INF] Route matched with {action = "Merge", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Merge(System.Threading.CancellationToken) on controller ShopCartController (PHONE_STORE.API).
2025-09-05 17:27:04.838 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:uid_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID"
FROM "HEHE"."CUSTOMERS" "c"
WHERE "c"."USER_ACCOUNT_ID" = :uid_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:27:04.840 +07:00 [INF] Merge: sid=0d2b62340b9744f1ad754dc55f322048 -> customerId=2
2025-09-05 17:27:04.844 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c1"."ID", "c1"."CREATED_AT", "c1"."CURRENCY", "c1"."CUSTOMER_ID", "c1"."SESSION_TOKEN", "c1"."STATUS", "c1"."UPDATED_AT", "c0"."CART_ID", "c0"."VARIANT_ID", "c0"."ADDED_AT", "c0"."CURRENCY", "c0"."QUANTITY", "c0"."UNIT_PRICE"
FROM (
    SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
    FROM "HEHE"."CARTS" "c"
    WHERE "c"."SESSION_TOKEN" = :sessionId_0
    FETCH FIRST 1 ROWS ONLY
) "c1"
LEFT JOIN "HEHE"."CART_ITEMS" "c0" ON "c1"."ID" = "c0"."CART_ID"
ORDER BY "c1"."ID", "c0"."CART_ID"
2025-09-05 17:27:04.849 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:customerId_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c1"."ID", "c1"."CREATED_AT", "c1"."CURRENCY", "c1"."CUSTOMER_ID", "c1"."SESSION_TOKEN", "c1"."STATUS", "c1"."UPDATED_AT", "c0"."CART_ID", "c0"."VARIANT_ID", "c0"."ADDED_AT", "c0"."CURRENCY", "c0"."QUANTITY", "c0"."UNIT_PRICE"
FROM (
    SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
    FROM "HEHE"."CARTS" "c"
    WHERE "c"."CUSTOMER_ID" = :customerId_0
    FETCH FIRST 1 ROWS ONLY
) "c1"
LEFT JOIN "HEHE"."CART_ITEMS" "c0" ON "c1"."ID" = "c0"."CART_ID"
ORDER BY "c1"."ID", "c0"."CART_ID"
2025-09-05 17:27:04.856 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:p0='?' (DbType = Int64), :cur0='?' (Direction = Output) (DbType = Object)], CommandType='"Text"', CommandTimeout='0']
DECLARE

v_RowCount INTEGER;

BEGIN

DELETE FROM "HEHE"."CARTS"
WHERE "ID" = :p0;
v_RowCount := SQL%ROWCOUNT;
OPEN :cur0 FOR SELECT v_RowCount FROM DUAL;

END;
2025-09-05 17:27:04.867 +07:00 [INF] Merge: done. guest cart removed.
2025-09-05 17:27:04.867 +07:00 [INF] Executing StatusCodeResult, setting HTTP status code 200
2025-09-05 17:27:04.868 +07:00 [INF] Executed action ShopCartController.Merge (PHONE_STORE.API) in 33.8032ms
2025-09-05 17:27:04.868 +07:00 [INF] Executed endpoint 'ShopCartController.Merge (PHONE_STORE.API)'
2025-09-05 17:27:04.870 +07:00 [INF] Request finished HTTP/1.1 POST https://localhost:7277/api/shop/cart/merge - 200 0 null 40.082ms
2025-09-05 17:27:04.895 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - null null
2025-09-05 17:27:04.897 +07:00 [INF] REQ GET /api/shop/products sid=0d2b62340b9744f1ad754dc55f322048 sub=null
2025-09-05 17:27:04.898 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 17:27:04.898 +07:00 [INF] Route matched with {action = "List", controller = "ShopProducts"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem]]] List(System.String, System.Nullable`1[System.Int64], Int32, Int32, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopProductsController (PHONE_STORE.API).
2025-09-05 17:27:04.902 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:p_0='?' (DbType = Int32), :p_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."ID" "Id", "p"."NAME" "Name", "p"."SLUG" "Slug"
FROM "HEHE"."PRODUCTS" "p"
WHERE "p"."IS_ACTIVE" = 1
ORDER BY "p"."CREATED_AT" DESC
OFFSET :p_0 ROWS FETCH NEXT :p_1 ROWS ONLY
2025-09-05 17:27:04.905 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", (
    SELECT "p0"."IMAGE_URL"
    FROM "HEHE"."PRODUCT_IMAGES" "p0"
    WHERE (("p0"."PRODUCT_ID" IS NOT NULL AND "p0"."PRODUCT_ID" IN (3, 2, 1)) AND ("p"."PRODUCT_ID" = "p0"."PRODUCT_ID"))
    ORDER BY "p0"."SORT_ORDER"
    FETCH FIRST 1 ROWS ONLY) "Url"
FROM "HEHE"."PRODUCT_IMAGES" "p"
WHERE "p"."PRODUCT_ID" IS NOT NULL AND "p"."PRODUCT_ID" IN (3, 2, 1)
GROUP BY "p"."PRODUCT_ID"
2025-09-05 17:27:04.907 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:now_1='?' (DbType = DateTime), :now_2='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='0']
SELECT "p"."PRODUCT_ID" "ProductId", MIN(COALESCE("p0"."SALE_PRICE", "p0"."LIST_PRICE")) "MinPrice"
FROM "HEHE"."PRODUCT_VARIANTS" "p"
INNER JOIN "HEHE"."PRODUCT_PRICES" "p0" ON "p"."ID" = "p0"."VARIANT_ID"
WHERE (("p"."PRODUCT_ID" IN (3, 2, 1)) AND ((("p0"."STARTS_AT" <= :now_1) AND ((("p0"."ENDS_AT" IS NULL) OR ("p0"."ENDS_AT" > :now_2))))))
GROUP BY "p"."PRODUCT_ID"
2025-09-05 17:27:04.909 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[PHONE_STORE.API.Controllers.ShopProductsController+ShopProductListItem, PHONE_STORE.API, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-05 17:27:04.909 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API) in 10.2734ms
2025-09-05 17:27:04.910 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopProductsController.List (PHONE_STORE.API)'
2025-09-05 17:27:04.911 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/products?q=&catId=&page=1 - 200 null application/json; charset=utf-8 15.3588ms
2025-09-05 17:27:04.954 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 17:27:04.958 +07:00 [INF] REQ GET /api/shop/cart sid=0d2b62340b9744f1ad754dc55f322048 sub=null
2025-09-05 17:27:04.961 +07:00 [INF] Executing endpoint 'ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 17:27:04.964 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller ShopCartController (PHONE_STORE.API).
2025-09-05 17:27:04.969 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:uid_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID"
FROM "HEHE"."CUSTOMERS" "c"
WHERE "c"."USER_ACCOUNT_ID" = :uid_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:27:04.971 +07:00 [INF] Cart GET: customerId=2, sid=0d2b62340b9744f1ad754dc55f322048
2025-09-05 17:27:04.974 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:customerId_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."CUSTOMER_ID" = :customerId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:27:04.977 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:27:04.981 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:27:04.985 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 17:27:04.987 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 17:27:04.988 +07:00 [INF] Executed action ShopCartController.Get (PHONE_STORE.API) in 22.225ms
2025-09-05 17:27:04.988 +07:00 [INF] Executed endpoint 'ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 17:27:04.989 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 34.5334ms
2025-09-05 17:27:06.610 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 17:27:06.611 +07:00 [INF] REQ GET /api/shop/cart sid=0d2b62340b9744f1ad754dc55f322048 sub=null
2025-09-05 17:27:06.612 +07:00 [INF] Executing endpoint 'ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 17:27:06.613 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller ShopCartController (PHONE_STORE.API).
2025-09-05 17:27:06.616 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:uid_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID"
FROM "HEHE"."CUSTOMERS" "c"
WHERE "c"."USER_ACCOUNT_ID" = :uid_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:27:06.617 +07:00 [INF] Cart GET: customerId=2, sid=0d2b62340b9744f1ad754dc55f322048
2025-09-05 17:27:06.620 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:customerId_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."CUSTOMER_ID" = :customerId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:27:06.622 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:27:06.624 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:27:06.626 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 17:27:06.628 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 17:27:06.628 +07:00 [INF] Executed action ShopCartController.Get (PHONE_STORE.API) in 14.6175ms
2025-09-05 17:27:06.629 +07:00 [INF] Executed endpoint 'ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 17:27:06.630 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 19.4394ms
2025-09-05 17:27:06.663 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/cart - null null
2025-09-05 17:27:06.665 +07:00 [INF] REQ GET /api/shop/cart sid=0d2b62340b9744f1ad754dc55f322048 sub=null
2025-09-05 17:27:06.667 +07:00 [INF] Executing endpoint 'ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 17:27:06.668 +07:00 [INF] Route matched with {action = "Get", controller = "ShopCart"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CartDto] Get(System.Threading.CancellationToken) on controller ShopCartController (PHONE_STORE.API).
2025-09-05 17:27:06.671 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:uid_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID"
FROM "HEHE"."CUSTOMERS" "c"
WHERE "c"."USER_ACCOUNT_ID" = :uid_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:27:06.673 +07:00 [INF] Cart GET: customerId=2, sid=0d2b62340b9744f1ad754dc55f322048
2025-09-05 17:27:06.675 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:customerId_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."CUSTOMER_ID" = :customerId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:27:06.679 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:27:06.681 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:27:06.684 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 17:27:06.687 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CartDto'.
2025-09-05 17:27:06.688 +07:00 [INF] Executed action ShopCartController.Get (PHONE_STORE.API) in 18.8974ms
2025-09-05 17:27:06.689 +07:00 [INF] Executed endpoint 'ShopCartController.Get (PHONE_STORE.API)'
2025-09-05 17:27:06.690 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/cart - 200 null application/json; charset=utf-8 27.7815ms
2025-09-05 17:27:07.798 +07:00 [INF] Request starting HTTP/1.1 GET https://localhost:7277/api/shop/me/addresses - null null
2025-09-05 17:27:07.799 +07:00 [INF] REQ GET /api/shop/me/addresses sid=0d2b62340b9744f1ad754dc55f322048 sub=null
2025-09-05 17:27:07.801 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopMeController.MyAddresses (PHONE_STORE.API)'
2025-09-05 17:27:07.805 +07:00 [INF] Route matched with {action = "MyAddresses", controller = "ShopMe"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.ActionResult`1[System.Collections.Generic.List`1[PHONE_STORE.Application.Dtos.AddressDto]]] MyAddresses(System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopMeController (PHONE_STORE.API).
2025-09-05 17:27:07.818 +07:00 [INF] Executed DbCommand (3ms) [Parameters=[:userId_Value_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID"
FROM "HEHE"."CUSTOMERS" "c"
WHERE "c"."USER_ACCOUNT_ID" = :userId_Value_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:27:07.852 +07:00 [INF] Executed DbCommand (26ms) [Parameters=[:cusId_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "a"."ID", "a"."CUSTOMER_ID", "a"."LABEL", "a"."RECIPIENT", "a"."PHONE", "a"."LINE1", "a"."WARD", "a"."DISTRICT", "a"."PROVINCE", "a"."POSTAL_CODE", "a"."ADDRESS_TYPE", "a"."IS_DEFAULT", "a"."CREATED_AT", "a"."UPDATED_AT"
FROM "HEHE"."ADDRESSES" "a"
WHERE "a"."CUSTOMER_ID" = :cusId_0
ORDER BY "a"."IS_DEFAULT" DESC, COALESCE("a"."UPDATED_AT", "a"."CREATED_AT") DESC
2025-09-05 17:27:07.855 +07:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[PHONE_STORE.Application.Dtos.AddressDto, PHONE_STORE.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-05 17:27:07.861 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopMeController.MyAddresses (PHONE_STORE.API) in 54.3188ms
2025-09-05 17:27:07.862 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopMeController.MyAddresses (PHONE_STORE.API)'
2025-09-05 17:27:07.863 +07:00 [INF] Request finished HTTP/1.1 GET https://localhost:7277/api/shop/me/addresses - 200 null application/json; charset=utf-8 64.8353ms
2025-09-05 17:27:07.873 +07:00 [INF] Request starting HTTP/1.1 POST https://localhost:7277/api/shop/checkout/preview - application/json; charset=utf-8 null
2025-09-05 17:27:07.874 +07:00 [INF] REQ POST /api/shop/checkout/preview sid=0d2b62340b9744f1ad754dc55f322048 sub=null
2025-09-05 17:27:07.875 +07:00 [INF] Executing endpoint 'PHONE_STORE.API.Controllers.ShopCheckoutController.Preview (PHONE_STORE.API)'
2025-09-05 17:27:07.877 +07:00 [INF] Route matched with {action = "Preview", controller = "ShopCheckout"}. Executing controller action with signature System.Threading.Tasks.Task`1[PHONE_STORE.Application.Dtos.CheckoutPreviewResult] Preview(PHONE_STORE.Application.Dtos.CheckoutPreviewRequest, System.Threading.CancellationToken) on controller PHONE_STORE.API.Controllers.ShopCheckoutController (PHONE_STORE.API).
2025-09-05 17:27:07.889 +07:00 [INF] Executed DbCommand (2ms) [Parameters=[:userId_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID"
FROM "HEHE"."CUSTOMERS" "c"
WHERE "c"."USER_ACCOUNT_ID" = :userId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:27:07.891 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:customerId_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."CUSTOMER_ID" = :customerId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:27:07.893 +07:00 [INF] Executed DbCommand (0ms) [Parameters=[:sessionId_0='?' (Size = 64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."SESSION_TOKEN" = :sessionId_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:27:07.895 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."ID", "c"."CREATED_AT", "c"."CURRENCY", "c"."CUSTOMER_ID", "c"."SESSION_TOKEN", "c"."STATUS", "c"."UPDATED_AT"
FROM "HEHE"."CARTS" "c"
WHERE "c"."ID" = :id_0
FETCH FIRST 1 ROWS ONLY
2025-09-05 17:27:07.897 +07:00 [INF] Executed DbCommand (1ms) [Parameters=[:id_0='?' (DbType = Int64)], CommandType='"Text"', CommandTimeout='0']
SELECT "c"."CART_ID", "c"."VARIANT_ID", "c"."ADDED_AT", "c"."CURRENCY", "c"."QUANTITY", "c"."UNIT_PRICE", "p"."ID", "p"."BARCODE", "p"."COLOR", "p"."IS_ACTIVE", "p"."PRODUCT_ID", "p"."SKU", "p"."STORAGE_GB", "p"."WEIGHT_GRAM"
FROM "HEHE"."CART_ITEMS" "c"
INNER JOIN "HEHE"."PRODUCT_VARIANTS" "p" ON "c"."VARIANT_ID" = "p"."ID"
WHERE "c"."CART_ID" = :id_0
2025-09-05 17:27:07.901 +07:00 [INF] Executing ObjectResult, writing value of type 'PHONE_STORE.Application.Dtos.CheckoutPreviewResult'.
2025-09-05 17:27:07.904 +07:00 [INF] Executed action PHONE_STORE.API.Controllers.ShopCheckoutController.Preview (PHONE_STORE.API) in 26.0029ms
2025-09-05 17:27:07.905 +07:00 [INF] Executed endpoint 'PHONE_STORE.API.Controllers.ShopCheckoutController.Preview (PHONE_STORE.API)'
2025-09-05 17:27:07.906 +07:00 [INF] Request finished HTTP/1.1 POST https://localhost:7277/api/shop/checkout/preview - 200 null application/json; charset=utf-8 33.5954ms
